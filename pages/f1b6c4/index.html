<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>NginxåŸºç¡€ | Pangolin Note</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="å¤§é“è‡³ç®€">
    <meta name="keywords" content="å‰ç«¯åšå®¢,ä¸ªäººæŠ€æœ¯åšå®¢,å‰ç«¯,å‰ç«¯å¼€å‘,å‰ç«¯æ¡†æ¶,webå‰ç«¯,å‰ç«¯é¢è¯•é¢˜,æŠ€æœ¯æ–‡æ¡£,å­¦ä¹ ,é¢è¯•,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.56073ad3.css" as="style"><link rel="preload" href="/assets/js/app.3f3e0e10.js" as="script"><link rel="preload" href="/assets/js/2.e9fcb30c.js" as="script"><link rel="preload" href="/assets/js/3.1998f389.js" as="script"><link rel="preload" href="/assets/js/164.a1cc0109.js" as="script"><link rel="prefetch" href="/assets/js/10.0b55747f.js"><link rel="prefetch" href="/assets/js/100.b8912a99.js"><link rel="prefetch" href="/assets/js/101.a6740c8a.js"><link rel="prefetch" href="/assets/js/102.e31e89b2.js"><link rel="prefetch" href="/assets/js/103.2c5dbdae.js"><link rel="prefetch" href="/assets/js/104.0e9c02f6.js"><link rel="prefetch" href="/assets/js/105.8288396c.js"><link rel="prefetch" href="/assets/js/106.62f43c11.js"><link rel="prefetch" href="/assets/js/107.70c90211.js"><link rel="prefetch" href="/assets/js/108.b488ce56.js"><link rel="prefetch" href="/assets/js/109.12942650.js"><link rel="prefetch" href="/assets/js/11.ac3fd1ca.js"><link rel="prefetch" href="/assets/js/110.1e57ecba.js"><link rel="prefetch" href="/assets/js/111.6e33b4ea.js"><link rel="prefetch" href="/assets/js/112.bd52831b.js"><link rel="prefetch" href="/assets/js/113.868c1ac9.js"><link rel="prefetch" href="/assets/js/114.090549d1.js"><link rel="prefetch" href="/assets/js/115.d97f6c2b.js"><link rel="prefetch" href="/assets/js/116.097c4b4e.js"><link rel="prefetch" href="/assets/js/117.4024cfe2.js"><link rel="prefetch" href="/assets/js/118.e3057cba.js"><link rel="prefetch" href="/assets/js/119.4ef1fa3b.js"><link rel="prefetch" href="/assets/js/12.863eaabe.js"><link rel="prefetch" href="/assets/js/120.78f9df50.js"><link rel="prefetch" href="/assets/js/121.8e16df87.js"><link rel="prefetch" href="/assets/js/122.f21c0107.js"><link rel="prefetch" href="/assets/js/123.ea1cb375.js"><link rel="prefetch" href="/assets/js/124.01c04c6e.js"><link rel="prefetch" href="/assets/js/125.d383e301.js"><link rel="prefetch" href="/assets/js/126.3162cb47.js"><link rel="prefetch" href="/assets/js/127.c6bebae6.js"><link rel="prefetch" href="/assets/js/128.d659db60.js"><link rel="prefetch" href="/assets/js/129.2afdcf48.js"><link rel="prefetch" href="/assets/js/13.4f59ce35.js"><link rel="prefetch" href="/assets/js/130.beb9ed9d.js"><link rel="prefetch" href="/assets/js/131.35b05f8a.js"><link rel="prefetch" href="/assets/js/132.d77f4f93.js"><link rel="prefetch" href="/assets/js/133.4ceda6e5.js"><link rel="prefetch" href="/assets/js/134.11390c5f.js"><link rel="prefetch" href="/assets/js/135.32f9e38f.js"><link rel="prefetch" href="/assets/js/136.6d8bb0f2.js"><link rel="prefetch" href="/assets/js/137.9c0ffeef.js"><link rel="prefetch" href="/assets/js/138.88d86e5f.js"><link rel="prefetch" href="/assets/js/139.8c2c3d6c.js"><link rel="prefetch" href="/assets/js/14.11c82d35.js"><link rel="prefetch" href="/assets/js/140.c5c375d3.js"><link rel="prefetch" href="/assets/js/141.d703f30b.js"><link rel="prefetch" href="/assets/js/142.6a005a44.js"><link rel="prefetch" href="/assets/js/143.9b2edf6f.js"><link rel="prefetch" href="/assets/js/144.3fd013c9.js"><link rel="prefetch" href="/assets/js/145.b05079c5.js"><link rel="prefetch" href="/assets/js/146.ed5360a6.js"><link rel="prefetch" href="/assets/js/147.7408d86f.js"><link rel="prefetch" href="/assets/js/148.f390b370.js"><link rel="prefetch" href="/assets/js/149.95017f0a.js"><link rel="prefetch" href="/assets/js/15.bd143bd5.js"><link rel="prefetch" href="/assets/js/150.f0ede764.js"><link rel="prefetch" href="/assets/js/151.b7093623.js"><link rel="prefetch" href="/assets/js/152.a82a6c83.js"><link rel="prefetch" href="/assets/js/153.965e3fb2.js"><link rel="prefetch" href="/assets/js/154.9e49311e.js"><link rel="prefetch" href="/assets/js/155.cef33ba5.js"><link rel="prefetch" href="/assets/js/156.bcc397ae.js"><link rel="prefetch" href="/assets/js/157.90824739.js"><link rel="prefetch" href="/assets/js/158.efd429b9.js"><link rel="prefetch" href="/assets/js/159.122ff5b7.js"><link rel="prefetch" href="/assets/js/16.2449162b.js"><link rel="prefetch" href="/assets/js/160.0b806535.js"><link rel="prefetch" href="/assets/js/161.835052c6.js"><link rel="prefetch" href="/assets/js/162.ca34e2d2.js"><link rel="prefetch" href="/assets/js/163.08000d04.js"><link rel="prefetch" href="/assets/js/165.65444686.js"><link rel="prefetch" href="/assets/js/166.7d73c84f.js"><link rel="prefetch" href="/assets/js/167.009d47a3.js"><link rel="prefetch" href="/assets/js/168.0afeae2a.js"><link rel="prefetch" href="/assets/js/169.7654cb31.js"><link rel="prefetch" href="/assets/js/17.eb7f9def.js"><link rel="prefetch" href="/assets/js/170.58569530.js"><link rel="prefetch" href="/assets/js/171.7db9ed40.js"><link rel="prefetch" href="/assets/js/172.3cb50ed4.js"><link rel="prefetch" href="/assets/js/173.0846425f.js"><link rel="prefetch" href="/assets/js/174.9e95f111.js"><link rel="prefetch" href="/assets/js/175.ef2098f2.js"><link rel="prefetch" href="/assets/js/176.c2635fe9.js"><link rel="prefetch" href="/assets/js/177.4fa38e8e.js"><link rel="prefetch" href="/assets/js/178.2be7037f.js"><link rel="prefetch" href="/assets/js/179.bf3bba28.js"><link rel="prefetch" href="/assets/js/18.0455f4d1.js"><link rel="prefetch" href="/assets/js/180.72c5f597.js"><link rel="prefetch" href="/assets/js/181.42287bcc.js"><link rel="prefetch" href="/assets/js/182.6cd4bf1a.js"><link rel="prefetch" href="/assets/js/183.05dbbfd9.js"><link rel="prefetch" href="/assets/js/184.03de7e00.js"><link rel="prefetch" href="/assets/js/185.42dd210e.js"><link rel="prefetch" href="/assets/js/186.28ee0f8a.js"><link rel="prefetch" href="/assets/js/187.bb58697b.js"><link rel="prefetch" href="/assets/js/188.1bc8be96.js"><link rel="prefetch" href="/assets/js/189.fac747e3.js"><link rel="prefetch" href="/assets/js/19.ae9e35d6.js"><link rel="prefetch" href="/assets/js/190.ea533ac7.js"><link rel="prefetch" href="/assets/js/191.6dc6eb13.js"><link rel="prefetch" href="/assets/js/192.184d249f.js"><link rel="prefetch" href="/assets/js/193.4a06bc12.js"><link rel="prefetch" href="/assets/js/194.8cce60a9.js"><link rel="prefetch" href="/assets/js/195.93231a13.js"><link rel="prefetch" href="/assets/js/196.4a596bde.js"><link rel="prefetch" href="/assets/js/197.96c113cf.js"><link rel="prefetch" href="/assets/js/198.73ba3f67.js"><link rel="prefetch" href="/assets/js/199.74bab595.js"><link rel="prefetch" href="/assets/js/20.b542d0e7.js"><link rel="prefetch" href="/assets/js/200.69a6928a.js"><link rel="prefetch" href="/assets/js/201.9ffa7c5a.js"><link rel="prefetch" href="/assets/js/202.41edb652.js"><link rel="prefetch" href="/assets/js/203.7fabcef3.js"><link rel="prefetch" href="/assets/js/204.b0ae2f62.js"><link rel="prefetch" href="/assets/js/205.add8738b.js"><link rel="prefetch" href="/assets/js/206.f3a712ec.js"><link rel="prefetch" href="/assets/js/207.cd7dd729.js"><link rel="prefetch" href="/assets/js/208.78b33afa.js"><link rel="prefetch" href="/assets/js/209.9d3329ff.js"><link rel="prefetch" href="/assets/js/21.5a050318.js"><link rel="prefetch" href="/assets/js/210.d285d5ac.js"><link rel="prefetch" href="/assets/js/211.8791bb3f.js"><link rel="prefetch" href="/assets/js/212.84ed81a8.js"><link rel="prefetch" href="/assets/js/213.7b990580.js"><link rel="prefetch" href="/assets/js/214.da31f20c.js"><link rel="prefetch" href="/assets/js/215.9eeed659.js"><link rel="prefetch" href="/assets/js/216.9539f0ec.js"><link rel="prefetch" href="/assets/js/217.11b575be.js"><link rel="prefetch" href="/assets/js/218.a67f12f1.js"><link rel="prefetch" href="/assets/js/219.bfbb817a.js"><link rel="prefetch" href="/assets/js/22.2bc6f7e3.js"><link rel="prefetch" href="/assets/js/220.8b01342f.js"><link rel="prefetch" href="/assets/js/221.b450decd.js"><link rel="prefetch" href="/assets/js/222.97468507.js"><link rel="prefetch" href="/assets/js/223.b6dafd73.js"><link rel="prefetch" href="/assets/js/224.c86c18c6.js"><link rel="prefetch" href="/assets/js/225.b0dcf86e.js"><link rel="prefetch" href="/assets/js/226.02cc2999.js"><link rel="prefetch" href="/assets/js/227.8474ef5a.js"><link rel="prefetch" href="/assets/js/228.0298e421.js"><link rel="prefetch" href="/assets/js/229.6aeaf595.js"><link rel="prefetch" href="/assets/js/23.9995fce4.js"><link rel="prefetch" href="/assets/js/230.a5785286.js"><link rel="prefetch" href="/assets/js/231.d791daa4.js"><link rel="prefetch" href="/assets/js/232.97aeeb00.js"><link rel="prefetch" href="/assets/js/233.46e51e28.js"><link rel="prefetch" href="/assets/js/234.2cffe82f.js"><link rel="prefetch" href="/assets/js/235.14965da6.js"><link rel="prefetch" href="/assets/js/236.00a5afc0.js"><link rel="prefetch" href="/assets/js/237.3b73d52f.js"><link rel="prefetch" href="/assets/js/238.6e1db765.js"><link rel="prefetch" href="/assets/js/239.75866c5e.js"><link rel="prefetch" href="/assets/js/24.9141eeb2.js"><link rel="prefetch" href="/assets/js/240.af9c2cc9.js"><link rel="prefetch" href="/assets/js/241.388acab2.js"><link rel="prefetch" href="/assets/js/242.c60f2b48.js"><link rel="prefetch" href="/assets/js/243.d8e81b13.js"><link rel="prefetch" href="/assets/js/244.58b0b21d.js"><link rel="prefetch" href="/assets/js/245.c3768497.js"><link rel="prefetch" href="/assets/js/246.ac8bbe7a.js"><link rel="prefetch" href="/assets/js/247.d095f70a.js"><link rel="prefetch" href="/assets/js/248.e9f210b5.js"><link rel="prefetch" href="/assets/js/249.a9fad023.js"><link rel="prefetch" href="/assets/js/25.98e8593e.js"><link rel="prefetch" href="/assets/js/250.ae7f0ebb.js"><link rel="prefetch" href="/assets/js/251.9a617d55.js"><link rel="prefetch" href="/assets/js/252.ce082446.js"><link rel="prefetch" href="/assets/js/253.4575302d.js"><link rel="prefetch" href="/assets/js/254.5899a61b.js"><link rel="prefetch" href="/assets/js/255.66c69f31.js"><link rel="prefetch" href="/assets/js/256.8fd6c706.js"><link rel="prefetch" href="/assets/js/257.31b77e5e.js"><link rel="prefetch" href="/assets/js/258.eba48891.js"><link rel="prefetch" href="/assets/js/259.edf74b59.js"><link rel="prefetch" href="/assets/js/26.e69924ea.js"><link rel="prefetch" href="/assets/js/260.cf2ed36d.js"><link rel="prefetch" href="/assets/js/261.9e7792d8.js"><link rel="prefetch" href="/assets/js/262.e7b9433e.js"><link rel="prefetch" href="/assets/js/263.1185b25c.js"><link rel="prefetch" href="/assets/js/264.5e0f89cb.js"><link rel="prefetch" href="/assets/js/265.a38d3b94.js"><link rel="prefetch" href="/assets/js/266.2ef170b3.js"><link rel="prefetch" href="/assets/js/267.a7d14651.js"><link rel="prefetch" href="/assets/js/268.05b18748.js"><link rel="prefetch" href="/assets/js/269.dad48d6f.js"><link rel="prefetch" href="/assets/js/27.13612515.js"><link rel="prefetch" href="/assets/js/270.4f5a6b8d.js"><link rel="prefetch" href="/assets/js/271.7ebf6682.js"><link rel="prefetch" href="/assets/js/272.7c2fbfd1.js"><link rel="prefetch" href="/assets/js/273.8ee20732.js"><link rel="prefetch" href="/assets/js/274.d525242a.js"><link rel="prefetch" href="/assets/js/275.a8a19acb.js"><link rel="prefetch" href="/assets/js/276.df3a4eb4.js"><link rel="prefetch" href="/assets/js/277.336debda.js"><link rel="prefetch" href="/assets/js/278.c470625f.js"><link rel="prefetch" href="/assets/js/279.a91e1a64.js"><link rel="prefetch" href="/assets/js/28.ab7ae1df.js"><link rel="prefetch" href="/assets/js/280.87e25c9a.js"><link rel="prefetch" href="/assets/js/281.87c1ba25.js"><link rel="prefetch" href="/assets/js/282.dcd4dce0.js"><link rel="prefetch" href="/assets/js/283.abac2e00.js"><link rel="prefetch" href="/assets/js/284.f6079659.js"><link rel="prefetch" href="/assets/js/285.f1b39879.js"><link rel="prefetch" href="/assets/js/286.f6a79242.js"><link rel="prefetch" href="/assets/js/287.06bebe07.js"><link rel="prefetch" href="/assets/js/288.89e325df.js"><link rel="prefetch" href="/assets/js/289.3aa1bedd.js"><link rel="prefetch" href="/assets/js/29.ebe50f76.js"><link rel="prefetch" href="/assets/js/290.ee059c92.js"><link rel="prefetch" href="/assets/js/291.fa9a921a.js"><link rel="prefetch" href="/assets/js/292.2a8811cd.js"><link rel="prefetch" href="/assets/js/293.eec09cdf.js"><link rel="prefetch" href="/assets/js/294.dfac20dc.js"><link rel="prefetch" href="/assets/js/295.825d2070.js"><link rel="prefetch" href="/assets/js/296.f645861e.js"><link rel="prefetch" href="/assets/js/297.424fdb17.js"><link rel="prefetch" href="/assets/js/298.ebf87cdc.js"><link rel="prefetch" href="/assets/js/299.b8f19cbb.js"><link rel="prefetch" href="/assets/js/30.75237511.js"><link rel="prefetch" href="/assets/js/300.10fb6d4f.js"><link rel="prefetch" href="/assets/js/301.ef77c612.js"><link rel="prefetch" href="/assets/js/302.1b839763.js"><link rel="prefetch" href="/assets/js/303.609f7d98.js"><link rel="prefetch" href="/assets/js/304.1d255f19.js"><link rel="prefetch" href="/assets/js/305.b0234f2c.js"><link rel="prefetch" href="/assets/js/306.48677f64.js"><link rel="prefetch" href="/assets/js/307.14390d4b.js"><link rel="prefetch" href="/assets/js/308.fa730b28.js"><link rel="prefetch" href="/assets/js/309.0496b9e0.js"><link rel="prefetch" href="/assets/js/31.cf3f471a.js"><link rel="prefetch" href="/assets/js/310.a31676dc.js"><link rel="prefetch" href="/assets/js/311.ed53adc5.js"><link rel="prefetch" href="/assets/js/312.1b0ff2f1.js"><link rel="prefetch" href="/assets/js/313.bf123f32.js"><link rel="prefetch" href="/assets/js/314.4e6ce06b.js"><link rel="prefetch" href="/assets/js/315.8eb18560.js"><link rel="prefetch" href="/assets/js/32.74fef842.js"><link rel="prefetch" href="/assets/js/33.bc2d190b.js"><link rel="prefetch" href="/assets/js/34.d23438fc.js"><link rel="prefetch" href="/assets/js/35.7675c4d0.js"><link rel="prefetch" href="/assets/js/36.96a4161b.js"><link rel="prefetch" href="/assets/js/37.d1824f2f.js"><link rel="prefetch" href="/assets/js/38.4effff9e.js"><link rel="prefetch" href="/assets/js/39.6509914b.js"><link rel="prefetch" href="/assets/js/4.4d01750f.js"><link rel="prefetch" href="/assets/js/40.1509d08b.js"><link rel="prefetch" href="/assets/js/41.f2c1124f.js"><link rel="prefetch" href="/assets/js/42.e541d077.js"><link rel="prefetch" href="/assets/js/43.369de999.js"><link rel="prefetch" href="/assets/js/44.43959db0.js"><link rel="prefetch" href="/assets/js/45.282fbd31.js"><link rel="prefetch" href="/assets/js/46.1b83cfe9.js"><link rel="prefetch" href="/assets/js/47.c3a88e41.js"><link rel="prefetch" href="/assets/js/48.bc7c0a1b.js"><link rel="prefetch" href="/assets/js/49.92a4e5ba.js"><link rel="prefetch" href="/assets/js/5.c3991e24.js"><link rel="prefetch" href="/assets/js/50.9c488c6c.js"><link rel="prefetch" href="/assets/js/51.546ea632.js"><link rel="prefetch" href="/assets/js/52.0d2ccee1.js"><link rel="prefetch" href="/assets/js/53.6f52b5b1.js"><link rel="prefetch" href="/assets/js/54.c838b295.js"><link rel="prefetch" href="/assets/js/55.13af99ee.js"><link rel="prefetch" href="/assets/js/56.6be6d1ed.js"><link rel="prefetch" href="/assets/js/57.67c98b39.js"><link rel="prefetch" href="/assets/js/58.107e82ec.js"><link rel="prefetch" href="/assets/js/59.b3e5edc7.js"><link rel="prefetch" href="/assets/js/6.36a535f9.js"><link rel="prefetch" href="/assets/js/60.3b0b4ba5.js"><link rel="prefetch" href="/assets/js/61.3df843df.js"><link rel="prefetch" href="/assets/js/62.1213823d.js"><link rel="prefetch" href="/assets/js/63.e8f3f926.js"><link rel="prefetch" href="/assets/js/64.e1219050.js"><link rel="prefetch" href="/assets/js/65.5bf5bb0b.js"><link rel="prefetch" href="/assets/js/66.a2502afb.js"><link rel="prefetch" href="/assets/js/67.690dd59b.js"><link rel="prefetch" href="/assets/js/68.de7b0915.js"><link rel="prefetch" href="/assets/js/69.ac61dd61.js"><link rel="prefetch" href="/assets/js/7.5d254238.js"><link rel="prefetch" href="/assets/js/70.3edd41b1.js"><link rel="prefetch" href="/assets/js/71.d23407e9.js"><link rel="prefetch" href="/assets/js/72.a5bd01bc.js"><link rel="prefetch" href="/assets/js/73.c9f4dd57.js"><link rel="prefetch" href="/assets/js/74.66323fc1.js"><link rel="prefetch" href="/assets/js/75.e1a72e00.js"><link rel="prefetch" href="/assets/js/76.801268b4.js"><link rel="prefetch" href="/assets/js/77.3a5fda67.js"><link rel="prefetch" href="/assets/js/78.54d84cd4.js"><link rel="prefetch" href="/assets/js/79.fa10f4e3.js"><link rel="prefetch" href="/assets/js/8.e060e47d.js"><link rel="prefetch" href="/assets/js/80.d5b24fea.js"><link rel="prefetch" href="/assets/js/81.0e9da714.js"><link rel="prefetch" href="/assets/js/82.e96ff6d7.js"><link rel="prefetch" href="/assets/js/83.771cced1.js"><link rel="prefetch" href="/assets/js/84.220b69e7.js"><link rel="prefetch" href="/assets/js/85.7dcc5659.js"><link rel="prefetch" href="/assets/js/86.44ba2100.js"><link rel="prefetch" href="/assets/js/87.281da75d.js"><link rel="prefetch" href="/assets/js/88.12d88449.js"><link rel="prefetch" href="/assets/js/89.f28c86d3.js"><link rel="prefetch" href="/assets/js/9.8f9fef32.js"><link rel="prefetch" href="/assets/js/90.715cabb2.js"><link rel="prefetch" href="/assets/js/91.6ced7c82.js"><link rel="prefetch" href="/assets/js/92.c05b33ca.js"><link rel="prefetch" href="/assets/js/93.6bf5fb66.js"><link rel="prefetch" href="/assets/js/94.3561200e.js"><link rel="prefetch" href="/assets/js/95.0f2cf716.js"><link rel="prefetch" href="/assets/js/96.ac8487ea.js"><link rel="prefetch" href="/assets/js/97.48042b5a.js"><link rel="prefetch" href="/assets/js/98.441bb7f8.js"><link rel="prefetch" href="/assets/js/99.4b214d92.js">
    <link rel="stylesheet" href="/assets/css/0.styles.56073ad3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/magic.png" alt="Pangolin Note" class="logo"> <span class="site-name can-hide">Pangolin Note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">ğŸ¡é¦–é¡µ</a></div><div class="nav-item"><a href="/basic/" class="nav-link">åŸºç¡€</a></div><div class="nav-item"><a href="/develop/" class="nav-link">å¼€å‘</a></div><div class="nav-item"><a href="/middleware/" class="nav-link">ç³»ç»Ÿ</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">ç®—æ³•</a></div><div class="nav-item"><a href="/books/" class="nav-link">ğŸ€è¯»ä¹¦ç¬”è®°</a></div><div class="nav-item"><a href="/work/" class="nav-link">å·¥ä½œ</a></div><div class="nav-item"><a href="/pangolin/" class="nav-link">ğŸŒ¸è¾¾å°”æ–‡çš„çŒ¹</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">æ”¶è—</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatarnew.png"> <div class="blogger-info"><h3>è¾¾å°”æ–‡çš„çŒ¹</h3> <span>å¤§é“è‡³ç®€ æ‚Ÿåœ¨å¤©æˆ</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">ğŸ¡é¦–é¡µ</a></div><div class="nav-item"><a href="/basic/" class="nav-link">åŸºç¡€</a></div><div class="nav-item"><a href="/develop/" class="nav-link">å¼€å‘</a></div><div class="nav-item"><a href="/middleware/" class="nav-link">ç³»ç»Ÿ</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">ç®—æ³•</a></div><div class="nav-item"><a href="/books/" class="nav-link">ğŸ€è¯»ä¹¦ç¬”è®°</a></div><div class="nav-item"><a href="/work/" class="nav-link">å·¥ä½œ</a></div><div class="nav-item"><a href="/pangolin/" class="nav-link">ğŸŒ¸è¾¾å°”æ–‡çš„çŒ¹</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">æ”¶è—</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç´¢å¼•" class="dropdown-title"><a href="/archives/" class="link-title">ç´¢å¼•</a> <span class="title" style="display:none;">ç´¢å¼•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">åˆ†ç±»</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">æ ‡ç­¾</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">å½’æ¡£</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ç³»ç»Ÿ</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>åˆ†å¸ƒå¼ç³»ç»Ÿç†è®º</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/129626/" class="sidebar-link">åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€</a></li><li><a href="/pages/fb5d35/" class="sidebar-link">åˆ†å¸ƒå¼å…±è¯†ç®—æ³•</a></li><li><a href="/pages/12ac37/" class="sidebar-link">åˆ†å¸ƒå¼ç³»ç»Ÿç»„ä»¶</a></li><li><a href="/pages/d03ebf/" class="sidebar-link">åˆ†å¸ƒå¼æŠ€æœ¯åŸç†ä¸ç®—æ³•è§£æ(æå®¢æ—¶é—´)ğŸŒ¸</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>ç³»ç»Ÿæ¥å…¥å±‚</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/f1b6c4/" aria-current="page" class="active sidebar-link">NginxåŸºç¡€</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/d4123d/" class="sidebar-link">æ·±å…¥æ‹†è§£Tomcatä¸Jetty(æå®¢æ—¶é—´)ğŸŒ¸</a></li><li><a href="/pages/baee2f/" class="sidebar-link">Netty</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>æœåŠ¡æ²»ç†-æ³¨å†Œå‘ç°ä¸RPC</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/05077d/" class="sidebar-link">åŸºç¡€</a></li><li><a href="/pages/51b6aa/" class="sidebar-link">RPCå®æˆ˜ä¸æ ¸å¿ƒåŸç†(æå®¢æ—¶é—´)ğŸŒ¸</a></li><li><a href="/pages/0966ee/" class="sidebar-link">Zookeeper</a></li><li><a href="/pages/3b7e05/" class="sidebar-link">Nacos</a></li><li><a href="/pages/7f31f8/" class="sidebar-link">Dubbo</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>æœåŠ¡æ²»ç†-æµé‡æ§åˆ¶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/44bfa8/" class="sidebar-link">è´Ÿè½½å‡è¡¡</a></li><li><a href="/pages/4d5a6c/" class="sidebar-link">é™æµ</a></li><li><a href="/pages/e0c561/" class="sidebar-link">ç†”æ–­</a></li><li><a href="/pages/12ae40/" class="sidebar-link">ç½‘å…³è·¯ç”±</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>æœåŠ¡æ²»ç†-ç³»ç»Ÿç›‘æ§ä¸å®‰å…¨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/8c9210/" class="sidebar-link">ç³»ç»Ÿå®‰å…¨æ€§</a></li><li><a href="/pages/c9bf40/" class="sidebar-link">ç³»ç»Ÿç›‘æ§ç»„ä»¶</a></li><li><a href="/pages/3f3cf7/" class="sidebar-link">è¿ç»´ç›‘æ§ç³»ç»Ÿå®æˆ˜(æå®¢æ—¶é—´)ğŸŒ¸</a></li><li><a href="/pages/e20e02/" class="sidebar-link">OAuth2.0å®æˆ˜è¯¾(æå®¢æ—¶é—´)ğŸŒŸ</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ä¸­é—´ä»¶-æ¶ˆæ¯é˜Ÿåˆ—</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/96d94c/" class="sidebar-link">æ¶ˆæ¯é˜Ÿåˆ—åŸºç¡€</a></li><li><a href="/pages/abf16c/" class="sidebar-link">RabbitMQ</a></li><li><a href="/pages/4fc3f1/" class="sidebar-link">Kafka</a></li><li><a href="/pages/013cfe/" class="sidebar-link">RocketMQ</a></li><li><a href="/pages/ed8d92/" class="sidebar-link">Disruptor</a></li><li><a href="/pages/249149/" class="sidebar-link">æ¶ˆæ¯é˜Ÿåˆ—é«˜æ‰‹è¯¾(æå®¢æ—¶é—´)ğŸŒŸ</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ä¸­é—´ä»¶-ç¼“å­˜</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/946847/" class="sidebar-link">ç¼“å­˜åŸºç¡€</a></li><li><a href="/pages/e46d56/" class="sidebar-link">æœ¬åœ°ç¼“å­˜</a></li><li><a href="/pages/0abfb9/" class="sidebar-link">RedisåŸºç¡€</a></li><li><a href="/pages/09236a/" class="sidebar-link">RedisæŒä¹…åŒ–</a></li><li><a href="/pages/867f9b/" class="sidebar-link">Redisä¸»ä»å¤åˆ¶</a></li><li><a href="/pages/50cae1/" class="sidebar-link">Rediså“¨å…µ</a></li><li><a href="/pages/43b45c/" class="sidebar-link">Redisé›†ç¾¤</a></li><li><a href="/pages/a32379/" class="sidebar-link">Rediså†…å­˜ç®¡ç†ä¸è¿ç»´</a></li><li><a href="/pages/386037/" class="sidebar-link">Redisæ ¸å¿ƒæŠ€æœ¯ä¸å®æˆ˜(æå®¢æ—¶é—´)ğŸŒ¸</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ä¸­é—´ä»¶-å…¶ä»–</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/23044d/" class="sidebar-link">å®šæ—¶ä»»åŠ¡-XXLJob</a></li><li><a href="/pages/459117/" class="sidebar-link">ESä¸æ£€ç´¢</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>ç³»ç»Ÿè®¾è®¡ä¸ä¼˜åŒ–</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/41a845/" class="sidebar-link">å‡¤å‡°æ¶æ„</a></li><li><a href="/pages/68cc0b/" class="sidebar-link">å·¦è€³å¬é£(æå®¢æ—¶é—´)ğŸŒŸ</a></li><li><a href="/pages/e3e99c/" class="sidebar-link">ä»0å¼€å§‹å­¦å¾®æœåŠ¡(æå®¢æ—¶é—´)ğŸŒ¸</a></li><li><a href="/pages/1e5368/" class="sidebar-link">é«˜å¹¶å‘ç³»ç»Ÿè®¾è®¡40é—®(æå®¢æ—¶é—´)ğŸŒ¸</a></li><li><a href="/pages/33599f/" class="sidebar-link">ç³»ç»Ÿæ€§èƒ½è°ƒä¼˜å¿…çŸ¥å¿…ä¼š(æå®¢æ—¶é—´)ğŸŒ¸</a></li><li><a href="/pages/c83472/" class="sidebar-link">åç«¯æŠ€æœ¯é¢è¯•38è®²(æå®¢æ—¶é—´)</a></li><li><a href="/pages/4404b6/" class="sidebar-link">æ¶æ„å®æˆ˜æ¡ˆä¾‹è§£æ(æå®¢æ—¶é—´)ğŸŒ¸</a></li><li><a href="/pages/8f1c1d/" class="sidebar-link">å¦‚ä½•è®¾è®¡ä¸€ä¸ªç§’æ€ç³»ç»Ÿ(æå®¢æ—¶é—´)</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>å®¹å™¨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>å®¹å™¨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/582acf/" class="sidebar-link">éƒ¨ç½²Minikube</a></li><li><a href="/pages/98e5e4/" class="sidebar-link">å®¹å™¨å®æˆ˜é«˜æ‰‹è¯¾(æå®¢æ—¶é—´)ğŸŒ¸</a></li><li><a href="/pages/c6a42c/" class="sidebar-link">Kuberneteså®æˆ˜ğŸŒ¸</a></li><li><a href="/pages/f35c72/" class="sidebar-link">æ·±å…¥å‰–æKubernetes(æå®¢æ—¶é—´)ğŸŒ¸</a></li><li><a href="/pages/caa314/" class="sidebar-link">Istio</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>è‡ªåŠ¨åŒ–è¿ç»´</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/beb97f/" class="sidebar-link">æŒç»­é›†æˆ(CICD)</a></li><li><a href="/pages/a0df2d/" class="sidebar-link">DevOps</a></li><li><a href="/pages/765815/" class="sidebar-link">SREå®æˆ˜æ‰‹å†Œ(æå®¢æ—¶é—´)</a></li></ul></section></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/middleware/#ç³»ç»Ÿ" data-v-06970110>ç³»ç»Ÿ</a></li><li data-v-06970110><a href="/middleware/#ç³»ç»Ÿ" data-v-06970110>ç³»ç»Ÿ</a></li><li data-v-06970110><a href="/middleware/#ç³»ç»Ÿæ¥å…¥å±‚" data-v-06970110>ç³»ç»Ÿæ¥å…¥å±‚</a></li></ul> <div class="info" data-v-06970110><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-06970110><a href="https://github.com/nanodaemony" target="_blank" title="ä½œè€…" class="beLink" data-v-06970110>NanoDaemony</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2025-02-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">æœ¬æ–‡ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">NginxåŸºç¡€<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="_100-nginxåŸºç¡€"><a href="#_100-nginxåŸºç¡€" class="header-anchor">#</a> 100.NginxåŸºç¡€</h1> <p><a href="https://nginx.org/en/" target="_blank" rel="noopener noreferrer">Nginx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ˜¯ä¸€æ¬¾é¢å‘æ€§èƒ½è®¾è®¡çš„ HTTP æœåŠ¡å™¨, èƒ½åå‘ä»£ç† HTTP, HTTPS å’Œé‚®ä»¶ç›¸å…³(SMTP, POP3, IMAP)çš„åè®®é“¾æ¥. å¹¶ä¸”æä¾›äº†è´Ÿè½½å‡è¡¡ä»¥åŠ HTTP ç¼“å­˜. å®ƒçš„è®¾è®¡å……åˆ†ä½¿ç”¨<strong>å¼‚æ­¥äº‹ä»¶æ¨¡å‹, å‰Šå‡ä¸Šä¸‹æ–‡è°ƒåº¦</strong>çš„å¼€é”€, æé«˜æœåŠ¡å™¨å¹¶å‘èƒ½åŠ›. é‡‡ç”¨äº†<strong>æ¨¡å—åŒ–è®¾è®¡</strong>, æä¾›äº†ä¸°å¯Œæ¨¡å—çš„ç¬¬ä¸‰æ–¹æ¨¡å—.</p> <p>æ‰€ä»¥å…³äº Nginx, æœ‰è¿™äº›æ ‡ç­¾:  <strong>ã€Œå¼‚æ­¥ã€ã€Œäº‹ä»¶ã€ã€Œæ¨¡å—åŒ–ã€ã€Œé«˜æ€§èƒ½ã€ã€Œé«˜å¹¶å‘ã€ã€Œåå‘ä»£ç†ã€ã€Œè´Ÿè½½å‡è¡¡ã€.</strong></p> <p>Linuxç³»ç»Ÿ: <code>Centos 7 x64</code>â€‹</p> <p>Nginxç‰ˆæœ¬: <code>1.11.5</code>â€‹</p> <h4 id="å®‰è£…"><a href="#å®‰è£…" class="header-anchor">#</a> å®‰è£…</h4> <h5 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="header-anchor">#</a> å®‰è£…ä¾èµ–</h5> <blockquote><p>prce(é‡å®šå‘æ”¯æŒ)å’Œopenssl(httpsæ”¯æŒ, å¦‚æœä¸éœ€è¦httpså¯ä»¥ä¸å®‰è£…. )</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yum <span class="token function">install</span> <span class="token parameter variable">-y</span> pcre-devel 
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> gcc <span class="token function">make</span> gcc-c++ <span class="token function">wget</span>
yum <span class="token parameter variable">-y</span> <span class="token function">install</span> openssl openssl-devel 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>CentOS 6.5 æˆ‘å®‰è£…çš„æ—¶å€™æ˜¯é€‰æ‹©çš„ &quot;åŸºæœ¬æœåŠ¡å™¨&quot;, é»˜è®¤è¿™ä¸¤ä¸ªåŒ…éƒ½æ²¡å®‰è£…å…¨, æ‰€ä»¥è¿™ä¸¤ä¸ªéƒ½è¿è¡Œå®‰è£…å³å¯.</p> <h5 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="header-anchor">#</a> ä¸‹è½½</h5> <p><a href="http://nginx.org/download/" target="_blank" rel="noopener noreferrer">nginxçš„æ‰€æœ‰ç‰ˆæœ¬åœ¨è¿™é‡Œ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">wget</span> http://nginx.org/download/nginx-1.13.3.tar.gz
<span class="token function">wget</span> http://nginx.org/download/nginx-1.13.7.tar.gz

<span class="token comment"># å¦‚æœæ²¡æœ‰å®‰è£…wget</span>
<span class="token comment"># ä¸‹è½½å·²ç¼–è¯‘ç‰ˆæœ¬</span>
$ yum <span class="token function">install</span> <span class="token function">wget</span>

<span class="token comment"># è§£å‹å‹ç¼©åŒ…</span>
<span class="token function">tar</span> zxf nginx-1.13.3.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h5 id="ç¼–è¯‘å®‰è£…"><a href="#ç¼–è¯‘å®‰è£…" class="header-anchor">#</a> ç¼–è¯‘å®‰è£…</h5> <p>ç„¶åè¿›å…¥ç›®å½•ç¼–è¯‘å®‰è£…, configure å‚æ•°è¯´æ˜å‚è€ƒä¸‹é¢å¯¹åº”çš„éƒ¨åˆ†.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> nginx-1.11.5
./configure

<span class="token punctuation">..</span><span class="token punctuation">..</span>
Configuration summary
  + using system PCRE library
  + OpenSSL library is not used
  + using system zlib library

  nginx path prefix: <span class="token string">&quot;/usr/local/nginx&quot;</span>
  nginx binary file: <span class="token string">&quot;/usr/local/nginx/sbin/nginx&quot;</span>
  nginx modules path: <span class="token string">&quot;/usr/local/nginx/modules&quot;</span>
  nginx configuration prefix: <span class="token string">&quot;/usr/local/nginx/conf&quot;</span>
  nginx configuration file: <span class="token string">&quot;/usr/local/nginx/conf/nginx.conf&quot;</span>
  nginx pid file: <span class="token string">&quot;/usr/local/nginx/logs/nginx.pid&quot;</span>
  nginx error log file: <span class="token string">&quot;/usr/local/nginx/logs/error.log&quot;</span>
  nginx http access log file: <span class="token string">&quot;/usr/local/nginx/logs/access.log&quot;</span>
  nginx http client request body temporary files: <span class="token string">&quot;client_body_temp&quot;</span>
  nginx http proxy temporary files: <span class="token string">&quot;proxy_temp&quot;</span>
  nginx http fastcgi temporary files: <span class="token string">&quot;fastcgi_temp&quot;</span>
  nginx http uwsgi temporary files: <span class="token string">&quot;uwsgi_temp&quot;</span>
  nginx http scgi temporary files: <span class="token string">&quot;scgi_temp&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>å®‰è£…æŠ¥é”™è¯¯çš„è¯æ¯”å¦‚: &quot;C compiler cc is not found&quot;, è¿™ä¸ªå°±æ˜¯ç¼ºå°‘ç¼–è¯‘ç¯å¢ƒ, å®‰è£…ä¸€ä¸‹å°±å¯ä»¥äº† **yum -y install gcc make gcc-c++ openssl-devel. **</p> <p>å¦‚æœæ²¡æœ‰ error ä¿¡æ¯, å°±å¯ä»¥æ‰§è¡Œä¸‹è¾¹çš„å®‰è£…äº†:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">make</span>
<span class="token function">make</span> <span class="token function">install</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="nginxæµ‹è¯•"><a href="#nginxæµ‹è¯•" class="header-anchor">#</a> nginxæµ‹è¯•</h5> <p>è¿è¡Œä¸‹é¢å‘½ä»¤ä¼šå‡ºç°ä¸¤ä¸ªç»“æœ, ä¸€èˆ¬æƒ…å†µ nginx ä¼šå®‰è£…åœ¨ <code>/usr/local/nginx</code>â€‹ ç›®å½•ä¸­.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /usr/local/nginx/sbin/
./nginx <span class="token parameter variable">-t</span>

<span class="token comment"># nginx: the configuration file /usr/local/nginx/conf/nginx.conf syntax is ok</span>
<span class="token comment"># nginx: configuration file /usr/local/nginx/conf/nginx.conf test is successful</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="è®¾ç½®å…¨å±€nginxå‘½ä»¤"><a href="#è®¾ç½®å…¨å±€nginxå‘½ä»¤" class="header-anchor">#</a> è®¾ç½®å…¨å±€nginxå‘½ä»¤</h5> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">vi</span> ~/.bash_profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å°†ä¸‹é¢å†…å®¹æ·»åŠ åˆ° <code>~/.bash_profile</code> æ–‡ä»¶ä¸­</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token environment constant">$HOME</span>/bin:/usr/local/nginx/sbin/
<span class="token builtin class-name">export</span> <span class="token environment constant">PATH</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>è¿è¡Œå‘½ä»¤ <strong>â€‹<code>source ~/.bash_profile</code>â€‹</strong>â€‹ è®©é…ç½®ç«‹å³ç”Ÿæ•ˆ. è¿™æ ·å°±å¯ä»¥å…¨å±€è¿è¡Œ <code>nginx</code>â€‹ å‘½ä»¤äº†.</p> <h5 id="macå®‰è£…"><a href="#macå®‰è£…" class="header-anchor">#</a> Macå®‰è£…</h5> <p>Mac OSX å®‰è£…ç‰¹åˆ«ç®€å•, é¦–å…ˆéœ€è¦å®‰è£… <a href="https://brew.sh/" target="_blank" rel="noopener noreferrer">Brew<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, é€šè¿‡ <code>brew</code>â€‹ å¿«é€Ÿå®‰è£… <code>nginx</code>â€‹.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>brew <span class="token function">install</span> nginx
<span class="token comment"># Updating Homebrew...</span>
<span class="token comment"># &lt;mark&gt;&gt; Auto-updated Homebrew!</span>
<span class="token comment"># Updated 2 taps (homebrew/core, homebrew/cask).</span>
<span class="token comment"># &lt;/mark&gt;&gt; Updated Formulae</span>
<span class="token comment"># &lt;mark&gt;&gt; Installing dependencies for nginx: openssl, pcre</span>
<span class="token comment"># &lt;/mark&gt;&gt; Installing nginx dependency: openssl</span>
<span class="token comment"># &lt;mark&gt;&gt; Downloading https://homebrew.bintray.com/bottles/openssl-1.0.2o_1.high_sierra.bottle.tar.gz</span>
<span class="token comment"># ######################################################################## 100.0%</span>
<span class="token comment"># &lt;/mark&gt;&gt; Pouring openssl-1.0.2o_1.high_sierra.bottle.tar.gz</span>
<span class="token comment"># ==&gt; Caveats</span>
<span class="token comment"># A CA file has been bootstrapped using certificates from the SystemRoots</span>
<span class="token comment"># keychain. To add additional certificates (e.g. the certificates added in</span>
<span class="token comment"># the System keychain), place .pem files in</span>
<span class="token comment">#   /usr/local/etc/openssl/certs</span>
<span class="token comment"># </span>
<span class="token comment"># and run</span>
<span class="token comment">#   /usr/local/opt/openssl/bin/c_rehash</span>
<span class="token comment"># </span>
<span class="token comment"># This formula is keg-only, which means it was not symlinked into /usr/local,</span>
<span class="token comment"># because Apple has deprecated use of OpenSSL in favor of its own TLS and crypto libraries.</span>
<span class="token comment"># </span>
<span class="token comment"># If you need to have this software first in your PATH run:</span>
<span class="token comment">#   echo 'export PATH=&quot;/usr/local/opt/openssl/bin:$PATH&quot;' &gt;&gt; ~/.zshrc</span>
<span class="token comment"># </span>
<span class="token comment"># For compilers to find this software you may need to set:</span>
<span class="token comment">#     LDFLAGS:  -L/usr/local/opt/openssl/lib</span>
<span class="token comment">#     CPPFLAGS: -I/usr/local/opt/openssl/include</span>
<span class="token comment"># For pkg-config to find this software you may need to set:</span>
<span class="token comment">#     PKG_CONFIG_PATH: /usr/local/opt/openssl/lib/pkgconfig</span>
<span class="token comment"># </span>
<span class="token comment"># &lt;mark&gt;&gt; Summary</span>
<span class="token comment"># ğŸº  /usr/local/Cellar/openssl/1.0.2o_1: 1,791 files, 12.3MB</span>
<span class="token comment"># &lt;/mark&gt;&gt; Installing nginx dependency: pcre</span>
<span class="token comment"># &lt;mark&gt;&gt; Downloading https://homebrew.bintray.com/bottles/pcre-8.42.high_sierra.bottle.tar.gz</span>
<span class="token comment"># ######################################################################## 100.0%</span>
<span class="token comment"># &lt;/mark&gt;&gt; Pouring pcre-8.42.high_sierra.bottle.tar.gz</span>
<span class="token comment"># ğŸº  /usr/local/Cellar/pcre/8.42: 204 files, 5.3MB</span>
<span class="token comment"># &lt;mark&gt;&gt; Installing nginx</span>
<span class="token comment"># &lt;/mark&gt;&gt; Downloading https://homebrew.bintray.com/bottles/nginx-1.13.12.high_sierra.bottle.tar.gz</span>
<span class="token comment"># ######################################################################## 100.0%</span>
<span class="token comment"># &lt;mark&gt;&gt; Pouring nginx-1.13.12.high_sierra.bottle.tar.gz</span>
<span class="token comment"># &lt;/mark&gt;&gt; Caveats</span>
<span class="token comment"># Docroot is: /usr/local/var/www</span>
<span class="token comment"># </span>
<span class="token comment"># The default port has been set in /usr/local/etc/nginx/nginx.conf to 8080 so that</span>
<span class="token comment"># nginx can run without sudo.</span>
<span class="token comment"># </span>
<span class="token comment"># nginx will load all files in /usr/local/etc/nginx/servers/.</span>
<span class="token comment"># </span>
<span class="token comment"># To have launchd start nginx now and restart at login:</span>
<span class="token comment">#   brew services start nginx</span>
<span class="token comment"># Or, if you don't wacd /usr/local/Cellar/nginx/1.13.12/n just run:</span>
<span class="token comment"># cd /usr/local/Cellar/nginx/1.13.12/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><blockquote><p>å¯åŠ¨æœåŠ¡</p></blockquote> <p>æ³¨æ„é»˜è®¤ç«¯å£ä¸æ˜¯ <code>8080</code> æŸ¥çœ‹ç¡®è®¤ç«¯å£æ˜¯å¦è¢«å ç”¨.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>brew services start nginx
<span class="token comment"># http://localhost:8080/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="è¿ç»´"><a href="#è¿ç»´" class="header-anchor">#</a> è¿ç»´</h4> <h5 id="å¼€æœºè‡ªå¯åŠ¨"><a href="#å¼€æœºè‡ªå¯åŠ¨" class="header-anchor">#</a> å¼€æœºè‡ªå¯åŠ¨</h5> <p>**å¼€æœºè‡ªå¯åŠ¨æ–¹æ³•ä¸€: **</p> <p>ç¼–è¾‘ <strong>vi /lib/systemd/system/nginx.service</strong> æ–‡ä»¶, æ²¡æœ‰åˆ›å»ºä¸€ä¸ª <strong>touch nginx.service</strong> ç„¶åå°†å¦‚ä¸‹å†…å®¹æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œä¿®æ”¹å, æ·»åŠ åˆ° nginx.service æ–‡ä»¶ä¸­:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>nginx
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target remote-fs.target nss-lookup.target

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>

<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking
<span class="token assign-left variable">PIDFile</span><span class="token operator">=</span>/var/run/nginx.pid
<span class="token assign-left variable">ExecStartPre</span><span class="token operator">=</span>/usr/local/nginx/sbin/nginx <span class="token parameter variable">-t</span> <span class="token parameter variable">-c</span> /usr/local/nginx/conf/nginx.conf
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/nginx/sbin/nginx <span class="token parameter variable">-c</span> /usr/local/nginx/conf/nginx.conf
<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> HUP <span class="token variable">$MAINPID</span>
<span class="token assign-left variable">ExecStop</span><span class="token operator">=</span>/bin/kill <span class="token parameter variable">-s</span> QUIT <span class="token variable">$MAINPID</span>
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><ul><li>â€‹<code>[Unit]</code>â€‹: æœåŠ¡çš„è¯´æ˜</li> <li>â€‹<code>Description</code>â€‹: æè¿°æœåŠ¡</li> <li>â€‹<code>After</code>â€‹: æè¿°æœåŠ¡ç±»åˆ«</li> <li>â€‹<code>[Service]</code>â€‹: æœåŠ¡è¿è¡Œå‚æ•°çš„è®¾ç½®</li> <li>â€‹<code>Type=forking</code>â€‹: æ˜¯åå°è¿è¡Œçš„å½¢å¼</li> <li>â€‹<code>ExecStart</code>â€‹: ä¸ºæœåŠ¡çš„å…·ä½“è¿è¡Œå‘½ä»¤</li> <li>â€‹<code>ExecReload</code>â€‹: ä¸ºé‡å¯å‘½ä»¤</li> <li>â€‹<code>ExecStop</code>â€‹: ä¸ºåœæ­¢å‘½ä»¤</li> <li>â€‹<code>PrivateTmp=True</code>â€‹: è¡¨ç¤ºç»™æœåŠ¡åˆ†é…ç‹¬ç«‹çš„ä¸´æ—¶ç©ºé—´</li></ul> <p>æ³¨æ„: <code>[Service]</code>â€‹ çš„å¯åŠ¨, é‡å¯, åœæ­¢å‘½ä»¤å…¨éƒ¨è¦æ±‚ä½¿ç”¨ç»å¯¹è·¯å¾„.</p> <p>â€‹<code>[Install]</code>â€‹ è¿è¡Œçº§åˆ«ä¸‹æœåŠ¡å®‰è£…çš„ç›¸å…³è®¾ç½®, å¯è®¾ç½®ä¸ºå¤šç”¨æˆ·, å³ç³»ç»Ÿè¿è¡Œçº§åˆ«ä¸º <code>3</code>â€‹.</p> <p>ä¿å­˜é€€å‡º.</p> <p>è®¾ç½®<strong>å¼€æœºå¯åŠ¨, ä½¿é…ç½®ç”Ÿæ•ˆ</strong>:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># å¯åŠ¨nginxæœåŠ¡</span>
systemctl start nginx.service
<span class="token comment"># åœæ­¢å¼€æœºè‡ªå¯åŠ¨</span>
systemctl disable nginx.service
<span class="token comment"># æŸ¥çœ‹æœåŠ¡å½“å‰çŠ¶æ€</span>
systemctl status nginx.service
<span class="token comment"># æŸ¥çœ‹æ‰€æœ‰å·²å¯åŠ¨çš„æœåŠ¡</span>
systemctl list-units <span class="token parameter variable">--type</span><span class="token operator">=</span>service
<span class="token comment"># é‡æ–°å¯åŠ¨æœåŠ¡</span>
systemctl restart nginx.service
<span class="token comment"># è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</span>
systemctl <span class="token builtin class-name">enable</span> nginx.service
<span class="token comment"># è¾“å‡ºä¸‹é¢å†…å®¹è¡¨ç¤ºæˆåŠŸäº†</span>
Created symlink from /etc/systemd/system/multi-user.target.wants/nginx.service to /usr/lib/systemd/system/nginx.service.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>systemctl is-enabled servicename.service <span class="token comment"># æŸ¥è¯¢æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨</span>
systemctl <span class="token builtin class-name">enable</span> *.service  <span class="token comment"># å¼€æœºè¿è¡ŒæœåŠ¡</span>
systemctl disable *.service <span class="token comment"># å–æ¶ˆå¼€æœºè¿è¡Œ</span>
systemctl start *.service   <span class="token comment"># å¯åŠ¨æœåŠ¡</span>
systemctl stop *.service    <span class="token comment"># åœæ­¢æœåŠ¡</span>
systemctl restart *.service <span class="token comment"># é‡å¯æœåŠ¡</span>
systemctl reload *.service  <span class="token comment"># é‡æ–°åŠ è½½æœåŠ¡é…ç½®æ–‡ä»¶</span>
systemctl status *.service  <span class="token comment"># æŸ¥è¯¢æœåŠ¡è¿è¡ŒçŠ¶æ€</span>
systemctl <span class="token parameter variable">--failed</span> <span class="token comment"># æ˜¾ç¤ºå¯åŠ¨å¤±è´¥çš„æœåŠ¡</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>æ³¨: * ä»£è¡¨æŸä¸ªæœåŠ¡çš„åå­—, å¦‚ http çš„æœåŠ¡åä¸º httpd.</p> <p>**å¼€æœºè‡ªå¯åŠ¨æ–¹æ³•äºŒ: **</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">vi</span> /etc/rc.local

<span class="token comment"># åœ¨ rc.local æ–‡ä»¶ä¸­, æ·»åŠ ä¸‹é¢è¿™æ¡å‘½ä»¤</span>
/usr/local/nginx/sbin/nginx start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å¦‚æœå¼€æœºåå‘ç°è‡ªå¯åŠ¨è„šæœ¬æ²¡æœ‰æ‰§è¡Œ, è¦å»ç¡®è®¤ä¸€ä¸‹ rc.local è¿™ä¸ªæ–‡ä»¶çš„è®¿é—®æƒé™æ˜¯å¦æ˜¯å¯æ‰§è¡Œçš„, å› ä¸º rc.local é»˜è®¤æ˜¯ä¸å¯æ‰§è¡Œçš„. ä¿®æ”¹ rc.local è®¿é—®æƒé™, å¢åŠ å¯æ‰§è¡Œæƒé™:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># /etc/rc.localæ˜¯/etc/rc.d/rc.localçš„è½¯è¿æ¥, </span>
<span class="token function">chmod</span> +x /etc/rc.d/rc.local
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>å®˜æ–¹è„šæœ¬ <a href="https://www.nginx.com/resources/wiki/start/topics/examples/redhatnginxinit/" target="_blank" rel="noopener noreferrer">ed Hat NGINX Init Script<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h5 id="æœåŠ¡ç®¡ç†"><a href="#æœåŠ¡ç®¡ç†" class="header-anchor">#</a> æœåŠ¡ç®¡ç†</h5> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># å¯åŠ¨</span>
/usr/local/nginx/sbin/nginx
<span class="token comment"># é‡å¯</span>
/usr/local/nginx/sbin/nginx <span class="token parameter variable">-s</span> reload
<span class="token comment"># å…³é—­è¿›ç¨‹</span>
/usr/local/nginx/sbin/nginx <span class="token parameter variable">-s</span> stop
<span class="token comment"># å¹³æ»‘å…³é—­nginx</span>
/usr/local/nginx/sbin/nginx <span class="token parameter variable">-s</span> quit
<span class="token comment"># æŸ¥çœ‹nginxçš„å®‰è£…çŠ¶æ€, </span>
/usr/local/nginx/sbin/nginx <span class="token parameter variable">-V</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>å…³é—­é˜²ç«å¢™, æˆ–è€…æ·»åŠ é˜²ç«å¢™è§„åˆ™å°±å¯ä»¥æµ‹è¯•äº†.</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">service</span> iptables stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æˆ–è€…ç¼–è¾‘é…ç½®æ–‡ä»¶:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">vi</span> /etc/sysconfig/iptables
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ·»åŠ è¿™æ ·ä¸€æ¡<strong>å¼€æ”¾ 80 ç«¯å£çš„è§„åˆ™</strong>åä¿å­˜:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token parameter variable">-A</span> INPUT <span class="token parameter variable">-m</span> state <span class="token parameter variable">--state</span> NEW <span class="token parameter variable">-m</span> tcp <span class="token parameter variable">-p</span> tcp <span class="token parameter variable">--dport</span> <span class="token number">80</span> <span class="token parameter variable">-j</span> ACCEPT
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>é‡å¯æœåŠ¡å³å¯:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">service</span> iptables restart
<span class="token comment"># å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹ç›®å‰nat</span>
iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-L</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="é‡å¯æœåŠ¡é˜²ç«å¢™æŠ¥é”™è§£å†³"><a href="#é‡å¯æœåŠ¡é˜²ç«å¢™æŠ¥é”™è§£å†³" class="header-anchor">#</a> é‡å¯æœåŠ¡é˜²ç«å¢™æŠ¥é”™è§£å†³</h5> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">service</span> iptables restart
<span class="token comment"># Redirecting to /bin/systemctl restart  iptables.service</span>
<span class="token comment"># Failed to restart iptables.service: Unit iptables.service failed to load: No such file or directory.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>åœ¨ CentOS 7 æˆ– RHEL 7 æˆ– Fedora ä¸­é˜²ç«å¢™ç”± <strong>firewalld</strong> æ¥ç®¡ç†, å½“ç„¶å¯ä»¥è¿˜åŸä¼ ç»Ÿçš„ç®¡ç†æ–¹å¼. æˆ–åˆ™ä½¿ç”¨æ–°çš„å‘½ä»¤è¿›è¡Œç®¡ç†.</p> <p>å‡å¦‚é‡‡ç”¨ä¼ ç»Ÿè¯·æ‰§è¡Œä¸€ä¸‹å‘½ä»¤:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># ä¼ ç»Ÿå‘½ä»¤</span>
systemctl stop firewalld
systemctl mask firewalld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># å®‰è£…å‘½ä»¤</span>
yum <span class="token function">install</span> iptables-services

systemctl <span class="token builtin class-name">enable</span> iptables 
<span class="token function">service</span> iptables restart
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="nginxå¸è½½"><a href="#nginxå¸è½½" class="header-anchor">#</a> nginxå¸è½½</h5> <p>å¦‚æœé€šè¿‡ yum å®‰è£…, ä½¿ç”¨ä¸‹é¢å‘½ä»¤å®‰è£….</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yum remove nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç¼–è¯‘å®‰è£…, åˆ é™¤ <code>/usr/local/nginx</code>â€‹ ç›®å½•å³å¯.</p> <p>å¦‚æœé…ç½®äº†è‡ªå¯åŠ¨è„šæœ¬, ä¹Ÿéœ€è¦åˆ é™¤.</p> <h5 id="å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—"><a href="#å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—" class="header-anchor">#</a> å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—</h5> <div class="language- line-numbers-mode"><pre class="language-text"><code>./configure --prefix=/ä½ çš„å®‰è£…ç›®å½•  --add-module=/ç¬¬ä¸‰æ–¹æ¨¡å—ç›®å½•
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="header-anchor">#</a> å‚æ•°è¯´æ˜</h4> <table><thead><tr><th>å‚æ•°</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td>--prefix=<code>&lt;path&gt;</code>â€‹</td> <td>Nginx å®‰è£…è·¯å¾„. å¦‚æœæ²¡æœ‰æŒ‡å®š, é»˜è®¤ä¸º <code>/usr/local/nginx</code>â€‹.</td></tr> <tr><td>--sbin-path=<code>&lt;path&gt;</code>â€‹</td> <td>Nginx å¯æ‰§è¡Œæ–‡ä»¶å®‰è£…è·¯å¾„. åªèƒ½å®‰è£…æ—¶æŒ‡å®š, å¦‚æœæ²¡æœ‰æŒ‡å®š, é»˜è®¤ä¸º <code>&lt;prefix&gt;</code>â€‹/sbin/nginx.</td></tr> <tr><td>--conf-path=<code>&lt;path&gt;</code>â€‹</td> <td>åœ¨æ²¡æœ‰ç»™å®š -c é€‰é¡¹ä¸‹é»˜è®¤çš„ <strong>nginx.conf</strong> çš„è·¯å¾„. å¦‚æœæ²¡æœ‰æŒ‡å®š, é»˜è®¤ä¸º <code>&lt;prefix&gt;</code>â€‹/conf/nginx.conf.</td></tr> <tr><td>--pid-path=<code>&lt;path&gt;</code>â€‹</td> <td>åœ¨ nginx.conf ä¸­æ²¡æœ‰æŒ‡å®š pid æŒ‡ä»¤çš„æƒ…å†µä¸‹, é»˜è®¤çš„ nginx.pid çš„è·¯å¾„. å¦‚æœæ²¡æœ‰æŒ‡å®š, é»˜è®¤ä¸º <code>&lt;prefix&gt;</code>â€‹/logs/nginx.pid.</td></tr> <tr><td>--lock-path=<code>&lt;path&gt;</code>â€‹</td> <td>nginx.lock æ–‡ä»¶çš„è·¯å¾„.</td></tr> <tr><td>--error-log-path=<code>&lt;path&gt;</code>â€‹</td> <td>åœ¨ nginx.conf ä¸­æ²¡æœ‰æŒ‡å®š error_log æŒ‡ä»¤çš„æƒ…å†µä¸‹, é»˜è®¤çš„é”™è¯¯æ—¥å¿—çš„è·¯å¾„. å¦‚æœæ²¡æœ‰æŒ‡å®š, é»˜è®¤ä¸º <code>&lt;prefix&gt;</code>â€‹/- logs/error.log.</td></tr> <tr><td>--http-log-path=<code>&lt;path&gt;</code>â€‹</td> <td>åœ¨ nginx.conf ä¸­æ²¡æœ‰æŒ‡å®š access_log æŒ‡ä»¤çš„æƒ…å†µä¸‹, é»˜è®¤çš„è®¿é—®æ—¥å¿—çš„è·¯å¾„. å¦‚æœæ²¡æœ‰æŒ‡å®š, é»˜è®¤ä¸º <code>&lt;prefix&gt;</code>â€‹/- logs/access.log.</td></tr> <tr><td>--user=<code>&lt;user&gt;</code>â€‹</td> <td>åœ¨ nginx.conf ä¸­æ²¡æœ‰æŒ‡å®š user æŒ‡ä»¤çš„æƒ…å†µä¸‹, é»˜è®¤çš„ nginx ä½¿ç”¨çš„ç”¨æˆ·. å¦‚æœæ²¡æœ‰æŒ‡å®š, é»˜è®¤ä¸º nobody.</td></tr> <tr><td>--group=<code>&lt;group&gt;</code>â€‹</td> <td>åœ¨ nginx.conf ä¸­æ²¡æœ‰æŒ‡å®š user æŒ‡ä»¤çš„æƒ…å†µä¸‹, é»˜è®¤çš„ nginx ä½¿ç”¨çš„ç»„. å¦‚æœæ²¡æœ‰æŒ‡å®š, é»˜è®¤ä¸º nobody.</td></tr> <tr><td>--builddir=DIR</td> <td>æŒ‡å®šç¼–è¯‘çš„ç›®å½•</td></tr> <tr><td>--with-rtsig_module</td> <td>å¯ç”¨ rtsig æ¨¡å—</td></tr> <tr><td>--with-select_module --without-select_module</td> <td>å…è®¸æˆ–ä¸å…è®¸å¼€å¯ SELECT æ¨¡å¼, å¦‚æœ configure æ²¡æœ‰æ‰¾åˆ°æ›´åˆé€‚çš„æ¨¡å¼, æ¯”å¦‚: kqueue(sun os), epoll (linux kenel 2.6+), rtsig(- å®æ—¶ä¿¡å·)æˆ–è€… /dev/poll(ä¸€ç§ç±»ä¼¼ select çš„æ¨¡å¼, åº•å±‚å®ç°ä¸ SELECT åŸºæœ¬ç›¸åŒ, éƒ½æ˜¯é‡‡ç”¨è½®è®­æ–¹æ³•) SELECT æ¨¡å¼å°†æ˜¯é»˜è®¤å®‰è£…æ¨¡å¼</td></tr> <tr><td>--with-poll_module --without-poll_module</td> <td>Whether or not to enable the poll module. This module is enabled by, default if a more suitable method such as kqueue, epoll, rtsig or /dev/poll is not discovered by configure.</td></tr> <tr><td>--with-http_ssl_module</td> <td>Enable ngx_http_ssl_module. Enables SSL support and the ability to handle HTTPS requests. Requires OpenSSL. On Debian, this is libssl-dev. <strong>å¼€å¯ HTTP SSL æ¨¡å—, ä½¿ NGINX å¯ä»¥æ”¯æŒ HTTPS è¯·æ±‚</strong>. è¿™ä¸ªæ¨¡å—éœ€è¦å·²ç»å®‰è£…äº† <strong>OPENSSL</strong>, åœ¨ DEBIAN ä¸Šæ˜¯libssl</td></tr> <tr><td>--with-http_realip_module</td> <td>å¯ç”¨ ngx_http_realip_module</td></tr> <tr><td>--with-http_addition_module</td> <td>å¯ç”¨ ngx_http_addition_module</td></tr> <tr><td>--with-http_sub_module</td> <td>å¯ç”¨ ngx_http_sub_module</td></tr> <tr><td>--with-http_dav_module</td> <td>å¯ç”¨ ngx_http_dav_module</td></tr> <tr><td>--with-http_flv_module</td> <td>å¯ç”¨ ngx_http_flv_module</td></tr> <tr><td>--with-http_stub_status_module</td> <td>å¯ç”¨ &quot;server status&quot; é¡µ</td></tr> <tr><td>--without-http_charset_module</td> <td>ç¦ç”¨ ngx_http_charset_module</td></tr> <tr><td>--without-http_gzip_module</td> <td>ç¦ç”¨ ngx_http_gzip_module. å¦‚æœå¯ç”¨, éœ€è¦ zlib.</td></tr> <tr><td>--without-http_ssi_module</td> <td>ç¦ç”¨ ngx_http_ssi_module</td></tr> <tr><td>--without-http_userid_module</td> <td>ç¦ç”¨ ngx_http_userid_module</td></tr> <tr><td>--without-http_access_module</td> <td>ç¦ç”¨ ngx_http_access_module</td></tr> <tr><td>--without-http_auth_basic_module</td> <td>ç¦ç”¨ ngx_http_auth_basic_module</td></tr> <tr><td>--without-http_autoindex_module</td> <td>ç¦ç”¨ ngx_http_autoindex_module</td></tr> <tr><td>--without-http_geo_module</td> <td>ç¦ç”¨ ngx_http_geo_module</td></tr> <tr><td>--without-http_map_module</td> <td>ç¦ç”¨ ngx_http_map_module</td></tr> <tr><td>--without-http_referer_module</td> <td>ç¦ç”¨ ngx_http_referer_module</td></tr> <tr><td>--without-http_rewrite_module</td> <td>ç¦ç”¨ ngx_http_rewrite_module. å¦‚æœå¯ç”¨éœ€è¦ PCRE.</td></tr> <tr><td>--without-http_proxy_module</td> <td>ç¦ç”¨ ngx_http_proxy_module</td></tr> <tr><td>--without-http_fastcgi_module</td> <td>ç¦ç”¨ ngx_http_fastcgi_module</td></tr> <tr><td>--without-http_memcached_module</td> <td>ç¦ç”¨ ngx_http_memcached_module</td></tr> <tr><td>--without-http_limit_zone_module</td> <td>ç¦ç”¨ ngx_http_limit_zone_module</td></tr> <tr><td>--without-http_empty_gif_module</td> <td>ç¦ç”¨ ngx_http_empty_gif_module</td></tr> <tr><td>--without-http_browser_module</td> <td>ç¦ç”¨ ngx_http_browser_module</td></tr> <tr><td>--without-http_upstream_ip_hash_module</td> <td>ç¦ç”¨ ngx_http_upstream_ip_hash_module</td></tr> <tr><td>--with-http_perl_module</td> <td>å¯ç”¨ ngx_http_perl_module</td></tr> <tr><td>--with-perl_modules_path=PATH</td> <td>æŒ‡å®š perl æ¨¡å—çš„è·¯å¾„</td></tr> <tr><td>--with-perl=PATH</td> <td>æŒ‡å®š perl æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„</td></tr> <tr><td>--http-log-path=PATH</td> <td>Set path to the http access log</td></tr> <tr><td>--http-client-body-temp-path=PATH</td> <td>Set path to the http client request body temporary files</td></tr> <tr><td>--http-proxy-temp-path=PATH</td> <td>Set path to the http proxy temporary files</td></tr> <tr><td>--http-fastcgi-temp-path=PATH</td> <td>Set path to the http fastcgi temporary files</td></tr> <tr><td>--without-http</td> <td>ç¦ç”¨ HTTP server</td></tr> <tr><td>--with-mail</td> <td>å¯ç”¨ IMAP4/POP3/SMTP ä»£ç†æ¨¡å—</td></tr> <tr><td>--with-mail_ssl_module</td> <td>å¯ç”¨ ngx_mail_ssl_module</td></tr> <tr><td>--with-cc=PATH</td> <td>æŒ‡å®š C ç¼–è¯‘å™¨çš„è·¯å¾„</td></tr> <tr><td>--with-cpp=PATH</td> <td>æŒ‡å®š C é¢„å¤„ç†å™¨çš„è·¯å¾„</td></tr> <tr><td>--with-cc-opt=OPTIONS</td> <td>Additional parameters which will be added to the variable CFLAGS. With the use of the system library PCRE in FreeBSD, it is necessary to indicate --with-cc-opt=&quot;-I /usr/local/include&quot;. If we are using select() and it is necessary to increase the number of file descriptors, then this also can be assigned here: --with-cc-opt=&quot;-D FD_SETSIZE=2048&quot;.</td></tr> <tr><td>--with-ld-opt=OPTIONS</td> <td>Additional parameters passed to the linker. With the use of the system library PCRE in - FreeBSD, it is necessary to indicate --with-ld-opt=&quot;-L /usr/local/lib&quot;.</td></tr> <tr><td>--with-cpu-opt=CPU</td> <td>ä¸ºç‰¹å®šçš„ CPU ç¼–è¯‘, æœ‰æ•ˆçš„å€¼åŒ…æ‹¬: pentium, pentiumpro, pentium3, pentium4, athlon, opteron, amd64, sparc32, sparc64, ppc64</td></tr> <tr><td>--without-pcre</td> <td>ç¦æ­¢ PCRE åº“çš„ä½¿ç”¨. åŒæ—¶ä¹Ÿä¼šç¦æ­¢ HTTP rewrite æ¨¡å—. åœ¨ &quot;location&quot; é…ç½®æŒ‡ä»¤ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿéœ€è¦ PCRE.</td></tr> <tr><td>--with-pcre=DIR</td> <td>æŒ‡å®š PCRE åº“çš„æºä»£ç çš„è·¯å¾„.</td></tr> <tr><td>--with-pcre-opt=OPTIONS</td> <td>Set additional options for PCRE building.</td></tr> <tr><td>--with-md5=DIR</td> <td>Set path to md5 library sources.</td></tr> <tr><td>--with-md5-opt=OPTIONS</td> <td>Set additional options for md5 building.</td></tr> <tr><td>--with-md5-asm</td> <td>Use md5 assembler sources.</td></tr> <tr><td>--with-sha1=DIR</td> <td>Set path to sha1 library sources.</td></tr> <tr><td>--with-sha1-opt=OPTIONS</td> <td>Set additional options for sha1 building.</td></tr> <tr><td>--with-sha1-asm</td> <td>Use sha1 assembler sources.</td></tr> <tr><td>--with-zlib=DIR</td> <td>Set path to zlib library sources.</td></tr> <tr><td>--with-zlib-opt=OPTIONS</td> <td>Set additional options for zlib building.</td></tr> <tr><td>--with-zlib-asm=CPU</td> <td>Use zlib assembler sources optimized for specified CPU, valid values are: pentium, pentiumpro</td></tr> <tr><td>--with-openssl=DIR</td> <td>Set path to OpenSSL library sources</td></tr> <tr><td>--with-openssl-opt=OPTIONS</td> <td>Set additional options for OpenSSL building</td></tr> <tr><td>--with-debug</td> <td>å¯ç”¨è°ƒè¯•æ—¥å¿—</td></tr> <tr><td>--add-module=PATH</td> <td>Add in a third-party module found in directory PATH</td></tr></tbody></table> <h4 id="nginxé…ç½®"><a href="#nginxé…ç½®" class="header-anchor">#</a> Nginxé…ç½®</h4> <p>åœ¨ Centos é»˜è®¤é…ç½®æ–‡ä»¶åœ¨  <strong>/usr/local/nginx-1.5.1/conf/nginx.conf.</strong>  è¦åœ¨è¿™é‡Œé…ç½®ä¸€äº›æ–‡ä»¶. <strong>nginx.conf æ˜¯ä¸»é…ç½®æ–‡ä»¶</strong>, ç”±è‹¥å¹²ä¸ªéƒ¨åˆ†ç»„æˆ, æ¯ä¸ªå¤§æ‹¬å· <code>{}</code>â€‹ è¡¨ç¤ºä¸€ä¸ªéƒ¨åˆ†. æ¯ä¸€è¡ŒæŒ‡ä»¤éƒ½ç”±åˆ†å·ç»“æŸ <code>;</code>â€‹, æ ‡å¿—ç€ä¸€è¡Œçš„ç»“æŸ.</p> <h5 id="å¸¸ç”¨æ­£åˆ™"><a href="#å¸¸ç”¨æ­£åˆ™" class="header-anchor">#</a> å¸¸ç”¨æ­£åˆ™</h5> <table><thead><tr><th style="text-align:center;">æ­£åˆ™</th> <th>è¯´æ˜</th> <th style="text-align:center;">æ­£åˆ™</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td style="text-align:center;">â€‹<code>.</code>â€‹</td> <td>åŒ¹é…é™¤æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦</td> <td style="text-align:center;">â€‹<code>$</code>â€‹</td> <td>åŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸ</td></tr> <tr><td style="text-align:center;">â€‹<code>?</code>â€‹</td> <td>é‡å¤ 0 æ¬¡æˆ– 1 æ¬¡</td> <td style="text-align:center;">â€‹<code>{n}</code>â€‹</td> <td>é‡å¤ n æ¬¡</td></tr> <tr><td style="text-align:center;">â€‹<code>+</code>â€‹</td> <td>é‡å¤ 1 æ¬¡æˆ–æ›´å¤šæ¬¡</td> <td style="text-align:center;">â€‹<code>{n,}</code>â€‹</td> <td>é‡å¤ n æ¬¡æˆ–æ›´å¤šæ¬¡</td></tr> <tr><td style="text-align:center;">â€‹<code>*</code>â€‹</td> <td>é‡å¤ 0 æ¬¡æˆ–æ›´å¤šæ¬¡</td> <td style="text-align:center;">â€‹<code>[c]</code>â€‹</td> <td>åŒ¹é…å•ä¸ªå­—ç¬¦ c</td></tr> <tr><td style="text-align:center;">â€‹<code>\d</code>â€‹</td> <td>åŒ¹é…æ•°å­—</td> <td style="text-align:center;">â€‹<code>[a-z]</code>â€‹</td> <td>åŒ¹é… a-z å°å†™å­—æ¯çš„ä»»æ„ä¸€ä¸ª</td></tr> <tr><td style="text-align:center;">â€‹<code>^</code>â€‹</td> <td>åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹</td> <td style="text-align:center;">-</td> <td>-</td></tr></tbody></table> <h5 id="å…¨å±€å˜é‡"><a href="#å…¨å±€å˜é‡" class="header-anchor">#</a> å…¨å±€å˜é‡</h5> <table><thead><tr><th>å˜é‡</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td>â€‹<code>$args</code>â€‹</td> <td>è¿™ä¸ªå˜é‡ç­‰äºè¯·æ±‚è¡Œä¸­çš„å‚æ•°, åŒ <code>$query_string</code>â€‹</td></tr> <tr><td>â€‹ <strong>â€‹<code>$content_length</code>â€‹</strong>â€‹</td> <td>è¯·æ±‚å¤´ä¸­çš„ Content-length å­—æ®µ.</td></tr> <tr><td>â€‹<code>$content_type</code>â€‹</td> <td>è¯·æ±‚å¤´ä¸­çš„ Content-Type å­—æ®µ.</td></tr> <tr><td>â€‹<code>$document_root</code>â€‹</td> <td>å½“å‰è¯·æ±‚åœ¨ root æŒ‡ä»¤ä¸­æŒ‡å®šçš„å€¼.</td></tr> <tr><td>â€‹<code>$host</code>â€‹</td> <td>è¯·æ±‚ä¸»æœºå¤´å­—æ®µ, å¦åˆ™ä¸ºæœåŠ¡å™¨åç§°.</td></tr> <tr><td>â€‹<code>$http_user_agent</code>â€‹</td> <td>å®¢æˆ·ç«¯ agent ä¿¡æ¯</td></tr> <tr><td>â€‹<code>$http_cookie</code>â€‹</td> <td>å®¢æˆ·ç«¯ cookie ä¿¡æ¯</td></tr> <tr><td>â€‹<code>$limit_rate</code>â€‹</td> <td>è¿™ä¸ªå˜é‡å¯ä»¥é™åˆ¶è¿æ¥é€Ÿç‡.</td></tr> <tr><td>â€‹<code>$request_method</code>â€‹</td> <td>å®¢æˆ·ç«¯è¯·æ±‚çš„åŠ¨ä½œ, é€šå¸¸ä¸º GET æˆ– POST.</td></tr> <tr><td>â€‹<code>$remote_addr</code>â€‹</td> <td>å®¢æˆ·ç«¯çš„ IP åœ°å€.</td></tr> <tr><td>â€‹<code>$document_uri</code>â€‹</td> <td>ä¸ $uri ç›¸åŒ.</td></tr> <tr><td>â€‹<code>$remote_port</code>â€‹</td> <td>å®¢æˆ·ç«¯çš„ç«¯å£.</td></tr> <tr><td>â€‹<code>$remote_user</code>â€‹</td> <td>å·²ç»ç»è¿‡ Auth Basic Module éªŒè¯çš„ç”¨æˆ·å.</td></tr> <tr><td>â€‹<code>$request_filename</code>â€‹</td> <td>å½“å‰è¯·æ±‚çš„æ–‡ä»¶è·¯å¾„, ç”± root æˆ– alias æŒ‡ä»¤ä¸ URI è¯·æ±‚ç”Ÿæˆ.</td></tr> <tr><td>â€‹<code>$scheme</code>â€‹</td> <td>HTTP æ–¹æ³•(å¦‚ http, https).</td></tr> <tr><td>â€‹<code>$server_protocol</code>â€‹</td> <td>è¯·æ±‚ä½¿ç”¨çš„åè®®, é€šå¸¸æ˜¯ HTTP/1.0 æˆ– HTTP/1.1.</td></tr> <tr><td>â€‹<code>$server_addr</code>â€‹</td> <td>æœåŠ¡å™¨åœ°å€, åœ¨å®Œæˆä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨åå¯ä»¥ç¡®å®šè¿™ä¸ªå€¼.</td></tr> <tr><td>â€‹<code>$server_name</code>â€‹</td> <td>æœåŠ¡å™¨åç§°.</td></tr> <tr><td>â€‹<code>$server_port</code>â€‹</td> <td>è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨çš„ç«¯å£å·.</td></tr> <tr><td>â€‹<code>$request_uri</code>â€‹</td> <td>åŒ…å«è¯·æ±‚å‚æ•°çš„åŸå§‹ URI, ä¸åŒ…å«ä¸»æœºå, å¦‚: <code>/foo/bar.php?arg=baz</code>â€‹.</td></tr> <tr><td>â€‹<code>$uri</code>â€‹</td> <td>ä¸å¸¦è¯·æ±‚å‚æ•°çš„å½“å‰ URI, $uri ä¸åŒ…å«ä¸»æœºå, å¦‚ <code>/foo/bar.html</code>â€‹.</td></tr></tbody></table> <p>ä¾‹å¦‚è¯·æ±‚: <code>http://localhost:3000/test1/test2/test.php</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$host: localhost
$server_port: 3000
$request_uri: /test1/test2/test.php
$document_uri: /test1/test2/test.php
$document_root: /var/www/html
$request_filename: /var/www/html/test1/test2/test.php
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="ç¬¦å·å‚è€ƒ"><a href="#ç¬¦å·å‚è€ƒ" class="header-anchor">#</a> ç¬¦å·å‚è€ƒ</h5> <table><thead><tr><th style="text-align:center;">ç¬¦å·</th> <th style="text-align:center;">è¯´æ˜</th> <th style="text-align:center;">ç¬¦å·</th> <th style="text-align:center;">è¯´æ˜</th> <th style="text-align:center;">ç¬¦å·</th> <th style="text-align:center;">è¯´æ˜</th></tr></thead> <tbody><tr><td style="text-align:center;">k,K</td> <td style="text-align:center;">åƒå­—èŠ‚</td> <td style="text-align:center;">m,M</td> <td style="text-align:center;">å…†å­—èŠ‚</td> <td style="text-align:center;">ms</td> <td style="text-align:center;">æ¯«ç§’</td></tr> <tr><td style="text-align:center;">s</td> <td style="text-align:center;">ç§’</td> <td style="text-align:center;">m</td> <td style="text-align:center;">åˆ†é’Ÿ</td> <td style="text-align:center;">h</td> <td style="text-align:center;">å°æ—¶</td></tr> <tr><td style="text-align:center;">d</td> <td style="text-align:center;">æ—¥</td> <td style="text-align:center;">w</td> <td style="text-align:center;">å‘¨</td> <td style="text-align:center;">M</td> <td style="text-align:center;">ä¸€ä¸ªæœˆ, 30å¤©</td></tr></tbody></table> <p>ä¾‹å¦‚, &quot;8k&quot;, &quot;1m&quot; ä»£è¡¨<strong>å­—èŠ‚æ•°è®¡é‡</strong>.
ä¾‹å¦‚, &quot;1h 30m&quot;, &quot;1y 6M&quot;. ä»£è¡¨ &quot;1 å°æ—¶ 30 åˆ†&quot;, &quot;1 å¹´é›¶ 6 ä¸ªæœˆ&quot;.</p> <h5 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="header-anchor">#</a> é…ç½®æ–‡ä»¶</h5> <p><strong>nginx çš„é…ç½®ç³»ç»Ÿç”±ä¸€ä¸ªä¸»é…ç½®æ–‡ä»¶å’Œå…¶ä»–ä¸€äº›è¾…åŠ©çš„é…ç½®æ–‡ä»¶æ„æˆ. è¿™äº›é…ç½®æ–‡ä»¶å‡æ˜¯çº¯æ–‡æœ¬æ–‡ä»¶, å…¨éƒ¨ä½äº nginx å®‰è£…ç›®å½•ä¸‹çš„ conf ç›®å½•ä¸‹</strong>.</p> <p>æŒ‡ä»¤ç”± nginx çš„å„ä¸ªæ¨¡å—æä¾›, ä¸åŒçš„æ¨¡å—ä¼šæä¾›ä¸åŒçš„æŒ‡ä»¤æ¥å®ç°é…ç½®. æŒ‡ä»¤é™¤äº† Key-Value çš„å½¢å¼, è¿˜æœ‰ä½œç”¨åŸŸæŒ‡ä»¤.</p> <p>nginx.conf ä¸­çš„é…ç½®ä¿¡æ¯, æ ¹æ®å…¶é€»è¾‘ä¸Šçš„æ„ä¹‰, å¯¹å®ƒä»¬è¿›è¡Œäº†<strong>åˆ†ç±»</strong>, ä¹Ÿå°±æ˜¯åˆ†æˆäº†<strong>å¤šä¸ªä½œç”¨åŸŸ</strong>, æˆ–è€…ç§°ä¹‹ä¸ºé…ç½®æŒ‡ä»¤ä¸Šä¸‹æ–‡. ä¸åŒçš„ä½œç”¨åŸŸå«æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªé…ç½®é¡¹.</p> <p>ä¸‹é¢çš„è¿™äº›ä¸Šä¸‹æ–‡æŒ‡ä»¤æ˜¯ç”¨çš„æ¯”è¾ƒå¤š:</p> <table><thead><tr><th style="text-align:center;">Directive</th> <th>Description</th> <th>Contains Directive</th></tr></thead> <tbody><tr><td style="text-align:center;">main</td> <td>nginx åœ¨<strong>è¿è¡Œæ—¶ä¸å…·ä½“ä¸šåŠ¡åŠŸèƒ½(æ¯”å¦‚ http æœåŠ¡æˆ–è€… email æœåŠ¡ä»£ç†)æ— å…³</strong>çš„ä¸€äº›å‚æ•°, æ¯”å¦‚å·¥ä½œè¿›ç¨‹æ•°, è¿è¡Œçš„èº«ä»½ç­‰.</td> <td>user, worker_processes, error_log, events, http, mail</td></tr> <tr><td style="text-align:center;">http</td> <td>ä¸<mark><strong>æä¾› http æœåŠ¡ç›¸å…³çš„ä¸€äº›é…ç½®å‚æ•°</strong></mark>. ä¾‹å¦‚: æ˜¯å¦ä½¿ç”¨ keepalive, æ˜¯å¦ä½¿ç”¨ gzip è¿›è¡Œå‹ç¼©ç­‰.</td> <td>server</td></tr> <tr><td style="text-align:center;">server</td> <td><mark><strong>http æœåŠ¡ä¸Šæ”¯æŒè‹¥å¹²è™šæ‹Ÿä¸»æœº. æ¯ä¸ªè™šæ‹Ÿä¸»æœºä¸€ä¸ªå¯¹åº”çš„ server é…ç½®é¡¹, é…ç½®é¡¹é‡Œé¢åŒ…å«è¯¥è™šæ‹Ÿä¸»æœºç›¸å…³çš„é…ç½®</strong></mark>. åœ¨æä¾› mail æœåŠ¡çš„ä»£ç†æ—¶, ä¹Ÿå¯ä»¥å»ºç«‹è‹¥å¹² server. æ¯ä¸ª server é€šè¿‡ç›‘å¬çš„åœ°å€æ¥åŒºåˆ†.</td> <td>listen, server_name, access_log, location, protocol, proxy, smtp_auth, xclient</td></tr> <tr><td style="text-align:center;">location</td> <td><mark>**http æœåŠ¡ä¸­, æŸäº›ç‰¹å®šçš„ URL å¯¹åº”çš„ä¸€ç³»åˆ—é…ç½®é¡¹. **</mark></td> <td>index, root</td></tr> <tr><td style="text-align:center;">mail</td> <td>å®ç° email ç›¸å…³çš„ SMTP/IMAP/POP3 ä»£ç†æ—¶, å…±äº«çš„ä¸€äº›é…ç½®é¡¹(å› ä¸ºå¯èƒ½å®ç°å¤šä¸ªä»£ç†, å·¥ä½œåœ¨å¤šä¸ªç›‘å¬åœ°å€ä¸Š).</td> <td>server, http, imap_capabilities</td></tr> <tr><td style="text-align:center;">include</td> <td>ä»¥ä¾¿å¢å¼ºé…ç½®æ–‡ä»¶çš„å¯è¯»æ€§, <strong>ä½¿å¾—éƒ¨åˆ†é…ç½®æ–‡ä»¶å¯ä»¥é‡æ–°ä½¿ç”¨</strong>.</td> <td>-</td></tr> <tr><td style="text-align:center;">valid_referers</td> <td>ç”¨æ¥æ ¡éªŒ Http è¯·æ±‚å¤´ Referer æ˜¯å¦æœ‰æ•ˆ.</td> <td>-</td></tr> <tr><td style="text-align:center;">try_files</td> <td>ç”¨åœ¨ server éƒ¨åˆ†, ä¸è¿‡æœ€å¸¸è§çš„è¿˜æ˜¯ç”¨åœ¨ location éƒ¨åˆ†, å®ƒä¼šæŒ‰ç…§ç»™å®šçš„å‚æ•°é¡ºåºè¿›è¡Œå°è¯•, ç¬¬ä¸€ä¸ªè¢«åŒ¹é…åˆ°çš„å°†ä¼šè¢«ä½¿ç”¨.</td> <td>-</td></tr> <tr><td style="text-align:center;">if</td> <td>å½“åœ¨ location å—ä¸­ä½¿ç”¨ if æŒ‡ä»¤, åœ¨æŸäº›æƒ…å†µä¸‹å®ƒå¹¶ä¸æŒ‰ç…§é¢„æœŸè¿è¡Œ, ä¸€èˆ¬æ¥è¯´<strong>é¿å…ä½¿ç”¨ if æŒ‡ä»¤</strong>.</td> <td>-</td></tr></tbody></table> <p>ä¾‹å¦‚åœ¨ <strong>nginx.conf</strong> é‡Œé¢å¼•ç”¨ä¸¤ä¸ªé…ç½® <code>vhost/example.com.conf</code>â€‹ å’Œ <code>vhost/gitlab.com.conf</code>â€‹ å®ƒä»¬éƒ½è¢«æ”¾åœ¨ä¸€ä¸ªè‡ªå·±æ–°å»ºçš„ç›®å½• vhost ä¸‹é¢. nginx.conf é…ç½®å¦‚ä¸‹:</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">worker_processes</span>  <span class="token number">1</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">events</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">worker_connections</span>  <span class="token number">1024</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">include</span>       mime.types</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">default_type</span>  application/octet-stream</span><span class="token punctuation">;</span>

    <span class="token comment">#log_format  main  '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '</span>
    <span class="token comment">#                  '$status $body_bytes_sent &quot;$http_referer&quot; '</span>
    <span class="token comment">#                  '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';</span>

    <span class="token comment">#access_log  logs/access.log  main;</span>

    <span class="token directive"><span class="token keyword">sendfile</span>        <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token comment">#tcp_nopush     on;</span>

    <span class="token comment">#keepalive_timeout  0;</span>
    <span class="token directive"><span class="token keyword">keepalive_timeout</span>  <span class="token number">65</span></span><span class="token punctuation">;</span>

    <span class="token comment">#gzip  on;</span>
    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>    <span class="token comment"># ç›‘å¬80ç«¯å£</span>
        <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
            <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token directive"><span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">location</span> = /50x.html</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token directive"><span class="token keyword">include</span>  vhost/example.com.conf</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">include</span>  vhost/gitlab.com.conf</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>ç®€å•çš„é…ç½®: example.com.conf</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token comment"># ä¾¦å¬çš„80ç«¯å£</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  baidu.com app.baidu.com</span><span class="token punctuation">;</span> <span class="token comment"># è¿™é‡ŒæŒ‡å®šåŸŸå</span>
    <span class="token directive"><span class="token keyword">index</span>        index.html index.htm</span><span class="token punctuation">;</span>    <span class="token comment"># è¿™é‡ŒæŒ‡å®šé»˜è®¤å…¥å£é¡µé¢</span>
    <span class="token directive"><span class="token keyword">root</span> /home/www/app.baidu.com</span><span class="token punctuation">;</span>         <span class="token comment"># è¿™é‡ŒæŒ‡å®šç›®å½•</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="å†…ç½®é¢„å®šä¹‰å˜é‡"><a href="#å†…ç½®é¢„å®šä¹‰å˜é‡" class="header-anchor">#</a> å†…ç½®é¢„å®šä¹‰å˜é‡</h5> <p>Nginx æä¾›äº†è®¸å¤šé¢„å®šä¹‰çš„å˜é‡, ä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨ set æ¥è®¾ç½®å˜é‡. å¯ä»¥åœ¨ if ä¸­ä½¿ç”¨é¢„å®šä¹‰å˜é‡, ä¹Ÿå¯ä»¥<strong>å°†å®ƒä»¬ä¼ é€’ç»™ä»£ç†æœåŠ¡å™¨</strong>. ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„é¢„å®šä¹‰å˜é‡, <a href="http://nginx.org/en/docs/varindex.html" target="_blank" rel="noopener noreferrer">æ›´å¤šè¯¦è§<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <table><thead><tr><th>å˜é‡åç§°</th> <th>å€¼</th></tr></thead> <tbody><tr><td>$args_name</td> <td>åœ¨è¯·æ±‚ä¸­çš„ name å‚æ•°</td></tr> <tr><td>$args</td> <td>æ‰€æœ‰è¯·æ±‚å‚æ•°</td></tr> <tr><td>$query_string</td> <td>$args çš„åˆ«å</td></tr> <tr><td>$content_length</td> <td>è¯·æ±‚å¤´ Content-Length çš„å€¼</td></tr> <tr><td>$content_type</td> <td>è¯·æ±‚å¤´ Content-Type çš„å€¼</td></tr> <tr><td>$host</td> <td>å¦‚æœå½“å‰æœ‰ Host, åˆ™ä¸ºè¯·æ±‚å¤´ Host çš„å€¼; å¦‚æœæ²¡æœ‰è¿™ä¸ªå¤´, é‚£ä¹ˆè¯¥å€¼ç­‰äºåŒ¹é…è¯¥è¯·æ±‚çš„ server_name çš„å€¼</td></tr> <tr><td>$remote_addr</td> <td>å®¢æˆ·ç«¯çš„ IP åœ°å€</td></tr> <tr><td>$request</td> <td>å®Œæ•´çš„è¯·æ±‚, ä»å®¢æˆ·ç«¯æ”¶åˆ°, åŒ…æ‹¬ Http è¯·æ±‚æ–¹æ³•, URI, Http åè®®, å¤´, è¯·æ±‚ä½“</td></tr> <tr><td>$request_uri</td> <td>å®Œæ•´è¯·æ±‚çš„ URI, ä»å®¢æˆ·ç«¯æ¥çš„è¯·æ±‚, åŒ…æ‹¬å‚æ•°</td></tr> <tr><td>$scheme</td> <td>å½“å‰è¯·æ±‚çš„åè®®</td></tr> <tr><td>$uri</td> <td>å½“å‰è¯·æ±‚çš„æ ‡å‡†åŒ– URI</td></tr></tbody></table> <h5 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="header-anchor">#</a> åå‘ä»£ç†</h5> <p>åå‘ä»£ç†æ˜¯ä¸€ä¸ª Web æœåŠ¡å™¨, å®ƒ<mark><strong>æ¥å—å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚, ç„¶åå°†è¯·æ±‚è½¬å‘ç»™ä¸Šæ¸¸æœåŠ¡å™¨, å¹¶å°†ä»æœåŠ¡å™¨å¾—åˆ°çš„ç»“æœè¿”å›ç»™è¿æ¥çš„å®¢æˆ·ç«¯</strong></mark>. ä¸‹é¢ç®€å•çš„åå‘ä»£ç†çš„ä¾‹å­:</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>  
  <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>                                                        
  <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>                                              
  <span class="token directive"><span class="token keyword">client_max_body_size</span> <span class="token number">1024M</span></span><span class="token punctuation">;</span>  <span class="token comment"># å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°</span>

  <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span>                         http://localhost:8080</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> Host              <span class="token variable">$host</span>:<span class="token variable">$server_port</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarded-For   <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span> <span class="token comment"># HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IP</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarded-Proto <span class="token variable">$scheme</span></span><span class="token punctuation">;</span>      <span class="token comment"># ä¸ºäº†æ­£ç¡®åœ°è¯†åˆ«å®é™…ç”¨æˆ·å‘å‡ºçš„åè®®æ˜¯ http è¿˜æ˜¯ https</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>å¤æ‚çš„é…ç½®: gitlab.com.conf.</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token comment"># ä¾¦å¬çš„80ç«¯å£</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  git.example.cn</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span>   http://localhost:3000</span><span class="token punctuation">;</span>
        <span class="token comment"># ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®å¯åˆ é™¤</span>
        <span class="token directive"><span class="token keyword">proxy_redirect</span>             <span class="token boolean">off</span></span><span class="token punctuation">;</span>
        <span class="token comment"># åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span>           Host <span class="token variable">$host</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">client_max_body_size</span>       <span class="token number">10m</span></span><span class="token punctuation">;</span> <span class="token comment"># å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°</span>
        <span class="token directive"><span class="token keyword">client_body_buffer_size</span>    <span class="token number">128k</span></span><span class="token punctuation">;</span> <span class="token comment"># ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°</span>
        <span class="token directive"><span class="token keyword">proxy_connect_timeout</span>      <span class="token number">300</span></span><span class="token punctuation">;</span> <span class="token comment"># nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶)</span>
        <span class="token directive"><span class="token keyword">proxy_send_timeout</span>         <span class="token number">300</span></span><span class="token punctuation">;</span> <span class="token comment"># åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶)</span>
        <span class="token directive"><span class="token keyword">proxy_read_timeout</span>         <span class="token number">300</span></span><span class="token punctuation">;</span> <span class="token comment"># è¿æ¥æˆåŠŸå, åç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶)</span>
        <span class="token directive"><span class="token keyword">proxy_buffer_size</span>          <span class="token number">4k</span></span><span class="token punctuation">;</span> <span class="token comment"># è®¾ç½®ä»£ç†æœåŠ¡å™¨(nginx)ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å°</span>
        <span class="token directive"><span class="token keyword">proxy_buffers</span>              <span class="token number">4</span> <span class="token number">32k</span></span><span class="token punctuation">;</span> <span class="token comment"># proxy_buffersç¼“å†²åŒº, ç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è¯, è¿™æ ·è®¾ç½®</span>
        <span class="token directive"><span class="token keyword">proxy_busy_buffers_size</span>    <span class="token number">64k</span></span><span class="token punctuation">;</span> <span class="token comment"># é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°(proxy_buffers*2)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>ä»£ç†åˆ°ä¸Šæ¸¸æœåŠ¡å™¨çš„é…ç½®ä¸­, æœ€é‡è¦çš„æ˜¯ proxy_pass æŒ‡ä»¤</strong>. ä»¥ä¸‹æ˜¯ä»£ç†æ¨¡å—ä¸­çš„ä¸€äº›å¸¸ç”¨æŒ‡ä»¤:</p> <table><thead><tr><th>æŒ‡ä»¤</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td><mark><strong>proxy_connect_timeout</strong></mark></td> <td><strong>Nginx ä»æ¥å—è¯·æ±‚è‡³è¿æ¥åˆ°ä¸Šæ¸¸æœåŠ¡å™¨çš„æœ€é•¿ç­‰å¾…æ—¶é—´</strong></td></tr> <tr><td><mark><strong>proxy_send_timeout</strong></mark></td> <td><strong>åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶)</strong></td></tr> <tr><td><mark><strong>proxy_read_timeout</strong></mark></td> <td><strong>è¿æ¥æˆåŠŸå, åç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶)</strong></td></tr> <tr><td>proxy_cookie_domain</td> <td>æ›¿ä»£ä»ä¸Šæ¸¸æœåŠ¡å™¨æ¥çš„ Set-Cookie å¤´çš„ domain å±æ€§</td></tr> <tr><td>proxy_cookie_path</td> <td>æ›¿ä»£ä»ä¸Šæ¸¸æœåŠ¡å™¨æ¥çš„ Set-Cookie å¤´çš„ path å±æ€§</td></tr> <tr><td>proxy_buffer_size</td> <td>è®¾ç½®ä»£ç†æœåŠ¡å™¨(nginx)ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å°</td></tr> <tr><td>proxy_buffers</td> <td>proxy_buffers ç¼“å†²åŒº, ç½‘é¡µå¹³å‡åœ¨å¤šå°‘ k ä»¥ä¸‹</td></tr> <tr><td>proxy_set_header</td> <td>é‡å†™å‘é€åˆ°ä¸Šæ¸¸æœåŠ¡å™¨å¤´çš„å†…å®¹, ä¹Ÿå¯ä»¥é€šè¿‡å°†æŸä¸ªå¤´éƒ¨çš„å€¼è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸², è€Œä¸å‘é€æŸä¸ªå¤´éƒ¨çš„æ–¹æ³•å®ç°</td></tr> <tr><td>proxy_ignore_headers</td> <td>è¿™ä¸ªæŒ‡ä»¤ç¦æ­¢å¤„ç†æ¥è‡ªä»£ç†æœåŠ¡å™¨çš„åº”ç­”.</td></tr> <tr><td>proxy_intercept_errors</td> <td>ä½¿ nginx é˜»æ­¢ HTTP åº”ç­”ä»£ç ä¸º 400 æˆ–è€…æ›´é«˜çš„åº”ç­”.</td></tr></tbody></table> <h5 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="header-anchor">#</a> è´Ÿè½½å‡è¡¡</h5> <p><mark><strong>upstream æŒ‡ä»¤å¯ç”¨ä¸€ä¸ªæ–°çš„é…ç½®åŒºæ®µ, åœ¨è¯¥åŒºæ®µå®šä¹‰ä¸€ç»„ä¸Šæ¸¸æœåŠ¡å™¨</strong></mark>. è¿™äº›æœåŠ¡å™¨å¯èƒ½è¢«è®¾ç½®ä¸åŒçš„æƒé‡, ä¹Ÿå¯èƒ½å‡ºäºå¯¹æœåŠ¡å™¨è¿›è¡Œç»´æŠ¤, æ ‡è®°ä¸º down.</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> gitlab</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">ip_hash</span></span><span class="token punctuation">;</span>
    <span class="token comment"># upstreamçš„è´Ÿè½½å‡è¡¡, weightæ˜¯æƒé‡, å¯ä»¥æ ¹æ®æœºå™¨é…ç½®å®šä¹‰æƒé‡. </span>
    <span class="token comment"># weigthå‚æ•°è¡¨ç¤ºæƒå€¼, æƒå€¼è¶Šé«˜è¢«åˆ†é…åˆ°çš„å‡ ç‡è¶Šå¤§. </span>
    <span class="token directive"><span class="token keyword">server</span> 192.168.122.11:8081</span> <span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> 127.0.0.1:82 weight=3</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> 127.0.0.1:83 weight=3 down</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> 127.0.0.1:84 weight=3</span><span class="token punctuation">;</span> <span class="token directive"><span class="token keyword">max_fails=3</span>  fail_timeout=20s</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> 127.0.0.1:85 weight=4</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">keepalive</span> <span class="token number">32</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token comment"># ä¾¦å¬çš„80ç«¯å£</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  git.example.cn</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span>   http://gitlab</span><span class="token punctuation">;</span>    <span class="token comment"># åœ¨è¿™é‡Œè®¾ç½®ä¸€ä¸ªä»£ç†, å’Œupstreamçš„åå­—ä¸€æ ·</span>
        <span class="token comment"># ä»¥ä¸‹æ˜¯ä¸€äº›åå‘ä»£ç†çš„é…ç½®å¯åˆ é™¤</span>
        <span class="token directive"><span class="token keyword">proxy_redirect</span>             <span class="token boolean">off</span></span><span class="token punctuation">;</span>
        <span class="token comment"># åç«¯çš„WebæœåŠ¡å™¨å¯ä»¥é€šè¿‡X-Forwarded-Forè·å–ç”¨æˆ·çœŸå®IP</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span>           Host <span class="token variable">$host</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span>           X-Real-IP <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span>           X-Forwarded-For <span class="token variable">$proxy_add_x_forwarded_for</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">client_max_body_size</span>       <span class="token number">10m</span></span><span class="token punctuation">;</span>  <span class="token comment">#å…è®¸å®¢æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å•æ–‡ä»¶å­—èŠ‚æ•°</span>
        <span class="token directive"><span class="token keyword">client_body_buffer_size</span>    <span class="token number">128k</span></span><span class="token punctuation">;</span> <span class="token comment">#ç¼“å†²åŒºä»£ç†ç¼“å†²ç”¨æˆ·ç«¯è¯·æ±‚çš„æœ€å¤§å­—èŠ‚æ•°</span>
        <span class="token directive"><span class="token keyword">proxy_connect_timeout</span>      <span class="token number">300</span></span><span class="token punctuation">;</span>  <span class="token comment">#nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶)</span>
        <span class="token directive"><span class="token keyword">proxy_send_timeout</span>         <span class="token number">300</span></span><span class="token punctuation">;</span>  <span class="token comment">#åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶)</span>
        <span class="token directive"><span class="token keyword">proxy_read_timeout</span>         <span class="token number">300</span></span><span class="token punctuation">;</span>  <span class="token comment">#è¿æ¥æˆåŠŸå, åç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶)</span>
        <span class="token directive"><span class="token keyword">proxy_buffer_size</span>          <span class="token number">4k</span></span><span class="token punctuation">;</span> <span class="token comment">#è®¾ç½®ä»£ç†æœåŠ¡å™¨(nginx)ä¿å­˜ç”¨æˆ·å¤´ä¿¡æ¯çš„ç¼“å†²åŒºå¤§å°</span>
        <span class="token directive"><span class="token keyword">proxy_buffers</span>              <span class="token number">4</span> <span class="token number">32k</span></span><span class="token punctuation">;</span><span class="token comment"># ç¼“å†²åŒº, ç½‘é¡µå¹³å‡åœ¨32kä»¥ä¸‹çš„è¯, è¿™æ ·è®¾ç½®</span>
        <span class="token directive"><span class="token keyword">proxy_busy_buffers_size</span>    <span class="token number">64k</span></span><span class="token punctuation">;</span> <span class="token comment">#é«˜è´Ÿè·ä¸‹ç¼“å†²å¤§å°(proxy_buffers*2)</span>
        <span class="token directive"><span class="token keyword">proxy_temp_file_write_size</span> <span class="token number">64k</span></span><span class="token punctuation">;</span> <span class="token comment">#è®¾å®šç¼“å­˜æ–‡ä»¶å¤¹å¤§å°, å¤§äºè¿™ä¸ªå€¼, å°†ä»upstreamæœåŠ¡å™¨ä¼ </span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨, å¦‚æœåç«¯æœåŠ¡å™¨ down æ‰, èƒ½è‡ªåŠ¨å‰”é™¤.</p> <p>**è´Ÿè½½å‡è¡¡: **</p> <p>upstream æ¨¡å—èƒ½å¤Ÿä½¿ç”¨ 3 ç§è´Ÿè½½å‡è¡¡ç®—æ³•: <strong>è½®è¯¢, IPå“ˆå¸Œ, æœ€å°‘è¿æ¥æ•°</strong>.</p> <ul><li>**è½®è¯¢(RR): ** é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨è½®è¯¢ç®—æ³•, ä¸éœ€è¦é…ç½®æŒ‡ä»¤æ¥æ¿€æ´»å®ƒ, å®ƒæ˜¯åŸºäºåœ¨é˜Ÿåˆ—ä¸­è°æ˜¯ä¸‹ä¸€ä¸ªçš„åŸç†ç¡®ä¿è®¿é—®å‡åŒ€åœ°åˆ†å¸ƒåˆ°æ¯ä¸ªä¸Šæ¸¸æœåŠ¡å™¨;</li> <li>**IPå“ˆå¸Œ: **  é€šè¿‡ ip_hash æŒ‡ä»¤æ¥æ¿€æ´», Nginx é€šè¿‡ IPv4 åœ°å€çš„å‰ 3 ä¸ªå­—èŠ‚æˆ–è€…æ•´ä¸ª IPv6 åœ°å€ä½œä¸ºå“ˆå¸Œé”®æ¥å®ç°, åŒä¸€ä¸ª IP åœ°å€æ€»æ˜¯èƒ½è¢«æ˜ å°„åˆ°åŒä¸€ä¸ªä¸Šæ¸¸æœåŠ¡å™¨;</li> <li><strong>æœ€å°‘è¿æ¥æ•°: **  é€šè¿‡ least_conn æŒ‡ä»¤æ¥æ¿€æ´», è¯¥ç®—æ³•</strong>é€šè¿‡é€‰æ‹©ä¸€ä¸ªæ´»è·ƒæ•°æœ€å°‘çš„ä¸Šæ¸¸æœåŠ¡å™¨è¿›è¡Œè¿æ¥**. å¦‚æœä¸Šæ¸¸æœåŠ¡å™¨å¤„ç†èƒ½åŠ›ä¸åŒ, å¯ä»¥é€šè¿‡ç»™ server é…ç½® weight æƒé‡æ¥è¯´æ˜, è¯¥ç®—æ³•å°†è€ƒè™‘åˆ°ä¸åŒæœåŠ¡å™¨çš„åŠ æƒæœ€å°‘è¿æ¥æ•°.</li></ul> <h6 id="è½®è¯¢-rr"><a href="#è½®è¯¢-rr" class="header-anchor">#</a> è½®è¯¢(RR)</h6> <p><strong>ç®€å•é…ç½®</strong>, è¿™é‡Œé…ç½®äº† 2 å°æœåŠ¡å™¨, å½“ç„¶å®é™…ä¸Šæ˜¯ä¸€å°, åªæ˜¯ç«¯å£ä¸ä¸€æ ·è€Œå·², è€Œ 8081 çš„æœåŠ¡å™¨æ˜¯ä¸å­˜åœ¨çš„, ä¹Ÿå°±æ˜¯è¯´è®¿é—®ä¸åˆ°, ä½†æ˜¯è®¿é—® <code>http://localhost</code>â€‹ çš„æ—¶å€™, ä¹Ÿä¸ä¼šæœ‰é—®é¢˜, ä¼šé»˜è®¤è·³è½¬åˆ° <code>http://localhost:8080</code>â€‹ å…·ä½“æ˜¯å› ä¸º Nginx ä¼šè‡ªåŠ¨åˆ¤æ–­æœåŠ¡å™¨çš„çŠ¶æ€, å¦‚æœæœåŠ¡å™¨å¤„äºä¸èƒ½è®¿é—®(æœåŠ¡å™¨æŒ‚äº†), å°±ä¸ä¼šè·³è½¬åˆ°è¿™å°æœåŠ¡å™¨, æ‰€ä»¥ä¹Ÿé¿å…äº†ä¸€å°æœåŠ¡å™¨æŒ‚äº†å½±å“ä½¿ç”¨çš„æƒ…å†µ, ç”±äº <strong>Nginx é»˜è®¤æ˜¯ RR ç­–ç•¥</strong>, æ‰€ä»¥ä¸éœ€è¦å…¶ä»–æ›´å¤šçš„è®¾ç½®.</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> test</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8080</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8081</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">81</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">client_max_body_size</span> <span class="token number">1024M</span></span><span class="token punctuation">;</span>
 
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://test</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span>:<span class="token variable">$server_port</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>è´Ÿè½½å‡è¡¡çš„æ ¸å¿ƒä»£ç ä¸º:</strong></p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> test</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8080</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8081</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h6 id="æƒé‡"><a href="#æƒé‡" class="header-anchor">#</a> æƒé‡</h6> <p>æŒ‡å®šè½®è¯¢å‡ ç‡, <strong>weight å’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”, ç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡</strong>çš„æƒ…å†µ. ä¾‹å¦‚:</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> test</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8080 weight=9</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8081 weight=1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>é‚£ä¹ˆ 10 æ¬¡ä¸€èˆ¬åªä¼šæœ‰ 1 æ¬¡ä¼šè®¿é—®åˆ° 8081, è€Œæœ‰ 9 æ¬¡ä¼šè®¿é—®åˆ° 8080.</p> <h6 id="ip-hash"><a href="#ip-hash" class="header-anchor">#</a> ip_hash</h6> <p>ä¸Šé¢çš„ 2 ç§æ–¹å¼éƒ½æœ‰ä¸€ä¸ªé—®é¢˜, é‚£å°±æ˜¯ä¸‹ä¸€ä¸ªè¯·æ±‚æ¥çš„æ—¶å€™è¯·æ±‚å¯èƒ½åˆ†å‘åˆ°å¦å¤–ä¸€ä¸ªæœåŠ¡å™¨, å½“ç¨‹åºä¸æ˜¯æ— çŠ¶æ€çš„æ—¶å€™(é‡‡ç”¨äº† session ä¿å­˜æ•°æ®), è¿™æ—¶å€™å°±æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¾ˆé—®é¢˜äº†, æ¯”å¦‚æŠŠç™»å½•ä¿¡æ¯ä¿å­˜åˆ°äº† session ä¸­, é‚£ä¹ˆè·³è½¬åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨çš„æ—¶å€™å°±éœ€è¦é‡æ–°ç™»å½•äº†, æ‰€ä»¥å¾ˆå¤šæ—¶å€™éœ€è¦ä¸€ä¸ªå®¢æˆ·åªè®¿é—®ä¸€ä¸ªæœåŠ¡å™¨, é‚£ä¹ˆå°±éœ€è¦ç”¨ iphash äº†, <strong>iphash çš„æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—® ip çš„ hash ç»“æœåˆ†é…, è¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨, å¯ä»¥è§£å†³ session çš„é—®é¢˜</strong>.</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> test</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">ip_hash</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8080</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8081</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h6 id="fair"><a href="#fair" class="header-anchor">#</a> fair</h6> <p>è¿™æ˜¯ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—, <strong>æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚, å“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…</strong>.</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> backend</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">fair</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8080</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8081</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h6 id="url-hash"><a href="#url-hash" class="header-anchor">#</a> url_hash</h6> <p>è¿™æ˜¯ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—, <strong>æŒ‰è®¿é—® url çš„ hash ç»“æœæ¥åˆ†é…è¯·æ±‚</strong>, ä½¿æ¯ä¸ª url å®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨, åç«¯æœåŠ¡å™¨ä¸ºç¼“å­˜æ—¶æ¯”è¾ƒæœ‰æ•ˆ. åœ¨ upstream ä¸­åŠ å…¥ hash è¯­å¥, server è¯­å¥ä¸­ä¸èƒ½å†™å…¥ weight ç­‰å…¶ä»–çš„å‚æ•°, hash_method æ˜¯ä½¿ç”¨çš„ hash ç®—æ³•</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> backend</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">hash</span> <span class="token variable">$request_uri</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">hash_method</span> crc32</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8080</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> localhost:8081</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ä»¥ä¸Š 5 ç§è´Ÿè½½å‡è¡¡å„è‡ªé€‚ç”¨ä¸åŒæƒ…å†µä¸‹ä½¿ç”¨, æ‰€ä»¥å¯ä»¥æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ä½¿ç”¨å“ªç§ç­–ç•¥æ¨¡å¼, ä¸è¿‡ fair å’Œ url_hash éœ€è¦å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—æ‰èƒ½ä½¿ç”¨.</p> <p>**server æŒ‡ä»¤å¯é€‰å‚æ•°: **</p> <ol><li><mark><strong>weight</strong></mark>: è®¾ç½®ä¸€ä¸ªæœåŠ¡å™¨çš„<strong>è®¿é—®æƒé‡</strong>, æ•°å€¼è¶Šé«˜, æ”¶åˆ°çš„è¯·æ±‚ä¹Ÿè¶Šå¤š;</li> <li><mark><strong>fail_timeout</strong></mark>: åœ¨è¿™ä¸ªæŒ‡å®šçš„æ—¶é—´å†…æœåŠ¡å™¨å¿…é¡»æä¾›å“åº”, å¦‚æœåœ¨è¿™ä¸ªæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°å“åº”, é‚£ä¹ˆæœåŠ¡å™¨å°†ä¼šè¢«æ ‡è®°ä¸º down çŠ¶æ€;</li> <li><mark><strong>max_fails</strong></mark>: è®¾ç½®åœ¨ fail_timeout æ—¶é—´ä¹‹å†…å°è¯•å¯¹ä¸€ä¸ªæœåŠ¡å™¨è¿æ¥çš„æœ€å¤§æ¬¡æ•°, å¦‚æœè¶…è¿‡è¿™ä¸ªæ¬¡æ•°, é‚£ä¹ˆæœåŠ¡å™¨å°†ä¼šè¢«æ ‡è®°ä¸º down;</li> <li><mark><strong>down</strong></mark>: æ ‡è®°ä¸€ä¸ªæœåŠ¡å™¨ä¸å†æ¥å—ä»»ä½•è¯·æ±‚;</li> <li><mark><strong>backup</strong></mark>: ä¸€æ—¦å…¶ä»–æœåŠ¡å™¨å®•æœº, é‚£ä¹ˆæœ‰è¯¥æ ‡è®°çš„æœºå™¨å°†ä¼šæ¥æ”¶è¯·æ±‚.</li></ol> <p>**keepalive æŒ‡ä»¤: **</p> <p>**Nginx æœåŠ¡å™¨å°†ä¼šä¸ºæ¯ä¸€ä¸ª worker è¿›è¡Œä¿æŒåŒä¸Šæ¸¸æœåŠ¡å™¨çš„è¿æ¥. **</p> <h6 id="å±è”½ip"><a href="#å±è”½ip" class="header-anchor">#</a> å±è”½ip</h6> <p>åœ¨ nginx çš„é…ç½®æ–‡ä»¶ <code>nginx.conf</code>â€‹ ä¸­åŠ å…¥å¦‚ä¸‹é…ç½®, å¯ä»¥æ”¾åˆ° http, server, location, limit_exceptè¯­å¥å—, éœ€è¦æ³¨æ„ç›¸å¯¹è·¯å¾„, æœ¬ä¾‹å½“ä¸­ <code>nginx.conf</code>â€‹, <code>blocksip.conf</code>â€‹ åœ¨åŒä¸€ä¸ªç›®å½•ä¸­.</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">include</span> blockip.conf</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>åœ¨ blockip.conf é‡Œé¢è¾“å…¥å†…å®¹, å¦‚:</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">deny</span> 165.91.122.67</span><span class="token punctuation">;</span>

<span class="token directive"><span class="token keyword">deny</span> IP</span><span class="token punctuation">;</span>   <span class="token comment"># å±è”½å•ä¸ªipè®¿é—®</span>
<span class="token directive"><span class="token keyword">allow</span> IP</span><span class="token punctuation">;</span>  <span class="token comment"># å…è®¸å•ä¸ªipè®¿é—®</span>
<span class="token directive"><span class="token keyword">deny</span> all</span><span class="token punctuation">;</span>  <span class="token comment"># å±è”½æ‰€æœ‰ipè®¿é—®</span>
<span class="token directive"><span class="token keyword">allow</span> all</span><span class="token punctuation">;</span> <span class="token comment"># å…è®¸æ‰€æœ‰ipè®¿é—®</span>
<span class="token directive"><span class="token keyword">deny</span> 123.0.0.0/8   <span class="token comment"># å±è”½æ•´ä¸ªæ®µå³ä»123.0.0.1åˆ°123.255.255.254è®¿é—®çš„å‘½ä»¤</span>
deny 124.45.0.0/16 <span class="token comment"># å±è”½IPæ®µå³ä»123.45.0.1åˆ°123.45.255.254è®¿é—®çš„å‘½ä»¤</span>
deny 123.45.6.0/24 <span class="token comment"># å±è”½IPæ®µå³ä»123.45.6.1åˆ°123.45.6.254è®¿é—®çš„å‘½ä»¤</span>

<span class="token comment"># å¦‚æœæƒ³å®ç°è¿™æ ·çš„åº”ç”¨, é™¤äº†å‡ ä¸ªIPå¤–, å…¶ä»–å…¨éƒ¨æ‹’ç»</span>
allow 1.1.1.1</span><span class="token punctuation">;</span> 
<span class="token directive"><span class="token keyword">allow</span> 1.1.1.2</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">deny</span> all</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="header-anchor">#</a> é‡å®šå‘</h4> <ul><li>â€‹<code>permanent</code>â€‹ æ°¸ä¹…æ€§é‡å®šå‘. è¯·æ±‚æ—¥å¿—ä¸­çš„çŠ¶æ€ç ä¸º 301.</li> <li>â€‹<code>redirect</code>â€‹ ä¸´æ—¶é‡å®šå‘. è¯·æ±‚æ—¥å¿—ä¸­çš„çŠ¶æ€ç ä¸º 302.</li></ul> <blockquote><p>é‡å®šå‘æ•´ä¸ªç½‘ç«™</p></blockquote> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">server_name</span> old-site.com
    return <span class="token number">301</span> <span class="token variable">$scheme</span>://new-site.com<span class="token variable">$request_uri</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>é‡å®šå‘å•é¡µ</p></blockquote> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">location</span> = /oldpage.html</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">return</span> <span class="token number">301</span> http://example.org/newpage.html</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>é‡å®šå‘æ•´ä¸ªå­è·¯å¾„</p></blockquote> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> /old-site</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">rewrite</span> ^/old-site/(.*) http://example.org/new-site/<span class="token variable">$1</span> permanent</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="header-anchor">#</a> æ€§èƒ½</h4> <h5 id="å†…å®¹ç¼“å­˜"><a href="#å†…å®¹ç¼“å­˜" class="header-anchor">#</a> å†…å®¹ç¼“å­˜</h5> <p>å…è®¸æµè§ˆå™¨åŸºæœ¬ä¸Šæ°¸ä¹…åœ°ç¼“å­˜é™æ€å†…å®¹.  Nginx å°†ä¸ºæ‚¨<strong>è®¾ç½® Expires å’Œ Cache-Control å¤´</strong>ä¿¡æ¯.</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> /static</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">root</span> /data</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">expires</span> max</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å¦‚æœ<strong>è¦æ±‚æµè§ˆå™¨æ°¸è¿œä¸ä¼šç¼“å­˜å“åº”(ä¾‹å¦‚ç”¨äºè·Ÿè¸ªè¯·æ±‚), è¯·ä½¿ç”¨ -1</strong>.</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> = /empty.gif</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">empty_gif</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">expires</span> -1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="gzipå‹ç¼©"><a href="#gzipå‹ç¼©" class="header-anchor">#</a> Gzipå‹ç¼©</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">gzip</span>  <span class="token boolean">on</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">gzip_buffers</span> <span class="token number">16</span> <span class="token number">8k</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">gzip_comp_level</span> <span class="token number">6</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">gzip_http_version</span> 1.1</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">gzip_min_length</span> <span class="token number">256</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">gzip_proxied</span> any</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">gzip_vary</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">gzip_types</span>
    text/xml application/xml application/atom+xml application/rss+xml application/xhtml+xml image/svg+xml
    text/javascript application/javascript application/x-javascript
    text/x-json application/json application/x-web-app-manifest+json
    text/css text/plain text/x-component
    font/opentype application/x-font-ttf application/vnd.ms-fontobject
    image/x-icon</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">gzip_disable</span>  <span class="token string">&quot;msie6&quot;</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="æ‰“å¼€æ–‡ä»¶ç¼“å­˜"><a href="#æ‰“å¼€æ–‡ä»¶ç¼“å­˜" class="header-anchor">#</a> æ‰“å¼€æ–‡ä»¶ç¼“å­˜</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">open_file_cache</span> max=1000 inactive=20s</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">open_file_cache_valid</span> <span class="token number">30s</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">open_file_cache_min_uses</span> <span class="token number">2</span></span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">open_file_cache_errors</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="sslç¼“å­˜"><a href="#sslç¼“å­˜" class="header-anchor">#</a> SSLç¼“å­˜</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">ssl_session_cache</span> shared:SSL:10m</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">ssl_session_timeout</span> <span class="token number">10m</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="ä¸Šæ¸¸keepalive"><a href="#ä¸Šæ¸¸keepalive" class="header-anchor">#</a> ä¸Šæ¸¸Keepalive</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> backend</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">server</span> 127.0.0.1:8080</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">keepalive</span> <span class="token number">32</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    ...
    <span class="token directive"><span class="token keyword">location</span> /api/</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://backend</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_http_version</span> 1.1</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span> Connection <span class="token string">&quot;&quot;</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h5 id="ç›‘æ§"><a href="#ç›‘æ§" class="header-anchor">#</a> ç›‘æ§</h5> <p>ä½¿ç”¨ <code>ngxtop</code>â€‹ å®æ—¶è§£æ nginx è®¿é—®æ—¥å¿—, å¹¶ä¸”å°†å¤„ç†ç»“æœè¾“å‡ºåˆ°ç»ˆç«¯, åŠŸèƒ½ç±»ä¼¼äºç³»ç»Ÿå‘½ ä»¤top. æ‰€æœ‰ç¤ºä¾‹éƒ½è¯»å– nginx é…ç½®æ–‡ä»¶çš„è®¿é—®æ—¥å¿—ä½ç½®å’Œæ ¼å¼. å¦‚æœè¦æŒ‡å®šè®¿é—®æ—¥å¿—æ–‡ä»¶å’Œ/æˆ–æ—¥å¿—æ ¼å¼, è¯·ä½¿ç”¨ -f å’Œ -a é€‰é¡¹.</p> <p>æ³¨æ„: åœ¨ nginx é…ç½®ä¸­ <code>/usr/local/nginx/conf/nginx.conf</code>â€‹ æ—¥å¿—æ–‡ä»¶å¿…é¡»æ˜¯<strong>ç»å¯¹è·¯å¾„</strong>.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># å®‰è£… ngxtop</span>
pip <span class="token function">install</span> ngxtop
<span class="token comment"># å®æ—¶çŠ¶æ€</span>
ngxtop
<span class="token comment"># çŠ¶æ€ä¸º404çš„å‰10ä¸ªè¯·æ±‚çš„è·¯å¾„: </span>
ngxtop <span class="token function">top</span> request_path <span class="token parameter variable">--filter</span> <span class="token string">'status == 404'</span>

<span class="token comment"># å‘é€æ€»å­—èŠ‚æ•°æœ€å¤šçš„å‰10ä¸ªè¯·æ±‚</span>
ngxtop --order-by <span class="token string">'avg(bytes_sent) * count'</span>

<span class="token comment"># æ’åå‰åä½çš„IP, ä¾‹å¦‚, è°æ”»å‡»ä½ æœ€å¤š</span>
ngxtop --group-by remote_addr

<span class="token comment"># æ‰“å°å…·æœ‰4xxæˆ–5xxçŠ¶æ€çš„è¯·æ±‚, ä»¥åŠstatuså’Œhttp referer</span>
ngxtop <span class="token parameter variable">-i</span> <span class="token string">'status &gt;= 400'</span> print request status http_referer

<span class="token comment"># ç”±200ä¸ªè¯·æ±‚è·¯å¾„å“åº”å‘é€çš„å¹³å‡æ­£æ–‡å­—èŠ‚ä»¥'foo'å¼€å§‹: </span>
ngxtop avg bytes_sent <span class="token parameter variable">--filter</span> <span class="token string">'status == 200 and request_path.startswith(&quot;foo&quot;)'</span>

<span class="token comment"># ä½¿ç”¨â€œcommonâ€æ—¥å¿—æ ¼å¼ä»è¿œç¨‹æœºå™¨åˆ†æapacheè®¿é—®æ—¥å¿—</span>
<span class="token function">ssh</span> remote <span class="token function">tail</span> <span class="token parameter variable">-f</span> /var/log/apache2/access.log <span class="token operator">|</span> ngxtop <span class="token parameter variable">-f</span> common
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="å¸¸è§ä½¿ç”¨åœºæ™¯"><a href="#å¸¸è§ä½¿ç”¨åœºæ™¯" class="header-anchor">#</a> å¸¸è§ä½¿ç”¨åœºæ™¯</h4> <h5 id="è·¨åŸŸé—®é¢˜"><a href="#è·¨åŸŸé—®é¢˜" class="header-anchor">#</a> è·¨åŸŸé—®é¢˜</h5> <p>åœ¨å·¥ä½œä¸­, æœ‰æ—¶å€™ä¼šé‡åˆ°ä¸€äº›æ¥å£ä¸æ”¯æŒè·¨åŸŸ, è¿™æ—¶å€™å¯ä»¥<strong>ç®€å•çš„æ·»åŠ  add_headers æ¥æ”¯æŒ cors è·¨åŸŸ</strong>. é…ç½®å¦‚ä¸‹:</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
  <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">server_name</span> api.xxx.com</span><span class="token punctuation">;</span>
    
  <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">'Access-Control-Allow-Origin'</span> <span class="token string">'*'</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">'Access-Control-Allow-Credentials'</span> <span class="token string">'true'</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">'Access-Control-Allow-Methods'</span> <span class="token string">'GET,POST,HEAD'</span></span><span class="token punctuation">;</span>

  <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span> http://127.0.0.1:3000</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Real-IP <span class="token variable">$remote_addr</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> X-Forwarded-For <span class="token variable">$proxy_add_x_forwarded_for</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> Host  <span class="token variable">$http_host</span></span><span class="token punctuation">;</span>    
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>ä¸Šé¢æ›´æ”¹å¤´ä¿¡æ¯, è¿˜æœ‰ä¸€ç§, ä½¿ç”¨ <a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html" target="_blank" rel="noopener noreferrer">rewrite<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æŒ‡ä»¤<strong>é‡å®šå‘ URI æ¥è§£å†³è·¨åŸŸé—®é¢˜</strong>.</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> test</span> <span class="token punctuation">{</span>
  <span class="token directive"><span class="token keyword">server</span> 127.0.0.1:8080</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">server</span> localhost:8081</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
  <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">server_name</span> api.xxx.com</span><span class="token punctuation">;</span>
  <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span> 
    <span class="token directive"><span class="token keyword">root</span>  html</span><span class="token punctuation">;</span>                   <span class="token comment">#å»è¯·æ±‚../htmlæ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶</span>
    <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>  <span class="token comment">#é¦–é¡µå“åº”åœ°å€</span>
  <span class="token punctuation">}</span>
  <span class="token comment"># ç”¨äºæ‹¦æˆªè¯·æ±‚, åŒ¹é…ä»»ä½•ä»¥ /api/å¼€å¤´çš„åœ°å€, </span>
  <span class="token comment"># åŒ¹é…ç¬¦åˆä»¥å, åœæ­¢å¾€ä¸‹æœç´¢æ­£åˆ™. </span>
  <span class="token directive"><span class="token keyword">location</span> ^~/api/</span><span class="token punctuation">{</span> 
    <span class="token comment"># ä»£è¡¨é‡å†™æ‹¦æˆªè¿›æ¥çš„è¯·æ±‚, å¹¶ä¸”åªèƒ½å¯¹åŸŸååè¾¹çš„é™¤å»ä¼ é€’çš„å‚æ•°å¤–çš„å­—ç¬¦ä¸²èµ·ä½œç”¨, </span>
    <span class="token comment"># ä¾‹å¦‚www.a.com/proxy/api/msg?meth=1&amp;par=2é‡å†™, åªå¯¹/proxy/api/msgé‡å†™. </span>
    <span class="token comment"># rewriteåé¢çš„å‚æ•°æ˜¯ä¸€ä¸ªç®€å•çš„æ­£åˆ™ ^/api/(.*)$, </span>
    <span class="token comment"># $1ä»£è¡¨æ­£åˆ™ä¸­çš„ç¬¬ä¸€ä¸ª(), $2ä»£è¡¨ç¬¬äºŒä¸ª()çš„å€¼, ä»¥æ­¤ç±»æ¨. </span>
    <span class="token directive"><span class="token keyword">rewrite</span> ^/api/(.*)$ /<span class="token variable">$1</span> break</span><span class="token punctuation">;</span>
    
    <span class="token comment"># æŠŠè¯·æ±‚ä»£ç†åˆ°å…¶ä»–ä¸»æœº </span>
    <span class="token comment"># å…¶ä¸­ http://www.b.com/ å†™æ³•å’Œ http://www.b.comå†™æ³•çš„åŒºåˆ«å¦‚ä¸‹</span>
    <span class="token comment"># å¦‚æœä½ çš„è¯·æ±‚åœ°å€æ˜¯ä»– http://server/html/test.jsp</span>
    <span class="token comment"># é…ç½®ä¸€:  http://www.b.com/ åé¢æœ‰â€œ/â€ </span>
    <span class="token comment">#         å°†åå‘ä»£ç†æˆ http://www.b.com/html/test.jsp è®¿é—®</span>
    <span class="token comment"># é…ç½®ä¸€:  http://www.b.com åé¢æ²¡æœ‰æœ‰â€œ/â€ </span>
    <span class="token comment">#         å°†åå‘ä»£ç†æˆ http://www.b.com/test.jsp è®¿é—®</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span> http://test</span><span class="token punctuation">;</span>

    <span class="token comment"># å¦‚æœ proxy_pass  URL æ˜¯ http://a.xx.com/platform/ è¿™ç§æƒ…å†µ</span>
    <span class="token comment"># proxy_cookie_pathåº”è¯¥è®¾ç½®æˆ /platform/ / (æ³¨æ„ä¸¤ä¸ªæ–œæ ä¹‹é—´æœ‰ç©ºæ ¼). </span>
    <span class="token directive"><span class="token keyword">proxy_cookie_path</span> /platfrom/ /</span><span class="token punctuation">;</span>

    <span class="token comment"># http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass_header</span>
    <span class="token comment"># è®¾ç½® Cookie å¤´é€šè¿‡</span>
    <span class="token directive"><span class="token keyword">proxy_pass_header</span> Set-Cookie</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h5 id="è·³è½¬åˆ°å¸¦wwwçš„åŸŸä¸Šé¢"><a href="#è·³è½¬åˆ°å¸¦wwwçš„åŸŸä¸Šé¢" class="header-anchor">#</a> è·³è½¬åˆ°å¸¦wwwçš„åŸŸä¸Šé¢</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token comment"># é…ç½®æ­£å¸¸çš„å¸¦wwwçš„åŸŸå</span>
    <span class="token directive"><span class="token keyword">server_name</span> www.wangchujiang.com</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">root</span> /home/www/wabg/download</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html =404</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token comment"># è¿™ä¸ªè¦æ”¾åˆ°ä¸‹é¢, </span>
    <span class="token comment"># å°†ä¸å¸¦wwwçš„ wangchujiang.com æ°¸ä¹…æ€§é‡å®šå‘åˆ°  https://www.wangchujiang.com</span>
    <span class="token directive"><span class="token keyword">server_name</span> wangchujiang.com</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">rewrite</span> ^(.*) https://www.wangchujiang.com<span class="token variable">$1</span> permanent</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="ä»£ç†è½¬å‘"><a href="#ä»£ç†è½¬å‘" class="header-anchor">#</a> ä»£ç†è½¬å‘</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> server-api</span><span class="token punctuation">{</span>
    <span class="token comment"># api ä»£ç†æœåŠ¡åœ°å€</span>
    <span class="token directive"><span class="token keyword">server</span> 127.0.0.1:3110</span><span class="token punctuation">;</span>    
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">upstream</span> server-resource</span><span class="token punctuation">{</span>
    <span class="token comment"># é™æ€èµ„æº ä»£ç†æœåŠ¡åœ°å€</span>
    <span class="token directive"><span class="token keyword">server</span> 127.0.0.1:3120</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">3111</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>      <span class="token comment"># è¿™é‡ŒæŒ‡å®šåŸŸå</span>
    <span class="token directive"><span class="token keyword">root</span> /home/www/server-statics</span><span class="token punctuation">;</span>
    <span class="token comment"># åŒ¹é… api è·¯ç”±çš„åå‘ä»£ç†åˆ°APIæœåŠ¡</span>
    <span class="token directive"><span class="token keyword">location</span> ^~/api/</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">rewrite</span> ^/(.*)$ /<span class="token variable">$1</span> break</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://server-api</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># å‡è®¾è¿™é‡ŒéªŒè¯ç ä¹Ÿåœ¨APIæœåŠ¡ä¸­</span>
    <span class="token directive"><span class="token keyword">location</span> ^~/captcha</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">rewrite</span> ^/(.*)$ /<span class="token variable">$1</span> break</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://server-api</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># å‡è®¾ä½ çš„å›¾ç‰‡èµ„æºå…¨éƒ¨åœ¨å¦å¤–ä¸€ä¸ªæœåŠ¡ä¸Šé¢</span>
    <span class="token directive"><span class="token keyword">location</span> ^~/img/</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">rewrite</span> ^/(.*)$ /<span class="token variable">$1</span> break</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://server-resource</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># è·¯ç”±åœ¨å‰ç«¯, åç«¯æ²¡æœ‰çœŸå®è·¯ç”±, åœ¨è·¯ç”±ä¸å­˜åœ¨çš„ 404çŠ¶æ€çš„é¡µé¢è¿”å› /index.html</span>
    <span class="token comment"># è¿™ä¸ªæ–¹å¼ä½¿ç”¨åœºæ™¯, ä½ åœ¨å†™Reactæˆ–è€…Vueé¡¹ç›®çš„æ—¶å€™, æ²¡æœ‰çœŸå®è·¯ç”±</span>
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html =404</span><span class="token punctuation">;</span>
        <span class="token comment">#                               ^ ç©ºæ ¼å¾ˆé‡è¦</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h5 id="ç›‘æ§çŠ¶æ€ä¿¡æ¯"><a href="#ç›‘æ§çŠ¶æ€ä¿¡æ¯" class="header-anchor">#</a> ç›‘æ§çŠ¶æ€ä¿¡æ¯</h5> <p>é€šè¿‡ <code>nginx -V</code> æ¥æŸ¥çœ‹æ˜¯å¦æœ‰ <code>with-http_stub_status_module</code> è¯¥æ¨¡å—.</p> <blockquote><p><code>nginx -V</code> è¿™é‡Œ <code>V</code> æ˜¯å¤§å†™çš„, å¦‚æœæ˜¯å°å†™çš„ <code>v</code> å³ <code>nginx -v</code>, åˆ™ä¸ä¼šå‡ºç°æœ‰å“ªäº›æ¨¡å—, åªä¼šå‡ºç° <code>nginx</code> çš„ç‰ˆæœ¬</p></blockquote> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> /nginx_status</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">stub_status</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">access_log</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>é€šè¿‡ <code>http://127.0.0.1/nginx_status</code>â€‹ è®¿é—®å‡ºç°ä¸‹é¢ç»“æœ.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Active connections: <span class="token number">3</span>
server accepts handled requests
 <span class="token number">7</span> <span class="token number">7</span> <span class="token number">5</span> 
Reading: <span class="token number">0</span> Writing: <span class="token number">1</span> Waiting: <span class="token number">2</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>ä¸»åŠ¨è¿æ¥(ç¬¬ 1 è¡Œ)</p></blockquote> <p>å½“å‰ä¸ http å»ºç«‹çš„è¿æ¥æ•°, åŒ…æ‹¬ç­‰å¾…çš„å®¢æˆ·ç«¯è¿æ¥: 3</p> <blockquote><p>æœåŠ¡å™¨æ¥å—å¤„ç†çš„è¯·æ±‚(ç¬¬ 2~3 è¡Œ)</p></blockquote> <p>æ¥å—çš„å®¢æˆ·ç«¯è¿æ¥æ€»æ•°ç›®: 7</p> <p>å¤„ç†çš„å®¢æˆ·ç«¯è¿æ¥æ€»æ•°ç›®: 7</p> <p>å®¢æˆ·ç«¯æ€»çš„è¯·æ±‚æ•°ç›®: 5</p> <blockquote><p>è¯»å–å…¶å®ƒä¿¡(ç¬¬ 4 è¡Œ)</p></blockquote> <p>å½“å‰, nginx è¯»è¯·æ±‚è¿æ¥</p> <p>å½“å‰, nginx å†™å“åº”è¿”å›ç»™å®¢æˆ·ç«¯</p> <p>ç›®å‰æœ‰å¤šå°‘ç©ºé—²å®¢æˆ·ç«¯è¯·æ±‚è¿æ¥</p> <h5 id="ä»£ç†è½¬å‘è¿æ¥æ›¿æ¢"><a href="#ä»£ç†è½¬å‘è¿æ¥æ›¿æ¢" class="header-anchor">#</a> ä»£ç†è½¬å‘è¿æ¥æ›¿æ¢</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> ^~/api/upload</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">rewrite</span> ^/(.*)$ /wfs/v1/upload break</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span> http://wfs-api</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="sslé…ç½®"><a href="#sslé…ç½®" class="header-anchor">#</a> sslé…ç½®</h5> <p>è¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®(ç¼©å†™: HTTPS)æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®å’Œ SSL/TLS çš„ç»„åˆ, ç”¨ä»¥æä¾›åŠ å¯†é€šè®¯åŠå¯¹ç½‘ç»œæœåŠ¡å™¨èº«ä»½çš„é‰´å®š. HTTPS è¿æ¥ç»å¸¸è¢«ç”¨äºä¸‡ç»´ç½‘ä¸Šçš„äº¤æ˜“æ”¯ä»˜å’Œä¼ä¸šä¿¡æ¯ç³»ç»Ÿä¸­æ•æ„Ÿä¿¡æ¯çš„ä¼ è¾“. HTTPS ç›®å‰å·²ç»æ˜¯æ‰€æœ‰æ³¨é‡éšç§å’Œå®‰å…¨çš„ç½‘ç«™çš„é¦–é€‰, éšç€æŠ€æœ¯çš„ä¸æ–­å‘å±•, HTTPS ç½‘ç«™å·²ä¸å†æ˜¯å¤§å‹ç½‘ç«™çš„ä¸“åˆ©, æ‰€æœ‰æ™®é€šçš„ä¸ªäººç«™é•¿å’Œåšå®¢å‡å¯ä»¥è‡ªå·±åŠ¨æ‰‹æ­å»ºä¸€ä¸ªå®‰å…¨çš„åŠ å¯†çš„ç½‘ç«™.</p> <p><strong>åˆ›å»º SSL è¯ä¹¦</strong>, å¦‚æœä½ è´­ä¹°çš„è¯ä¹¦, å°±å¯ä»¥ç›´æ¥ä¸‹è½½.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">mkdir</span> /etc/nginx/ssl
<span class="token comment"># åˆ›å»ºäº†æœ‰æ•ˆæœŸ100å¹´, åŠ å¯†å¼ºåº¦ä¸ºRSA2048çš„SSLå¯†é’¥keyå’ŒX509è¯ä¹¦æ–‡ä»¶. </span>
<span class="token function">sudo</span> openssl req <span class="token parameter variable">-x509</span> <span class="token parameter variable">-nodes</span> <span class="token parameter variable">-days</span> <span class="token number">36500</span> <span class="token parameter variable">-newkey</span> rsa:2048 <span class="token parameter variable">-keyout</span> /etc/nginx/ssl/nginx.key <span class="token parameter variable">-out</span> /etc/nginx/ssl/nginx.crt
<span class="token comment"># ä¸Šé¢å‘½ä»¤, ä¼šæœ‰ä¸‹é¢éœ€è¦å¡«å†™å†…å®¹</span>
Country Name <span class="token punctuation">(</span><span class="token number">2</span> letter code<span class="token punctuation">)</span> <span class="token punctuation">[</span>AU<span class="token punctuation">]</span>:US
State or Province Name <span class="token punctuation">(</span>full name<span class="token punctuation">)</span> <span class="token punctuation">[</span>Some-State<span class="token punctuation">]</span>:New York
Locality Name <span class="token punctuation">(</span>eg, city<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>:New York City
Organization Name <span class="token punctuation">(</span>eg, company<span class="token punctuation">)</span> <span class="token punctuation">[</span>Internet Widgits Pty Ltd<span class="token punctuation">]</span>:Bouncy Castles, Inc.
Organizational Unit Name <span class="token punctuation">(</span>eg, section<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>:Ministry of Water Slides
Common Name <span class="token punctuation">(</span>e.g. server FQDN or YOUR name<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>:your_domain.com
Email Address <span class="token punctuation">[</span><span class="token punctuation">]</span>:admin@your_domain.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>åˆ›å»ºè‡ªç­¾è¯ä¹¦:</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>é¦–å…ˆ, åˆ›å»ºè¯ä¹¦å’Œç§é’¥çš„ç›®å½•
<span class="token comment"># mkdir -p /etc/nginx/cert</span>
<span class="token comment"># cd /etc/nginx/cert</span>
åˆ›å»ºæœåŠ¡å™¨ç§é’¥, å‘½ä»¤ä¼šè®©ä½ è¾“å…¥ä¸€ä¸ªå£ä»¤: 
<span class="token comment"># openssl genrsa -des3 -out nginx.key 2048</span>
åˆ›å»ºç­¾åè¯·æ±‚çš„è¯ä¹¦<span class="token punctuation">(</span>CSR<span class="token punctuation">)</span>: 
<span class="token comment"># openssl req -new -key nginx.key -out nginx.csr</span>
åœ¨åŠ è½½SSLæ”¯æŒçš„Nginxå¹¶ä½¿ç”¨ä¸Šè¿°ç§é’¥æ—¶é™¤å»å¿…é¡»çš„å£ä»¤: 
<span class="token comment"># cp nginx.key nginx.key.org</span>
<span class="token comment"># openssl rsa -in nginx.key.org -out nginx.key</span>
æœ€åæ ‡è®°è¯ä¹¦ä½¿ç”¨ä¸Šè¿°ç§é’¥å’ŒCSR: 
<span class="token comment"># openssl x509 -req -days 365 -in nginx.csr -signkey nginx.key -out nginx.crt</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>æŸ¥çœ‹ç›®å‰ nginx ç¼–è¯‘é€‰é¡¹</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>sbin/nginx -V
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¾“å‡ºä¸‹é¢å†…å®¹:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>nginx version: nginx/1.7.8
built by gcc 4.4.7 20120313 (Red Hat 4.4.7-4) (GCC)
TLS SNI support enabled
configure arguments: --prefix=/usr/local/nginx-1.7.8 --with-http_ssl_module --with-http_spdy_module --with-http_stub_status_module --with-pcre
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å¦‚æœä¾èµ–çš„æ¨¡å—ä¸å­˜åœ¨, å¯ä»¥è¿›å…¥å®‰è£…ç›®å½•, è¾“å…¥ä¸‹é¢å‘½ä»¤é‡æ–°ç¼–è¯‘å®‰è£….</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>./configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¿è¡Œå®Œæˆä¹‹åè¿˜éœ€è¦ <code>make</code>â€‹ (ä¸ç”¨ make install)</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># å¤‡ä»½nginxçš„äºŒè¿›åˆ¶æ–‡ä»¶</span>
<span class="token function">cp</span> <span class="token parameter variable">-rf</span> /usr/local/nginx/sbin/nginxã€€ /usr/local/nginx/sbin/nginx.bak
<span class="token comment"># è¦†ç›–nginxçš„äºŒè¿›åˆ¶æ–‡ä»¶</span>
<span class="token function">cp</span> <span class="token parameter variable">-rf</span> objs/nginx   /usr/local/nginx/sbin/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>HTTPS server:</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">443</span> ssl</span><span class="token punctuation">;</span>    <span class="token comment"># ç›‘å¬443ç«¯å£</span>
    <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">ssl_certificate</span> /etc/nginx/ssl/nginx.crt</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">ssl_certificate_key</span> /etc/nginx/ssl/nginx.key</span><span class="token punctuation">;</span>
    <span class="token comment"># ç¦æ­¢åœ¨headerä¸­å‡ºç°æœåŠ¡å™¨ç‰ˆæœ¬, é˜²æ­¢é»‘å®¢åˆ©ç”¨ç‰ˆæœ¬æ¼æ´æ”»å‡»</span>
    <span class="token directive"><span class="token keyword">server_tokens</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>
    <span class="token comment"># è®¾ç½®ssl/tlsä¼šè¯ç¼“å­˜çš„ç±»å‹å’Œå¤§å°. å¦‚æœè®¾ç½®äº†è¿™ä¸ªå‚æ•°ä¸€èˆ¬æ˜¯shared, buildinå¯èƒ½ä¼šå‚æ•°å†…å­˜ç¢ç‰‡, é»˜è®¤æ˜¯none, å’Œoffå·®ä¸å¤š, åœç”¨ç¼“å­˜. å¦‚shared:SSL:10mè¡¨ç¤ºæˆ‘æ‰€æœ‰çš„nginxå·¥ä½œè¿›ç¨‹å…±äº«sslä¼šè¯ç¼“å­˜, å®˜ç½‘ä»‹ç»è¯´1Må¯ä»¥å­˜æ”¾çº¦4000ä¸ªsessions.  </span>
    <span class="token directive"><span class="token keyword">ssl_session_cache</span>    shared:SSL:1m</span><span class="token punctuation">;</span> 

    <span class="token comment"># å®¢æˆ·ç«¯å¯ä»¥é‡ç”¨ä¼šè¯ç¼“å­˜ä¸­sslå‚æ•°çš„è¿‡æœŸæ—¶é—´, å†…ç½‘ç³»ç»Ÿé»˜è®¤5åˆ†é’Ÿå¤ªçŸ­äº†, å¯ä»¥è®¾æˆ30må³30åˆ†é’Ÿç”šè‡³4h. </span>
    <span class="token directive"><span class="token keyword">ssl_session_timeout</span>  <span class="token number">5m</span></span><span class="token punctuation">;</span> 

    <span class="token comment"># é€‰æ‹©åŠ å¯†å¥—ä»¶, ä¸åŒçš„æµè§ˆå™¨æ‰€æ”¯æŒçš„å¥—ä»¶(å’Œé¡ºåº)å¯èƒ½ä¼šä¸åŒ. </span>
    <span class="token comment"># è¿™é‡ŒæŒ‡å®šçš„æ˜¯OpenSSLåº“èƒ½å¤Ÿè¯†åˆ«çš„å†™æ³•, ä½ å¯ä»¥é€šè¿‡ openssl -v cipher 'RC4:HIGH:!aNULL:!MD5'(åé¢æ˜¯ä½ æ‰€æŒ‡å®šçš„å¥—ä»¶åŠ å¯†ç®—æ³•) æ¥çœ‹æ‰€æ”¯æŒç®—æ³•. </span>
    <span class="token directive"><span class="token keyword">ssl_ciphers</span>  HIGH:!aNULL:!MD5</span><span class="token punctuation">;</span>

    <span class="token comment"># è®¾ç½®åå•†åŠ å¯†ç®—æ³•æ—¶, ä¼˜å…ˆä½¿ç”¨æˆ‘ä»¬æœåŠ¡ç«¯çš„åŠ å¯†å¥—ä»¶, è€Œä¸æ˜¯å®¢æˆ·ç«¯æµè§ˆå™¨çš„åŠ å¯†å¥—ä»¶. </span>
    <span class="token directive"><span class="token keyword">ssl_prefer_server_ciphers</span>  <span class="token boolean">on</span></span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h5 id="å¼ºåˆ¶å°†httpé‡å®šå‘åˆ°https"><a href="#å¼ºåˆ¶å°†httpé‡å®šå‘åˆ°https" class="header-anchor">#</a> å¼ºåˆ¶å°†httpé‡å®šå‘åˆ°https</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  example.com</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">rewrite</span> ^ https://<span class="token variable">$http_host</span><span class="token variable">$request_uri?</span> permanent</span><span class="token punctuation">;</span>    <span class="token comment"># å¼ºåˆ¶å°†httpé‡å®šå‘åˆ°https</span>
    <span class="token comment"># åœ¨é”™è¯¯é¡µé¢å’Œâ€œæœåŠ¡å™¨â€å“åº”å¤´å­—æ®µä¸­å¯ç”¨æˆ–ç¦ç”¨å‘å°„nginxç‰ˆæœ¬.  é˜²æ­¢é»‘å®¢åˆ©ç”¨ç‰ˆæœ¬æ¼æ´æ”»å‡»</span>
    <span class="token directive"><span class="token keyword">server_tokens</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="ä¸¤ä¸ªè™šæ‹Ÿä¸»æœº"><a href="#ä¸¤ä¸ªè™šæ‹Ÿä¸»æœº" class="header-anchor">#</a> ä¸¤ä¸ªè™šæ‹Ÿä¸»æœº</h5> <p>çº¯é™æ€ -html æ”¯æŒ</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span>          <span class="token number">80</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">server_name</span>     www.domain1.com</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">access_log</span>      logs/domain1.access.log main</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">index</span> index.html</span><span class="token punctuation">;</span>
            <span class="token directive"><span class="token keyword">root</span>  /var/www/domain1.com/htdocs</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span>          <span class="token number">80</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">server_name</span>     www.domain2.com</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">access_log</span>      logs/domain2.access.log main</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">index</span> index.html</span><span class="token punctuation">;</span>
            <span class="token directive"><span class="token keyword">root</span>  /var/www/domain2.com/htdocs</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h5 id="è™šæ‹Ÿä¸»æœºæ ‡å‡†é…ç½®"><a href="#è™šæ‹Ÿä¸»æœºæ ‡å‡†é…ç½®" class="header-anchor">#</a> è™šæ‹Ÿä¸»æœºæ ‡å‡†é…ç½®</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
  <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>          <span class="token number">80</span> default</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>     _ *</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">access_log</span>      logs/default.access.log main</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
       <span class="token directive"><span class="token keyword">index</span> index.html</span><span class="token punctuation">;</span>
       <span class="token directive"><span class="token keyword">root</span>  /var/www/default/htdocs</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h5 id="çˆ¬è™«è¿‡æ»¤"><a href="#çˆ¬è™«è¿‡æ»¤" class="header-anchor">#</a> çˆ¬è™«è¿‡æ»¤</h5> <p>æ ¹æ® <code>User-Agent</code>â€‹ è¿‡æ»¤è¯·æ±‚, é€šè¿‡ä¸€ä¸ªç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼, å°±å¯ä»¥<strong>è¿‡æ»¤ä¸ç¬¦åˆè¦æ±‚çš„çˆ¬è™«è¯·æ±‚</strong>(åˆçº§çˆ¬è™«).</p> <blockquote><p><code>~*</code> è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…</p></blockquote> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$http_user_agent</span> ~* <span class="token string">&quot;python|curl|java|wget|httpclient|okhttp&quot;</span>)</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">return</span> <span class="token number">503</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment"># æ­£å¸¸å¤„ç†</span>
    <span class="token comment"># ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="é˜²ç›—é“¾"><a href="#é˜²ç›—é“¾" class="header-anchor">#</a> é˜²ç›—é“¾</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> ~* \.(gif|jpg|png|swf|flv)$</span> <span class="token punctuation">{</span>
   <span class="token directive"><span class="token keyword">root</span> html
   valid_referers none blocked *.nginxcn.com</span><span class="token punctuation">;</span>
   <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$invalid_referer</span>)</span> <span class="token punctuation">{</span>
     rewrite ^/ www.nginx.cn
     <span class="token comment">#return 404;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="è™šæ‹Ÿç›®å½•é…ç½®"><a href="#è™šæ‹Ÿç›®å½•é…ç½®" class="header-anchor">#</a> è™šæ‹Ÿç›®å½•é…ç½®</h5> <p>alias æŒ‡å®šçš„ç›®å½•æ˜¯å‡†ç¡®çš„, root æ˜¯æŒ‡å®šç›®å½•çš„ä¸Šçº§ç›®å½•, å¹¶ä¸”è¯¥ä¸Šçº§ç›®å½•è¦å«æœ‰ location æŒ‡å®šåç§°çš„åŒåç›®å½•.</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> /img/</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">alias</span> /var/www/image/</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment"># è®¿é—®/img/ç›®å½•é‡Œé¢çš„æ–‡ä»¶æ—¶, ningxä¼šè‡ªåŠ¨å»/var/www/image/ç›®å½•æ‰¾æ–‡ä»¶</span>
<span class="token directive"><span class="token keyword">location</span> /img/</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">root</span> /var/www/image</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment"># è®¿é—®/img/ç›®å½•ä¸‹çš„æ–‡ä»¶æ—¶, nginxä¼šå»/var/www/image/img/ç›®å½•ä¸‹æ‰¾æ–‡ä»¶. ]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="é˜²ç›—å›¾é…ç½®"><a href="#é˜²ç›—å›¾é…ç½®" class="header-anchor">#</a> é˜²ç›—å›¾é…ç½®</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> ~ \/public\/(css|js|img)\/.*\.(js|css|gif|jpg|jpeg|png|bmp|swf)</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">valid_referers</span> none blocked *.jslite.io</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$invalid_referer</span>)</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">rewrite</span> ^/  http://wangchujiang.com/piratesp.png</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="å±è”½-gitç­‰æ–‡ä»¶"><a href="#å±è”½-gitç­‰æ–‡ä»¶" class="header-anchor">#</a> å±è”½.gitç­‰æ–‡ä»¶</h5> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> ~ (.git|.gitattributes|.gitignore|.svn)</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">deny</span> all</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="åŸŸåè·¯å¾„åŠ ä¸åŠ éœ€è¦éƒ½èƒ½æ­£å¸¸è®¿é—®"><a href="#åŸŸåè·¯å¾„åŠ ä¸åŠ éœ€è¦éƒ½èƒ½æ­£å¸¸è®¿é—®" class="header-anchor">#</a> åŸŸåè·¯å¾„åŠ ä¸åŠ éœ€è¦éƒ½èƒ½æ­£å¸¸è®¿é—®</h5> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>http://wangchujiang.com/api/index.php?a<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token assign-left variable">name</span><span class="token operator">=</span>wcj
                                  ^ æœ‰åç¼€

http://wangchujiang.com/api/index?a<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token assign-left variable">name</span><span class="token operator">=</span>wcj
                                 ^ æ²¡æœ‰åç¼€
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>nginx rewrite è§„åˆ™å¦‚ä¸‹:</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">rewrite</span> ^/(.*)/$ /index.php?/<span class="token variable">$1</span> permanent</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">if</span> (!-d <span class="token variable">$request_filename</span>)</span><span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">set</span> <span class="token variable">$rule_1</span> 1<span class="token variable">$rule_1</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">if</span> (!-f <span class="token variable">$request_filename</span>)</span><span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">set</span> <span class="token variable">$rule_1</span> 2<span class="token variable">$rule_1</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$rule_1</span> = <span class="token string">&quot;21&quot;</span>)</span><span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">rewrite</span> ^/ /index.php last</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="cockpit"><a href="#cockpit" class="header-anchor">#</a> cockpit</h5> <p>https://github.com/cockpit-project/cockpit</p> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span><span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> cockpit.xxxxxxx.com</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">return</span> <span class="token number">301</span> https://<span class="token variable">$server_name</span><span class="token variable">$request_uri</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">443</span> ssl</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> cockpit.xxxxxxx.com</span><span class="token punctuation">;</span>
 
    <span class="token comment">#ssl on;</span>
    <span class="token directive"><span class="token keyword">ssl_certificate</span> /etc/nginx/cert/cockpit.xxxxxxx.com.pem</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">ssl_certificate_key</span> /etc/nginx/cert/cockpit.xxxxxxx.com.key</span><span class="token punctuation">;</span>
 
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">root</span> /</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">index</span> index.html</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_redirect</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://websocket</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_http_version</span> 1.1</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span> Upgrade <span class="token variable">$http_upgrade</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span> Connection <span class="token string">&quot;upgrade&quot;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span> Host <span class="token variable">$http_host</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>è¿™æ—¶è¾“å…¥åŸŸå, èƒ½çœ‹åˆ°ç™»å½•é¡µé¢, ä½†ç™»å½•å, æ˜¾ç¤ºä¸å‡ºå†…å®¹, é¡µé¢å…¨ç™½. è¿™é‡Œè¦å¯¹ <code>cockpit.conf</code> è¿›è¡Œè®¾ç½®ä¿®æ”¹.</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">vim</span> /etc/cockpit/cockpit.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å‚ç…§å¦‚ä¸‹é…ç½®ä¿®æ”¹, æ³¨æ„åŸŸåæ›¿æ¢ä¸º <code>your_domain_host</code>:</p> <div class="language-toml line-numbers-mode"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">WebService</span><span class="token punctuation">]</span>
<span class="token key property">Origins</span> <span class="token punctuation">=</span> https://cockpit<span class="token punctuation">.</span>xxxxxxx<span class="token punctuation">.</span>com https://<span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span>:<span class="token number">9090</span>
<span class="token key property">ProtocolHeader</span> <span class="token punctuation">=</span> X-Forwarded-Proto
<span class="token key property">AllowUnencrypted</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>â€</p> <p>â€</p> <h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="header-anchor">#</a> å‚è€ƒèµ„æ–™</h4> <ul><li><a href="https://my.oschina.net/u/3341316/blog/877206" target="_blank" rel="noopener noreferrer">è´Ÿè½½å‡è¡¡åŸç†çš„è§£æ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://blog.githuber.cn/posts/73" target="_blank" rel="noopener noreferrer">Nginxæ³›åŸŸåè§£æ, å®ç°å¤šä¸ªäºŒçº§åŸŸå <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.nginx.com/blog/inside-nginx-how-we-designed-for-performance-scale/" target="_blank" rel="noopener noreferrer">æ·±å…¥ NGINX: æˆ‘ä»¬å¦‚ä½•è®¾è®¡æ€§èƒ½å’Œæ‰©å±•<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.nginx.com/blog/inside-nginx-how-we-designed-for-performance-scale/" target="_blank" rel="noopener noreferrer">Inside NGINX: How We Designed for Performance &amp; Scale<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://tengine.taobao.org/book/index.html" target="_blank" rel="noopener noreferrer">Nginxå¼€å‘ä»å…¥é—¨åˆ°ç²¾é€š<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://os.51cto.com/art/201703/535326.htm#topx" target="_blank" rel="noopener noreferrer">Nginxçš„ä¼˜åŒ–ä¸é˜²ç›—é“¾<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://segmentfault.com/a/1190000009769143" target="_blank" rel="noopener noreferrer">å®æˆ˜å¼€å‘ä¸€ä¸ªNginxæ‰©å±• (Nginx Module)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://my.oschina.net/xshuai/blog/917097" target="_blank" rel="noopener noreferrer">Nginx+Keepalived(åŒæœºçƒ­å¤‡)æ­å»ºé«˜å¯ç”¨è´Ÿè½½å‡è¡¡ç¯å¢ƒ(HA)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://www.huxd.org/articles/2017/07/24/1500890692329.html" target="_blank" rel="noopener noreferrer">Nginx å¹³æ»‘å‡çº§<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://mp.weixin.qq.com/s?__biz=MzIxNzg5ODE0OA==&amp;mid=2247483708&amp;idx=1&amp;sn=90b0b1dccd9c337922a0588245277666&amp;chksm=97f38cf7a08405e1928e0b46d923d630e529e7db8ac7ca2a91310a075986f8bcb2cee5b4953d#rd" target="_blank" rel="noopener noreferrer">Nginxæœ€æ–°æ¨¡å—â€”ngx_http_mirror_moduleåˆ†æå¯ä»¥åšç‰ˆæœ¬å‘å¸ƒå‰çš„é¢„å…ˆéªŒè¯, è¿›è¡Œæµé‡æ”¾å¤§åçš„å‹æµ‹ç­‰ç­‰<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>â€</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/xugaoyi/vuepress-theme-vdoing/edit/main/docs/30.ç³»ç»Ÿ/3000.ç³»ç»Ÿ/150.ç³»ç»Ÿæ¥å…¥å±‚/100.NginxåŸºç¡€.md" target="_blank" rel="noopener noreferrer">ç¼–è¾‘</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/d03ebf/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">åˆ†å¸ƒå¼æŠ€æœ¯åŸç†ä¸ç®—æ³•è§£æ(æå®¢æ—¶é—´)ğŸŒ¸</div></a> <a href="/pages/d4123d/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">æ·±å…¥æ‹†è§£Tomcatä¸Jetty(æå®¢æ—¶é—´)ğŸŒ¸</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/pages/d03ebf/" class="prev">åˆ†å¸ƒå¼æŠ€æœ¯åŸç†ä¸ç®—æ³•è§£æ(æå®¢æ—¶é—´)ğŸŒ¸</a></span> <span class="next"><a href="/pages/d4123d/">æ·±å…¥æ‹†è§£Tomcatä¸Jetty(æå®¢æ—¶é—´)ğŸŒ¸</a>â†’
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:1174520425@qq.com" title="å‘é‚®ä»¶" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/nanodaemony" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2019-2025
    <span>è¾¾å°”æ–‡çš„çŒ¹ | MIT License</span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3f3e0e10.js" defer></script><script src="/assets/js/2.e9fcb30c.js" defer></script><script src="/assets/js/3.1998f389.js" defer></script><script src="/assets/js/164.a1cc0109.js" defer></script>
  </body>
</html>
