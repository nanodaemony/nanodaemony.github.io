<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>口算-OOM案例分析-开发过程中的死循环导致的内存OOM🌸 | Pangolin Note</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="大道至简">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.56073ad3.css" as="style"><link rel="preload" href="/assets/js/app.3f3e0e10.js" as="script"><link rel="preload" href="/assets/js/2.e9fcb30c.js" as="script"><link rel="preload" href="/assets/js/3.1998f389.js" as="script"><link rel="preload" href="/assets/js/243.d8e81b13.js" as="script"><link rel="prefetch" href="/assets/js/10.0b55747f.js"><link rel="prefetch" href="/assets/js/100.b8912a99.js"><link rel="prefetch" href="/assets/js/101.a6740c8a.js"><link rel="prefetch" href="/assets/js/102.e31e89b2.js"><link rel="prefetch" href="/assets/js/103.2c5dbdae.js"><link rel="prefetch" href="/assets/js/104.0e9c02f6.js"><link rel="prefetch" href="/assets/js/105.8288396c.js"><link rel="prefetch" href="/assets/js/106.62f43c11.js"><link rel="prefetch" href="/assets/js/107.70c90211.js"><link rel="prefetch" href="/assets/js/108.b488ce56.js"><link rel="prefetch" href="/assets/js/109.12942650.js"><link rel="prefetch" href="/assets/js/11.ac3fd1ca.js"><link rel="prefetch" href="/assets/js/110.1e57ecba.js"><link rel="prefetch" href="/assets/js/111.6e33b4ea.js"><link rel="prefetch" href="/assets/js/112.bd52831b.js"><link rel="prefetch" href="/assets/js/113.868c1ac9.js"><link rel="prefetch" href="/assets/js/114.090549d1.js"><link rel="prefetch" href="/assets/js/115.d97f6c2b.js"><link rel="prefetch" href="/assets/js/116.097c4b4e.js"><link rel="prefetch" href="/assets/js/117.4024cfe2.js"><link rel="prefetch" href="/assets/js/118.e3057cba.js"><link rel="prefetch" href="/assets/js/119.4ef1fa3b.js"><link rel="prefetch" href="/assets/js/12.863eaabe.js"><link rel="prefetch" href="/assets/js/120.78f9df50.js"><link rel="prefetch" href="/assets/js/121.8e16df87.js"><link rel="prefetch" href="/assets/js/122.f21c0107.js"><link rel="prefetch" href="/assets/js/123.ea1cb375.js"><link rel="prefetch" href="/assets/js/124.01c04c6e.js"><link rel="prefetch" href="/assets/js/125.d383e301.js"><link rel="prefetch" href="/assets/js/126.3162cb47.js"><link rel="prefetch" href="/assets/js/127.c6bebae6.js"><link rel="prefetch" href="/assets/js/128.d659db60.js"><link rel="prefetch" href="/assets/js/129.2afdcf48.js"><link rel="prefetch" href="/assets/js/13.4f59ce35.js"><link rel="prefetch" href="/assets/js/130.beb9ed9d.js"><link rel="prefetch" href="/assets/js/131.35b05f8a.js"><link rel="prefetch" href="/assets/js/132.d77f4f93.js"><link rel="prefetch" href="/assets/js/133.4ceda6e5.js"><link rel="prefetch" href="/assets/js/134.11390c5f.js"><link rel="prefetch" href="/assets/js/135.32f9e38f.js"><link rel="prefetch" href="/assets/js/136.6d8bb0f2.js"><link rel="prefetch" href="/assets/js/137.9c0ffeef.js"><link rel="prefetch" href="/assets/js/138.88d86e5f.js"><link rel="prefetch" href="/assets/js/139.8c2c3d6c.js"><link rel="prefetch" href="/assets/js/14.11c82d35.js"><link rel="prefetch" href="/assets/js/140.c5c375d3.js"><link rel="prefetch" href="/assets/js/141.d703f30b.js"><link rel="prefetch" href="/assets/js/142.6a005a44.js"><link rel="prefetch" href="/assets/js/143.9b2edf6f.js"><link rel="prefetch" href="/assets/js/144.3fd013c9.js"><link rel="prefetch" href="/assets/js/145.b05079c5.js"><link rel="prefetch" href="/assets/js/146.ed5360a6.js"><link rel="prefetch" href="/assets/js/147.7408d86f.js"><link rel="prefetch" href="/assets/js/148.f390b370.js"><link rel="prefetch" href="/assets/js/149.95017f0a.js"><link rel="prefetch" href="/assets/js/15.bd143bd5.js"><link rel="prefetch" href="/assets/js/150.f0ede764.js"><link rel="prefetch" href="/assets/js/151.b7093623.js"><link rel="prefetch" href="/assets/js/152.a82a6c83.js"><link rel="prefetch" href="/assets/js/153.965e3fb2.js"><link rel="prefetch" href="/assets/js/154.9e49311e.js"><link rel="prefetch" href="/assets/js/155.cef33ba5.js"><link rel="prefetch" href="/assets/js/156.bcc397ae.js"><link rel="prefetch" href="/assets/js/157.90824739.js"><link rel="prefetch" href="/assets/js/158.efd429b9.js"><link rel="prefetch" href="/assets/js/159.122ff5b7.js"><link rel="prefetch" href="/assets/js/16.2449162b.js"><link rel="prefetch" href="/assets/js/160.0b806535.js"><link rel="prefetch" href="/assets/js/161.835052c6.js"><link rel="prefetch" href="/assets/js/162.ca34e2d2.js"><link rel="prefetch" href="/assets/js/163.08000d04.js"><link rel="prefetch" href="/assets/js/164.a1cc0109.js"><link rel="prefetch" href="/assets/js/165.65444686.js"><link rel="prefetch" href="/assets/js/166.7d73c84f.js"><link rel="prefetch" href="/assets/js/167.009d47a3.js"><link rel="prefetch" href="/assets/js/168.0afeae2a.js"><link rel="prefetch" href="/assets/js/169.7654cb31.js"><link rel="prefetch" href="/assets/js/17.eb7f9def.js"><link rel="prefetch" href="/assets/js/170.58569530.js"><link rel="prefetch" href="/assets/js/171.7db9ed40.js"><link rel="prefetch" href="/assets/js/172.3cb50ed4.js"><link rel="prefetch" href="/assets/js/173.0846425f.js"><link rel="prefetch" href="/assets/js/174.9e95f111.js"><link rel="prefetch" href="/assets/js/175.ef2098f2.js"><link rel="prefetch" href="/assets/js/176.c2635fe9.js"><link rel="prefetch" href="/assets/js/177.4fa38e8e.js"><link rel="prefetch" href="/assets/js/178.2be7037f.js"><link rel="prefetch" href="/assets/js/179.bf3bba28.js"><link rel="prefetch" href="/assets/js/18.0455f4d1.js"><link rel="prefetch" href="/assets/js/180.72c5f597.js"><link rel="prefetch" href="/assets/js/181.42287bcc.js"><link rel="prefetch" href="/assets/js/182.6cd4bf1a.js"><link rel="prefetch" href="/assets/js/183.05dbbfd9.js"><link rel="prefetch" href="/assets/js/184.03de7e00.js"><link rel="prefetch" href="/assets/js/185.42dd210e.js"><link rel="prefetch" href="/assets/js/186.28ee0f8a.js"><link rel="prefetch" href="/assets/js/187.bb58697b.js"><link rel="prefetch" href="/assets/js/188.1bc8be96.js"><link rel="prefetch" href="/assets/js/189.fac747e3.js"><link rel="prefetch" href="/assets/js/19.ae9e35d6.js"><link rel="prefetch" href="/assets/js/190.ea533ac7.js"><link rel="prefetch" href="/assets/js/191.6dc6eb13.js"><link rel="prefetch" href="/assets/js/192.184d249f.js"><link rel="prefetch" href="/assets/js/193.4a06bc12.js"><link rel="prefetch" href="/assets/js/194.8cce60a9.js"><link rel="prefetch" href="/assets/js/195.93231a13.js"><link rel="prefetch" href="/assets/js/196.4a596bde.js"><link rel="prefetch" href="/assets/js/197.96c113cf.js"><link rel="prefetch" href="/assets/js/198.73ba3f67.js"><link rel="prefetch" href="/assets/js/199.74bab595.js"><link rel="prefetch" href="/assets/js/20.b542d0e7.js"><link rel="prefetch" href="/assets/js/200.69a6928a.js"><link rel="prefetch" href="/assets/js/201.9ffa7c5a.js"><link rel="prefetch" href="/assets/js/202.41edb652.js"><link rel="prefetch" href="/assets/js/203.7fabcef3.js"><link rel="prefetch" href="/assets/js/204.b0ae2f62.js"><link rel="prefetch" href="/assets/js/205.add8738b.js"><link rel="prefetch" href="/assets/js/206.f3a712ec.js"><link rel="prefetch" href="/assets/js/207.cd7dd729.js"><link rel="prefetch" href="/assets/js/208.78b33afa.js"><link rel="prefetch" href="/assets/js/209.9d3329ff.js"><link rel="prefetch" href="/assets/js/21.5a050318.js"><link rel="prefetch" href="/assets/js/210.d285d5ac.js"><link rel="prefetch" href="/assets/js/211.8791bb3f.js"><link rel="prefetch" href="/assets/js/212.84ed81a8.js"><link rel="prefetch" href="/assets/js/213.7b990580.js"><link rel="prefetch" href="/assets/js/214.da31f20c.js"><link rel="prefetch" href="/assets/js/215.9eeed659.js"><link rel="prefetch" href="/assets/js/216.9539f0ec.js"><link rel="prefetch" href="/assets/js/217.11b575be.js"><link rel="prefetch" href="/assets/js/218.a67f12f1.js"><link rel="prefetch" href="/assets/js/219.bfbb817a.js"><link rel="prefetch" href="/assets/js/22.2bc6f7e3.js"><link rel="prefetch" href="/assets/js/220.8b01342f.js"><link rel="prefetch" href="/assets/js/221.b450decd.js"><link rel="prefetch" href="/assets/js/222.97468507.js"><link rel="prefetch" href="/assets/js/223.b6dafd73.js"><link rel="prefetch" href="/assets/js/224.c86c18c6.js"><link rel="prefetch" href="/assets/js/225.b0dcf86e.js"><link rel="prefetch" href="/assets/js/226.02cc2999.js"><link rel="prefetch" href="/assets/js/227.8474ef5a.js"><link rel="prefetch" href="/assets/js/228.0298e421.js"><link rel="prefetch" href="/assets/js/229.6aeaf595.js"><link rel="prefetch" href="/assets/js/23.9995fce4.js"><link rel="prefetch" href="/assets/js/230.a5785286.js"><link rel="prefetch" href="/assets/js/231.d791daa4.js"><link rel="prefetch" href="/assets/js/232.97aeeb00.js"><link rel="prefetch" href="/assets/js/233.46e51e28.js"><link rel="prefetch" href="/assets/js/234.2cffe82f.js"><link rel="prefetch" href="/assets/js/235.14965da6.js"><link rel="prefetch" href="/assets/js/236.00a5afc0.js"><link rel="prefetch" href="/assets/js/237.3b73d52f.js"><link rel="prefetch" href="/assets/js/238.6e1db765.js"><link rel="prefetch" href="/assets/js/239.75866c5e.js"><link rel="prefetch" href="/assets/js/24.9141eeb2.js"><link rel="prefetch" href="/assets/js/240.af9c2cc9.js"><link rel="prefetch" href="/assets/js/241.388acab2.js"><link rel="prefetch" href="/assets/js/242.c60f2b48.js"><link rel="prefetch" href="/assets/js/244.58b0b21d.js"><link rel="prefetch" href="/assets/js/245.c3768497.js"><link rel="prefetch" href="/assets/js/246.ac8bbe7a.js"><link rel="prefetch" href="/assets/js/247.d095f70a.js"><link rel="prefetch" href="/assets/js/248.e9f210b5.js"><link rel="prefetch" href="/assets/js/249.a9fad023.js"><link rel="prefetch" href="/assets/js/25.98e8593e.js"><link rel="prefetch" href="/assets/js/250.ae7f0ebb.js"><link rel="prefetch" href="/assets/js/251.9a617d55.js"><link rel="prefetch" href="/assets/js/252.ce082446.js"><link rel="prefetch" href="/assets/js/253.4575302d.js"><link rel="prefetch" href="/assets/js/254.5899a61b.js"><link rel="prefetch" href="/assets/js/255.66c69f31.js"><link rel="prefetch" href="/assets/js/256.8fd6c706.js"><link rel="prefetch" href="/assets/js/257.31b77e5e.js"><link rel="prefetch" href="/assets/js/258.eba48891.js"><link rel="prefetch" href="/assets/js/259.edf74b59.js"><link rel="prefetch" href="/assets/js/26.e69924ea.js"><link rel="prefetch" href="/assets/js/260.cf2ed36d.js"><link rel="prefetch" href="/assets/js/261.9e7792d8.js"><link rel="prefetch" href="/assets/js/262.e7b9433e.js"><link rel="prefetch" href="/assets/js/263.1185b25c.js"><link rel="prefetch" href="/assets/js/264.5e0f89cb.js"><link rel="prefetch" href="/assets/js/265.a38d3b94.js"><link rel="prefetch" href="/assets/js/266.2ef170b3.js"><link rel="prefetch" href="/assets/js/267.a7d14651.js"><link rel="prefetch" href="/assets/js/268.05b18748.js"><link rel="prefetch" href="/assets/js/269.dad48d6f.js"><link rel="prefetch" href="/assets/js/27.13612515.js"><link rel="prefetch" href="/assets/js/270.4f5a6b8d.js"><link rel="prefetch" href="/assets/js/271.7ebf6682.js"><link rel="prefetch" href="/assets/js/272.7c2fbfd1.js"><link rel="prefetch" href="/assets/js/273.8ee20732.js"><link rel="prefetch" href="/assets/js/274.d525242a.js"><link rel="prefetch" href="/assets/js/275.a8a19acb.js"><link rel="prefetch" href="/assets/js/276.df3a4eb4.js"><link rel="prefetch" href="/assets/js/277.336debda.js"><link rel="prefetch" href="/assets/js/278.c470625f.js"><link rel="prefetch" href="/assets/js/279.a91e1a64.js"><link rel="prefetch" href="/assets/js/28.ab7ae1df.js"><link rel="prefetch" href="/assets/js/280.87e25c9a.js"><link rel="prefetch" href="/assets/js/281.87c1ba25.js"><link rel="prefetch" href="/assets/js/282.dcd4dce0.js"><link rel="prefetch" href="/assets/js/283.abac2e00.js"><link rel="prefetch" href="/assets/js/284.f6079659.js"><link rel="prefetch" href="/assets/js/285.f1b39879.js"><link rel="prefetch" href="/assets/js/286.f6a79242.js"><link rel="prefetch" href="/assets/js/287.06bebe07.js"><link rel="prefetch" href="/assets/js/288.89e325df.js"><link rel="prefetch" href="/assets/js/289.3aa1bedd.js"><link rel="prefetch" href="/assets/js/29.ebe50f76.js"><link rel="prefetch" href="/assets/js/290.ee059c92.js"><link rel="prefetch" href="/assets/js/291.fa9a921a.js"><link rel="prefetch" href="/assets/js/292.2a8811cd.js"><link rel="prefetch" href="/assets/js/293.eec09cdf.js"><link rel="prefetch" href="/assets/js/294.dfac20dc.js"><link rel="prefetch" href="/assets/js/295.825d2070.js"><link rel="prefetch" href="/assets/js/296.f645861e.js"><link rel="prefetch" href="/assets/js/297.424fdb17.js"><link rel="prefetch" href="/assets/js/298.ebf87cdc.js"><link rel="prefetch" href="/assets/js/299.b8f19cbb.js"><link rel="prefetch" href="/assets/js/30.75237511.js"><link rel="prefetch" href="/assets/js/300.10fb6d4f.js"><link rel="prefetch" href="/assets/js/301.ef77c612.js"><link rel="prefetch" href="/assets/js/302.1b839763.js"><link rel="prefetch" href="/assets/js/303.609f7d98.js"><link rel="prefetch" href="/assets/js/304.1d255f19.js"><link rel="prefetch" href="/assets/js/305.b0234f2c.js"><link rel="prefetch" href="/assets/js/306.48677f64.js"><link rel="prefetch" href="/assets/js/307.14390d4b.js"><link rel="prefetch" href="/assets/js/308.fa730b28.js"><link rel="prefetch" href="/assets/js/309.0496b9e0.js"><link rel="prefetch" href="/assets/js/31.cf3f471a.js"><link rel="prefetch" href="/assets/js/310.a31676dc.js"><link rel="prefetch" href="/assets/js/311.ed53adc5.js"><link rel="prefetch" href="/assets/js/312.1b0ff2f1.js"><link rel="prefetch" href="/assets/js/313.bf123f32.js"><link rel="prefetch" href="/assets/js/314.4e6ce06b.js"><link rel="prefetch" href="/assets/js/315.8eb18560.js"><link rel="prefetch" href="/assets/js/32.74fef842.js"><link rel="prefetch" href="/assets/js/33.bc2d190b.js"><link rel="prefetch" href="/assets/js/34.d23438fc.js"><link rel="prefetch" href="/assets/js/35.7675c4d0.js"><link rel="prefetch" href="/assets/js/36.96a4161b.js"><link rel="prefetch" href="/assets/js/37.d1824f2f.js"><link rel="prefetch" href="/assets/js/38.4effff9e.js"><link rel="prefetch" href="/assets/js/39.6509914b.js"><link rel="prefetch" href="/assets/js/4.4d01750f.js"><link rel="prefetch" href="/assets/js/40.1509d08b.js"><link rel="prefetch" href="/assets/js/41.f2c1124f.js"><link rel="prefetch" href="/assets/js/42.e541d077.js"><link rel="prefetch" href="/assets/js/43.369de999.js"><link rel="prefetch" href="/assets/js/44.43959db0.js"><link rel="prefetch" href="/assets/js/45.282fbd31.js"><link rel="prefetch" href="/assets/js/46.1b83cfe9.js"><link rel="prefetch" href="/assets/js/47.c3a88e41.js"><link rel="prefetch" href="/assets/js/48.bc7c0a1b.js"><link rel="prefetch" href="/assets/js/49.92a4e5ba.js"><link rel="prefetch" href="/assets/js/5.c3991e24.js"><link rel="prefetch" href="/assets/js/50.9c488c6c.js"><link rel="prefetch" href="/assets/js/51.546ea632.js"><link rel="prefetch" href="/assets/js/52.0d2ccee1.js"><link rel="prefetch" href="/assets/js/53.6f52b5b1.js"><link rel="prefetch" href="/assets/js/54.c838b295.js"><link rel="prefetch" href="/assets/js/55.13af99ee.js"><link rel="prefetch" href="/assets/js/56.6be6d1ed.js"><link rel="prefetch" href="/assets/js/57.67c98b39.js"><link rel="prefetch" href="/assets/js/58.107e82ec.js"><link rel="prefetch" href="/assets/js/59.b3e5edc7.js"><link rel="prefetch" href="/assets/js/6.36a535f9.js"><link rel="prefetch" href="/assets/js/60.3b0b4ba5.js"><link rel="prefetch" href="/assets/js/61.3df843df.js"><link rel="prefetch" href="/assets/js/62.1213823d.js"><link rel="prefetch" href="/assets/js/63.e8f3f926.js"><link rel="prefetch" href="/assets/js/64.e1219050.js"><link rel="prefetch" href="/assets/js/65.5bf5bb0b.js"><link rel="prefetch" href="/assets/js/66.a2502afb.js"><link rel="prefetch" href="/assets/js/67.690dd59b.js"><link rel="prefetch" href="/assets/js/68.de7b0915.js"><link rel="prefetch" href="/assets/js/69.ac61dd61.js"><link rel="prefetch" href="/assets/js/7.5d254238.js"><link rel="prefetch" href="/assets/js/70.3edd41b1.js"><link rel="prefetch" href="/assets/js/71.d23407e9.js"><link rel="prefetch" href="/assets/js/72.a5bd01bc.js"><link rel="prefetch" href="/assets/js/73.c9f4dd57.js"><link rel="prefetch" href="/assets/js/74.66323fc1.js"><link rel="prefetch" href="/assets/js/75.e1a72e00.js"><link rel="prefetch" href="/assets/js/76.801268b4.js"><link rel="prefetch" href="/assets/js/77.3a5fda67.js"><link rel="prefetch" href="/assets/js/78.54d84cd4.js"><link rel="prefetch" href="/assets/js/79.fa10f4e3.js"><link rel="prefetch" href="/assets/js/8.e060e47d.js"><link rel="prefetch" href="/assets/js/80.d5b24fea.js"><link rel="prefetch" href="/assets/js/81.0e9da714.js"><link rel="prefetch" href="/assets/js/82.e96ff6d7.js"><link rel="prefetch" href="/assets/js/83.771cced1.js"><link rel="prefetch" href="/assets/js/84.220b69e7.js"><link rel="prefetch" href="/assets/js/85.7dcc5659.js"><link rel="prefetch" href="/assets/js/86.44ba2100.js"><link rel="prefetch" href="/assets/js/87.281da75d.js"><link rel="prefetch" href="/assets/js/88.12d88449.js"><link rel="prefetch" href="/assets/js/89.f28c86d3.js"><link rel="prefetch" href="/assets/js/9.8f9fef32.js"><link rel="prefetch" href="/assets/js/90.715cabb2.js"><link rel="prefetch" href="/assets/js/91.6ced7c82.js"><link rel="prefetch" href="/assets/js/92.c05b33ca.js"><link rel="prefetch" href="/assets/js/93.6bf5fb66.js"><link rel="prefetch" href="/assets/js/94.3561200e.js"><link rel="prefetch" href="/assets/js/95.0f2cf716.js"><link rel="prefetch" href="/assets/js/96.ac8487ea.js"><link rel="prefetch" href="/assets/js/97.48042b5a.js"><link rel="prefetch" href="/assets/js/98.441bb7f8.js"><link rel="prefetch" href="/assets/js/99.4b214d92.js">
    <link rel="stylesheet" href="/assets/css/0.styles.56073ad3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/magic.png" alt="Pangolin Note" class="logo"> <span class="site-name can-hide">Pangolin Note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">🏡首页</a></div><div class="nav-item"><a href="/basic/" class="nav-link">基础</a></div><div class="nav-item"><a href="/develop/" class="nav-link">开发</a></div><div class="nav-item"><a href="/middleware/" class="nav-link">系统</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">算法</a></div><div class="nav-item"><a href="/books/" class="nav-link">🍀读书笔记</a></div><div class="nav-item"><a href="/work/" class="nav-link">工作</a></div><div class="nav-item"><a href="/pangolin/" class="nav-link">🌸达尔文的猹</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatarnew.png"> <div class="blogger-info"><h3>达尔文的猹</h3> <span>大道至简 悟在天成</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">🏡首页</a></div><div class="nav-item"><a href="/basic/" class="nav-link">基础</a></div><div class="nav-item"><a href="/develop/" class="nav-link">开发</a></div><div class="nav-item"><a href="/middleware/" class="nav-link">系统</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">算法</a></div><div class="nav-item"><a href="/books/" class="nav-link">🍀读书笔记</a></div><div class="nav-item"><a href="/work/" class="nav-link">工作</a></div><div class="nav-item"><a href="/pangolin/" class="nav-link">🌸达尔文的猹</a></div><div class="nav-item"><a href="/pages/beb6c0bd8a66cea6/" class="nav-link">收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>工作</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>口算</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/07dbf0/" class="sidebar-link">总结</a></li><li><a href="/pages/a5b5f3/" class="sidebar-link">拍照检查接口流程</a></li><li><a href="/pages/482658/" class="sidebar-link">口算C端服务权限校验</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>CheckMath</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/72c339/" class="sidebar-link">总结</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>墨水屏</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/5a2c80/" class="sidebar-link">总结</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>软实力</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/6aad1f/" class="sidebar-link">开发经验</a></li><li><a href="/pages/41aa0a/" class="sidebar-link">软实力</a></li><li><a href="/pages/a2bcb1/" class="sidebar-link">如何做一个技术主R</a></li><li><a href="/pages/95b842/" class="sidebar-link">大厂晋升指南(极客时间)🌸</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>问题记录</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/1b74b9/" aria-current="page" class="active sidebar-link">口算-OOM案例分析-开发过程中的死循环导致的内存OOM🌸</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/0eb085/" class="sidebar-link">口算-全流程复盘-限流原因分析优化与全链路数据传输研究🌟</a></li><li><a href="/pages/c15cbc/" class="sidebar-link">口算-拍试卷轮询接口报错🌟</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>面试</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/0ec1f4/" class="sidebar-link">找工作准备</a></li><li><a href="/pages/6df9e2/" class="sidebar-link">简历基础</a></li><li><a href="/pages/476e3b/" class="sidebar-link">Java程序员简历模板</a></li><li><a href="/pages/6a9de2/" class="sidebar-link">面经帖子</a></li><li><a href="/pages/acdd42/" class="sidebar-link">反问面试官的问题</a></li></ul></section></li><li><a href="/pages/d6dc9c/" class="sidebar-link">面试问答整理</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/work/#工作" data-v-06970110>工作</a></li><li data-v-06970110><a href="/work/#工作" data-v-06970110>工作</a></li><li data-v-06970110><a href="/work/#问题记录" data-v-06970110>问题记录</a></li></ul> <div class="info" data-v-06970110><div title="作者" class="author iconfont icon-touxiang" data-v-06970110><a href="https://github.com/nanodaemony" target="_blank" title="作者" class="beLink" data-v-06970110>NanoDaemony</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2025-02-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">本文目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">口算-OOM案例分析-开发过程中的死循环导致的内存OOM🌸<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="_1-口算-oom案例分析-开发过程中的死循环导致的内存oom🌸"><a href="#_1-口算-oom案例分析-开发过程中的死循环导致的内存oom🌸" class="header-anchor">#</a> 1.口算-OOM案例分析-开发过程中的死循环导致的内存OOM🌸</h1> <h4 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h4> <p>开发组里面有同学反馈测试环境的机器可能存在内存泄露. POD 节点被强制 KILL 了. 同时留下了一个很小的故障 dump 文件. 根据经验, 这个可能是由于堆内存使用过多. 堆外内存空间较小. 在有较大的内存压力的时候极可能触发 K8S 的 POD 节点内存限制. 从而直接被 KILL.</p> <h4 id="增加内存无效"><a href="#增加内存无效" class="header-anchor">#</a> 增加内存无效</h4> <p>在尝试增加内存大小后(非重点,不详述). 仍然出现了机器假死, 内存占用过大的情况.</p> <blockquote><p>注: 此图为后面复现OOM产生的图.非最原始的现场图</p></blockquote> <p><img src="https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20231122211626-dbqpzzl.png" alt="image"></p> <p>上图说明: 实际当时情况下看到的内存占用更像是一个内存无法 GC. 处于一直 FULLGC 的情况下. 类似于图中时间段: 20:20~20:25 这段时间.</p> <p><img src="https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20231122211711-q2bhl43.png" alt="image"></p> <p>下面的监控图展示了 GC 的频率与 GC 时长</p> <p><img src="https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20231122211731-vzowyzh.png" alt=""></p> <blockquote><p>注: GC的频率已经非常高了</p></blockquote> <p>下面是摘抄了一些 GC 日志:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">51.228</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">514.283</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">5943</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5671</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0779985</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">51.576</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">514.631</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">5955</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5683</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0478549</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">51.885</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">514.940</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">5967</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5696</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0465688</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">52.186</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">515.241</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">5978</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5707</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0472413</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">52.270</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">515.325</span>: <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>mark<span class="token operator">-</span><span class="token keyword">end</span><span class="token punctuation">,</span> <span class="token number">21.0200623</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">52.271</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">515.326</span>: <span class="token punctuation">[</span>GC remark<span class="token punctuation">,</span> <span class="token number">0.0890849</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">52.360</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">515.415</span>: <span class="token punctuation">[</span>GC cleanup <span class="token number">5739</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5739</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0072510</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">52.539</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">515.594</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">5991</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5718</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0498064</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">52.761</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">515.816</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6002</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5729</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0463567</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">52.980</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">516.035</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token punctuation">(</span>initial<span class="token operator">-</span>mark<span class="token punctuation">)</span> <span class="token number">6013</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5740</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0491012</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">53.029</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">516.084</span>: <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>root<span class="token operator">-</span>region<span class="token operator">-</span>scan<span class="token operator">-</span><span class="token keyword">start</span><span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">53.041</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">516.096</span>: <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>root<span class="token operator">-</span>region<span class="token operator">-</span>scan<span class="token operator">-</span><span class="token keyword">end</span><span class="token punctuation">,</span> <span class="token number">0.0113863</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">53.041</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">516.096</span>: <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>mark<span class="token operator">-</span><span class="token keyword">start</span><span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">53.292</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">516.347</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6024</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5751</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0506288</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">53.605</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">516.660</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6035</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5762</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0675043</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">55.789</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">518.844</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6046</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5774</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0480081</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">55.837</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">518.892</span>: <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>mark<span class="token operator">-</span>reset<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">-</span>overflow<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">56.095</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">519.150</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6058</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5787</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0501702</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">56.408</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">519.463</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6069</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5798</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0667547</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">56.722</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">519.777</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6082</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5810</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0749635</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">57.035</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">520.090</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6094</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5822</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0837193</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">57.380</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">520.435</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6104</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5832</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0510885</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">57.694</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">520.749</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span><span class="token comment">-- 6116M-&gt;5854M(6144M), 0.2161288 secs]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">58.173</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">521.228</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span><span class="token comment">-- 6138M-&gt;6138M(6144M), 0.6843441 secs]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">58.859</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">521.914</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6138</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">6138</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0089336</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">58.868</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">521.923</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6138</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">6138</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0058675</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">58.874</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">521.929</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6138</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">6138</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0052280</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">58.880</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">521.935</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6138</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">6138</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0049346</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">58.885</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">521.940</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6138</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">6138</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0053852</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">58.891</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">521.946</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">6138</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">6138</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0048031</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">20</span>:<span class="token number">58.897</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">521.951</span>: <span class="token punctuation">[</span><span class="token keyword">Full</span> GC <span class="token punctuation">(</span>Allocation Failure<span class="token punctuation">)</span>  <span class="token number">6138</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5545</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10.1593790</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">09.056</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">532.111</span>: <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>mark<span class="token operator">-</span>abort<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">09.279</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">532.334</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">5851</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5556</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0272664</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">09.527</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">532.582</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token punctuation">(</span>initial<span class="token operator">-</span>mark<span class="token punctuation">)</span> <span class="token number">5850</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5568</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0553430</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">09.583</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">532.638</span>: <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>root<span class="token operator">-</span>region<span class="token operator">-</span>scan<span class="token operator">-</span><span class="token keyword">start</span><span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">09.595</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">532.650</span>: <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>root<span class="token operator">-</span>region<span class="token operator">-</span>scan<span class="token operator">-</span><span class="token keyword">end</span><span class="token punctuation">,</span> <span class="token number">0.0121384</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">09.595</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">532.650</span>: <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>mark<span class="token operator">-</span><span class="token keyword">start</span><span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">09.909</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">532.964</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">5850</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5579</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1019146</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">10.311</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">533.366</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">5861</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5591</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0730048</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">12.653</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">535.708</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">5873</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5603</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0517848</span> secs<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">12.705</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">535.760</span>: <span class="token punctuation">[</span>GC concurrent<span class="token operator">-</span>mark<span class="token operator">-</span>reset<span class="token operator">-</span><span class="token keyword">for</span><span class="token operator">-</span>overflow<span class="token punctuation">]</span>
<span class="token number">2022</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">19</span>T20:<span class="token number">21</span>:<span class="token number">12.982</span><span class="token operator">+</span><span class="token number">0800</span>: <span class="token number">536.037</span>: <span class="token punctuation">[</span>GC pause <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> <span class="token punctuation">(</span>young<span class="token punctuation">)</span> <span class="token number">5885</span>M<span class="token operator">-</span><span class="token operator">&gt;</span><span class="token number">5615</span>M<span class="token punctuation">(</span><span class="token number">6144</span>M<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.0606651</span> secs<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><blockquote><p>注: 实际这个 GC 日志实际上会 GC 失败.同时用户线程应该也会失败. 失败后堆空间的内存可以被释放,即下一次 GC 是可以回收到内存的. (当时没有明白出问题的点和被持续的用户请求以及 GC 日志的频繁 FULL GC 给迷惑了)</p></blockquote> <h4 id="dump内存"><a href="#dump内存" class="header-anchor">#</a> dump内存</h4> <blockquote><p>命令: <code>jmap -dump:live,format=b,file=./a.dump</code>​<br>
堆大小: 约6G</p></blockquote> <h5 id="_1-使用imb-heap-analyzer工具进行分析"><a href="#_1-使用imb-heap-analyzer工具进行分析" class="header-anchor">#</a> 1.使用IMB Heap Analyzer工具进行分析</h5> <blockquote><p>由于需要的内存较大, 需要设置一下启动命令: <code>java -jar -Xmx24g /path/to/JVM/ha457.jar</code>​</p></blockquote> <p><img src="https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20231122211835-i1d5mtw.png" alt="image"></p> <p>从图中可以看到内存中存在一个 <strong>ArrayList</strong> 里面存储了大量的 string. 其值是一个中横线连接的两个数字串.如:<strong>3-18354009600000</strong>, 这个看起来非常像是拼接起来的 <strong>cache_key</strong>. 但是询问开发同学,其并没有什么印象. 只能从另外一个方向努力.</p> <blockquote><p>注: 这个工具目前用下来就是既好用,也难用. 好用的点是. 他能够比较好的分析堆. 把堆上的对象统计出来. 然后统计出各种维度的对象个数与大小计数. 不好太的地方就是没有给出 GC_ROOTS, 简单说就是比如我栈上引用了一个 <code>ArrayList&lt;String&gt;</code>​ , 他能够找到这个 <code>arraylist</code>​ 对象,并且其子节点的所有节点的大小,内容基本都能够识别和查看. 但是却没有这个数组对象的持有者是谁. 按 IBM Analyzer 的说法.这个数组就是一个根对象.或者是没有 parent 的对象.但是按常理一个 ArrayList 是无法直接存在的.按可能的 GC_ROOT:要么是被一个某个类的静态变量持有;要么是在某一个栈桢里面;要么是常量池或者是方法区的Class对象依赖等;<br>
不管怎样,应该会有一个引用槽位才对.但是这个软件并没有给出来是哪来的根引用了这个对象. 因此需要进一步的分析.</p></blockquote> <h5 id="_2-使用mat工具分析内存泄露"><a href="#_2-使用mat工具分析内存泄露" class="header-anchor">#</a> 2.使用MAT工具分析内存泄露.</h5> <p>不得不说<code>MAT</code>​是一个强大的内存分析工具. 功能和可人工介入和探索的点要丰富很多. 如果早一些用这个工具分析就不会这么麻烦了.</p> <p><img src="/img/image-20231122211858-dkl9skh.png" alt="image"></p> <p>mat 给出的可疑内存泄露报告给出的信息非常的准确. 这个堆文件中<strong>只有一个可疑的内存泄露点</strong>. 同时这个报告里面有:</p> <ul><li>线程: 确定是哪个线程持有这些对象. 对分析范围的缩小有非常大的帮助.</li> <li>这里是一个 <code>http-nio-8080-exec-8</code>​ 说明这是<strong>一个 HTTP 请求</strong>中出现了问题.</li> <li>在后面给出了对象占用的内存大小.</li> <li>下图中的<strong>最短路径到堆积节点(可以理解为汇聚节点)</strong>  给出了 HTTP 线程拥有了这个 ArrayList, 同时这个 ArrayList 里面是 Object 对象.</li></ul> <p><img src="/img/image-20231122211915-1ylm6va.png" alt="image"></p> <p>具体再看一下对象的内容. 因为是 string, 最直观的是把内容打出来. 人工瞅瞅.可能一眼就发现了问题, 如下图:</p> <p><img src="https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20231122211927-e7kdm9k.png" alt=""></p> <p>在这个支配图(<strong>Dominator Tree</strong>)中, 可以发现这个 <strong>ArrayList</strong> 中大量的内容都是雷同的. 再往下看.</p> <p><img src="/img/image-20231122211938-rtchc7y.png" alt="image"></p> <p>通过类型对对象进行汇聚, 发现所有的类型都为 String. 与上图一致. 在泄露的内存类型都为 String 且被关联到了这个 ArrayList 中. 最关键的是下面提供的 Thread 信息. 能够非常精确的找到出问题的点:</p> <p><img src="/img/image-20231122211950-1b420sx.png" alt="image"></p> <p>线程属性分析:</p> <blockquote><ul><li>这是一个http线程: http-nio-8080-exec-8</li> <li>这个浅堆大小(<a href="https://blog.csdn.net/wwlwwy89/article/details/74330544" target="_blank" rel="noopener noreferrer">参考shallow heap - 浅堆大小<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) 是128</li> <li>深堆大小: 2.8G (大约, 定义参考上面的连接)</li> <li>状态是: 存活,可运行 (alive , runnable)</li></ul></blockquote> <p>再看一下堆栈:</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>http<span class="token operator">-</span>nio<span class="token operator">-</span><span class="token number">8080</span><span class="token operator">-</span><span class="token keyword">exec</span><span class="token operator">-</span><span class="token number">8</span>
 at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>GregorianCalendar<span class="token punctuation">.</span><span class="token operator">&lt;</span>init<span class="token operator">&gt;</span><span class="token punctuation">(</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>TimeZone<span class="token punctuation">;</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>Locale<span class="token punctuation">;</span>Z<span class="token punctuation">)</span>V <span class="token punctuation">(</span>GregorianCalendar<span class="token punctuation">.</span>java:<span class="token number">737</span><span class="token punctuation">)</span>
 at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Calendar$Builder<span class="token punctuation">.</span>build<span class="token punctuation">(</span><span class="token punctuation">)</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>Calendar<span class="token punctuation">;</span> <span class="token punctuation">(</span>Calendar<span class="token punctuation">.</span>java:<span class="token number">1482</span><span class="token punctuation">)</span>
 at sun<span class="token punctuation">.</span>util<span class="token punctuation">.</span>locale<span class="token punctuation">.</span>provider<span class="token punctuation">.</span>CalendarProviderImpl<span class="token punctuation">.</span>getInstance<span class="token punctuation">(</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>TimeZone<span class="token punctuation">;</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>Locale<span class="token punctuation">;</span><span class="token punctuation">)</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>Calendar<span class="token punctuation">;</span> <span class="token punctuation">(</span>CalendarProviderImpl<span class="token punctuation">.</span>java:<span class="token number">88</span><span class="token punctuation">)</span>
 at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Calendar<span class="token punctuation">.</span>createCalendar<span class="token punctuation">(</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>TimeZone<span class="token punctuation">;</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>Locale<span class="token punctuation">;</span><span class="token punctuation">)</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>Calendar<span class="token punctuation">;</span> <span class="token punctuation">(</span>Calendar<span class="token punctuation">.</span>java:<span class="token number">1666</span><span class="token punctuation">)</span>
 at java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Calendar<span class="token punctuation">.</span>getInstance<span class="token punctuation">(</span><span class="token punctuation">)</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>Calendar<span class="token punctuation">;</span> <span class="token punctuation">(</span>Calendar<span class="token punctuation">.</span>java:<span class="token number">1613</span><span class="token punctuation">)</span>
 at com<span class="token punctuation">.</span>fenbi<span class="token punctuation">.</span>leo<span class="token punctuation">.</span>homework<span class="token punctuation">.</span>server<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>DateTimeUtils<span class="token punctuation">.</span>getEndTimeOfMonthExclusive<span class="token punctuation">(</span>J<span class="token punctuation">)</span>J <span class="token punctuation">(</span>DateTimeUtils<span class="token punctuation">.</span>java:<span class="token number">228</span><span class="token punctuation">)</span>
 at com<span class="token punctuation">.</span>fenbi<span class="token punctuation">.</span>leo<span class="token punctuation">.</span>homework<span class="token punctuation">.</span>server<span class="token punctuation">.</span>web<span class="token punctuation">.</span>logic<span class="token punctuation">.</span><span class="token keyword">group</span><span class="token punctuation">.</span>StudyGroupRankingListLogic<span class="token punctuation">.</span>addNewLikeCnt<span class="token punctuation">(</span>Ljava<span class="token operator">/</span>util<span class="token operator">/</span>Map<span class="token punctuation">;</span>JJLjava<span class="token operator">/</span>util<span class="token operator">/</span>List<span class="token punctuation">;</span><span class="token punctuation">)</span>V <span class="token punctuation">(</span>StudyGroupRankingListLogic<span class="token punctuation">.</span>java:<span class="token number">277</span><span class="token punctuation">)</span>
 at com<span class="token punctuation">.</span>fenbi<span class="token punctuation">.</span>leo<span class="token punctuation">.</span>homework<span class="token punctuation">.</span>server<span class="token punctuation">.</span>web<span class="token punctuation">.</span>logic<span class="token punctuation">.</span><span class="token keyword">group</span><span class="token punctuation">.</span>StudyGroupRankingListLogic<span class="token punctuation">.</span>getHonorMonthRankingList<span class="token punctuation">(</span>Lcom<span class="token operator">/</span>fenbi<span class="token operator">/</span>leo<span class="token operator">/</span>homework<span class="token operator">/</span>server<span class="token operator">/</span>web<span class="token operator">/</span>context<span class="token operator">/</span>LeoContext<span class="token punctuation">;</span><span class="token punctuation">)</span>Lcom<span class="token operator">/</span>fenbi<span class="token operator">/</span>leo<span class="token operator">/</span>homework<span class="token operator">/</span>server<span class="token operator">/</span>web<span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span><span class="token keyword">group</span><span class="token operator">/</span>vo<span class="token operator">/</span>StudyGroupHonorRankingListVO<span class="token punctuation">;</span> <span class="token punctuation">(</span>StudyGroupRankingListLogic<span class="token punctuation">.</span>java:<span class="token number">260</span><span class="token punctuation">)</span>
 at com<span class="token punctuation">.</span>fenbi<span class="token punctuation">.</span>leo<span class="token punctuation">.</span>homework<span class="token punctuation">.</span>server<span class="token punctuation">.</span>web<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span><span class="token keyword">group</span><span class="token punctuation">.</span>StudyGroupRankingListController<span class="token punctuation">.</span>honorMonth$original$i9HwKDay<span class="token punctuation">(</span><span class="token punctuation">)</span>Lcom<span class="token operator">/</span>yuanli<span class="token operator">/</span>leo<span class="token operator">/</span>framework<span class="token operator">/</span>core<span class="token operator">/</span>remote<span class="token operator">/</span>api<span class="token operator">/</span>APIResponse<span class="token punctuation">;</span> <span class="token punctuation">(</span>StudyGroupRankingListController<span class="token punctuation">.</span>java:<span class="token number">57</span><span class="token punctuation">)</span>
 at com<span class="token punctuation">.</span>fenbi<span class="token punctuation">.</span>leo<span class="token punctuation">.</span>homework<span class="token punctuation">.</span>server<span class="token punctuation">.</span>web<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span><span class="token keyword">group</span><span class="token punctuation">.</span>StudyGroupRankingListController<span class="token punctuation">.</span>honorMonth$original$i9HwKDay$accessor$Mb4aspCT<span class="token punctuation">(</span><span class="token punctuation">)</span>Lcom<span class="token operator">/</span>yuanli<span class="token operator">/</span>leo<span class="token operator">/</span>framework<span class="token operator">/</span>core<span class="token operator">/</span>remote<span class="token operator">/</span>api<span class="token operator">/</span>APIResponse<span class="token punctuation">;</span> <span class="token punctuation">(</span>Unknown Source<span class="token punctuation">)</span>
 at com<span class="token punctuation">.</span>fenbi<span class="token punctuation">.</span>leo<span class="token punctuation">.</span>homework<span class="token punctuation">.</span>server<span class="token punctuation">.</span>web<span class="token punctuation">.</span>ctrl<span class="token punctuation">.</span><span class="token keyword">group</span><span class="token punctuation">.</span>StudyGroupRankingListController$auxiliary$k9SdSGPC<span class="token punctuation">.</span><span class="token keyword">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Ljava<span class="token operator">/</span>lang<span class="token operator">/</span>Object<span class="token punctuation">;</span> <span class="token punctuation">(</span>Unknown Source<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>这里可以很明显的看到代码在 <strong>StudyGroupRankingListLogic.java:277</strong> 中存在问题.</p> <p><img src="/img/image-20231122212017-hhdgi3r.png" alt="image"></p> <p>这里的 <code>likedKey</code>​ 就是上面提到的 <code>ArrayList</code>​ 里面存储的是 <code>String</code>​. 而且是一个栈上的局部变量. 但是由于 while 的循环条件这里书写有错误导致这个循环一直不能结束. 直到把内存写爆.</p> <blockquote><p>注: 这里的代码含义大概是根据一个起始日期时间戳, 循环遍历生成一个月以内的所有可能的 key. 每一个 key 由一个 <code>groupid</code>​-<code>timestamp</code>​ 这个刚好就是在内存 dump 中看到的值. 由于这个时间无法停下来. 后面失效的时间里面的时间戳就会特别大. 所以在看内存值的时候有种好像不是时间戳的感觉.</p></blockquote> <p>到这里其实这个问题基本主分析完了. 其实这个问题也不需要这么复杂. 只要是代码作者自己对自己代码功能敏感一点的话. 其实是比较好发现的. 当然还是得依赖一定的分析工具. 比如直接使用 <code>jstack</code>​ 进行分析.而不是上最后的屠龙刀.</p> <h4 id="后记"><a href="#后记" class="header-anchor">#</a> 后记</h4> <p>通过上面的分析, 对这一个故障的复盘就比较清晰了.</p> <blockquote><p>这是一个HTTP请求, 需要一个月榜的数据. 而这个月榜的数据在实时计算的时候需要生成每一天的相应的榜单数据 key. 而这个 key 的生成处理代码有问题, 导致 <code>while</code>​ 循环处理成了死循环. 最后把内存给写爆了. 不过有几点需要梳理的如下, 这些实际与一般的理解是有出入的.</p></blockquote> <ul><li>这个内存泄露不算是最终的泄露. 如果 HTTP 请求在进入死循环的时候. 会一直申请内存. 直到内存耗尽. 但是在申请内存失败的时候, 最终 HTTP 请求会失败. 在 HTTP 请求失败后 , 这些内存是可以<strong>释放</strong>的.</li> <li>并不是所有的 GC 都会失败. 每一次请求的 GC 只会失败一次.</li> <li>这个内存泄露与一般的使用了全局类的缓存还不一样.比如: HashMap, LoadingCace 等. 实际是代码逻辑错误导致的内存使用无法停止.</li> <li>这个错误是可以简单发现的.</li></ul> <p>‍</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/xugaoyi/vuepress-theme-vdoing/edit/main/docs/60.工作/7000.工作/5.问题记录/1.口算-OOM案例分析-开发过程中的死循环导致的内存OOM🌸.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/95b842/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">大厂晋升指南(极客时间)🌸</div></a> <a href="/pages/0eb085/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">口算-全流程复盘-限流原因分析优化与全链路数据传输研究🌟</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/95b842/" class="prev">大厂晋升指南(极客时间)🌸</a></span> <span class="next"><a href="/pages/0eb085/">口算-全流程复盘-限流原因分析优化与全链路数据传输研究🌟</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:1174520425@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/nanodaemony" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2025
    <span>达尔文的猹 | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3f3e0e10.js" defer></script><script src="/assets/js/2.e9fcb30c.js" defer></script><script src="/assets/js/3.1998f389.js" defer></script><script src="/assets/js/243.d8e81b13.js" defer></script>
  </body>
</html>
