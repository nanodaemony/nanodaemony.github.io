(window.webpackJsonp=window.webpackJsonp||[]).push([[159],{469:function(s,t,n){"use strict";n.r(t);var a=n(7),e=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_33-rediså“¨å…µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_33-rediså“¨å…µ"}},[s._v("#")]),s._v(" 33.Rediså“¨å…µ")]),s._v(" "),t("h4",{attrs:{id:"sentinelæ¶æ„åŸºç¡€ğŸŒŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sentinelæ¶æ„åŸºç¡€ğŸŒŸ"}},[s._v("#")]),s._v(" Sentinelæ¶æ„åŸºç¡€ğŸŒŸ")]),s._v(" "),t("h5",{attrs:{id:"_1-æ™®é€šä¸»ä»å¤åˆ¶çš„é—®é¢˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ™®é€šä¸»ä»å¤åˆ¶çš„é—®é¢˜"}},[s._v("#")]),s._v(" 1.æ™®é€šä¸»ä»å¤åˆ¶çš„é—®é¢˜")]),s._v(" "),t("p",[t("strong",[s._v("ä¸»ä»å¤åˆ¶")]),s._v("å­˜åœ¨ä»¥ä¸‹é—®é¢˜:")]),s._v(" "),t("ul",[t("li",[s._v("ä¸€æ—¦ä¸»èŠ‚ç‚¹"),t("strong",[s._v("å‡ºç°æ•…éšœ")]),s._v(", éœ€è¦æ‰‹åŠ¨å°†ä¸€ä¸ªä»èŠ‚ç‚¹æ™‹å‡ä¸ºä¸»èŠ‚ç‚¹, åŒæ—¶éœ€è¦ä¿®æ”¹åº”ç”¨æ–¹çš„ä¸»èŠ‚ç‚¹åœ°å€, è¿˜éœ€è¦å‘½ä»¤å…¶ä»–ä»èŠ‚ç‚¹å»å¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹, æ•´ä¸ªè¿‡ç¨‹éœ€è¦"),t("strong",[s._v("äººå·¥å¹²é¢„")]),s._v(".")]),s._v(" "),t("li",[s._v("ä¸»èŠ‚ç‚¹çš„"),t("strong",[s._v("å†™èƒ½åŠ›")]),s._v("å—åˆ°å•æœºçš„é™åˆ¶, ä¸»èŠ‚ç‚¹çš„"),t("strong",[s._v("å­˜å‚¨èƒ½åŠ›")]),s._v("å—åˆ°å•æœºçš„é™åˆ¶.")])]),s._v(" "),t("p",[s._v("è¿™ä¸€ç‚¹ä¹Ÿ"),t("strong",[s._v("ä¸é«˜å¯ç”¨")]),s._v(".")]),s._v(" "),t("h5",{attrs:{id:"_2-sentinelæ¶æ„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-sentinelæ¶æ„"}},[s._v("#")]),s._v(" 2.Sentinelæ¶æ„")]),s._v(" "),t("p",[s._v("Redis Sentinel æ˜¯ä¸€ä¸ª"),t("strong",[s._v("åˆ†å¸ƒå¼æ¶æ„")]),s._v(", å…¶ä¸­åŒ…å«"),t("strong",[s._v("è‹¥å¹²ä¸ª Sentinel èŠ‚ç‚¹")]),s._v("å’Œ Redis æ•°æ®èŠ‚ç‚¹, æ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šå¯¹æ•°æ®èŠ‚ç‚¹å’Œ"),t("strong",[s._v("å…¶ä½™")]),s._v(" Sentinel èŠ‚ç‚¹è¿›è¡Œç›‘æ§, å½“å®ƒå‘ç°èŠ‚ç‚¹ä¸å¯è¾¾æ—¶, ä¼šå¯¹èŠ‚ç‚¹åš"),t("strong",[s._v("ä¸‹çº¿æ ‡è¯†")]),s._v(". å¦‚æœè¢«æ ‡è¯†çš„æ˜¯"),t("strong",[s._v("ä¸»èŠ‚ç‚¹")]),s._v(', å®ƒè¿˜ä¼šå’Œå…¶ä»– Sentinel èŠ‚ç‚¹è¿›è¡Œ "'),t("strong",[s._v("åå•†")]),s._v('", å½“å¤§å¤šæ•° Sentinel èŠ‚ç‚¹'),t("strong",[s._v("éƒ½è®¤ä¸ºä¸»èŠ‚ç‚¹ä¸å¯è¾¾")]),s._v("æ—¶, å®ƒä»¬ä¼š"),t("strong",[s._v("é€‰ä¸¾å‡ºä¸€ä¸ª Sentinel èŠ‚ç‚¹")]),s._v("æ¥å®Œæˆ"),t("strong",[s._v("è‡ªåŠ¨æ•…éšœè½¬ç§»")]),s._v("çš„å·¥ä½œ, åŒæ—¶ä¼šå°†è¿™ä¸ªå˜åŒ–"),t("strong",[s._v("å®æ—¶é€šçŸ¥")]),s._v("ç»™å®¢æˆ·ç«¯.")]),s._v(" "),t("p",[s._v("Sentinel å“¨å…µæ˜¯ç‰¹æ®Šçš„ Redis æœåŠ¡, ä¸æä¾›è¯»å†™æœåŠ¡, ä¸»è¦ç”¨æ¥ç›‘æ§ Redis å®ä¾‹èŠ‚ç‚¹. ä¸»èŠ‚ç‚¹å‡ºç°æ•…éšœæ—¶, "),t("strong",[s._v("Redis Sentinel")]),s._v(" èƒ½"),t("strong",[s._v("è‡ªåŠ¨å®Œæˆæ•…éšœå‘ç°å’Œæ•…éšœè½¬ç§»")]),s._v(", å¹¶"),t("strong",[s._v("é€šçŸ¥åº”ç”¨æ–¹")]),s._v(", æ•´ä¸ªè¿‡ç¨‹å®Œå…¨æ˜¯"),t("strong",[s._v("è‡ªåŠ¨")]),s._v("çš„, ä¸éœ€è¦äººå·¥æ¥ä»‹å…¥, ä»è€Œå®ç°çœŸæ­£çš„"),t("strong",[s._v("é«˜å¯ç”¨")]),s._v(".")]),s._v(" "),t("p",[s._v("Redis Sentinel ä¸ Redis ä¸»ä»å¤åˆ¶çš„æ¶æ„ç›¸æ¯”è¾ƒ"),t("strong",[s._v("åªæ˜¯å¤šäº†è‹¥å¹² Sentinel èŠ‚ç‚¹")]),s._v(", æ‰€ä»¥ Redis Sentinel "),t("strong",[s._v("å¹¶æ²¡æœ‰")]),s._v("é’ˆå¯¹ Redis èŠ‚ç‚¹åšç‰¹æ®Šå¤„ç†.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20211218185927434.png",alt:""}})]),s._v(" "),t("p",[t("strong",[s._v("Sentinel èŠ‚ç‚¹æœ¬èº«å°±æ˜¯ç‹¬ç«‹çš„ Redis èŠ‚ç‚¹, åªä¸è¿‡å®ƒä»¬æœ‰ä¸€äº›ç‰¹æ®Š, å®ƒä»¬ä¸å­˜å‚¨æ•°æ®, åªæ”¯æŒéƒ¨åˆ†å‘½ä»¤")]),s._v(". Sentinel èŠ‚ç‚¹é›†åˆä¼šå®šæœŸå¯¹"),t("strong",[s._v("æ‰€æœ‰èŠ‚ç‚¹")]),s._v("è¿›è¡Œç›‘æ§, ç‰¹åˆ«æ˜¯å¯¹ä¸»èŠ‚ç‚¹çš„"),t("strong",[s._v("æ•…éšœå®ç°è‡ªåŠ¨è½¬ç§»")]),s._v(".")]),s._v(" "),t("p",[s._v("Redis Sentinel åŒæ—¶åŒ…å«äº†"),t("strong",[s._v("è‹¥ä¸ª Sentinel èŠ‚ç‚¹")]),s._v(", è¿™æ ·åšæœ‰å¦‚ä¸‹å¥½å¤„:")]),s._v(" "),t("ul",[t("li",[s._v("èŠ‚ç‚¹"),t("strong",[s._v("æ•…éšœåˆ¤æ–­")]),s._v("ç”±å¤šä¸ª Sentinel èŠ‚ç‚¹"),t("strong",[s._v("å…±åŒå®Œæˆ")]),s._v(", å¯ä»¥"),t("strong",[s._v("é˜²æ­¢è¯¯åˆ¤")]),s._v(".")]),s._v(" "),t("li",[s._v("Sentinel èŠ‚ç‚¹é›†åˆç”±è‹¥å¹²ä¸ª Sentinel èŠ‚ç‚¹ç»„æˆ, å³ä½¿ä¸ªåˆ« Sentinel èŠ‚ç‚¹ä¸å¯ç”¨, æ•´ä¸ª Sentinel èŠ‚ç‚¹é›†åˆä¾ç„¶æ˜¯å¥å£®çš„, é˜²æ­¢ Sentinel å‡ºç°å•ç‚¹æ•…éšœ.")])]),s._v(" "),t("h5",{attrs:{id:"_3-sentinelçš„åŠŸèƒ½"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-sentinelçš„åŠŸèƒ½"}},[s._v("#")]),s._v(" 3.Sentinelçš„åŠŸèƒ½")]),s._v(" "),t("p",[s._v("Redis Sentinel å…·æœ‰ä»¥ä¸‹å‡ ä¸ªåŠŸèƒ½:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("ç›‘æ§")]),s._v(": Sentinel èŠ‚ç‚¹ä¼šå®šæœŸæ£€æµ‹ Redis æ•°æ®èŠ‚ç‚¹ä»¥åŠå…¶ä½™ Sentinel èŠ‚ç‚¹æ˜¯å¦å¯è¾¾.")]),s._v(" "),t("li",[t("strong",[s._v("é€šçŸ¥")]),s._v(": Sentinel èŠ‚ç‚¹ä¼šå°†æ•…éšœè½¬ç§»çš„ç»“æœé€šçŸ¥ç»™åº”ç”¨æ–¹.")]),s._v(" "),t("li",[t("strong",[s._v("ä¸»èŠ‚ç‚¹æ•…éšœè½¬ç§»")]),s._v(": å®ç°ä»èŠ‚ç‚¹æ™‹å‡ä¸ºä¸»èŠ‚ç‚¹å¹¶ç»´æŠ¤åç»­æ­£ç¡®çš„ä¸»ä»å…³ç³».")]),s._v(" "),t("li",[t("strong",[s._v("é…ç½®æä¾›è€…")]),s._v(": åœ¨ Sentinel ç»“æ„ä¸­, å®¢æˆ·ç«¯åˆå§‹åŒ–æ—¶è¿æ¥çš„æ˜¯ Sentinel èŠ‚ç‚¹"),t("strong",[s._v("é›†åˆ")]),s._v(", ä»ä¸­è·å–ä¸»èŠ‚ç‚¹ä¿¡æ¯.")])]),s._v(" "),t("h4",{attrs:{id:"sentineléƒ¨ç½²ä¸é…ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sentineléƒ¨ç½²ä¸é…ç½®"}},[s._v("#")]),s._v(" Sentineléƒ¨ç½²ä¸é…ç½®")]),s._v(" "),t("p",[s._v("éƒ¨ç½²å®æ“å¯ä»¥çœ‹çœ‹ Sentinel æ¶æ„çš„éƒ¨ç½²è¿‡ç¨‹: "),t("a",{attrs:{href:"https://blog.csdn.net/cuiwjava/article/details/98844949",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/cuiwjava/article/details/98844949"),t("OutboundLink")],1)]),s._v(" "),t("h5",{attrs:{id:"_1-é…ç½®å‚æ•°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-é…ç½®å‚æ•°"}},[s._v("#")]),s._v(" 1.é…ç½®å‚æ•°")]),s._v(" "),t("p",[s._v("Redis å®‰è£…ç›®å½•ä¸‹æœ‰ä¸€ä¸ª "),t("strong",[s._v("sentinel.conf")]),s._v(", æ˜¯é»˜è®¤çš„ Sentinel èŠ‚ç‚¹"),t("strong",[s._v("é…ç½®æ–‡ä»¶")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26379")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ç«¯å£")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" /opt/soft/redis/data  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å·¥ä½œç›®å½•")]),s._v("\nsentinel monitor mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# é…ç½®ä¸»èŠ‚ç‚¹åœ°å€ç«¯å£, ä¸å¯è¾¾ç¥¨æ•°ä¸º2")]),s._v("\nsentinel down-after-milliseconds mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\nsentinel parallel-syncs mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nsentinel failover-timeout mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("180000")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sentinel auth-pass <master-name> <password>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sentinel notification-script <master-name> <script-path>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#sentinel client-reconfig-script <master-name> <script-path>")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[t("strong",[s._v("â‘  sentinel monitor")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ sentinel monitor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("master-name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("ip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("quorum"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("Sentinel èŠ‚ç‚¹ä¼šå®šæœŸç›‘æ§"),t("strong",[s._v("ä¸»èŠ‚ç‚¹")]),s._v(", æ‰€ä»¥ä»é…ç½®ä¸Šå¿…ç„¶ä¹Ÿä¼šæœ‰æ‰€ä½“ç°, Sentinel èŠ‚ç‚¹è¦ç›‘æ§çš„æ˜¯ä¸€ä¸ªåå­—å«åš "),t("code",[s._v("<master-name>")]),s._v("â€‹, ip åœ°å€å’Œç«¯å£ä¸º "),t("code",[s._v("<ip><port>")]),s._v("â€‹ çš„"),t("strong",[s._v("ä¸»èŠ‚ç‚¹")]),s._v(".")]),s._v(" "),t("p",[s._v("â€‹"),t("code",[s._v("<quorum>")]),s._v("â€‹ ä»£è¡¨è¦åˆ¤å®š"),t("mark",[t("strong",[s._v("ä¸»èŠ‚ç‚¹æœ€ç»ˆä¸å¯è¾¾æ‰€éœ€è¦çš„ç¥¨æ•°")])]),s._v(". "),t("code",[s._v("<quorum>")]),s._v("â€‹ å‚æ•°ç”¨äºæ•…éšœå‘ç°å’Œåˆ¤å®š, ä¾‹å¦‚å°† quorum é…ç½®ä¸º 2, ä»£è¡¨è‡³å°‘æœ‰ 2 ä¸ª Sentinel èŠ‚ç‚¹"),t("strong",[s._v("è®¤ä¸º")]),s._v("ä¸»èŠ‚ç‚¹ä¸å¯è¾¾æ—¶, è¿™ä¸ªä¸å¯è¾¾çš„åˆ¤å®šæ‰æ˜¯å®¢è§‚çš„. ä¸€èˆ¬å»ºè®®å°†å…¶"),t("strong",[s._v("è®¾ç½®ä¸º Sentinel èŠ‚ç‚¹æ•°é‡çš„ä¸€åŠåŠ  1")]),s._v(".")]),s._v(" "),t("p",[s._v("åŒæ—¶ "),t("code",[s._v("<quorum>")]),s._v("â€‹ è¿˜ä¸ Sentinel èŠ‚ç‚¹çš„"),t("strong",[s._v("é¢†å¯¼è€…é€‰ä¸¾")]),s._v("æœ‰å…³, è‡³å°‘è¦æœ‰ "),t("strong",[s._v("max(quorum, num(sentinels) / 2 + 1)")]),s._v("  ä¸ª Sentinel èŠ‚ç‚¹å‚ä¸é€‰ä¸¾, æ‰èƒ½é€‰å‡ºé¢†å¯¼è€… Sentinel, ä»è€Œå®Œæˆæ•…éšœè½¬ç§».")]),s._v(" "),t("p",[s._v("Sentinel èŠ‚ç‚¹ä¼šå¯¹"),t("strong",[s._v("æ‰€æœ‰èŠ‚ç‚¹")]),s._v("è¿›è¡Œç›‘æ§, ä½†åœ¨ Sentinel èŠ‚ç‚¹é…ç½®ä¸­æ²¡æœ‰çœ‹åˆ°æœ‰å…³ä»èŠ‚ç‚¹å’Œå…¶ä½™ Sentinel èŠ‚ç‚¹çš„é…ç½®, è¿™æ˜¯å› ä¸º Sentinel èŠ‚ç‚¹ä¼š"),t("strong",[s._v("è‡ªåŠ¨ä»ä¸»èŠ‚ä¸­è·å–æœ‰å…³ä»èŠ‚ç‚¹ä»¥åŠå…¶ä½™ Sentinel èŠ‚ç‚¹")]),s._v("çš„ç›¸å…³ä¿¡æ¯.")]),s._v(" "),t("p",[s._v("ä¾‹å¦‚æŸä¸ª Sentinel "),t("strong",[s._v("åˆå§‹èŠ‚ç‚¹é…ç½®")]),s._v("å¦‚ä¸‹:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26379")]),s._v("\ndaemonize "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nlogfile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"26379.log"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" /opt/soft/redis/data\nsentinel monitor mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åªæœ‰ä¸»èŠ‚ç‚¹çš„é…ç½®")]),s._v("\nsentinel down-after-milliseconds mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\nsentinel parallel-syncs mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nsentinel failover-timeout mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("180000")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("å½“æ‰€æœ‰èŠ‚ç‚¹å¯åŠ¨å, é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹å‘ç”Ÿäº†"),t("strong",[s._v("å˜åŒ–")]),s._v(", åŸæ¥é…ç½®æ–‡ä»¶ä¸­ä¼š"),t("strong",[s._v("è‡ªåŠ¨åŠ å…¥ä»èŠ‚ç‚¹å’Œå…¶ä»– Sentinel ç»“ç‚¹çš„ä¿¡æ¯")]),s._v(", å¹¶ä¼šå»æ‰ä¸€äº›é»˜è®¤é…ç½®å‚æ•°. å¦‚ä¸‹.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("port "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26379")]),s._v("\ndaemonize "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nlogfile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"26379.log"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/soft/redis/data"')]),s._v("\nsentinel monitor mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nsentinel config-epoch mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nsentinel leader-epoch mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å‘ç°ä¸¤ä¸ªslaveèŠ‚ç‚¹")]),s._v("\nsentinel known-slave mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6380")]),s._v("\nsentinel known-slave mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6381")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å‘ç°ä¸¤ä¸ªsentinelèŠ‚ç‚¹")]),s._v("\nsentinel known-sentinel mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26380")]),s._v(" 282a70ff56c36ed56e8f7ee6ada741\n24140d6f53\nsentinel known-sentinel mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26381")]),s._v(" f714470d30a61a8e39ae031192f1fe\nae7eb5b2be\nsentinel current-epoch "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("Redis Sentinel å¯ä»¥"),t("strong",[s._v("åŒæ—¶ç›‘æ§å¤šä¸ªä¸»èŠ‚ç‚¹")]),s._v(". é…ç½®æ—¶åªéœ€è¦æŒ‡å®š"),t("strong",[s._v("å¤šä¸ª masterName")]),s._v(" æ¥åŒºåˆ†"),t("strong",[s._v("ä¸åŒçš„ä¸»èŠ‚ç‚¹")]),s._v("å³å¯.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20211218185927434.png",alt:""}})]),s._v(" "),t("p",[t("strong",[s._v("â‘¡ sentinel down-after-milliseconds")])]),s._v(" "),t("p",[s._v("é…ç½®ç»“ç‚¹é—´ä¸å¯è¾¾"),t("strong",[s._v("è¶…æ—¶æ—¶é—´")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ sentinel down-after-milliseconds "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("master-name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("times"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("æ¯ä¸ª Sentinel èŠ‚ç‚¹éƒ½è¦é€šè¿‡"),t("strong",[s._v("å®šæœŸå‘é€ ping å‘½ä»¤")]),s._v("æ¥åˆ¤æ–­ Redis æ•°æ®èŠ‚ç‚¹å’Œå…¶ä½™ Sentinel èŠ‚ç‚¹"),t("strong",[s._v("æ˜¯å¦å¯è¾¾")]),s._v(", å¦‚æœè¶…è¿‡äº† down-after-milliseconds é…ç½®çš„"),t("strong",[s._v("æ—¶é—´")]),s._v("ä¸”æ²¡æœ‰æœ‰æ•ˆçš„å›å¤, åˆ™åˆ¤å®šèŠ‚ç‚¹ä¸å¯è¾¾.")]),s._v(" "),t("p",[t("strong",[s._v("â‘¢ sentinel parallel-syncs")])]),s._v(" "),t("p",[s._v("ç”¨æ¥é™åˆ¶åœ¨ä¸€æ¬¡"),t("strong",[s._v("æ•…éšœè½¬ç§»")]),s._v("ä¹‹å, "),t("strong",[s._v("æ¯æ¬¡å‘æ–°çš„ä¸»èŠ‚ç‚¹å‘èµ·å¤åˆ¶æ“ä½œ")]),s._v("çš„ä»èŠ‚ç‚¹ä¸ªæ•°.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ sentinel parallel-syncs "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("master-name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("nums"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("éƒ¨ç½²æŠ€å·§")])]),s._v(" "),t("ul",[t("li",[s._v("Sentinel èŠ‚ç‚¹åº”éƒ¨ç½²åœ¨å¤šå°ç‰©ç†æœºå™¨ä¸Š.")]),s._v(" "),t("li",[s._v("éƒ¨ç½²"),t("strong",[s._v("ä¸‰ä¸ªä»¥ä¸Šä¸”å¥‡æ•°ä¸ª")]),s._v("çš„ Sentinel èŠ‚ç‚¹. 3 ä¸ªä»¥ä¸Šæ˜¯é€šè¿‡å¢åŠ  Sentinel èŠ‚ç‚¹çš„ä¸ªæ•°æé«˜å¯¹äºæ•…éšœåˆ¤å®šçš„"),t("strong",[s._v("å‡†ç¡®æ€§")]),s._v(", å› ä¸ºé¢†å¯¼è€…é€‰ä¸¾éœ€è¦è‡³å°‘ä¸€åŠåŠ  1 ä¸ªèŠ‚ç‚¹, å¥‡æ•°ä¸ªèŠ‚ç‚¹å¯ä»¥åœ¨æ»¡è¶³è¯¥æ¡ä»¶çš„åŸºç¡€ä¸ŠèŠ‚çœä¸€ä¸ªèŠ‚ç‚¹.")])]),s._v(" "),t("h5",{attrs:{id:"_2-å“¨å…µéƒ¨ç½²ä¸æ•…éšœè½¬ç§»ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å“¨å…µéƒ¨ç½²ä¸æ•…éšœè½¬ç§»ç¤ºä¾‹"}},[s._v("#")]),s._v(" 2.å“¨å…µéƒ¨ç½²ä¸æ•…éšœè½¬ç§»ç¤ºä¾‹")]),s._v(" "),t("p",[t("strong",[s._v("(1)ç¬¬ä¸€æ­¥: åˆ›å»ºä¸»ä»èŠ‚ç‚¹é…ç½®æ–‡ä»¶å¹¶å¯åŠ¨")])]),s._v(" "),t("p",[s._v("å®‰è£…ç›®å½•ä¸‹æ‰¾åˆ° redis.conf æ–‡ä»¶å¤åˆ¶ä¸‰ä»½åˆ†åˆ«å‘½åä¸º redis-master.conf/redis-slave1.conf/redis-slave2.conf, åˆ†åˆ«ä½œä¸º 1 ä¸ªä¸»èŠ‚ç‚¹å’Œ 2 ä¸ªä»èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶. åˆ†åˆ«ä¿®æ”¹å¦‚ä¸‹æ‰€ç¤º:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis-master.conf")]),s._v("\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\ndaemonize "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nlogfile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6379.log"')]),s._v("\ndbfilename "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dump-6379.rdb"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis-slave1.conf")]),s._v("\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6380")]),s._v("\ndaemonize "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nlogfile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6380.log"')]),s._v("\ndbfilename "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dump-6380.rdb"')]),s._v("\nslaveof "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis-slave2.conf")]),s._v("\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6381")]),s._v("\ndaemonize "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nlogfile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6381.log"')]),s._v("\ndbfilename "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dump-6381.rdb"')]),s._v("\nslaveof "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("p",[s._v("ç„¶åæ‰§è¡Œ "),t("code",[s._v("redis-server <config file path>")]),s._v("â€‹ æ¥æ ¹æ®é…ç½®æ–‡ä»¶å¯åŠ¨ä¸åŒçš„ Redis èŠ‚ç‚¹å®ä¾‹.")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("$ redis-server /usr/local/redis-5.0.3/redis-master.conf\n$ redis-server /usr/local/redis-5.0.3/redis-slave1.conf\n$ redis-server /usr/local/redis-5.0.3/redis-slave2.conf\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("èŠ‚ç‚¹å¯åŠ¨åå®¢æˆ·ç«¯è¿æ¥åˆ°ç«¯å£ä¸º "),t("strong",[s._v("6379 çš„ä¸»èŠ‚ç‚¹")]),s._v("æ‰§è¡Œ "),t("strong",[s._v("info Replication")]),s._v(" æ£€æŸ¥ä¸€ä¸‹"),t("strong",[s._v("ä¸»ä»çŠ¶æ€")]),s._v("æ˜¯å¦æ­£å¸¸(å¯ä»¥çœ‹åˆ°ä¸‹æ–¹æ­£ç¡®åœ°æ˜¾ç¤ºäº†ä¸¤ä¸ªä»èŠ‚ç‚¹):")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/7896890-a1c935f094240cac-3785108.png",alt:""}})]),s._v(" "),t("p",[t("strong",[s._v("(2)ç¬¬äºŒæ­¥: åˆ›å»ºå“¨å…µèŠ‚ç‚¹é…ç½®æ–‡ä»¶å¹¶å¯åŠ¨")])]),s._v(" "),t("p",[s._v("æŒ‰ç…§åŒæ ·çš„æ–¹æ³•, ç»™"),t("strong",[s._v("å“¨å…µèŠ‚ç‚¹")]),s._v("ä¹Ÿåˆ›å»º"),t("strong",[s._v("ä¸‰ä¸ªé…ç½®æ–‡ä»¶")]),s._v(". å“¨å…µèŠ‚ç‚¹æœ¬è´¨ä¸Šæ˜¯ç‰¹æ®Šçš„ Redis èŠ‚ç‚¹, æ‰€ä»¥é…ç½®å‡ ä¹æ²¡ä»€ä¹ˆå·®åˆ«, åªæ˜¯åœ¨ç«¯å£ä¸ŠåšåŒºåˆ†å³å¯.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis-sentinel-1.conf")]),s._v("\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26379")]),s._v("\ndaemonize "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nlogfile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"26379.log"')]),s._v("\nsentinel monitor mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis-sentinel-2.conf")]),s._v("\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26380")]),s._v("\ndaemonize "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nlogfile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"26380.log"')]),s._v("\nsentinel monitor mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis-sentinel-3.conf")]),s._v("\nport "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26381")]),s._v("\ndaemonize "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nlogfile "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"26381.log"')]),s._v("\nsentinel monitor mymaster "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("å…¶ä¸­ "),t("strong",[s._v("sentinel monitor mymaster 127.0.0.1 6379 2")]),s._v(" é…ç½®çš„å«ä¹‰æ˜¯: è¯¥å“¨å…µèŠ‚ç‚¹ç›‘æ§ 127.0.0.1:6379 è¿™ä¸ª"),t("strong",[s._v("ä¸»èŠ‚ç‚¹")]),s._v(", è¯¥ä¸»èŠ‚ç‚¹çš„åç§°æ˜¯ mymaster, æœ€å 2 çš„å«ä¹‰ä¸ä¸»èŠ‚ç‚¹çš„æ•…éšœåˆ¤å®šæœ‰å…³: "),t("strong",[s._v("è‡³å°‘éœ€è¦ 2 ä¸ªå“¨å…µèŠ‚ç‚¹åŒæ„")]),s._v(", æ‰èƒ½åˆ¤å®šä¸»èŠ‚ç‚¹æ•…éšœå¹¶è¿›è¡Œæ•…éšœè½¬ç§».")]),s._v(" "),t("p",[s._v("æ‰§è¡Œå‘½ä»¤å¯åŠ¨å“¨å…µèŠ‚ç‚¹.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ redis-server /usr/local/redis-5.0.3/redis-sentinel-1.conf "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--sentinel")]),s._v("\n$ redis-server /usr/local/redis-5.0.3/redis-sentinel-2.conf "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--sentinel")]),s._v("\n$ redis-server /usr/local/redis-5.0.3/redis-sentinel-3.conf "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--sentinel")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("ä½¿ç”¨å®¢æˆ·ç«¯è¿æ¥å“¨å…µèŠ‚ç‚¹, å¹¶æ‰§è¡Œ "),t("strong",[s._v("info Sentinel å‘½ä»¤")]),s._v("æ¥æŸ¥çœ‹æ˜¯å¦å·²ç»åœ¨ç›‘è§†ä¸»èŠ‚ç‚¹äº†.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿æ¥ç«¯å£ä¸º 26379 çš„ Redis èŠ‚ç‚¹")]),s._v("\n$ redis-cli "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26379")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:2637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" info Sentinel\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Sentinel")]),s._v("\nsentinel_masters:1\nsentinel_tilt:0\nsentinel_running_scripts:0\nsentinel_scripts_queue_length:0\nsentinel_simulate_failure_flags:0\nmaster0:name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mymaster,status"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ok,address"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6379,slaves"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(",sentinels"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("æŸ¥çœ‹å“¨å…µé…ç½®æ–‡ä»¶, ä¼šå‘ç°å·²ç»è‡ªåŠ¨å†™å…¥ä¸€äº›èŠ‚ç‚¹ç›¸å…³çš„ä¿¡æ¯.")]),s._v(" "),t("p",[t("strong",[s._v("(3)ç¬¬ä¸‰æ­¥: æ¨¡æ‹Ÿæ•…éšœè½¬ç§»")])]),s._v(" "),t("p",[s._v("ä½¿ç”¨  "),t("strong",[s._v('"kill -9"')]),s._v("  å‘½ä»¤"),t("strong",[s._v("æ€æ‰ä¸»èŠ‚ç‚¹")]),s._v(", åŒæ—¶åœ¨å“¨å…µèŠ‚ç‚¹ä¸­æ‰§è¡Œ  "),t("strong",[s._v('"info Sentinel" å‘½ä»¤')]),s._v("æ¥è§‚å¯Ÿæ•…éšœèŠ‚ç‚¹çš„è¿‡ç¨‹.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" aux "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("74529")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4346936")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2132")]),s._v("   ??  Ss   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":30ä¸Šåˆ   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":03.09 redis-server *:26379 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sentinel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("73541")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4348072")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2292")]),s._v("   ??  Ss   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":18ä¸Šåˆ   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":04.79 redis-server *:6379\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("75521")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4286728")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("728")]),s._v(" s008  S+   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":39ä¸Šåˆ   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00.00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--color")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto --exclude-dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".bzr --exclude-dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("CVS --exclude-dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".git --exclude-dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".hg --exclude-dir"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(".svn "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("nano")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("74836")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4289844")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("944")]),s._v(" s006  S+   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":32ä¸Šåˆ   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00.01 redis-cli "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26379")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-9")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("73541")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("å¦‚æœ"),t("strong",[s._v("åˆšæ€æ‰ç¬é—´")]),s._v('åœ¨å“¨å…µèŠ‚ç‚¹ä¸­æ‰§è¡Œ "info" å‘½ä»¤, ä¼šå‘ç°ä¸»èŠ‚ç‚¹è¿˜æ²¡æœ‰åˆ‡æ¢è¿‡æ¥, å› ä¸ºå“¨å…µå‘ç°ä¸»èŠ‚ç‚¹æ•…éšœå¹¶è½¬ç§»éœ€è¦ä¸€æ®µæ—¶é—´. ä¸€æ®µæ—¶é—´ä¹‹åå†æ‰§è¡Œ  '),t("strong",[s._v('"info" å‘½ä»¤')]),s._v(", å°±ä¼šå‘ç°"),t("strong",[s._v("ä¸»èŠ‚ç‚¹å·²ç»åˆ‡æ¢æˆäº† 6381 ç«¯å£çš„ä»èŠ‚ç‚¹")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¿‡ä¸€æ®µæ—¶é—´ä¹‹ååœ¨æ‰§è¡Œ, å‘ç°å·²ç»åˆ‡æ¢äº† 6381 ç«¯å£")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:2637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" info Sentinel\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Sentinel")]),s._v("\nsentinel_masters:1\nsentinel_tilt:0\nsentinel_running_scripts:0\nsentinel_scripts_queue_length:0\nsentinel_simulate_failure_flags:0\nmaster0:name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mymaster,status"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ok,address"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:6381,slaves"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(",sentinels"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("ä½†åŒæ—¶è¿˜å¯ä»¥å‘ç°, "),t("strong",[s._v("å“¨å…µèŠ‚ç‚¹è®¤ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ä»ç„¶æœ‰ä¸¤ä¸ªä»èŠ‚ç‚¹")]),s._v("(ä¸Šæ–¹ slaves=2), è¿™æ˜¯å› ä¸ºå“¨å…µåœ¨å°† 6381 åˆ‡æ¢æˆä¸»èŠ‚ç‚¹çš„åŒæ—¶, å°† 6379 èŠ‚ç‚¹ç½®ä¸ºå…¶ä»èŠ‚ç‚¹. è™½ç„¶ 6379 ä»èŠ‚ç‚¹å·²ç»æŒ‚æ‰, ä½†æ˜¯ç”±äº "),t("strong",[s._v("å“¨å…µå¹¶ä¸ä¼šå¯¹ä»èŠ‚ç‚¹è¿›è¡Œå®¢è§‚ä¸‹çº¿")]),s._v(", å› æ­¤è®¤ä¸ºè¯¥ä»èŠ‚ç‚¹ä¸€ç›´å­˜åœ¨. å½“ 6379 èŠ‚ç‚¹é‡æ–°å¯åŠ¨å, ä¼šè‡ªåŠ¨å˜æˆ 6381 èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹.")]),s._v(" "),t("p",[s._v("å¦å¤–åœ¨æ•…éšœè½¬ç§»çš„é˜¶æ®µ, å“¨å…µå’Œä¸»ä»èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶éƒ½ä¼šè¢«æ”¹å†™:")]),s._v(" "),t("ul",[t("li",[s._v("**å¯¹äºä¸»ä»èŠ‚ç‚¹: ** ä¸»è¦æ˜¯ slaveof é…ç½®çš„å˜åŒ–, æ–°çš„ä¸»èŠ‚ç‚¹æ²¡æœ‰äº† slaveof é…ç½®, å…¶ä»èŠ‚ç‚¹åˆ™ slaveof æ–°çš„ä¸»èŠ‚ç‚¹.")]),s._v(" "),t("li",[s._v("**å¯¹äºå“¨å…µèŠ‚ç‚¹: ** é™¤äº†ä¸»ä»èŠ‚ç‚¹ä¿¡æ¯çš„å˜åŒ–, ç”¨äºè®°å½•å½“å‰é›†ç¾¤çŠ¶æ€çš„å‚æ•°çºªå…ƒ(epoch) ä¹Ÿä¼šå˜åŒ–, çºªå…ƒç›¸å…³çš„å‚æ•°éƒ½ +1 äº†.")])]),s._v(" "),t("h4",{attrs:{id:"sentinelå®¢æˆ·ç«¯æ“ä½œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sentinelå®¢æˆ·ç«¯æ“ä½œ"}},[s._v("#")]),s._v(" Sentinelå®¢æˆ·ç«¯æ“ä½œ")]),s._v(" "),t("h5",{attrs:{id:"_1-å®¢æˆ·ç«¯å‘½ä»¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å®¢æˆ·ç«¯å‘½ä»¤"}},[s._v("#")]),s._v(" 1.å®¢æˆ·ç«¯å‘½ä»¤")]),s._v(" "),t("p",[s._v("Sentinel èŠ‚ç‚¹æ˜¯ä¸€ä¸ª"),t("strong",[s._v("ç‰¹æ®Šçš„ Redis èŠ‚ç‚¹")]),s._v(", å®ƒæœ‰è‡ªå·±"),t("strong",[s._v("ä¸“å±çš„ API")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("â‘  sentinel masters")]),s._v(": å±•ç¤ºæ‰€æœ‰è¢«ç›‘æ§çš„"),t("strong",[s._v("ä¸»èŠ‚ç‚¹")]),s._v("çŠ¶æ€ä»¥åŠç›¸å…³çš„ç»Ÿè®¡ä¿¡æ¯.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:2637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" sentinel masters\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mymaster-2"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ip"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"port"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6382"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".å¿½ç•¥"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mymaster-1"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ip"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"port"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6379"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".å¿½ç•¥"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[t("strong",[s._v("â‘¡ sentinel master (master name)")]),s._v(" : å±•ç¤ºæŒ‡å®š master name çš„"),t("strong",[s._v("ä¸»èŠ‚ç‚¹")]),s._v("çŠ¶æ€ä»¥åŠç›¸å…³çš„ç»Ÿè®¡ä¿¡æ¯.")]),s._v(" "),t("p",[t("strong",[s._v("â‘¢ sentinel slaves (master name)")]),s._v(" : å±•ç¤ºæŒ‡å®š master name çš„"),t("strong",[s._v("ä»èŠ‚ç‚¹")]),s._v("çŠ¶æ€ä»¥åŠç›¸å…³çš„ç»Ÿè®¡ä¿¡æ¯.")]),s._v(" "),t("p",[t("strong",[s._v("â‘£ sentinel sentinels (master name)")]),s._v(" : å±•ç¤ºæŒ‡å®š master name çš„ "),t("strong",[s._v("Sentinel èŠ‚ç‚¹é›†åˆ")]),s._v(", ä¸åŒ…å«å½“å‰ Sentinel èŠ‚ç‚¹.")]),s._v(" "),t("p",[t("strong",[s._v("â‘¤ sentinel failover (master name)")]),s._v(" : å¯¹æŒ‡å®š master name "),t("strong",[s._v("ä¸»èŠ‚ç‚¹è¿›è¡Œå¼ºåˆ¶æ•…éšœè½¬ç§»")]),s._v("(æ²¡æœ‰å’Œå…¶ä»– Sentinel èŠ‚ç‚¹åå•†), å½“æ•…éšœè½¬ç§»å®Œæˆå, å…¶ä»– Sentinel èŠ‚ç‚¹æŒ‰ç…§æ•…éšœè½¬ç§»çš„ç»“æœ"),t("strong",[s._v("æ›´æ–°è‡ªèº«é…ç½®")]),s._v(", è¿™ä¸ªå‘½ä»¤åœ¨ Redis Sentinel çš„"),t("strong",[s._v("æ—¥å¸¸è¿ç»´ä¸­éå¸¸æœ‰ç”¨")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:2637"),t("span",{pre:!0,attrs:{class:"token operator"}},[t("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("9")]),s._v(">")]),s._v(" sentinel failover mymaster-2\nOK\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("strong",[s._v("â‘¥ sentinel remove (master name)")]),s._v(" : å–æ¶ˆå¯¹æŸä¸ªä¸»èŠ‚ç‚¹çš„ç›‘æ§.")]),s._v(" "),t("h5",{attrs:{id:"_2-å®¢æˆ·ç«¯è¿æ¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å®¢æˆ·ç«¯è¿æ¥"}},[s._v("#")]),s._v(" 2.å®¢æˆ·ç«¯è¿æ¥")]),s._v(" "),t("h6",{attrs:{id:"_1-æ¦‚è¿°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ¦‚è¿°"}},[s._v("#")]),s._v(" (1)æ¦‚è¿°")]),s._v(" "),t("p",[t("strong",[s._v("å®¢æˆ·ç«¯åˆå§‹åŒ–æ—¶è¿æ¥")]),s._v("çš„æ˜¯ Sentinel "),t("strong",[s._v("èŠ‚ç‚¹é›†åˆ")]),s._v(", "),t("strong",[s._v("ä¸å†æ˜¯")]),s._v("å…·ä½“çš„ Redis èŠ‚ç‚¹, ä½† Sentinel åªæ˜¯é…ç½®ä¸­å¿ƒä¸æ˜¯ä»£ç†.")]),s._v(" "),t("p",[s._v("Sentinel èŠ‚ç‚¹é›†åˆå…·å¤‡äº†"),t("strong",[s._v("ç›‘æ§, é€šçŸ¥, è‡ªåŠ¨æ•…éšœè½¬ç§», é…ç½®æä¾›è€…è‹¥å¹²åŠŸèƒ½")]),s._v(", æ‰€ä»¥æœ€äº†è§£ä¸»èŠ‚ç‚¹ä¿¡æ¯çš„å°±æ˜¯ Sentinel èŠ‚ç‚¹é›†åˆ, è€Œå„ä¸ªä¸»èŠ‚ç‚¹å¯ä»¥é€šè¿‡ "),t("code",[s._v("<master-name>")]),s._v("â€‹ è¿›è¡Œæ ‡è¯†. å¦‚æœéœ€è¦æ­£ç¡®åœ°è¿æ¥ Redis Sentinel, å¿…é¡»æœ‰ "),t("strong",[s._v("Sentinel èŠ‚ç‚¹é›†åˆå’Œ masterName ä¸¤ä¸ªå‚æ•°")]),s._v(".")]),s._v(" "),t("p",[s._v("å®¢æˆ·ç«¯åŸºæœ¬æ“ä½œ:")]),s._v(" "),t("ul",[t("li",[s._v("éå† Sentinel èŠ‚ç‚¹é›†åˆè·å–ä¸€ä¸ªå¯ç”¨çš„ Sentinel èŠ‚ç‚¹, Sentinel èŠ‚ç‚¹ä¹‹é—´å¯ä»¥"),t("strong",[s._v("å…±äº«æ•°æ®")]),s._v(", æ‰€ä»¥ä»"),t("strong",[s._v("ä»»æ„")]),s._v("ä¸€ä¸ª Sentinel èŠ‚ç‚¹è·å–"),t("strong",[s._v("ä¸»èŠ‚ç‚¹")]),s._v("ä¿¡æ¯éƒ½æ˜¯å¯ä»¥çš„.")]),s._v(" "),t("li",[s._v("éœ€è¦"),t("strong",[s._v("éªŒè¯")]),s._v('å½“å‰è·å–çš„ "ä¸»èŠ‚ç‚¹" æ˜¯çœŸæ­£çš„ä¸»èŠ‚ç‚¹, è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢'),t("strong",[s._v("æ•…éšœè½¬ç§»æœŸé—´")]),s._v("ä¸»èŠ‚ç‚¹çš„å˜åŒ–.")]),s._v(" "),t("li",[s._v("ä¿æŒå’Œ Sentinel èŠ‚ç‚¹é›†åˆçš„è”ç³», æ—¶åˆ»è·å–å…³äºä¸»èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯.")])]),s._v(" "),t("h6",{attrs:{id:"_2-jedisæ“ä½œå“¨å…µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-jedisæ“ä½œå“¨å…µ"}},[s._v("#")]),s._v(" (2)Jedisæ“ä½œå“¨å…µ")]),s._v(" "),t("p",[s._v("Jedis ä¹Ÿæä¾›äº† "),t("strong",[s._v("Sentinel")]),s._v(" è¿æ¥æ± .")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisSentinelPool")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" masterName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¸»èŠ‚ç‚¹å")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Set")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" sentinels"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// SentinelèŠ‚ç‚¹é›†åˆ")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GenericObjectPoolConfig")]),s._v(" poolConfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// common-poolè¿æ¥æ± é…ç½®")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" connectionTimeout"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¿æ¥è¶…æ—¶")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" soTimeout"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¯»å†™è¶…æ—¶")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¸»èŠ‚ç‚¹å¯†ç ")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" database"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å½“å‰æ•°æ®åº“ç´¢å¼•")]),s._v("\n       "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" clientName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å®¢æˆ·ç«¯å")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("è¿æ¥æ—¶"),t("strong",[s._v("éå†")]),s._v(" Sentinel ç»“ç‚¹é›†åˆ, æ‰¾åˆ°ä¸€ä¸ªå¯ç”¨çš„ Sentinel ç»“ç‚¹, ç„¶åä»ä¸­å¾—åˆ°"),t("strong",[s._v("ä¸»èŠ‚ç‚¹ä¿¡æ¯")]),s._v(".")]),s._v(" "),t("p",[s._v("ç¤ºä¾‹ä»£ç :")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisSentinelTest")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IOException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisPoolConfig")]),s._v(" config "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisPoolConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setMaxTotal")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setMaxIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setMinIdle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" masterName "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mymaster"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Set")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" sentinels "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashSet")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        sentinels"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HostAndPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.60"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26379")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        sentinels"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HostAndPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.60"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26380")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        sentinels"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HostAndPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.0.60"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26381")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// JedisSentinelPoolå…¶å®æœ¬è´¨è·ŸJedisPoolç±»ä¼¼, éƒ½æ˜¯ä¸redisä¸»èŠ‚ç‚¹å»ºç«‹çš„è¿æ¥æ± ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// JedisSentinelPoolå¹¶ä¸æ˜¯è¯´ä¸sentinelå»ºç«‹çš„è¿æ¥æ± , è€Œæ˜¯é€šè¿‡sentinelå‘ç°redisä¸»èŠ‚ç‚¹å¹¶ä¸å…¶å»ºç«‹è¿æ¥")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisSentinelPool")]),s._v(" jedisSentinelPool "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("JedisSentinelPool")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("masterName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sentinels"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" config"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Jedis")]),s._v(" jedis "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            jedis "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" jedisSentinelPool"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getResource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sentinel"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zhuge"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sentinel"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ³¨æ„è¿™é‡Œä¸æ˜¯å…³é—­è¿æ¥, åœ¨JedisPoolæ¨¡å¼ä¸‹, Jedisä¼šè¢«å½’è¿˜ç»™èµ„æºæ± . ")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("jedis "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                jedis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])]),t("h6",{attrs:{id:"_3-spring-bootæ•´åˆå“¨å…µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-spring-bootæ•´åˆå“¨å…µ"}},[s._v("#")]),s._v(" (3)Spring Bootæ•´åˆå“¨å…µ")]),s._v(" "),t("p",[s._v("å¼•å…¥ç›¸å…³ä¾èµ–:")]),s._v(" "),t("div",{staticClass:"language-XML line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.springframework.boot"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("spring-boot-starter-data-redis"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.apache.commons"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("commons-pool2"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("Spring Boot é…ç½®:")]),s._v(" "),t("div",{staticClass:"language-YML line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("database")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("timeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sentinel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å“¨å…µæ¨¡å¼")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("master")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mymaster "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ä¸»æœåŠ¡å™¨æ‰€åœ¨é›†ç¾¤åç§°")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 192.168.0.60"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26379")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("192.168.0.60"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26380")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("192.168.0.60"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26381")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("lettuce")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pool")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-idle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("min-idle")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-active")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max-wait")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("ç¤ºä¾‹ä»£ç :")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RestController")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IndexController")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Logger")]),s._v(" logger "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("LoggerFactory")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getLogger")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("IndexController")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Autowired")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringRedisTemplate")]),s._v(" stringRedisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * æµ‹è¯•èŠ‚ç‚¹æŒ‚äº†å“¨å…µé‡æ–°é€‰ä¸¾æ–°çš„masterèŠ‚ç‚¹, å®¢æˆ·ç«¯æ˜¯å¦èƒ½åŠ¨æ€æ„ŸçŸ¥åˆ°\n     * æ–°çš„masteré€‰ä¸¾å‡ºæ¥å, å“¨å…µä¼šæŠŠæ¶ˆæ¯å‘å¸ƒå‡ºå», å®¢æˆ·ç«¯å®é™…ä¸Šæ˜¯å®ç°äº†ä¸€ä¸ªæ¶ˆæ¯ç›‘å¬æœºåˆ¶, \n     * å½“å“¨å…µæŠŠæ–°masterçš„æ¶ˆæ¯å‘å¸ƒå‡ºå», å®¢æˆ·ç«¯ä¼šç«‹é©¬æ„ŸçŸ¥åˆ°æ–°masterçš„ä¿¡æ¯, ä»è€ŒåŠ¨æ€åˆ‡æ¢è®¿é—®çš„masterip\n     *\n     * @throws InterruptedException\n     */")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@RequestMapping")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/test-sentinel"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testSentinel")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                stringRedisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zhuge"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"è®¾ç½®key: "')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zhuge"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                logger"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("error")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"é”™è¯¯: "')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])]),t("blockquote",[t("p",[s._v("StringRedisTemplateä¸RedisTemplate")])]),s._v(" "),t("p",[s._v("Spring å°è£…äº† "),t("strong",[s._v("RedisTemplate å¯¹è±¡")]),s._v("æ¥è¿›è¡Œå¯¹ Redis çš„å„ç§æ“ä½œ, å®ƒæ”¯æŒæ‰€æœ‰çš„ Redis åŸç”Ÿçš„ api. åœ¨ RedisTemplate ä¸­æä¾›äº†å‡ ä¸ªå¸¸ç”¨çš„æ¥å£æ–¹æ³•çš„ä½¿ç”¨, åˆ†åˆ«æ˜¯:")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ValueOperations")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" valueOps"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashOperations")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" hashOps"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ListOperations")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" listOps"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SetOperations")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" setOps"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ZSetOperations")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("V")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" zSetOps"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("RedisTemplate ä¸­å®šä¹‰äº†å¯¹ 5 ç§æ•°æ®ç»“æ„æ“ä½œ")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("redisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForValue")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ“ä½œå­—ç¬¦ä¸²")]),s._v("\nredisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForHash")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ“ä½œhash")]),s._v("\nredisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ“ä½œlist")]),s._v("\nredisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForSet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ“ä½œset")]),s._v("\nredisTemplate"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("opsForZSet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ“ä½œæœ‰åºset")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("StringRedisTemplate ç»§æ‰¿è‡ª RedisTemplate, ä¹Ÿä¸€æ ·æ‹¥æœ‰ä¸Šé¢è¿™äº›æ“ä½œ.")]),s._v(" "),t("p",[s._v("StringRedisTemplate é»˜è®¤é‡‡ç”¨çš„æ˜¯ String çš„åºåˆ—åŒ–ç­–ç•¥, ä¿å­˜çš„ key å’Œ value éƒ½æ˜¯é‡‡ç”¨æ­¤ç­–ç•¥åºåˆ—åŒ–ä¿å­˜çš„.")]),s._v(" "),t("p",[s._v("RedisTemplate é»˜è®¤é‡‡ç”¨çš„æ˜¯ JDK çš„åºåˆ—åŒ–ç­–ç•¥, ä¿å­˜çš„ key å’Œ value éƒ½æ˜¯é‡‡ç”¨æ­¤ç­–ç•¥åºåˆ—åŒ–ä¿å­˜çš„.")]),s._v(" "),t("h4",{attrs:{id:"å“¨å…µå®ç°åŸç†ğŸŒŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å“¨å…µå®ç°åŸç†ğŸŒŸ"}},[s._v("#")]),s._v(" å“¨å…µå®ç°åŸç†ğŸŒŸ")]),s._v(" "),t("p",[s._v("ä¸‹é¢è¯¦ç»†ä»‹ç»ä¸€ä¸‹å“¨å…µæœºåˆ¶æ˜¯å¦‚ä½•å®ç°çš„.")]),s._v(" "),t("h5",{attrs:{id:"_1-ä¸‰ä¸ªå®šæ—¶ç›‘æ§ä»»åŠ¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ä¸‰ä¸ªå®šæ—¶ç›‘æ§ä»»åŠ¡"}},[s._v("#")]),s._v(" 1.ä¸‰ä¸ªå®šæ—¶ç›‘æ§ä»»åŠ¡")]),s._v(" "),t("p",[s._v("ä¸€å¥—åˆç†çš„ç›‘æ§æœºåˆ¶æ˜¯ Sentinel èŠ‚ç‚¹åˆ¤å®šèŠ‚ç‚¹"),t("strong",[s._v("ä¸å¯è¾¾")]),s._v("çš„é‡è¦ä¿è¯, Redis Sentinel é€šè¿‡"),t("strong",[s._v("ä¸‰ä¸ªå®šæ—¶ç›‘æ§ä»»åŠ¡")]),s._v("å®Œæˆå¯¹å„ä¸ªèŠ‚ç‚¹å‘ç°å’Œç›‘æ§.")]),s._v(" "),t("h6",{attrs:{id:"_1-sentinelä¸æ•°æ®ç»“ç‚¹çš„å®šæ—¶ä»»åŠ¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-sentinelä¸æ•°æ®ç»“ç‚¹çš„å®šæ—¶ä»»åŠ¡"}},[s._v("#")]),s._v(" (1)Sentinelä¸æ•°æ®ç»“ç‚¹çš„å®šæ—¶ä»»åŠ¡")]),s._v(" "),t("p",[t("strong",[s._v("æ¯éš” 10 ç§’, æ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šå‘ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹å‘é€ info å‘½ä»¤è·å–æœ€æ–°çš„æ‹“æ‰‘ç»“æ„")]),s._v(".")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523213535648.png",alt:""}})]),s._v(" "),t("p",[s._v("å¦‚åœ¨ä¸€ä¸ªä¸»èŠ‚ç‚¹æ‰§è¡Œ "),t("strong",[s._v("info replication")]),s._v(" å‘½ä»¤.")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Replication")]),s._v("\nrole:master\nconnected_slaves:2\nslave0:ip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1,port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6380")]),s._v(",state"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("online,offset"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4917")]),s._v(",lag"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nslave1:ip"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1,port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6381")]),s._v(",state"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("online,offset"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4917")]),s._v(",lag"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("Sentinel èŠ‚ç‚¹é€šè¿‡å¯¹ä¸Šè¿°ç»“æœè¿›è¡Œ"),t("strong",[s._v("è§£æ")]),s._v("å°±å¯ä»¥æ‰¾åˆ°ç›¸åº”çš„"),t("strong",[s._v("ä»èŠ‚ç‚¹")]),s._v(".")]),s._v(" "),t("p",[s._v("è¿™ä¸ªå®šæ—¶ä»»åŠ¡çš„ä½œç”¨æœ‰:")]),s._v(" "),t("ul",[t("li",[s._v("é€šè¿‡å‘ä¸»èŠ‚ç‚¹æ‰§è¡Œ info å‘½ä»¤, è·å–ä»èŠ‚ç‚¹çš„ä¿¡æ¯, å› æ­¤ Sentinel èŠ‚ç‚¹æ— éœ€æ˜¾å¼é…ç½®ç›‘æ§ä»èŠ‚ç‚¹.")]),s._v(" "),t("li",[s._v("å½“æœ‰æ–°çš„ä»èŠ‚ç‚¹åŠ å…¥æ—¶éƒ½å¯ä»¥"),t("strong",[s._v("ç«‹åˆ»æ„ŸçŸ¥")]),s._v("å‡ºæ¥.")]),s._v(" "),t("li",[s._v("èŠ‚ç‚¹ä¸å¯è¾¾æˆ–è€…æ•…éšœè½¬ç§»å, å¯ä»¥é€šè¿‡ info å‘½ä»¤å®æ—¶"),t("strong",[s._v("æ›´æ–°")]),s._v("èŠ‚ç‚¹æ‹“æ‰‘ä¿¡æ¯.")])]),s._v(" "),t("h6",{attrs:{id:"_2-sentinelä¹‹é—´çš„å®šæ—¶ä»»åŠ¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-sentinelä¹‹é—´çš„å®šæ—¶ä»»åŠ¡"}},[s._v("#")]),s._v(" (2)Sentinelä¹‹é—´çš„å®šæ—¶ä»»åŠ¡")]),s._v(" "),t("p",[s._v("æ¯éš” "),t("strong",[s._v("2 ç§’")]),s._v(", "),t("strong",[s._v("æ¯ä¸ª Sentinel èŠ‚ç‚¹")]),s._v("ä¼šå‘ Redis "),t("strong",[s._v("æ•°æ®èŠ‚ç‚¹")]),s._v("çš„ "),t("strong",[t("strong",[s._v("sentinel")])]),s._v("â€‹ "),t("strong",[s._v(": hello")]),s._v(" é¢‘é“ä¸Šå‘é€è¯¥ Sentinel èŠ‚ç‚¹å¯¹äº"),t("strong",[s._v("ä¸»èŠ‚ç‚¹çš„åˆ¤æ–­")]),s._v("ä»¥åŠå½“å‰ Sentinel "),t("strong",[s._v("èŠ‚ç‚¹çš„ä¿¡æ¯")]),s._v(", åŒæ—¶æ¯ä¸ª Sentinel èŠ‚ç‚¹ä¹Ÿä¼š"),t("strong",[s._v("è®¢é˜…è¯¥é¢‘é“")]),s._v(", æ¥äº†è§£å…¶ä»– Sentinel èŠ‚ç‚¹ä»¥åŠå®ƒä»¬å¯¹ä¸»èŠ‚ç‚¹çš„åˆ¤æ–­.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523213648378.png",alt:""}})]),s._v(" "),t("p",[s._v("è¿™ä¸ªå®šæ—¶ä»»åŠ¡çš„ä½œç”¨:")]),s._v(" "),t("ul",[t("li",[s._v("å‘ç°"),t("strong",[s._v("æ–°çš„ Sentinel èŠ‚ç‚¹")]),s._v(": é€šè¿‡è®¢é˜…ä¸»èŠ‚ç‚¹çš„ "),t("code",[s._v("_sentinel_: hello")]),s._v("â€‹ äº†è§£å…¶ä»–çš„ Sentinel èŠ‚ç‚¹ä¿¡æ¯, å¦‚æœæ˜¯æ–°åŠ å…¥çš„ Sentinel èŠ‚ç‚¹, å°†è¯¥ Sentinel èŠ‚ç‚¹ä¿¡æ¯ä¿å­˜èµ·æ¥, å¹¶ä¸è¯¥ Sentinel èŠ‚ç‚¹åˆ›å»ºè¿æ¥.")]),s._v(" "),t("li",[s._v("Sentinel èŠ‚ç‚¹ä¹‹é—´"),t("strong",[s._v("äº¤æ¢ä¸»èŠ‚ç‚¹çš„çŠ¶æ€")]),s._v(", ä½œä¸ºåé¢"),t("strong",[s._v("å®¢è§‚ä¸‹çº¿")]),s._v("ä»¥åŠ"),t("strong",[s._v("é¢†å¯¼è€…é€‰ä¸¾")]),s._v("çš„ä¾æ®.")])]),s._v(" "),t("h6",{attrs:{id:"_3-å¿ƒè·³å®šæ—¶ä»»åŠ¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-å¿ƒè·³å®šæ—¶ä»»åŠ¡"}},[s._v("#")]),s._v(" (3)å¿ƒè·³å®šæ—¶ä»»åŠ¡")]),s._v(" "),t("p",[s._v("æ¯éš” 1 ç§’, æ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šå‘"),t("strong",[s._v("ä¸»èŠ‚ç‚¹, ä»èŠ‚ç‚¹, å…¶ä½™ Sentinel èŠ‚ç‚¹")]),s._v("å‘é€ä¸€æ¡ "),t("strong",[s._v("ping å‘½ä»¤åšä¸€æ¬¡å¿ƒè·³æ£€æµ‹")]),s._v(", æ¥ç¡®è®¤è¿™äº›èŠ‚ç‚¹å½“å‰"),t("strong",[s._v("æ˜¯å¦å¯è¾¾")]),s._v(". é€šè¿‡ä¸Šé¢çš„å®šæ—¶ä»»åŠ¡, Sentinel èŠ‚ç‚¹å¯¹ä¸»èŠ‚ç‚¹, ä»èŠ‚ç‚¹, å…¶ä½™ Sentinel èŠ‚ç‚¹"),t("strong",[s._v("éƒ½å»ºç«‹èµ·è¿æ¥")]),s._v(", å®ç°äº†å¯¹"),t("strong",[s._v("æ¯ä¸ªèŠ‚ç‚¹")]),s._v("çš„ç›‘æ§, è¿™ä¸ªå®šæ—¶ä»»åŠ¡æ˜¯èŠ‚ç‚¹å¤±è´¥åˆ¤å®šçš„é‡è¦ä¾æ®.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523213736868.png",alt:""}})]),s._v(" "),t("h5",{attrs:{id:"_2-ä¸»è§‚ä¸‹çº¿ä¸å®¢è§‚ä¸‹çº¿"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ä¸»è§‚ä¸‹çº¿ä¸å®¢è§‚ä¸‹çº¿"}},[s._v("#")]),s._v(" 2.ä¸»è§‚ä¸‹çº¿ä¸å®¢è§‚ä¸‹çº¿")]),s._v(" "),t("h6",{attrs:{id:"_1-ä¸»è§‚ä¸‹çº¿"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ä¸»è§‚ä¸‹çº¿"}},[s._v("#")]),s._v(" (1)ä¸»è§‚ä¸‹çº¿")]),s._v(" "),t("p",[t("strong",[s._v("æ¯ä¸ª Sentinel èŠ‚ç‚¹")]),s._v("ä¼šæ¯éš” 1 ç§’å¯¹ä¸»èŠ‚ç‚¹, ä»èŠ‚ç‚¹, å…¶ä»– Sentinel èŠ‚ç‚¹å‘é€ ping å‘½ä»¤åš"),t("strong",[s._v("å¿ƒè·³æ£€æµ‹")]),s._v(", å½“è¿™äº›èŠ‚ç‚¹è¶…è¿‡ down-after-milliseconds "),t("strong",[s._v("æ²¡æœ‰è¿›è¡Œæœ‰æ•ˆå›å¤")]),s._v(", è¿™ä¸ª Sentinel èŠ‚ç‚¹å°±ä¼šå¯¹"),t("strong",[s._v("è¯¥èŠ‚ç‚¹åšå¤±è´¥åˆ¤å®š")]),s._v(", è¿™ä¸ªè¡Œä¸ºå«åš"),t("strong",[s._v("ä¸»è§‚ä¸‹çº¿")]),s._v(".")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523213813042.png",alt:""}})]),s._v(" "),t("p",[s._v("ä»å­—é¢æ„æ€ä¹Ÿå¯ä»¥çœ‹å‡ºä¸»è§‚ä¸‹çº¿æ˜¯"),t("strong",[s._v("å½“å‰ Sentinel èŠ‚ç‚¹çš„ä¸€å®¶ä¹‹è¨€")]),s._v(", å­˜åœ¨"),t("strong",[s._v("è¯¯åˆ¤")]),s._v("çš„å¯èƒ½. ä¹Ÿå°±æ˜¯å¯èƒ½å°±è¿™ä¸€ä¸ª Sentinel è®¤ä¸ºä¸€ä¸ªç»“ç‚¹æ˜¯ä¸‹çº¿äº†.")]),s._v(" "),t("h6",{attrs:{id:"_2-å®¢è§‚ä¸‹çº¿"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å®¢è§‚ä¸‹çº¿"}},[s._v("#")]),s._v(" (2)å®¢è§‚ä¸‹çº¿")]),s._v(" "),t("p",[s._v("å½“ Sentinel ä¸»è§‚ä¸‹çº¿çš„èŠ‚ç‚¹æ˜¯"),t("strong",[s._v("ä¸»èŠ‚ç‚¹")]),s._v("æ—¶, è¯¥ Sentinel èŠ‚ç‚¹ä¼šé€šè¿‡ "),t("code",[s._v("sentinel ismaster-down-by-addr")]),s._v("â€‹ å‘½ä»¤å‘å…¶ä»– Sentinel èŠ‚ç‚¹"),t("strong",[s._v("è¯¢é—®å¯¹ä¸»èŠ‚ç‚¹çš„åˆ¤æ–­")]),s._v(", å½“è¶…è¿‡ â€‹"),t("code",[s._v("quorum")]),s._v("â€‹ ä¸ªæ•°, Sentinel èŠ‚ç‚¹è®¤ä¸ºä¸»èŠ‚ç‚¹"),t("strong",[s._v("ç¡®å®æœ‰é—®é¢˜")]),s._v(", è¿™æ—¶è¯¥ Sentinel èŠ‚ç‚¹ä¼š"),t("strong",[s._v("åšå‡ºå®¢è§‚ä¸‹çº¿")]),s._v("çš„å†³å®š, ä¹Ÿå°±æ˜¯å¤§éƒ¨åˆ† Sentinel èŠ‚ç‚¹éƒ½å¯¹ä¸»èŠ‚ç‚¹çš„ä¸‹çº¿åšäº†åŒæ„çš„åˆ¤å®š, é‚£ä¹ˆè¿™ä¸ªåˆ¤å®šå°±æ˜¯"),t("strong",[s._v("å®¢è§‚")]),s._v("çš„.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523213901063.png",alt:""}})]),s._v(" "),t("p",[s._v("æ³¨æ„: "),t("strong",[s._v("ä»èŠ‚ç‚¹, Sentinel èŠ‚ç‚¹åœ¨ä¸»è§‚ä¸‹çº¿å, æ²¡æœ‰åç»­çš„æ•…éšœè½¬ç§»æ“ä½œ")]),s._v(". "),t("strong",[s._v("åªå¯¹ä¸»èŠ‚ç‚¹åšæ•…éšœè½¬ç§»")]),s._v(".")]),s._v(" "),t("h5",{attrs:{id:"_3-é¢†å¯¼è€…sentinelé€‰ä¸¾"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-é¢†å¯¼è€…sentinelé€‰ä¸¾"}},[s._v("#")]),s._v(" 3.é¢†å¯¼è€…Sentinelé€‰ä¸¾")]),s._v(" "),t("p",[s._v("å‡å¦‚ Sentinel èŠ‚ç‚¹å¯¹äº"),t("strong",[s._v("ä¸»èŠ‚ç‚¹")]),s._v("å·²ç»åšäº†"),t("strong",[s._v("å®¢è§‚ä¸‹çº¿")]),s._v(", å¹¶ä¸æ˜¯é©¬ä¸Šè¿›è¡Œæ•…éšœè½¬ç§». å®é™…ä¸Š"),t("strong",[s._v("æ•…éšœè½¬ç§»çš„å·¥ä½œ")]),s._v("åªéœ€è¦"),t("strong",[s._v("ä¸€ä¸ª Sentinel èŠ‚ç‚¹æ¥å®Œæˆ")]),s._v("å³å¯, æ‰€ä»¥ Sentinel èŠ‚ç‚¹ä¹‹é—´ä¼šåšä¸€ä¸ª"),t("strong",[s._v("é¢†å¯¼è€…é€‰ä¸¾")]),s._v("çš„å·¥ä½œ, é€‰å‡ºä¸€ä¸ª Sentinel èŠ‚ç‚¹"),t("strong",[s._v("ä½œä¸ºé¢†å¯¼è€…è¿›è¡Œæ•…éšœè½¬ç§»")]),s._v("çš„å·¥ä½œ. Redis ä½¿ç”¨äº† "),t("mark",[t("strong",[s._v("Raft ç®—æ³•")])]),s._v("å®ç°é¢†å¯¼è€…é€‰ä¸¾(å‚è€ƒ: Raftç®—æ³•).")]),s._v(" "),t("p",[s._v("å¤§è‡´æµç¨‹å¦‚ä¸‹:")]),s._v(" "),t("p",[s._v("(1) æ¯ä¸ªåœ¨çº¿çš„ Sentinel èŠ‚ç‚¹éƒ½æœ‰èµ„æ ¼æˆä¸ºé¢†å¯¼è€…, å½“å®ƒç¡®è®¤ä¸»èŠ‚ç‚¹ä¸»è§‚ä¸‹çº¿æ—¶å€™, ä¼šå‘å…¶ä»– Sentinel èŠ‚ç‚¹å‘é€ "),t("code",[s._v("sentinel is-master-down-by-addr")]),s._v("â€‹ å‘½ä»¤, è¦æ±‚"),t("strong",[s._v("å°†è‡ªå·±")]),s._v("è®¾ç½®ä¸ºé¢†å¯¼è€….")]),s._v(" "),t("p",[s._v("(2) æ”¶åˆ°å‘½ä»¤çš„ Sentinel èŠ‚ç‚¹, å¦‚æœæ²¡æœ‰åŒæ„è¿‡å…¶ä»– Sentinel èŠ‚ç‚¹çš„ "),t("code",[s._v("sentinel is-master-down-by-addr")]),s._v("â€‹ å‘½ä»¤, å°†"),t("strong",[s._v("åŒæ„")]),s._v("è¯¥è¯·æ±‚, å¦åˆ™æ‹’ç».")]),s._v(" "),t("p",[s._v("(3) å¦‚æœè¯¥ Sentinel èŠ‚ç‚¹å‘ç°"),t("strong",[s._v("è‡ªå·±çš„ç¥¨æ•°å·²ç»å¤§äºç­‰äº max(quorum, num(sentinels) / 2 + 1)")]),s._v(" , é‚£ä¹ˆå®ƒå°†æˆä¸º"),t("strong",[s._v("é¢†å¯¼è€…")]),s._v(". æ¯ä¸ª Sentinel èŠ‚ç‚¹åªæœ‰"),t("strong",[s._v("ä¸€ç¥¨")]),s._v(".")]),s._v(" "),t("p",[s._v("(4) å¦‚æœæ­¤è¿‡ç¨‹æ²¡æœ‰é€‰ä¸¾å‡ºé¢†å¯¼è€…, å°†è¿›å…¥"),t("strong",[s._v("ä¸‹ä¸€æ¬¡")]),s._v("é€‰ä¸¾.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20200725150625390.png",alt:""}})]),s._v(" "),t("p",[s._v("é€‰ä¸¾çš„è¿‡ç¨‹éå¸¸å¿«, åŸºæœ¬ä¸Šè°å…ˆå®Œæˆå®¢è§‚ä¸‹çº¿, è°å°±æ˜¯é¢†å¯¼è€…. æ³¨æ„è¿™é‡Œåªæ˜¯é€‰ä¸¾ä¸€ä¸ª Sentinel é¢†å¯¼èŠ‚ç‚¹è¿›è¡Œæ•…éšœè½¬ç§», è€Œä¸æ˜¯é€‰ä¸¾ä¸»èŠ‚ç‚¹. ä¸‹é¢ä»‹ç»çš„æ‰æ˜¯ç”±é€‰ä¸¾å‡ºæ¥çš„ Sentinel é¢†å¯¼èŠ‚ç‚¹ä¸»å¯¼è¿›è¡Œæ•…éšœè½¬ç§»çš„è¿‡ç¨‹.")]),s._v(" "),t("h5",{attrs:{id:"_4-æ•…éšœè½¬ç§»è¿‡ç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-æ•…éšœè½¬ç§»è¿‡ç¨‹"}},[s._v("#")]),s._v(" 4.æ•…éšœè½¬ç§»è¿‡ç¨‹")]),s._v(" "),t("p",[s._v("æ•…éšœè½¬ç§»è¿‡ç¨‹å¦‚ä¸‹. æ•…éšœè½¬ç§»æ¯ä¸€æ­¥éƒ½å¯ä»¥é€šè¿‡"),t("strong",[s._v("å‘å¸ƒè®¢é˜…")]),s._v("æ¥è·å–.")]),s._v(" "),t("p",[s._v("(1) åŠ å…¥ä¸»èŠ‚ç‚¹å‡ºç°"),t("strong",[s._v("æ•…éšœ")]),s._v(", æ­¤æ—¶ä¸¤ä¸ªä»èŠ‚ç‚¹ä¸ä¸»èŠ‚ç‚¹"),t("strong",[s._v("å¤±å»è¿æ¥")]),s._v(", "),t("strong",[s._v("ä¸»ä»å¤åˆ¶å¤±è´¥")]),s._v(".")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523214205176.png",alt:""}})]),s._v(" "),t("p",[s._v("(2) æ¯ä¸ª Sentinel èŠ‚ç‚¹é€šè¿‡"),t("strong",[s._v("å®šæœŸç›‘æ§")]),s._v("å‘ç°ä¸»èŠ‚ç‚¹å‡ºç°äº†æ•…éšœ.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523214232398.png",alt:""}})]),s._v(" "),t("p",[s._v("(3) å¤šä¸ª Sentinel èŠ‚ç‚¹"),t("strong",[s._v("å¯¹ä¸»èŠ‚ç‚¹çš„æ•…éšœè¾¾æˆä¸€è‡´")]),s._v(", "),t("strong",[s._v("é€‰ä¸¾å‡º sentinel-3 èŠ‚ç‚¹ä½œä¸º")]),s._v("â€‹"),t("mark",[t("strong",[s._v("é¢†å¯¼è€…è´Ÿè´£æ•…éšœè½¬ç§»")])]),s._v(".")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523214302088.png",alt:""}})]),s._v(" "),t("p",[s._v("(4) Sentinel é¢†å¯¼è€…èŠ‚ç‚¹æ‰§è¡Œäº†"),t("strong",[s._v("æ•…éšœè½¬ç§»")]),s._v(". æµç¨‹å¦‚ä¸‹.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523214329887.png",alt:""}})]),s._v(" "),t("p",[t("strong",[s._v("éœ€è¦åœ¨ä»èŠ‚ç‚¹åˆ—è¡¨ä¸­é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºæ–°çš„ä¸»èŠ‚ç‚¹")]),s._v(', é€‰æ‹©æ–¹æ³•æœ‰: (1)è¿‡æ»¤ "ä¸å¥åº·" çš„èŠ‚ç‚¹; (2)é€‰æ‹© '),t("strong",[s._v("salve-priority")]),s._v(" æœ€é«˜çš„ä»èŠ‚ç‚¹åˆ—è¡¨; (3)é€‰æ‹©"),t("strong",[s._v("å¤åˆ¶åç§»é‡æœ€å¤§(å¤åˆ¶æ•°æ®æœ€å®Œæ•´)")]),s._v(" çš„èŠ‚ç‚¹; (4)é€‰æ‹© runid æœ€å°çš„ä»èŠ‚ç‚¹.")]),s._v(" "),t("ul",[t("li",[s._v("å‡è®¾è¿™é‡Œä»èŠ‚ç‚¹ 1 å˜æˆä¸»èŠ‚ç‚¹.")]),s._v(" "),t("li",[s._v("Sentinel é¢†å¯¼è€…èŠ‚ç‚¹ä¼šå¯¹é€‰å‡ºæ¥çš„ä»èŠ‚ç‚¹æ‰§è¡Œ "),t("code",[s._v("slaveof no one")]),s._v("â€‹ å‘½ä»¤è®©å…¶æˆä¸º"),t("strong",[s._v("ä¸»èŠ‚ç‚¹")]),s._v(", æ­¤æ—¶åŸæ¥çš„ä»èŠ‚ç‚¹ 1 å˜æˆæ–°çš„ä¸»èŠ‚ç‚¹.")]),s._v(" "),t("li",[s._v("Sentinel é¢†å¯¼è€…èŠ‚ç‚¹ä¼šå‘"),t("strong",[s._v("å‰©ä½™çš„ä»èŠ‚ç‚¹")]),s._v("å‘é€å‘½ä»¤, è®©å®ƒä»¬æˆä¸ºæ–°ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹, "),t("strong",[s._v("å¤åˆ¶è§„åˆ™")]),s._v("å’Œ parallel-syncs å‚æ•°æœ‰å…³.")]),s._v(" "),t("li",[s._v("ç„¶å Sentinel é¢†å¯¼è€…èŠ‚ç‚¹"),t("strong",[s._v("é€šçŸ¥")]),s._v("å®¢æˆ·ç«¯.")]),s._v(" "),t("li",[s._v("æœ€ååŸæ¥çš„æ•…éšœä¸»èŠ‚ç‚¹"),t("strong",[s._v("é‡å¯")]),s._v("æˆä¸ºä¸€ä¸ª"),t("strong",[s._v("ä»èŠ‚ç‚¹")]),s._v(".")])]),s._v(" "),t("p",[t("strong",[s._v("æ•…éšœè½¬ç§»å")]),s._v("æ•´ä¸ª Redis Sentinel çš„"),t("strong",[s._v("æ‹“æ‰‘ç»“æ„å›¾")]),s._v("å¦‚ä¸‹.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523214440695.png",alt:""}})]),s._v(" "),t("p",[s._v("æ•´ä¸ªæ•…éšœè½¬ç§»è¿‡ç¨‹ä¼šäº§ç”Ÿå¤§é‡çš„"),t("strong",[s._v("æ—¥å¿—")]),s._v(", å¦‚æœ‰éœ€è¦å†çœ‹çœ‹.")]),s._v(" "),t("h4",{attrs:{id:"é«˜å¯ç”¨è¯»å†™åˆ†ç¦»ğŸŒŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é«˜å¯ç”¨è¯»å†™åˆ†ç¦»ğŸŒŸ"}},[s._v("#")]),s._v(" é«˜å¯ç”¨è¯»å†™åˆ†ç¦»ğŸŒŸ")]),s._v(" "),t("p",[s._v("Sentinel å®ç°"),t("strong",[s._v("è¯»å†™åˆ†ç¦»é«˜å¯ç”¨")]),s._v("å¯ä»¥ä¾èµ– Sentinel èŠ‚ç‚¹çš„"),t("strong",[s._v("æ¶ˆæ¯é€šçŸ¥")]),s._v(", è·å– Redis æ•°æ®èŠ‚ç‚¹çš„"),t("strong",[s._v("çŠ¶æ€å˜åŒ–")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("ä»èŠ‚ç‚¹")]),s._v("çš„ä½œç”¨:")]),s._v(" "),t("ul",[t("li",[s._v("å½“ä¸»èŠ‚ç‚¹å‡ºç°æ•…éšœæ—¶, ä½œä¸ºä¸»èŠ‚ç‚¹çš„åå¤‡é¡¶ä¸Šæ¥å®ç°"),t("strong",[s._v("æ•…éšœè½¬ç§»")]),s._v(", Redis Sentinel å·²ç»å®ç°äº†è¯¥åŠŸèƒ½çš„è‡ªåŠ¨åŒ–, å®ç°äº†çœŸæ­£çš„é«˜å¯ç”¨.")]),s._v(" "),t("li",[s._v("æ‰©å±•ä¸»èŠ‚ç‚¹çš„"),t("strong",[s._v("è¯»èƒ½åŠ›")]),s._v(", å°¤å…¶æ˜¯åœ¨"),t("strong",[s._v("è¯»å¤šå†™å°‘çš„åœºæ™¯")]),s._v("éå¸¸é€‚ç”¨.")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523214621694.png",alt:""}})]),s._v(" "),t("p",[s._v("ä½†ä¸Šè¿°æ¨¡å‹ä¸­, ä»èŠ‚ç‚¹"),t("strong",[s._v("ä¸æ˜¯é«˜å¯ç”¨")]),s._v("çš„, å¦‚æœ slave-1 èŠ‚ç‚¹"),t("strong",[s._v("å‡ºç°æ•…éšœ")]),s._v(", é¦–å…ˆå®¢æˆ·ç«¯ client-1 å°†ä¸å…¶"),t("strong",[s._v("å¤±è”")]),s._v(", å…¶æ¬¡ Sentinel èŠ‚ç‚¹åªä¼šå¯¹è¯¥èŠ‚ç‚¹åš"),t("strong",[s._v("ä¸»è§‚ä¸‹çº¿")]),s._v(", å› ä¸º Redis Sentinel çš„"),t("strong",[s._v("æ•…éšœè½¬ç§»æ˜¯é’ˆå¯¹ä¸»èŠ‚ç‚¹")]),s._v("çš„.")]),s._v(" "),t("p",[s._v("æ‰€ä»¥å¾ˆå¤šæ—¶å€™ Redis Sentinel ä¸­çš„"),t("strong",[s._v("ä»èŠ‚ç‚¹ä»…ä»…æ˜¯ä½œä¸ºä¸»èŠ‚ç‚¹ä¸€ä¸ªçƒ­å¤‡")]),s._v(", ä¸è®©å®ƒå‚ä¸å®¢æˆ·ç«¯çš„è¯»æ“ä½œ, å°±æ˜¯ä¸ºäº†ä¿è¯æ•´ä½“é«˜å¯ç”¨æ€§, ä½†å®é™…ä¸Šè¿™ç§ä½¿ç”¨æ–¹æ³•è¿˜æ˜¯æœ‰ä¸€äº›æµªè´¹, å°¤å…¶æ˜¯åœ¨æœ‰å¾ˆå¤šä»èŠ‚ç‚¹æˆ–è€…ç¡®å®éœ€è¦è¯»å†™åˆ†ç¦»çš„åœºæ™¯, æ‰€ä»¥"),t("strong",[s._v("å¦‚ä½•å®ç°ä»èŠ‚ç‚¹çš„é«˜å¯ç”¨")]),s._v("æ˜¯éå¸¸æœ‰å¿…è¦çš„.")]),s._v(" "),t("p",[t("strong",[s._v("Redis Sentinel è¯»å†™åˆ†ç¦»è®¾è®¡æ€è·¯")]),s._v(": Sentinel åœ¨å¯¹å„ä¸ªèŠ‚ç‚¹çš„ç›‘æ§ä¸­, å¦‚æœæœ‰å¯¹åº”"),t("strong",[s._v("äº‹ä»¶")]),s._v("çš„å‘ç”Ÿ, éƒ½ä¼šå‘å‡ºç›¸åº”çš„"),t("strong",[s._v("äº‹ä»¶æ¶ˆæ¯")]),s._v(". åœ¨è®¾è®¡ Redis Sentinel çš„"),t("strong",[s._v("ä»èŠ‚ç‚¹é«˜å¯ç”¨")]),s._v("æ—¶, åªè¦èƒ½å¤Ÿå®æ—¶æŒæ¡"),t("strong",[s._v("æ‰€æœ‰ä»èŠ‚ç‚¹çš„çŠ¶æ€")]),s._v(", æŠŠæ‰€æœ‰ä»èŠ‚ç‚¹çœ‹åšä¸€ä¸ª"),t("strong",[s._v("èµ„æºæ± ")]),s._v(", æ— è®ºæ˜¯ä¸Šçº¿è¿˜æ˜¯ä¸‹çº¿ä»èŠ‚ç‚¹, å®¢æˆ·ç«¯éƒ½èƒ½"),t("strong",[s._v("åŠæ—¶æ„ŸçŸ¥")]),s._v("åˆ°(å°†å…¶ä»èµ„æºæ± ä¸­æ·»åŠ æˆ–è€…åˆ é™¤), è¿™æ ·ä»èŠ‚ç‚¹çš„é«˜å¯ç”¨ç›®æ ‡å°±è¾¾åˆ°äº†.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220523214707545.png",alt:""}})]),s._v(" "),t("p",[s._v("â€")]),s._v(" "),t("p",[s._v("â€")]),s._v(" "),t("h4",{attrs:{id:"å‚è€ƒèµ„æ–™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒèµ„æ–™"}},[s._v("#")]),s._v(" å‚è€ƒèµ„æ–™")]),s._v(" "),t("ul",[t("li",[s._v("ã€ŠRediså¼€å‘ä¸è¿ç»´ã€‹")])])])}),[],!1,null,null,null);t.default=e.exports}}]);