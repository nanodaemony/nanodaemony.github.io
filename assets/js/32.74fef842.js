(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{346:function(t,s,_){"use strict";_.r(s);var v=_(7),r=Object(v.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_5-ioæ¨¡å‹ğŸŒ¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-ioæ¨¡å‹ğŸŒ¼"}},[t._v("#")]),t._v(" 5.IOæ¨¡å‹ğŸŒ¼")]),t._v(" "),s("p",[t._v("è¿™é‡Œä»‹ç»ä¸‹æ“ä½œç³»ç»Ÿä¸­çš„ IO æ¨¡å‹, "),s("strong",[t._v("IO æ¨¡å‹ç®€å•æ¥è¯´å°±æ˜¯ç”¨ä»€ä¹ˆæ ·çš„é€šé“è¿›è¡Œæ•°æ®çš„å‘é€å’Œæ¥æ”¶")]),t._v(". Java ä¸­ä¹Ÿå¯¹è¿™äº›æ¨¡å‹è¿›è¡Œäº†å°è£…, å…·ä½“å¯ä»¥å‚è€ƒ Javaç½‘ç»œIOæ¨¡å‹.")]),t._v(" "),s("h4",{attrs:{id:"åŸºç¡€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åŸºç¡€"}},[t._v("#")]),t._v(" åŸºç¡€")]),t._v(" "),s("h5",{attrs:{id:"_1-åŒæ­¥ä¸å¼‚æ­¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-åŒæ­¥ä¸å¼‚æ­¥"}},[t._v("#")]),t._v(" 1.åŒæ­¥ä¸å¼‚æ­¥")]),t._v(" "),s("p",[s("strong",[t._v("åŒæ­¥å’Œå¼‚æ­¥")]),t._v("æ˜¯é’ˆå¯¹"),s("mark",[s("strong",[t._v("åº”ç”¨ç¨‹åºå’Œæ“ä½œç³»ç»Ÿå†…æ ¸")])]),t._v("çš„äº¤äº’è€Œè¨€çš„, åŒæ­¥å’Œå¼‚æ­¥å…³æ³¨çš„æ˜¯"),s("strong",[t._v("æ¶ˆæ¯é€šä¿¡æœºåˆ¶")]),t._v(".")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("åŒæ­¥")]),t._v(": ä¸¤ä¸ªåŒæ­¥ä»»åŠ¡"),s("strong",[t._v("ç›¸äº’ä¾èµ–")]),t._v(", ä¸”ä¸€ä¸ªä»»åŠ¡å¿…é¡»ä¾èµ–äºå¦ä¸€ä»»åŠ¡çš„æŸç§æ–¹å¼æ‰§è¡Œ. æ¯”å¦‚åœ¨ A->B äº‹ä»¶æ¨¡å‹ä¸­, éœ€è¦å…ˆå®Œæˆ A æ‰èƒ½æ‰§è¡Œ B. å†æ¢å¥è¯è¯´, "),s("strong",[t._v("åŒæ­¥ IO")]),t._v(" "),s("strong",[s("strong",[t._v("è°ƒç”¨ä¸€æ—¦å¼€å§‹, è°ƒç”¨è€…å¿…é¡»")])]),t._v("â€‹"),s("strong",[t._v("ç­‰åˆ°æ–¹æ³•è°ƒç”¨è¿”å›å, æ‰èƒ½ç»§ç»­åç»­çš„è¡Œä¸º")]),t._v(". ä¾‹å¦‚: æŒ‰ä¸‹ç”µé¥­é”…çš„ç…®é¥­æŒ‰é’®, ç„¶åç­‰å¾…é¥­ç…®å¥½, æŠŠé¥­ç››å‡ºæ¥, ç„¶åå†å»ç‚’èœ.")]),t._v(" "),s("li",[s("strong",[t._v("å¼‚æ­¥")]),t._v(": "),s("strong",[t._v("å¼‚æ­¥ IO")]),t._v(" è°ƒç”¨æ›´åƒä¸€ä¸ª"),s("strong",[t._v("æ¶ˆæ¯ä¼ é€’")]),t._v(", ä¸€æ—¦å¼€å§‹, æ–¹æ³•è°ƒç”¨å°±ä¼šç«‹å³è¿”å›, è°ƒç”¨è€…å¯ä»¥ç»§ç»­åç»­çš„æ“ä½œ. ä¸¤ä¸ªå¼‚æ­¥çš„"),s("strong",[t._v("ä»»åŠ¡å®Œå…¨ç‹¬ç«‹")]),t._v("çš„, ä¸€æ–¹çš„æ‰§è¡Œä¸éœ€è¦ç­‰å¾…å¦å¤–ä¸€æ–¹çš„æ‰§è¡Œ. ä¾‹å¦‚: æŒ‰ä¸‹ç”µé’®é”…çš„ç…®é¥­æŒ‰é’®, ç›´æ¥å»ç‚’èœæˆ–è€…åšåˆ«çš„äº‹æƒ…, å½“ç”µé¥­é”…å“çš„æ—¶å€™, å†å›å»æŠŠé¥­ç››å‡ºæ¥.")])]),t._v(" "),s("h5",{attrs:{id:"_2-é˜»å¡ä¸éé˜»å¡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-é˜»å¡ä¸éé˜»å¡"}},[t._v("#")]),t._v(" 2.é˜»å¡ä¸éé˜»å¡")]),t._v(" "),s("p",[s("strong",[t._v("é˜»å¡å’Œéé˜»å¡")]),t._v("æ˜¯é’ˆå¯¹"),s("mark",[s("strong",[t._v("è¿›ç¨‹åœ¨è®¿é—®æ•°æ®")])]),t._v("çš„æ—¶å€™, æ ¹æ® IO æ“ä½œçš„"),s("strong",[t._v("å°±ç»ªçŠ¶æ€")]),t._v("æ¥é‡‡å–çš„ä¸åŒæ–¹å¼, æ˜¯ä¸€ç§è¯»å–æˆ–å†™å…¥æ“ä½œå‡½æ•°çš„å®ç°æ–¹å¼. é˜»å¡æ–¹å¼ä¸‹è¯»å–æˆ–å†™å…¥å‡½æ•°å°†ä¸€ç›´ç­‰å¾…, è€Œéé˜»å¡æ–¹å¼ä¸‹, è¯»å–æˆ–è€…å†™å…¥å‡½æ•°ä¼šç«‹å³è¿”å›ä¸€ä¸ªçŠ¶æ€å€¼. é˜»å¡å’Œéé˜»å¡å…³æ³¨çš„æ˜¯"),s("strong",[t._v("ç¨‹åºåœ¨ç­‰å¾…è°ƒç”¨ç»“æœ(æ¶ˆæ¯, è¿”å›å€¼)æ—¶çš„çŠ¶æ€")]),t._v(".")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("é˜»å¡")]),t._v(": å½“å‘èµ·ä¸€ä¸ªè¯·æ±‚æ—¶, "),s("strong",[t._v("è°ƒç”¨è€…ä¸€ç›´ç­‰å¾…è¯·æ±‚ç»“æœè¿”å›")]),t._v(", ä¹Ÿå°±æ˜¯å½“å‰çº¿ç¨‹ä¼šè¢«"),s("strong",[t._v("æŒ‚èµ·")]),t._v(", æ— æ³•è¿›è¡Œå…¶ä»–ä»»åŠ¡, åªæœ‰å½“æ¡ä»¶å°±ç»ªæ‰èƒ½ç»§ç»­å½“ç„¶çº¿ç¨‹. ä¾‹å¦‚: ä½ æ‰“ç”µè¯é—®ä¹¦åº—è€æ¿æœ‰æ²¡æœ‰ã€Šé‡‘ç“¶æ¢…ã€‹, å¦‚æœæ˜¯é˜»å¡å¼è°ƒç”¨, åˆ™ä¸ä¼šæŒ‚ç”µè¯, ç›´åˆ°å¾—åˆ°è€æ¿å›å¤æœ‰æ²¡æœ‰è¿™æœ¬ä¹¦çš„ç»“æœ.")]),t._v(" "),s("li",[s("strong",[t._v("éé˜»å¡")]),t._v(": å½“å‘èµ·ä¸€ä¸ªè¯·æ±‚æ—¶, "),s("strong",[t._v("è°ƒç”¨è€…ä¸ç”¨ä¸€ç›´ç­‰ç€ç»“æœè¿”å›")]),t._v(", å¯ä»¥å…ˆå»å¹²å…¶ä»–äº‹æƒ…, åœ¨ä¸èƒ½ç«‹åˆ»å¾—åˆ°ç»“æœä¹‹å‰, è¯¥è°ƒç”¨ä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹. ä¾‹å­: æ‰“ç”µè¯é—®ä¹¦åº—è€æ¿æœ‰æ²¡æœ‰ã€Šé‡‘ç“¶æ¢…ã€‹, ä¸ç®¡è€æ¿æœ‰æ²¡æœ‰å‘Šè¯‰ä½ ç»“æœ, å¯ä»¥è‡ªå·±å…ˆä¸€è¾¹å»ç©, å½“ç„¶ä¹Ÿè¦å¶å°”è¿‡å‡ åˆ†é’Ÿ check ä¸€ä¸‹è€æ¿æœ‰æ²¡æœ‰å‘ŠçŸ¥ç»“æœ.")])]),t._v(" "),s("p",[s("strong",[t._v("åŒæ­¥å’Œå¼‚æ­¥æ˜¯ç›®çš„, é˜»å¡å’Œéé˜»å¡æ˜¯å®ç°æ–¹å¼. åŒæ­¥/å¼‚æ­¥æ˜¯ä»è¡Œä¸ºè§’åº¦æè¿°äº‹ç‰©çš„, è€Œé˜»å¡å’Œéé˜»å¡æè¿°çš„å½“å‰äº‹ç‰©çš„çŠ¶æ€(ç­‰å¾…è°ƒç”¨ç»“æœæ—¶çš„çŠ¶æ€)")]),t._v(" .")]),t._v(" "),s("blockquote",[s("p",[t._v("ç»¼åˆç¤ºä¾‹")])]),t._v(" "),s("p",[t._v("å¦‚æœæƒ³åƒä¸€ä»½å®«ä¿é¸¡ä¸ç›–é¥­:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("åŒæ­¥é˜»å¡")]),t._v(": åˆ°é¥­é¦†ç‚¹é¤, ç„¶ååœ¨é‚£ç­‰ç€, è¿˜è¦ä¸€è¾¹å–Š: å¥½äº†æ²¡! (é˜»å¡å¼IO)")]),t._v(" "),s("li",[s("strong",[t._v("åŒæ­¥éé˜»å¡")]),t._v(": åœ¨é¥­é¦†ç‚¹å®Œé¤, å°±å»é›ç‹—äº†. ä¸è¿‡æ¯è¿‡ååˆ†é’Ÿå°±æ‰“ç”µè¯é—®é¥­åº—: å¥½äº†æ²¡! (éé˜»å¡å¼IO)")]),t._v(" "),s("li",[s("strong",[t._v("å¼‚æ­¥é˜»å¡")]),t._v(": é›ç‹—çš„æ—¶å€™, æ¥åˆ°é¥­é¦†ç”µè¯, è¯´é¥­åšå¥½äº†, è®©æ‚¨äº²è‡ªå»æ‹¿. (å¤šè·¯å¤ç”¨å¼IO)")]),t._v(" "),s("li",[s("strong",[t._v("å¼‚æ­¥éé˜»å¡")]),t._v(": é¥­é¦†æ‰“ç”µè¯è¯´, æˆ‘ä»¬çŸ¥é“æ‚¨çš„ä½ç½®, ä¸€ä¼šç»™ä½ é€è¿‡æ¥, å®‰å¿ƒé›ç‹—å°±å¯ä»¥äº†.")])]),t._v(" "),s("h5",{attrs:{id:"_3-ioäº¤äº’æµç¨‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-ioäº¤äº’æµç¨‹"}},[t._v("#")]),t._v(" 3.IOäº¤äº’æµç¨‹")]),t._v(" "),s("p",[t._v("é€šå¸¸ç”¨æˆ·è¿›ç¨‹ä¸­çš„ä¸€æ¬¡"),s("strong",[t._v("å®Œæ•´ IO äº¤äº’")]),t._v("æµç¨‹åˆ†ä¸º"),s("strong",[t._v("ä¸¤ä¸ªé˜¶æ®µ")]),t._v(". é¦–å…ˆæ˜¯ç»è¿‡"),s("strong",[t._v("å†…æ ¸ç©ºé—´")]),t._v(", ç”±"),s("strong",[t._v("æ“ä½œç³»ç»Ÿ")]),t._v("å¤„ç†; ç„¶ååˆ°"),s("strong",[t._v("ç”¨æˆ·ç©ºé—´")]),t._v(", ç”±"),s("strong",[t._v("åº”ç”¨è¿›ç¨‹")]),t._v("å¤„ç†. åº”ç”¨è¿›ç¨‹å¿…é¡»é€šè¿‡"),s("strong",[t._v("ç³»ç»Ÿè°ƒç”¨")]),t._v("è¯·æ±‚å†…æ ¸ååŠ©"),s("strong",[t._v("å®Œæˆ IO æ“ä½œ")]),t._v(".")]),t._v(" "),s("p",[t._v("å¯¹äºä¸€ä¸ª"),s("strong",[t._v("å¥—æ¥å­—")]),t._v("ä¸Šçš„ç½‘ç»œè¾“å…¥æ“ä½œä¸»è¦åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µ:")]),t._v(" "),s("ul",[s("li",[s("mark",[s("strong",[t._v("ç­‰å¾…æ•°æ®")])]),t._v(": ç­‰å¾…ç½‘ç»œæ•°æ®åˆ°è¾¾"),s("strong",[t._v("ç½‘å¡")]),t._v(", ç„¶åå°†"),s("strong",[t._v("æ•°æ®è¯»å–åˆ°å†…æ ¸ç¼“å†²åŒº")]),t._v(".")]),t._v(" "),s("li",[s("mark",[s("strong",[t._v("å¤åˆ¶æ•°æ®")])]),t._v(": ä»å†…æ ¸ç¼“å†²åŒº"),s("strong",[t._v("å¤åˆ¶æ•°æ®")]),t._v(", æ‹·è´åˆ°"),s("strong",[t._v("ç”¨æˆ·ç©ºé—´çš„åº”ç”¨è¿›ç¨‹")]),t._v("ä¸­.")])]),t._v(" "),s("p",[t._v("IO æ¨¡å‹åˆ™æ˜¯å¯¹è¿™ä¸ªäº¤äº’æµç¨‹çš„å®ç°, ä¸åŒçš„ IO æ¨¡å‹åœ¨ä¸€æ¬¡ç½‘ç»œæ“ä½œè¿‡ç¨‹ä¸­å…¶ç­‰å¾…æ•°æ®å’Œå¤åˆ¶æ•°æ®çš„æ­¥éª¤æœ‰ä¸åŒçš„è¡¨ç°.")]),t._v(" "),s("h4",{attrs:{id:"ioæ¨¡å‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ioæ¨¡å‹"}},[t._v("#")]),t._v(" IOæ¨¡å‹")]),t._v(" "),s("p",[t._v("Unix æœ‰"),s("strong",[t._v("äº”ç§")]),t._v(" IO æ¨¡å‹:")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("é˜»å¡å¼ IO")])]),t._v(" "),s("li",[s("strong",[t._v("éé˜»å¡å¼ IO")])]),t._v(" "),s("li",[s("strong",[t._v("IO å¤ç”¨(select å’Œ poll)")])]),t._v(" "),s("li",[s("strong",[t._v("ä¿¡å·é©±åŠ¨å¼ IO(SIGIO)")])]),t._v(" "),s("li",[s("strong",[t._v("å¼‚æ­¥ IO(AIO)")])])]),t._v(" "),s("h5",{attrs:{id:"_1-é˜»å¡å¼io"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-é˜»å¡å¼io"}},[t._v("#")]),t._v(" 1.é˜»å¡å¼IO")]),t._v(" "),s("p",[s("strong",[t._v("åº”ç”¨è¿›ç¨‹")]),t._v("è¢«"),s("strong",[t._v("é˜»å¡")]),t._v(", ç›´åˆ°æ•°æ®"),s("strong",[t._v("ä»å†…æ ¸ç¼“å†²åŒºå¤åˆ¶")]),t._v("åˆ°åº”ç”¨"),s("strong",[t._v("è¿›ç¨‹ç¼“å†²åŒºä¸­")]),t._v("æ‰è¿”å›.")]),t._v(" "),s("p",[t._v("åœ¨é˜»å¡è¿‡ç¨‹ä¸­, å…¶å®ƒåº”ç”¨è¿›ç¨‹ä¾ç„¶å¯ä»¥æ‰§è¡Œ, å› æ­¤é˜»å¡ä¸æ„å‘³ç€æ•´ä¸ªæ“ä½œç³»ç»Ÿéƒ½è¢«é˜»å¡. å› ä¸ºå…¶å®ƒåº”ç”¨è¿›ç¨‹è¿˜å¯ä»¥æ‰§è¡Œ, æ‰€ä»¥ä¸æ¶ˆè€— CPU æ—¶é—´, è¿™ç§æ¨¡å‹çš„ CPU "),s("strong",[t._v("åˆ©ç”¨æ•ˆç‡")]),t._v("ä¼šæ¯”è¾ƒé«˜. ä¾‹å¦‚ "),s("strong",[t._v("Java BIO")]),t._v("(BIO).")]),t._v(" "),s("p",[t._v("ä¸‹å›¾ä¸­, "),s("strong",[t._v("recvfrom()")]),t._v("  å‡½æ•°ç”¨äº"),s("strong",[t._v("æ¥æ”¶ Socket")]),t._v(" ä¼ æ¥çš„æ•°æ®, å¹¶å¤åˆ¶åˆ°"),s("strong",[t._v("åº”ç”¨è¿›ç¨‹çš„ç¼“å†²åŒº buf")]),t._v(" ä¸­. è¿™é‡Œå¯æŠŠ recvfrom() å½“æˆ"),s("strong",[t._v("ç³»ç»Ÿè°ƒç”¨")]),t._v(". é™¤äº†å¼‚æ­¥ IO ä¹‹å¤–çš„å…¶ä»–å‡ ä¸ªæ¨¡å‹éƒ½éœ€è¦"),s("strong",[t._v("è°ƒç”¨ recvfrom() æ¥ä»æ“ä½œç³»ç»Ÿå†…æ ¸å¤åˆ¶æ•°æ®åˆ°è¿›ç¨‹ä¸­")]),t._v(", è°ƒç”¨å®ƒçš„æ—¶å€™å°±æ˜¯"),s("strong",[t._v("é˜»å¡")]),t._v("çš„.")]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ssize_t")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("recvfrom")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" sockfd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("buf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("size_t")]),t._v(" len"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" flags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("sockaddr")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("src_addr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("socklen_t")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("addrlen"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220528180004061.png",alt:"",title:"é˜»å¡å¼IO"}})]),t._v(" "),s("h5",{attrs:{id:"_2-éé˜»å¡å¼io"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-éé˜»å¡å¼io"}},[t._v("#")]),t._v(" 2.éé˜»å¡å¼IO")]),t._v(" "),s("p",[s("strong",[t._v("åº”ç”¨è¿›ç¨‹")]),t._v("æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ "),s("strong",[t._v("recvfrom()")]),t._v("  ä¹‹å, å†…æ ¸è¿”å›ä¸€ä¸ª"),s("strong",[t._v("é”™è¯¯ç ")]),t._v(". åº”ç”¨è¿›ç¨‹"),s("strong",[t._v("å¯ä»¥ç»§ç»­æ‰§è¡Œ")]),t._v(", ä½†æ˜¯éœ€è¦"),s("strong",[t._v("ä¸æ–­æ‰§è¡Œç³»ç»Ÿè°ƒç”¨")]),t._v("æ¥è·çŸ¥ IO æ˜¯å¦å®Œæˆ, è¿™ç§æ–¹å¼ç§°ä¸º"),s("strong",[t._v("è½®è¯¢")]),t._v("(polling). ç”±äº CPU è¦å¤„ç†æ›´å¤šçš„"),s("strong",[t._v("ç³»ç»Ÿè°ƒç”¨")]),t._v(", å› æ­¤è¿™ç§ IO æ¨¡å‹çš„ CPU åˆ©ç”¨ç‡æ¯”è¾ƒ"),s("strong",[t._v("ä½")]),t._v(".")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220528180218113.png",alt:"",title:"éé˜»å¡å¼IO"}})]),t._v(" "),s("h5",{attrs:{id:"_3-å¤šè·¯å¤ç”¨ioğŸŒŸ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-å¤šè·¯å¤ç”¨ioğŸŒŸ"}},[t._v("#")]),t._v(" 3.å¤šè·¯å¤ç”¨IOğŸŒŸ")]),t._v(" "),s("p",[t._v("ä½¿ç”¨ "),s("strong",[t._v("select() æˆ–è€… poll()")]),t._v(" "),s("strong",[t._v("ç­‰å¾…")]),t._v("æ•°æ®, å¹¶ä¸”å¯ä»¥"),s("strong",[t._v("ç­‰å¾…å¤šä¸ªå¥—æ¥å­—")]),t._v("ä¸­çš„ä»»ä½•ä¸€ä¸ªå˜ä¸º"),s("strong",[t._v("å¯è¯»")]),t._v(", è¿™ä¸€è¿‡ç¨‹ä¼šè¢«"),s("strong",[t._v("é˜»å¡")]),t._v(". å½“æŸä¸€ä¸ªå¥—æ¥å­—"),s("strong",[t._v("å¯è¯»æ—¶")]),t._v("è¿”å›, ä¹‹åå†ä½¿ç”¨ "),s("strong",[t._v("recvfrom()")]),t._v("  æŠŠæ•°æ®ä»å†…æ ¸"),s("strong",[t._v("å¤åˆ¶")]),t._v("åˆ°è¿›ç¨‹ä¸­, æ‰€ä»¥è¿™ä¸ªè¿‡ç¨‹ä½¿ç”¨äº†"),s("strong",[t._v("ä¸¤ä¸ª")]),t._v("ç³»ç»Ÿè°ƒç”¨.")]),t._v(" "),s("p",[s("strong",[t._v("å¤šä¸ªè¿›ç¨‹çš„ IO")]),t._v(" å¯ä»¥æ³¨å†Œåˆ°ä¸€ä¸ª "),s("strong",[t._v("Selector")]),t._v(" ä¸Š, Selector ä¼šå¯¹æ‰€æœ‰ IO äº‹ä»¶è¿›è¡Œç›‘å¬. å®ƒå¯ä»¥è®©"),s("strong",[t._v("å•ä¸ªè¿›ç¨‹")]),t._v("å…·æœ‰å¤„ç†"),s("strong",[t._v("å¤šä¸ª IO äº‹ä»¶")]),t._v("çš„èƒ½åŠ›. å› æ­¤åˆè¢«ç§°ä¸º"),s("strong",[t._v("äº‹ä»¶é©±åŠ¨ IO")]),t._v("(Event Driven IO).")]),t._v(" "),s("p",[t._v("å¦‚æœä¸€ä¸ª Web æœåŠ¡å™¨æ²¡æœ‰ IO å¤ç”¨, é‚£ä¹ˆ"),s("strong",[t._v("æ¯ä¸€ä¸ª Socket è¿æ¥")]),t._v("éƒ½éœ€è¦åˆ›å»ºä¸€ä¸ª"),s("strong",[t._v("çº¿ç¨‹")]),t._v("å»å¤„ç†. å¦‚æœåŒæ—¶æœ‰"),s("strong",[t._v("å‡ ä¸‡ä¸ª")]),t._v("è¿æ¥, é‚£ä¹ˆå°±éœ€è¦åˆ›å»ºç›¸åŒæ•°é‡çš„çº¿ç¨‹. ç›¸æ¯”å¤šè¿›ç¨‹å’Œå¤šçº¿ç¨‹æŠ€æœ¯, "),s("strong",[t._v("IO å¤ç”¨ä¸éœ€è¦è¿›ç¨‹çº¿ç¨‹åˆ›å»ºå’Œåˆ‡æ¢çš„å¼€é”€")]),t._v(", ç³»ç»Ÿå¼€é”€æ›´å°.")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220528180300053.png",alt:"",title:"å¤šè·¯å¤ç”¨IO"}})]),t._v(" "),s("p",[t._v("IO å¤ç”¨çš„"),s("strong",[t._v("ä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿå¤„ç†æ›´å¤šçš„è¿æ¥")]),t._v(", ä½†æ˜¯å¯¹å•ä¸ªè¿æ¥çš„å¤„ç†ä¸ä¸€å®šæ¯”é˜»å¡ IO å¿«. å¯¹äº"),s("strong",[t._v("æ¯ä¸€ä¸ª Socket")]),t._v(", ä¸€èˆ¬éƒ½æ˜¯è®¾ç½®ä¸º"),s("strong",[t._v("éé˜»å¡")]),t._v(", ä½†æ˜¯"),s("strong",[t._v("æ•´ä¸ªç”¨æˆ·è¿›ç¨‹å…¶å®æ˜¯ä¸€ç›´è¢«é˜»å¡")]),t._v("çš„, åªä¸è¿‡è¿›ç¨‹æ˜¯"),s("strong",[t._v("è¢« select è°ƒç”¨")]),t._v("é˜»å¡, è€Œä¸æ˜¯è¢« Socket IO é˜»å¡.")]),t._v(" "),s("p",[t._v("å…¸å‹åº”ç”¨æœ‰ "),s("strong",[t._v("Java NIO, Nginx, Netty")]),t._v(". å‚è€ƒ: NIO.")]),t._v(" "),s("h5",{attrs:{id:"_4-ä¿¡å·é©±åŠ¨io"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-ä¿¡å·é©±åŠ¨io"}},[t._v("#")]),t._v(" 4.ä¿¡å·é©±åŠ¨IO")]),t._v(" "),s("p",[t._v("åº”ç”¨è¿›ç¨‹ä½¿ç”¨ "),s("strong",[t._v("sigaction()")]),t._v("  ç³»ç»Ÿè°ƒç”¨, å†…æ ¸"),s("strong",[t._v("ç«‹å³")]),t._v("è¿”å›, åº”ç”¨è¿›ç¨‹"),s("strong",[t._v("å¯ä»¥ç»§ç»­æ‰§è¡Œ")]),t._v(", æ‰€ä»¥"),s("strong",[t._v("ç­‰å¾…æ•°æ®")]),t._v("é˜¶æ®µåº”ç”¨è¿›ç¨‹æ˜¯"),s("strong",[t._v("éé˜»å¡")]),t._v("çš„. å†…æ ¸åœ¨æ•°æ®"),s("strong",[t._v("åˆ°è¾¾æ—¶")]),t._v("å‘åº”ç”¨è¿›ç¨‹å‘é€ "),s("strong",[t._v("SIGIO")]),t._v(" ä¿¡å·, åº”ç”¨è¿›ç¨‹æ”¶åˆ°ä¹‹ååœ¨ä¿¡å·å¤„ç†ç¨‹åºä¸­è°ƒç”¨ "),s("strong",[t._v("recvfrom()")]),t._v("  è°ƒç”¨å°†æ•°æ®ä»å†…æ ¸"),s("strong",[t._v("å¤åˆ¶")]),t._v("åˆ°åº”ç”¨è¿›ç¨‹ä¸­.")]),t._v(" "),s("p",[t._v("ç›¸æ¯”äºéé˜»å¡å¼ IO çš„è½®è¯¢æ–¹å¼, ä¿¡å·é©±åŠ¨ IO çš„ CPU åˆ©ç”¨ç‡æ›´é«˜. ç­‰å¾…æ•°æ®çš„æ—¶å€™ä¸æ˜¯é˜»å¡çš„, ä½†æ˜¯"),s("strong",[t._v("æ‹·è´")]),t._v("æ•°æ®åˆ°åº”ç”¨è¿›ç¨‹çš„æ—¶å€™"),s("strong",[t._v("ä¾ç„¶æ˜¯é˜»å¡")]),t._v("çš„.")]),t._v(" "),s("p",[t._v("è¿™ä¸ªæ¨¡å‹å…¶å®"),s("strong",[t._v("ç”¨çš„ä¸å¤ªå¤š")]),t._v(".")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220528180344073.png",alt:"",title:"ä¿¡å·é©±åŠ¨IO"}})]),t._v(" "),s("h5",{attrs:{id:"_5-å¼‚æ­¥io"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-å¼‚æ­¥io"}},[t._v("#")]),t._v(" 5.å¼‚æ­¥IO")]),t._v(" "),s("p",[s("strong",[t._v("åº”ç”¨è¿›ç¨‹æ‰§è¡Œ aio_read() ç³»ç»Ÿè°ƒç”¨ä¼šç«‹å³è¿”å›, åº”ç”¨è¿›ç¨‹å¯ä»¥ç»§ç»­æ‰§è¡Œ, ä¸ä¼šè¢«é˜»å¡, å†…æ ¸è‡ªå·±ä¼šç­‰å¾…æ•°æ®åˆ°æ¥å¹¶æŠŠæ•°æ®å¤åˆ¶åˆ°åº”ç”¨è¿›ç¨‹ç¼“å†²åŒºä¹‹åä¼šå‘åº”ç”¨è¿›ç¨‹å‘é€æ•°æ®å¤åˆ¶å®Œæˆçš„ä¿¡å·")]),t._v(".")]),t._v(" "),s("p",[t._v("å¼‚æ­¥ IO ä¸ä¿¡å·é©±åŠ¨ IO çš„åŒºåˆ«åœ¨äº, "),s("strong",[t._v("å¼‚æ­¥ IO")]),t._v(" çš„ä¿¡å·æ˜¯é€šçŸ¥åº”ç”¨è¿›ç¨‹ "),s("strong",[t._v("IO æ“ä½œå·²ç»å®Œæˆ, æ•°æ®å·²ç»å¤åˆ¶åˆ°äº†åº”ç”¨è¿›ç¨‹ç¼“å†²åŒº")]),t._v(", è€Œ"),s("strong",[t._v("ä¿¡å·é©±åŠ¨")]),t._v(" IO çš„ä¿¡å·æ˜¯é€šçŸ¥åº”ç”¨è¿›ç¨‹"),s("strong",[t._v("å¯ä»¥å¼€å§‹ IO")]),t._v(", ä¹Ÿå°±æ˜¯é€šçŸ¥åº”ç”¨è¿›ç¨‹"),s("strong",[t._v("å¯ä»¥å¼€å§‹é˜»å¡å¹¶æ‹·è´æ•°æ®")]),t._v("äº†, æ•°æ®å¾—è‡ªå·±æ‹·è´.")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220528180421373.png",alt:"",title:"å¼‚æ­¥IO"}})]),t._v(" "),s("p",[t._v("å¼‚æ­¥ IO æ¨¡å‹çœŸæ­£å®ç°äº†å¼‚æ­¥, æ˜¯äº”ç§ IO æ¨¡å‹ä¸­"),s("strong",[t._v("å”¯ä¸€çš„å¼‚æ­¥æ¨¡å‹")]),t._v(".")]),t._v(" "),s("p",[s("strong",[t._v("å…¸å‹åº”ç”¨")]),t._v(": "),s("strong",[t._v("Java7 AIO")]),t._v(", é«˜æ€§èƒ½æœåŠ¡å™¨åº”ç”¨. å‚è€ƒ: AIO.")]),t._v(" "),s("h5",{attrs:{id:"_6-ioæ¨¡å‹æ¯”è¾ƒğŸŒŸ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-ioæ¨¡å‹æ¯”è¾ƒğŸŒŸ"}},[t._v("#")]),t._v(" 6.IOæ¨¡å‹æ¯”è¾ƒğŸŒŸ")]),t._v(" "),s("p",[s("strong",[t._v("é˜»å¡å¼ IO, éé˜»å¡å¼ IO, å¤šè·¯å¤ç”¨ IO å’Œä¿¡å·é©±åŠ¨ IO éƒ½æ˜¯åŒæ­¥ IO")]),t._v(", å®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨"),s("strong",[t._v("ç¬¬ä¸€ä¸ªé˜¶æ®µ")]),t._v(", å› ä¸º"),s("strong",[t._v("ç¬¬äºŒé˜¶æ®µ")]),t._v("éƒ½æ˜¯"),s("mark",[s("strong",[t._v("é˜»å¡è°ƒç”¨ recvfrom()")])]),t._v("â€‹ ** å°†æ•°æ®ä»å†…æ ¸å¤åˆ¶åˆ°ç”¨æˆ·è¿›ç¨‹**.")]),t._v(" "),s("p",[t._v("éé˜»å¡å¼ IO, ä¿¡å·é©±åŠ¨ IO å’Œå¼‚æ­¥ IO åœ¨ç¬¬ä¸€é˜¶æ®µä¸ä¼šé˜»å¡.")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220528181647796.png",alt:"image-20220528181647796",title:"IOæ¨¡å‹å¯¹æ¯”æ€»ç»“"}})]),t._v(" "),s("h4",{attrs:{id:"å¤šè·¯å¤ç”¨ioå®ç°ğŸŒŸ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¤šè·¯å¤ç”¨ioå®ç°ğŸŒŸ"}},[t._v("#")]),t._v(" å¤šè·¯å¤ç”¨IOå®ç°ğŸŒŸ")]),t._v(" "),s("p",[s("strong",[t._v("select/poll/epoll éƒ½æ˜¯å¤šè·¯å¤ç”¨ IO æ¨¡å‹çš„å…·ä½“å®ç°")]),t._v(", select å‡ºç°çš„æœ€æ—©, ä¹‹åæ˜¯ poll, å†æ˜¯ epoll.")]),t._v(" "),s("h5",{attrs:{id:"_1-select"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-select"}},[t._v("#")]),t._v(" 1.select")]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fd_set "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("readfds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fd_set "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("writefds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fd_set "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("exceptfds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("timeval")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("timeout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("æœ‰"),s("strong",[t._v("ä¸‰ç§ç±»å‹")]),t._v("çš„æè¿°ç¬¦ç±»å‹: "),s("strong",[t._v("readset, writeset, exceptset")]),t._v(", åˆ†åˆ«å¯¹åº”è¯», å†™, å¼‚å¸¸æ¡ä»¶çš„æè¿°ç¬¦é›†åˆ. fd_set ä½¿ç”¨"),s("strong",[t._v("æ•°ç»„")]),t._v("å®ç°, æ•°ç»„å¤§å°ä½¿ç”¨ FD_SETSIZE å®šä¹‰. "),s("strong",[t._v("timeout")]),t._v(" ä¸ºè¶…æ—¶å‚æ•°, "),s("strong",[t._v("è°ƒç”¨ select ä¼šä¸€ç›´é˜»å¡ç›´åˆ°æœ‰æè¿°ç¬¦çš„äº‹ä»¶åˆ°è¾¾æˆ–è€…ç­‰å¾…çš„æ—¶é—´è¶…è¿‡ timeout")]),t._v(". æˆåŠŸè°ƒç”¨è¿”å›ç»“æœå¤§äº 0, å‡ºé”™è¿”å›ç»“æœä¸º -1, è¶…æ—¶è¿”å›ç»“æœä¸º 0.")]),t._v(" "),s("h5",{attrs:{id:"_2-poll"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-poll"}},[t._v("#")]),t._v(" 2.poll")]),t._v(" "),s("h6",{attrs:{id:"_1-åŸºç¡€"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-åŸºç¡€"}},[t._v("#")]),t._v(" (1)åŸºç¡€")]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("poll")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("pollfd")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("fds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("unsigned")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" nfds"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" timeout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("ç»“æ„ä½“ pollfd ä½¿ç”¨"),s("strong",[t._v("é“¾è¡¨å®ç°")]),t._v(".")]),t._v(" "),s("h6",{attrs:{id:"_2-selectä¸pollæ¯”è¾ƒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-selectä¸pollæ¯”è¾ƒ"}},[t._v("#")]),t._v(" (2)selectä¸pollæ¯”è¾ƒ")]),t._v(" "),s("blockquote",[s("p",[t._v("åŠŸèƒ½")])]),t._v(" "),s("p",[t._v("select å’Œ poll çš„åŠŸèƒ½"),s("strong",[t._v("åŸºæœ¬ç›¸åŒ")]),t._v(", ä¸è¿‡åœ¨ä¸€äº›å®ç°ç»†èŠ‚ä¸Šæœ‰æ‰€ä¸åŒ.")]),t._v(" "),s("ul",[s("li",[t._v("select ä¼š"),s("strong",[t._v("ä¿®æ”¹æè¿°ç¬¦")]),t._v(", è€Œ poll ä¸ä¼š;")]),t._v(" "),s("li",[s("strong",[t._v("select")]),t._v(" çš„"),s("strong",[t._v("æè¿°ç¬¦ç±»å‹")]),t._v("ä½¿ç”¨"),s("strong",[t._v("æ•°ç»„å®ç°")]),t._v(", FD_SETSIZE å¤§å°é»˜è®¤ä¸º "),s("strong",[t._v("1024")]),t._v(", å› æ­¤é»˜è®¤"),s("strong",[t._v("åªèƒ½ç›‘å¬ 1024 ä¸ªæè¿°ç¬¦")]),t._v(". å¦‚æœè¦ç›‘å¬æ›´å¤šæè¿°ç¬¦çš„è¯, éœ€è¦ä¿®æ”¹ FD_SETSIZE ä¹‹å"),s("strong",[t._v("é‡æ–°ç¼–è¯‘")]),t._v("; è€Œ "),s("strong",[t._v("poll")]),t._v(" çš„"),s("strong",[t._v("æè¿°ç¬¦ç±»å‹")]),t._v("ä½¿ç”¨"),s("strong",[t._v("é“¾è¡¨å®ç°")]),t._v(", æ²¡æœ‰æè¿°ç¬¦æ•°é‡çš„é™åˆ¶;")]),t._v(" "),s("li",[t._v("poll æä¾›äº†æ›´å¤šçš„"),s("strong",[t._v("äº‹ä»¶ç±»å‹")]),t._v(", å¹¶ä¸”å¯¹æè¿°ç¬¦çš„"),s("strong",[t._v("é‡å¤åˆ©ç”¨")]),t._v("ä¸Šæ¯” select é«˜.")]),t._v(" "),s("li",[t._v("å¦‚æœä¸€ä¸ªçº¿ç¨‹å¯¹æŸä¸ªæè¿°ç¬¦è°ƒç”¨äº† select æˆ–è€… poll, å¦ä¸€ä¸ªçº¿ç¨‹å…³é—­äº†è¯¥æè¿°ç¬¦, ä¼šå¯¼è‡´è°ƒç”¨ç»“æœä¸ç¡®å®š.")])]),t._v(" "),s("blockquote",[s("p",[t._v("é€Ÿåº¦")])]),t._v(" "),s("p",[t._v("select å’Œ poll é€Ÿåº¦"),s("strong",[t._v("éƒ½æ¯”è¾ƒæ…¢")]),t._v(".")]),t._v(" "),s("ul",[s("li",[t._v("select å’Œ poll "),s("strong",[t._v("æ¯æ¬¡è°ƒç”¨")]),t._v("éƒ½éœ€è¦å°†"),s("strong",[t._v("å…¨éƒ¨æè¿°ç¬¦")]),t._v("ä»åº”ç”¨è¿›ç¨‹ç¼“å†²åŒºå¤åˆ¶åˆ°"),s("strong",[t._v("å†…æ ¸")]),t._v("ç¼“å†²åŒº.")]),t._v(" "),s("li",[t._v("select å’Œ poll çš„è¿”å›ç»“æœä¸­æ²¡æœ‰å£°æ˜å“ªäº›æè¿°ç¬¦å·²ç»å‡†å¤‡å¥½, æ‰€ä»¥å¦‚æœè¿”å›å€¼å¤§äº 0 æ—¶, åº”ç”¨è¿›ç¨‹éƒ½éœ€è¦ä½¿ç”¨"),s("strong",[t._v("è½®è¯¢")]),t._v("çš„æ–¹å¼æ¥æ‰¾åˆ° IO å®Œæˆçš„æè¿°ç¬¦.")])]),t._v(" "),s("blockquote",[s("p",[t._v("å¯ç§»æ¤æ€§")])]),t._v(" "),s("p",[t._v("å‡ ä¹"),s("strong",[t._v("æ‰€æœ‰çš„")]),t._v("ç³»ç»Ÿéƒ½"),s("strong",[t._v("æ”¯æŒ select")]),t._v(", ä½†æ˜¯åªæœ‰"),s("strong",[t._v("æ¯”è¾ƒæ–°çš„")]),t._v("ç³»ç»Ÿæ”¯æŒ "),s("strong",[t._v("poll")]),t._v(".")]),t._v(" "),s("h5",{attrs:{id:"_3-epoll"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-epoll"}},[t._v("#")]),t._v(" 3.epoll")]),t._v(" "),s("h6",{attrs:{id:"_1-åŸºç¡€-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-åŸºç¡€-2"}},[t._v("#")]),t._v(" (1)åŸºç¡€")]),t._v(" "),s("div",{staticClass:"language-c line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("epoll_create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("epoll_ctl")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" epfd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" op"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("epoll_event")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("epoll_wait")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" epfd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("struct")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("epoll_event")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" events"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" maxevents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" timeout"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[s("strong",[t._v("epoll_ctl()")]),t._v("  ç”¨äºå‘å†…æ ¸æ³¨å†Œ"),s("strong",[t._v("æ–°çš„")]),t._v("æè¿°ç¬¦æˆ–è€…æ˜¯æ”¹å˜æŸä¸ªæ–‡ä»¶æè¿°ç¬¦çš„"),s("strong",[t._v("çŠ¶æ€")]),t._v(". å·²æ³¨å†Œçš„"),s("strong",[t._v("æè¿°ç¬¦")]),t._v("åœ¨å†…æ ¸ä¸­ä¼šè¢«ç»´æŠ¤åœ¨ä¸€æ£µ"),s("strong",[t._v("çº¢é»‘æ ‘")]),t._v("ä¸Š, é€šè¿‡"),s("strong",[t._v("å›è°ƒå‡½æ•°")]),t._v("å†…æ ¸ä¼šå°† IO å‡†å¤‡å¥½çš„"),s("strong",[t._v("æè¿°ç¬¦")]),t._v("åŠ å…¥åˆ°ä¸€ä¸ª"),s("strong",[t._v("é“¾è¡¨")]),t._v("ä¸­ç®¡ç†, è¿›ç¨‹è°ƒç”¨ epoll_wait() ä¾¿å¯ä»¥å¾—åˆ°"),s("strong",[t._v("äº‹ä»¶å®Œæˆ")]),t._v("çš„æè¿°ç¬¦. "),s("strong",[t._v("é€šè¿‡")]),t._v("â€‹"),s("mark",[s("strong",[t._v("çº¢é»‘æ ‘å’ŒåŒå‘é“¾")])]),t._v("â€‹"),s("strong",[t._v("è¡¨æ•°æ®ç»“æ„, å¹¶ç»“åˆå›è°ƒæœºåˆ¶, é€ å°±äº† epoll çš„é«˜æ•ˆ")]),t._v(".")]),t._v(" "),s("p",[s("strong",[t._v("epoll åªéœ€è¦å°†æè¿°ç¬¦ä»è¿›ç¨‹ç¼“å†²åŒºå‘å†…æ ¸ç¼“å†²åŒº")]),t._v("â€‹"),s("mark",[s("strong",[t._v("æ‹·è´ä¸€æ¬¡")])]),t._v(", å¹¶ä¸”è¿›ç¨‹"),s("strong",[t._v("ä¸éœ€è¦é€šè¿‡è½®è¯¢")]),t._v("æ¥è·å¾—äº‹ä»¶"),s("strong",[t._v("å®Œæˆçš„æè¿°ç¬¦")]),t._v(".")]),t._v(" "),s("p",[s("strong",[t._v("epoll ä»…é€‚ç”¨äº Linux")]),t._v(". "),s("strong",[t._v("epoll æ¯” select å’Œ poll æ›´åŠ çµæ´»")]),t._v("è€Œä¸”"),s("strong",[t._v("æ²¡æœ‰æè¿°ç¬¦æ•°é‡é™åˆ¶")]),t._v(". epoll å¯¹"),s("strong",[t._v("å¤šçº¿ç¨‹ç¼–ç¨‹æ›´æœ‰å‹å¥½")]),t._v(", ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨äº† epoll_wait() å¦ä¸€ä¸ªçº¿ç¨‹å…³é—­äº†åŒä¸€ä¸ªæè¿°ç¬¦ä¹Ÿ"),s("strong",[t._v("ä¸ä¼š")]),t._v("äº§ç”Ÿåƒ select å’Œ poll çš„ä¸ç¡®å®šæƒ…å†µ.")]),t._v(" "),s("h6",{attrs:{id:"_2-epollå·¥ä½œæ¨¡å¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-epollå·¥ä½œæ¨¡å¼"}},[t._v("#")]),t._v(" (2)epollå·¥ä½œæ¨¡å¼")]),t._v(" "),s("p",[s("strong",[t._v("epoll")]),t._v(" çš„æè¿°ç¬¦äº‹ä»¶æœ‰"),s("strong",[t._v("ä¸¤ç§è§¦å‘æ¨¡å¼")]),t._v(": "),s("strong",[t._v("LT")]),t._v("(level trigger) å’Œ "),s("strong",[t._v("ET")]),t._v("(edge trigger).")]),t._v(" "),s("blockquote",[s("p",[t._v("æ°´å¹³è§¦å‘æ¨¡å¼")])]),t._v(" "),s("p",[t._v("epoll_wait() å‡½æ•°ä¸º epoll ç³»åˆ—ä¸»è¦ç³»ç»Ÿè°ƒç”¨å‡½æ•°, å®ƒåœ¨"),s("strong",[t._v("ä¸€æ®µè¶…æ—¶æ—¶é—´å†…ç­‰å¾…ä¸€ç»„æ–‡ä»¶æè¿°ç¬¦ä¸Šçš„äº‹ä»¶")]),t._v(". æ­¤å‡½æ•°æˆåŠŸè¿”å›æ—¶è¿”å›"),s("strong",[t._v("å°±ç»ªç½‘ç»œäº‹ä»¶çš„ä¸ªæ•°")]),t._v('. å¯ä»¥è®¾ç½® "timout" å‚æ•°, å…¶å•ä½æ˜¯æ¯«ç§’, åœ¨è¿™ä¸ªæ—¶é—´å†… epoll_wait() ç³»ç»Ÿè°ƒç”¨å°†è¢«é˜»å¡.')]),t._v(" "),s("p",[t._v("å½“ epoll_wait() æ£€æµ‹åˆ°"),s("strong",[t._v("æè¿°ç¬¦äº‹ä»¶åˆ°è¾¾")]),t._v("æ—¶, å°†æ­¤"),s("mark",[s("strong",[t._v("äº‹ä»¶é€šçŸ¥è¿›ç¨‹, è¿›ç¨‹å¯ä»¥ä¸ç«‹å³å¤„ç†è¯¥äº‹ä»¶")])]),t._v(", ä¸‹æ¬¡è°ƒç”¨ epoll_wait() ä¼š"),s("strong",[t._v("å†æ¬¡é€šçŸ¥è¿›ç¨‹")]),t._v(". æ˜¯"),s("strong",[t._v("é»˜è®¤")]),t._v("çš„ä¸€ç§æ¨¡å¼, å¹¶ä¸”åŒæ—¶æ”¯æŒ "),s("strong",[t._v("Blocking")]),t._v(" å’Œ "),s("strong",[t._v("No-Blocking")]),t._v(".")]),t._v(" "),s("blockquote",[s("p",[t._v("è¾¹æ²¿è§¦å‘æ¨¡å¼")])]),t._v(" "),s("p",[t._v("å’Œæ°´å¹³è§¦å‘æ¨¡å¼ä¸åŒçš„æ˜¯, "),s("mark",[s("strong",[t._v("é€šçŸ¥ä¹‹åè¿›ç¨‹å¿…é¡»ç«‹å³å¤„ç†äº‹ä»¶")])]),t._v(", ä¸‹æ¬¡å†è°ƒç”¨ epoll_wait() æ—¶"),s("strong",[t._v("ä¸ä¼š")]),t._v("å†å¾—åˆ°äº‹ä»¶åˆ°è¾¾çš„é€šçŸ¥. è¿™ç§æ¨¡å¼å¾ˆå¤§ç¨‹åº¦ä¸Š"),s("strong",[t._v("å‡å°‘äº† epoll äº‹ä»¶è¢«é‡å¤è§¦å‘çš„æ¬¡æ•°")]),t._v(", å› æ­¤æ•ˆç‡è¦æ¯” LT æ¨¡å¼é«˜. "),s("strong",[t._v("åªæ”¯æŒ No-Blocking")]),t._v("(å¯ä»¥ç†è§£ä¸ºé©¬ä¸Šå°±éœ€è¦å¤„ç†æ‰€ä»¥æ˜¯éé˜»å¡), ä»¥é¿å…ç”±äºä¸€ä¸ªæ–‡ä»¶å¥æŸ„çš„é˜»å¡è¯»/é˜»å¡å†™æ“ä½œæŠŠå¤„ç†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦çš„ä»»åŠ¡é¥¿æ­».")]),t._v(" "),s("h5",{attrs:{id:"_4-åº”ç”¨åœºæ™¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-åº”ç”¨åœºæ™¯"}},[t._v("#")]),t._v(" 4.åº”ç”¨åœºæ™¯")]),t._v(" "),s("p",[t._v("ä¸è¦è®¤ä¸º select å’Œ poll éƒ½å·²ç»è¿‡æ—¶åªç”¨ epoll å°±å¯ä»¥, å®ƒä»¬éƒ½æœ‰å„è‡ªçš„ä½¿ç”¨åœºæ™¯.")]),t._v(" "),s("h6",{attrs:{id:"_1-selectåº”ç”¨åœºæ™¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-selectåº”ç”¨åœºæ™¯"}},[t._v("#")]),t._v(" (1)selectåº”ç”¨åœºæ™¯")]),t._v(" "),s("p",[t._v("select çš„ timeout å‚æ•°"),s("strong",[t._v("ç²¾åº¦ä¸º 1ns")]),t._v(", è€Œ poll å’Œ epoll ä¸º "),s("strong",[t._v("1ms")]),t._v(", å› æ­¤ "),s("strong",[t._v("select æ›´åŠ é€‚ç”¨äºå®æ—¶æ€§è¦æ±‚æ¯”è¾ƒé«˜")]),t._v("çš„åœºæ™¯, æ¯”å¦‚æ ¸ååº”å †çš„æ§åˆ¶.")]),t._v(" "),s("p",[s("strong",[t._v("select å¯ç§»æ¤æ€§æ›´å¥½")]),t._v(", å‡ ä¹è¢«"),s("strong",[t._v("æ‰€æœ‰ä¸»æµå¹³å°")]),t._v("æ‰€æ”¯æŒ.")]),t._v(" "),s("h6",{attrs:{id:"_2-pollåº”ç”¨åœºæ™¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-pollåº”ç”¨åœºæ™¯"}},[t._v("#")]),t._v(" (2)pollåº”ç”¨åœºæ™¯")]),t._v(" "),s("p",[t._v("poll "),s("strong",[t._v("æ²¡æœ‰æœ€å¤§æè¿°ç¬¦æ•°é‡çš„é™åˆ¶")]),t._v(", å¦‚æœ"),s("strong",[t._v("å¹³å°æ”¯æŒ")]),t._v("å¹¶ä¸”å¯¹"),s("strong",[t._v("å®æ—¶æ€§è¦æ±‚ä¸é«˜")]),t._v(", åº”è¯¥ä½¿ç”¨ "),s("strong",[t._v("poll")]),t._v(" è€Œé select.")]),t._v(" "),s("h6",{attrs:{id:"_3-epollåº”ç”¨åœºæ™¯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-epollåº”ç”¨åœºæ™¯"}},[t._v("#")]),t._v(" (3)epollåº”ç”¨åœºæ™¯")]),t._v(" "),s("p",[t._v("åªéœ€è¦è¿è¡Œåœ¨ "),s("strong",[t._v("Linux")]),t._v(" ä¸Š, æœ‰"),s("strong",[t._v("å¤§é‡çš„æè¿°ç¬¦")]),t._v("éœ€è¦åŒæ—¶è½®è¯¢, å¹¶ä¸”è¿™äº›è¿æ¥æœ€å¥½æ˜¯"),s("strong",[t._v("é•¿è¿æ¥")]),t._v(".")]),t._v(" "),s("p",[t._v("å¦‚æœéœ€è¦åŒæ—¶ç›‘æ§"),s("strong",[t._v("å°äº 1000")]),t._v(" ä¸ªæè¿°ç¬¦, å°±"),s("strong",[t._v("æ²¡æœ‰å¿…è¦")]),t._v("ä½¿ç”¨ epoll, å› ä¸ºè¿™ä¸ªåº”ç”¨åœºæ™¯ä¸‹å¹¶ä¸èƒ½ä½“ç° epoll çš„ä¼˜åŠ¿. éœ€è¦ç›‘æ§çš„æè¿°ç¬¦çŠ¶æ€"),s("strong",[t._v("å˜åŒ–å¤š")]),t._v(", è€Œä¸”éƒ½æ˜¯éå¸¸çŸ­æš‚çš„, ä¹Ÿ"),s("strong",[t._v("æ²¡æœ‰å¿…è¦")]),t._v("ä½¿ç”¨ epoll. å› ä¸º epoll ä¸­çš„æ‰€æœ‰æè¿°ç¬¦éƒ½å­˜å‚¨åœ¨å†…æ ¸ä¸­, é€ æˆæ¯æ¬¡éœ€è¦å¯¹æè¿°ç¬¦çš„çŠ¶æ€æ”¹å˜éƒ½éœ€è¦é€šè¿‡ epoll_ctl() è¿›è¡Œç³»ç»Ÿè°ƒç”¨, é¢‘ç¹ç³»ç»Ÿè°ƒç”¨é™ä½æ•ˆç‡. å¹¶ä¸” epoll çš„æè¿°ç¬¦å­˜å‚¨åœ¨å†…æ ¸, ä¸å®¹æ˜“è°ƒè¯•.")]),t._v(" "),s("p",[t._v("â€")]),t._v(" "),s("p",[t._v("â€")]),t._v(" "),s("h4",{attrs:{id:"å‚è€ƒèµ„æ–™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒèµ„æ–™"}},[t._v("#")]),t._v(" å‚è€ƒèµ„æ–™")]),t._v(" "),s("ul",[s("li",[t._v("Stevens W R, Fenner B, Rudoff A M. UNIX network programming[M]. Addison-Wesley Professional, 2004.")]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.ibm.com/developerworks/linux/library/l-async/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Boost application performance using asynchronous I/O"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365683(v=vs.85).aspx",target:"_blank",rel:"noopener noreferrer"}},[t._v("Synchronous and Asynchronous I/O"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://segmentfault.com/a/1190000003063859",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux IO æ¨¡å¼åŠ select, poll, epoll è¯¦è§£"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://daniel.haxx.se/docs/poll-vs-select.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("poll vs select vs event-based"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"http://www.ulduzsoft.com/2014/01/select-poll-epoll-practical-difference-for-system-architects/",target:"_blank",rel:"noopener noreferrer"}},[t._v("select / poll / epoll: practical difference for system architects"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://code.woboq.org/userspace/glibc/sysdeps/unix/sysv/linux/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Browse the source code of userspace/glibc/sysdeps/unix/sysv/linux/ online"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);