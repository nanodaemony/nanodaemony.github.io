(window.webpackJsonp=window.webpackJsonp||[]).push([[150],{462:function(s,t,a){"use strict";a.r(t);var n=a(7),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_3-kafka"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-kafka"}},[s._v("#")]),s._v(" 3.Kafka")]),s._v(" "),t("h4",{attrs:{id:"æ¦‚è¿°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ¦‚è¿°"}},[s._v("#")]),s._v(" æ¦‚è¿°")]),s._v(" "),t("p",[s._v("Kafka æ˜¯åŸºäº"),t("strong",[s._v("å‘å¸ƒ/è®¢é˜…æ¨¡å‹")]),s._v("çš„æ¶ˆæ¯ç³»ç»Ÿ, æ˜¯ä¸€ä¸ª"),t("strong",[s._v("åŸºäº Zookeeper åè°ƒçš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿ")]),s._v(", æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æµå¼å¤„ç†å¹³å°.")]),s._v(" "),t("blockquote",[t("p",[s._v("Kafkaçš„ç‰¹ç‚¹")])]),s._v(" "),t("p",[s._v("Kafka ä¸»è¦ç‰¹ç‚¹:")]),s._v(" "),t("ul",[t("li",[s._v("ä»¥æ—¶é—´å¤æ‚åº¦ä¸º O(1) çš„æ–¹å¼æä¾›"),t("strong",[s._v("æ¶ˆæ¯æŒä¹…åŒ–")]),s._v("èƒ½åŠ›, å³ä½¿å¯¹ TB çº§ä»¥ä¸Šæ•°æ®ä¹Ÿèƒ½ä¿è¯"),t("strong",[s._v("å¸¸æ•°æ—¶é—´å¤æ‚åº¦çš„è®¿é—®æ€§èƒ½")]),s._v(".")]),s._v(" "),t("li",[t("strong",[s._v("é«˜ååç‡")]),s._v(". èƒ½åšåˆ°å•æœºæ”¯æŒ"),t("strong",[s._v("æ¯ç§’ 100K æ¡ä»¥ä¸Š")]),s._v("æ¶ˆæ¯ä¼ è¾“.")]),s._v(" "),t("li",[s._v("æ”¯æŒ Kafka Server é—´çš„æ¶ˆæ¯åˆ†åŒºåŠåˆ†å¸ƒå¼æ¶ˆè´¹, åŒæ—¶ä¿è¯"),t("strong",[s._v("æ¯ä¸ª Partition å†…çš„æ¶ˆæ¯é¡ºåºä¼ è¾“")]),s._v(".")]),s._v(" "),t("li",[s._v("åŒæ—¶æ”¯æŒç¦»çº¿æ•°æ®å¤„ç†å’Œå®æ—¶æ•°æ®å¤„ç†.")]),s._v(" "),t("li",[s._v("æ”¯æŒåœ¨çº¿æ°´å¹³æ‰©å±•.")])]),s._v(" "),t("blockquote",[t("p",[s._v("Kafkaçš„åº”ç”¨åœºæ™¯")])]),s._v(" "),t("p",[s._v("Kafka ä¸»è¦åº”ç”¨åœºæ™¯:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("æ¶ˆæ¯é˜Ÿåˆ—")]),s._v(": å»ºç«‹å®æ—¶æµæ•°æ®ç®¡é“, ä»¥å¯é åœ°åœ¨ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºä¹‹é—´è·å–æ•°æ®.")]),s._v(" "),t("li",[t("strong",[s._v("æ•°æ®å¤„ç†:")]),s._v("  æ„å»ºå®æ—¶çš„æµæ•°æ®å¤„ç†ç¨‹åºæ¥è½¬æ¢æˆ–å¤„ç†æ•°æ®æµ.")]),s._v(" "),t("li",[t("strong",[s._v("æ—¥å¿—æ”¶é›†")]),s._v(": å¯ä»¥ç”¨ Kafka æ”¶é›†å„ç§æœåŠ¡çš„æ—¥å¿—, å¹¶ä»¥"),t("strong",[s._v("ç»Ÿä¸€æ¥å£æœåŠ¡")]),s._v("çš„æ–¹å¼å¼€æ”¾ç»™å„ç§æ¶ˆè´¹è€…, å¦‚ Hadoop, Hbase, Solr ç­‰.")]),s._v(" "),t("li",[t("strong",[s._v("ç”¨æˆ·æ´»åŠ¨è·Ÿè¸ª")]),s._v(": å¯ä»¥ç”¨äºè®°å½•ç”¨æˆ·çš„æµè§ˆç½‘é¡µ, æœç´¢, ç‚¹å‡»ç­‰æ´»åŠ¨, è¿™äº›ä¿¡æ¯è¢«å„ä¸ªæœåŠ¡å™¨å‘å¸ƒåˆ° Kafka, æ¶ˆè´¹è€…è€…é€šè¿‡è®¢é˜…è¿™äº›ä¿¡æ¯æ¥åšå®æ—¶ç›‘æ§åˆ†æ, æˆ–è€…è£…è½½åˆ° Hadoop, æ•°æ®ä»“åº“ä¸­åšç¦»çº¿åˆ†æå’ŒæŒ–æ˜.")]),s._v(" "),t("li",[t("strong",[s._v("è¿è¥æŒ‡æ ‡")]),s._v(": å¯ä»¥ç”¨æ¥è®°å½•è¿è¥ç›‘æ§æ•°æ®. åŒ…æ‹¬æ”¶é›†å„ç§åˆ†å¸ƒå¼åº”ç”¨æ•°æ®, ç”Ÿäº§å„ç§æ“ä½œçš„é›†ä¸­åé¦ˆ, æ¯”å¦‚æŠ¥è­¦å’ŒæŠ¥å‘Š.")])]),s._v(" "),t("h4",{attrs:{id:"kafkaæ¶æ„æ¨¡å‹ğŸŒŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kafkaæ¶æ„æ¨¡å‹ğŸŒŸ"}},[s._v("#")]),s._v(" Kafkaæ¶æ„æ¨¡å‹ğŸŒŸ")]),s._v(" "),t("p",[s._v("æ•´ä½“æ¶æ„å¦‚ä¸‹æ‰€ç¤º.")]),s._v(" "),t("p",[s._v("â€‹"),t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703210722829.png",alt:""}}),s._v("â€‹")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Producer(ç”Ÿäº§è€…)")]),s._v(" : æ¶ˆæ¯ç”Ÿäº§è€….")]),s._v(" "),t("li",[t("strong",[s._v("Consumer(æ¶ˆè´¹è€…)")]),s._v(" : æ¶ˆæ¯æ¶ˆè´¹è€….")]),s._v(" "),t("li",[t("strong",[s._v("Consumer Group(æ¶ˆè´¹è€…ç»„)")]),s._v(" : ç”±å¤šä¸ª consumer ç»„æˆ. æ¶ˆè´¹è€…ç»„å†…æ¯ä¸ªæ¶ˆè´¹è€…è´Ÿè´£æ¶ˆè´¹"),t("strong",[s._v("ä¸åŒåˆ†åŒº")]),s._v("çš„æ•°æ®, "),t("strong",[s._v("ä¸€ä¸ªåˆ†åŒºåªèƒ½ç”±ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹, æ¶ˆè´¹è€…ç»„ä¹‹é—´äº’ä¸å½±å“")]),s._v(". æ¶ˆè´¹è€…ç»„æ˜¯é€»è¾‘ä¸Šçš„ä¸€ä¸ªè®¢é˜…è€…. å¦‚æœåªæœ‰ä¸€ä¸ªæ¶ˆè´¹ç»„, é‚£ä¹ˆæ¶æ„å…¶å®å°±æ˜¯æ¶ˆæ¯æ¨¡å‹ä¸­çš„"),t("strong",[s._v("ç‚¹å¯¹ç‚¹æ¨¡å‹")]),s._v("; å¦‚æœæœ‰å¤šä¸ªæ¶ˆè´¹ç»„, é‚£å°±å¯¹åº”æ¶ˆæ¯æ¨¡å‹ä¸­çš„"),t("strong",[s._v("å‘å¸ƒè®¢é˜…æ¨¡å‹")]),s._v(".")]),s._v(" "),t("li",[t("strong",[s._v("Broker")]),s._v(": å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ Kafka "),t("strong",[s._v("æœåŠ¡å™¨å®ä¾‹")]),s._v(". å¤šä¸ª Broker ç»„æˆ Kafka Cluster.")]),s._v(" "),t("li",[t("strong",[s._v("Topic(ä¸»é¢˜)")]),s._v(" : ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°ç‰¹å®šçš„"),t("strong",[s._v("ä¸»é¢˜")]),s._v(", æ¶ˆè´¹è€…éœ€è®¢é˜…ç‰¹å®šçš„ä¸»é¢˜æ¥æ¶ˆè´¹æ¶ˆæ¯.")]),s._v(" "),t("li",[t("strong",[s._v("Partition(åˆ†åŒº)")]),s._v(" : Partition å¯ä»¥ç†è§£ä¸º"),t("strong",[s._v("æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„é˜Ÿåˆ—")]),s._v(". ä¸»è¦ä½¿ç”¨æ¥å®ç°è´Ÿè½½å‡è¡¡. Partition å±äº Topic çš„ä¸€éƒ¨åˆ†. ä¸€ä¸ª "),t("strong",[s._v("Topic å¯ä»¥æœ‰å¤šä¸ª Partition")]),s._v(", åŒä¸€ Topic ä¸‹çš„ Partition å¯ä»¥"),t("strong",[s._v("åˆ†å¸ƒåœ¨ä¸åŒçš„ Broker ä¸Š")]),s._v(", è¿™è¡¨æ˜ä¸€ä¸ª Topic å¯ä»¥åˆ†å¸ƒåœ¨å¤šä¸ª Broker.")]),s._v(" "),t("li",[t("strong",[s._v("Replica")]),s._v(": ä¸ºä¿è¯é›†ç¾¤ä¸­çš„æŸä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶, è¯¥èŠ‚ç‚¹ä¸Šçš„ Partition æ•°æ®ä¸ä¸¢å¤±, Kafka æä¾›äº†"),t("strong",[s._v("å‰¯æœ¬æœºåˆ¶")]),s._v(", ä¸€ä¸ª Topic çš„æ¯ä¸ªåˆ†åŒºéƒ½æœ‰è‹¥å¹²ä¸ªå‰¯æœ¬, å‰¯æœ¬åŒ…å«ä¸€ä¸ª "),t("strong",[s._v("leader")]),s._v(" å’Œè‹¥å¹²ä¸ª "),t("strong",[s._v("follower")]),s._v(".")]),s._v(" "),t("li",[t("strong",[s._v("Leader")]),s._v(": æ¯ä¸ªåˆ†åŒº"),t("strong",[s._v('å¤šä¸ªå‰¯æœ¬çš„ "ä¸»"')]),s._v(" , ç”Ÿäº§è€…å‘é€æ•°æ®çš„å¯¹è±¡, ä»¥åŠæ¶ˆè´¹è€…æ¶ˆè´¹æ•°æ®çš„å¯¹è±¡éƒ½æ˜¯ leader.")]),s._v(" "),t("li",[t("strong",[s._v("Follower")]),s._v(": æ¯ä¸ªåˆ†åŒº"),t("strong",[s._v('å¤šä¸ªå‰¯æœ¬ä¸­çš„ "ä»"')]),s._v(" , å®æ—¶ä» leader ä¸­"),t("strong",[s._v("åŒæ­¥")]),s._v("æ•°æ®, ä¿æŒå’Œ leader æ•°æ®çš„ä¸€è‡´. leader å‘ç”Ÿæ•…éšœæ—¶, ä¼šé€‰ä¸¾ä¸€ä¸ª follower ä¼šæˆä¸ºæ–°çš„ leader.")])]),s._v(" "),t("p",[s._v("æœåŠ¡ç«¯(Brokers)å’Œå®¢æˆ·ç«¯(Producer, Consumer)ä¹‹é—´é€šè¿‡ "),t("strong",[s._v("TCP åè®®")]),s._v("å®Œæˆé€šä¿¡.")]),s._v(" "),t("h4",{attrs:{id:"ç”Ÿäº§è€…ğŸŒŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç”Ÿäº§è€…ğŸŒŸ"}},[s._v("#")]),s._v(" ç”Ÿäº§è€…ğŸŒŸ")]),s._v(" "),t("h5",{attrs:{id:"_1-å‘æ¶ˆæ¯æµç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å‘æ¶ˆæ¯æµç¨‹"}},[s._v("#")]),s._v(" 1.å‘æ¶ˆæ¯æµç¨‹")]),s._v(" "),t("p",[t("strong",[s._v("Kafka æ¯æ¬¡å‘é€æ•°æ®éƒ½æ˜¯å‘ Leader åˆ†åŒºå‘é€æ•°æ®, å¹¶é¡ºåºå†™å…¥åˆ°ç£ç›˜, ç„¶å Leader åˆ†åŒºä¼šå°†æ•°æ®åŒæ­¥åˆ°å„ä¸ª Follower åˆ†åŒº")]),s._v(".")]),s._v(" "),t("p",[s._v("æ•°æ®å†™å…¥åˆ†åŒºçš„åŸåˆ™: 1.æ•°æ®åœ¨å†™å…¥çš„æ—¶å€™å¯ä»¥æŒ‡å®šéœ€è¦å†™å…¥çš„åˆ†åŒº, å¦‚æœæœ‰åˆ™å†™å…¥æŒ‡å®šçš„åˆ†åŒº; 2.å¦‚æœæ²¡æœ‰æŒ‡å®šåˆ†åŒº, ä½†è®¾ç½®äº†æ•°æ® key, åˆ™æ ¹æ® key å€¼ hash å‡ºä¸€ä¸ªåˆ†åŒº; 3.å¦‚æœæ—¢æ²¡æŒ‡å®šåˆ†åŒºä¹Ÿæ²¡æœ‰è®¾ç½® key, åˆ™è½®è¯¢é€‰å‡ºä¸€ä¸ªåˆ†åŒº.")]),s._v(" "),t("p",[s._v("å‘ç°æ¶ˆæ¯çš„æ•´ä½“æµç¨‹å¦‚ä¸‹:")]),s._v(" "),t("ol",[t("li",[s._v("é¦–å…ˆåˆ›å»ºä¸€ä¸ª "),t("strong",[s._v("ProducerRecord")]),s._v(", è¿™ä¸ªå¯¹è±¡éœ€è¦åŒ…å«æ¶ˆæ¯çš„"),t("strong",[s._v("ä¸»é¢˜(topic)å’Œå€¼(value)")]),s._v(" , å¯ä»¥é€‰æ‹©æ€§"),t("strong",[s._v("æŒ‡å®šä¸€ä¸ªé”®å€¼(key)æˆ–åˆ†åŒº(partition)")]),s._v(" .")]),s._v(" "),t("li",[s._v("å‘é€æ¶ˆæ¯æ—¶, ç”Ÿäº§è€…ä¼šå°†é”®å’Œå€¼"),t("strong",[s._v("åºåˆ—åŒ–ä¸ºå­—èŠ‚æ•°ç»„")]),s._v(", ç„¶åå‘é€åˆ°"),t("strong",[s._v("åˆ†é…å™¨(partitioner)")]),s._v(" .")]),s._v(" "),t("li",[s._v("å¦‚æœæŒ‡å®šäº†"),t("strong",[s._v("åˆ†åŒº")]),s._v(", é‚£ä¹ˆåˆ†é…å™¨è¿”å›è¯¥åˆ†åŒºå³å¯; å¦åˆ™åˆ†é…å™¨å°†ä¼š"),t("strong",[s._v("åŸºäºé”®å€¼")]),s._v("æ¥é€‰æ‹©ä¸€ä¸ªåˆ†åŒºå¹¶è¿”å›.")]),s._v(" "),t("li",[s._v("é€‰æ‹©å®Œåˆ†åŒºå, ç”Ÿäº§è€…çŸ¥é“äº†æ¶ˆæ¯æ‰€å±çš„ä¸»é¢˜å’Œåˆ†åŒº, å®ƒå°†è¿™æ¡è®°å½•æ·»åŠ åˆ°ç›¸åŒä¸»é¢˜å’Œåˆ†åŒºçš„"),t("strong",[s._v("æ‰¹é‡æ¶ˆæ¯")]),s._v("ä¸­, å¦ä¸€ä¸ªçº¿ç¨‹è´Ÿè´£å‘é€è¿™äº›æ‰¹é‡æ¶ˆæ¯åˆ°å¯¹åº”çš„ broker.")]),s._v(" "),t("li",[s._v("broker æ¥æ”¶åˆ°æ¶ˆæ¯å, å¦‚æœæˆåŠŸå†™å…¥åˆ™"),t("strong",[s._v("è¿”å›ä¸€ä¸ªåŒ…å«æ¶ˆæ¯çš„ä¸»é¢˜, åˆ†åŒºåŠä½ç§»çš„ RecordMetadata å¯¹è±¡")]),s._v(", å¦åˆ™è¿”å›å¼‚å¸¸.")]),s._v(" "),t("li",[s._v("ç”Ÿäº§è€…æ¥æ”¶åˆ°ç»“æœå, å¯¹äºå¼‚å¸¸å¯èƒ½ä¼šè¿›è¡Œé‡è¯•.")])]),s._v(" "),t("h5",{attrs:{id:"_2-å‘æ¶ˆæ¯æ¨¡å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å‘æ¶ˆæ¯æ¨¡å‹"}},[s._v("#")]),s._v(" 2.å‘æ¶ˆæ¯æ¨¡å‹")]),s._v(" "),t("p",[s._v("Kafka ä¸­ "),t("strong",[s._v("Partition(åˆ†åŒº)æ˜¯å­˜å‚¨ä¿å­˜æ¶ˆæ¯çš„åœ°æ–¹")]),s._v(", å‘é€çš„æ¶ˆæ¯éƒ½è¢«æ”¾åœ¨åˆ†åŒºé‡Œ. æ¯æ¬¡æ·»åŠ æ¶ˆæ¯åˆ° Partition çš„æ—¶å€™éƒ½ä¼šé‡‡ç”¨"),t("strong",[s._v("å°¾åŠ æ³•")]),s._v(", å¦‚å›¾æ‰€ç¤º.")]),s._v(" "),t("p",[s._v("â€‹"),t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703211238314.png",alt:""}}),s._v("â€‹")]),s._v(" "),t("h4",{attrs:{id:"æ¶ˆè´¹è€…ğŸŒŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ¶ˆè´¹è€…ğŸŒŸ"}},[s._v("#")]),s._v(" æ¶ˆè´¹è€…ğŸŒŸ")]),s._v(" "),t("h5",{attrs:{id:"_1-æ¶ˆè´¹è€…ä¸æ¶ˆè´¹ç»„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ¶ˆè´¹è€…ä¸æ¶ˆè´¹ç»„"}},[s._v("#")]),s._v(" 1.æ¶ˆè´¹è€…ä¸æ¶ˆè´¹ç»„")]),s._v(" "),t("p",[s._v("æ¶ˆè´¹è€…éœ€è¦ä¸»åŠ¨ä» Leader åˆ†åŒºæ‹‰å–æ•°æ®.")]),s._v(" "),t("p",[t("strong",[s._v("å¤šä¸ªæ¶ˆè´¹è€…å¯ä»¥ç»„æˆä¸€ä¸ªæ¶ˆè´¹ç»„, åŒä¸€ä¸ªæ¶ˆè´¹ç»„è€…çš„æ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹åŒä¸€ä¸ª topic ä¸‹ä¸åŒåˆ†åŒºçš„æ•°æ®, ä½†ä¸€ä¸ªåˆ†åŒºçš„æ¶ˆæ¯åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹ç»„å†…çš„ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹, é˜²æ­¢å‡ºç°é‡å¤æ¶ˆè´¹çš„é—®é¢˜. æ³¨æ„: ä¸åŒçš„æ¶ˆè´¹è€…ç»„, ä¾ç„¶å¯ä»¥æ¶ˆè´¹åŒä¸€ä¸ªåˆ†åŒºçš„æ•°æ®")]),s._v(".")]),s._v(" "),t("p",[s._v("å‡è®¾æœ‰ä¸€ä¸ª T1 ä¸»é¢˜, è¯¥ä¸»é¢˜æœ‰ 4 ä¸ªåˆ†åŒº. åŒæ—¶æœ‰ä¸€ä¸ªæ¶ˆè´¹ç»„ G1, è¯¥æ¶ˆè´¹ç»„åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€… C1. é‚£ä¹ˆ C1 å°†ä¼šæ¶ˆè´¹è¿™ 4 ä¸ªåˆ†åŒºçš„æ¶ˆæ¯, å¦‚ä¸‹æ‰€ç¤º.")]),s._v(" "),t("p",[s._v("â€‹"),t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703212022186.png",alt:""}}),s._v("â€‹")]),s._v(" "),t("p",[s._v("å¦‚æœå¢åŠ æ–°çš„æ¶ˆè´¹è€… C2 åˆ°æ¶ˆè´¹ç»„ G1, é‚£ä¹ˆæ¯ä¸ªæ¶ˆè´¹è€…å°†ä¼šåˆ†åˆ«æ¶ˆè´¹"),t("strong",[s._v("ä¸¤ä¸ªåˆ†åŒº")]),s._v("çš„æ¶ˆæ¯, å¦‚ä¸‹æ‰€ç¤º:")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703212044971.png",alt:""}})]),s._v(" "),t("p",[s._v("å¦‚æœå¢åŠ åˆ° 4 ä¸ªæ¶ˆè´¹è€…, é‚£ä¹ˆæ¯ä¸ªæ¶ˆè´¹è€…å°†ä¼šåˆ†åˆ«æ¶ˆè´¹"),t("strong",[s._v("ä¸€ä¸ªåˆ†åŒº")]),s._v("çš„æ¶ˆæ¯, å¦‚ä¸‹æ‰€ç¤º:")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703212107839.png",alt:""}})]),s._v(" "),t("p",[s._v("ä½†å¦‚æœç»§ç»­å¢åŠ æ¶ˆè´¹è€…åˆ°è¿™ä¸ªæ¶ˆè´¹ç»„, "),t("strong",[s._v("å‰©ä½™çš„æ¶ˆè´¹è€…å°†ä¼šç©ºé—²")]),s._v(", ä¸ä¼šæ¶ˆè´¹ä»»ä½•æ¶ˆæ¯:")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703212140432.png",alt:""}})]),s._v(" "),t("p",[s._v("æ€»è€Œè¨€ä¹‹, å½“æ¶ˆè´¹é€Ÿåº¦ä½äºç”Ÿäº§é€Ÿåº¦å¼•èµ·æ¶ˆæ¯å †ç§¯æ—¶, å¯ä»¥"),t("strong",[s._v("é€šè¿‡å¢åŠ æ¶ˆè´¹è€…æ•°é‡æ¥è¿›è¡Œæ°´å¹³æ‰©å±•æå‡æ¶ˆè´¹èƒ½åŠ›")]),s._v(". å› æ­¤å»ºè®®åˆ›å»ºä¸»é¢˜æ—¶é€‰æ‹©ä½¿ç”¨é€‚é‡çš„åˆ†åŒºæ•°, è¿™æ ·å¯ä»¥åœ¨æ¶ˆè´¹è´Ÿè½½é«˜çš„æƒ…å†µä¸‹å¢åŠ æ¶ˆè´¹è€…æ¥æå‡æ€§èƒ½. æ³¨æ„: æ¶ˆè´¹è€…çš„æ•°é‡"),t("strong",[s._v("ä¸åº”è¯¥æ¯”åˆ†åŒºæ•°å¤š")]),s._v(", å› ä¸ºå¤šå‡ºæ¥çš„æ¶ˆè´¹è€…æ˜¯ç©ºé—²çš„, æ²¡æœ‰ä»»ä½•å¸®åŠ©.")]),s._v(" "),t("p",[t("strong",[s._v("Kafka åªéœ€å†™å…¥ä¸€æ¬¡æ¶ˆæ¯, å°±èƒ½æ”¯æŒä»»æ„å¤šçš„æ¶ˆè´¹è€…ç»„è¯»å–è¿™ä¸ªæ¶ˆæ¯.")]),s._v(" "),t("strong",[t("strong",[s._v("æ¢å¥è¯è¯´,")])]),s._v("   ******æ¯ä¸ª**"),t("strong",[t("strong",[s._v("â€‹")]),s._v("æ¶ˆè´¹è€…ç»„")]),s._v("â€‹****"),t("strong",[s._v("éƒ½å¯ä»¥æ¶ˆè´¹å…¨é‡çš„æ¶ˆæ¯"),t("strong",[t("strong",[t("strong",[s._v("â€‹ "),t("strong",[t("strong",[s._v(". ä¸ºäº†ä½¿å¾—æ¯ä¸ªåº”ç”¨éƒ½èƒ½è¯»åˆ°å…¨é‡æ¶ˆæ¯, åº”ç”¨éœ€è¦æœ‰")])]),s._v("â€‹")]),s._v("ä¸åŒçš„æ¶ˆè´¹ç»„")]),s._v(". å‡å¦‚æ–°å¢äº†ä¸€ä¸ªæ–°çš„æ¶ˆè´¹ç»„ G2, è€Œè¿™ä¸ªæ¶ˆè´¹ç»„æœ‰")]),s._v("ä¸¤ä¸ªæ¶ˆè´¹è€…")]),s._v(", é‚£ä¹ˆæ¶ˆè´¹æ–¹å¼å¦‚ä¸‹æ‰€ç¤º.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703212219650.png",alt:""}})]),s._v(" "),t("p",[s._v("è¿™é‡Œæ¶ˆè´¹ç»„ G1 å’Œ G2 éƒ½èƒ½æ”¶åˆ° T1 ä¸»é¢˜çš„"),t("strong",[s._v("å…¨é‡æ¶ˆæ¯")]),s._v(", åœ¨é€»è¾‘æ„ä¹‰ä¸Šæ¥è¯´å®ƒä»¬"),t("strong",[s._v("å±äºä¸åŒçš„åº”ç”¨")]),s._v(".")]),s._v(" "),t("p",[s._v("å¦‚æœåº”ç”¨éœ€è¦è¯»å–å…¨é‡æ¶ˆæ¯, é‚£éœ€è¦ä¸ºè¯¥åº”ç”¨è®¾ç½®ä¸€ä¸ªæ¶ˆè´¹ç»„; å¦‚æœè¯¥åº”ç”¨æ¶ˆè´¹èƒ½åŠ›ä¸è¶³, é‚£ä¹ˆè€ƒè™‘åœ¨è¿™ä¸ªæ¶ˆè´¹ç»„é‡Œå¢åŠ æ¶ˆè´¹è€…. å®é™…çš„åº”ç”¨ä¸­, "),t("strong",[s._v("å»ºè®®æ¶ˆè´¹è€…ç»„çš„æ¶ˆè´¹è€…æ•°é‡ä¸åˆ†åŒºæ•°é‡ä¿æŒä¸€è‡´")]),s._v(".")]),s._v(" "),t("h5",{attrs:{id:"_2-åˆ†åŒºé‡å¹³è¡¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-åˆ†åŒºé‡å¹³è¡¡"}},[s._v("#")]),s._v(" 2.åˆ†åŒºé‡å¹³è¡¡")]),s._v(" "),t("p",[s._v("å½“"),t("strong",[s._v("æ–°çš„æ¶ˆè´¹è€…")]),s._v("åŠ å…¥"),t("strong",[s._v("æ¶ˆè´¹ç»„")]),s._v(", å®ƒä¼šæ¶ˆè´¹ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†åŒº, è€Œè¿™äº›åˆ†åŒºä¹‹å‰æ˜¯ç”±å…¶ä»–æ¶ˆè´¹è€…è´Ÿè´£çš„; æˆ–å½“æœ‰æ¶ˆè´¹è€…ç¦»å¼€æ¶ˆè´¹ç»„(å¦‚é‡å¯, å®•æœºç­‰)æ—¶, å®ƒæ‰€æ¶ˆè´¹çš„åˆ†åŒºä¼š"),t("strong",[s._v("åˆ†é…ç»™å…¶ä»–åˆ†åŒº")]),s._v(". è¿™ç§ç°è±¡ç§°ä¸º"),t("strong",[s._v("é‡å¹³è¡¡(rebalance)")]),s._v(" . é‡å¹³è¡¡ä¿è¯äº†é«˜å¯ç”¨å’Œæ°´å¹³æ‰©å±•.")]),s._v(" "),t("p",[t("strong",[s._v("æ³¨æ„: åœ¨é‡å¹³è¡¡æœŸé—´, æ‰€æœ‰æ¶ˆè´¹è€…éƒ½ä¸èƒ½æ¶ˆè´¹æ¶ˆæ¯, å› æ­¤è¿™ä¼šé€ æˆæ•´ä¸ªæ¶ˆè´¹ç»„çŸ­æš‚çš„ä¸å¯ç”¨")]),s._v(". å°†åˆ†åŒºè¿›è¡Œé‡å¹³è¡¡ä¹Ÿä¼šå¯¼è‡´åŸæ¥çš„æ¶ˆè´¹è€…çŠ¶æ€è¿‡æœŸ, å¯¼è‡´æ¶ˆè´¹è€…éœ€è¦é‡æ–°æ›´æ–°çŠ¶æ€, è¿™æ®µæœŸé—´ä¹Ÿä¼šé™ä½æ¶ˆè´¹æ€§èƒ½.")]),s._v(" "),t("p",[s._v("æ¶ˆè´¹è€…é€šè¿‡"),t("strong",[s._v("å®šæœŸå‘é€å¿ƒè·³")]),s._v("(hearbeat)åˆ°ä¸€ä¸ªä½œä¸ºç»„åè°ƒè€…(group coordinator)çš„ broker æ¥ä¿æŒåœ¨æ¶ˆè´¹ç»„å†…å­˜æ´». è¿™ä¸ª broker ä¸æ˜¯å›ºå®šçš„, æ¯ä¸ªæ¶ˆè´¹ç»„éƒ½å¯èƒ½ä¸åŒ. å½“æ¶ˆè´¹è€…æ‹‰å–æ¶ˆæ¯æˆ–è€…æäº¤æ—¶, ä¾¿ä¼šå‘é€å¿ƒè·³. å¦‚æœæ¶ˆè´¹è€…è¶…è¿‡ä¸€å®šæ—¶é—´æ²¡æœ‰å‘é€å¿ƒè·³, é‚£ä¹ˆå®ƒçš„"),t("strong",[s._v("ä¼šè¯(session)å°±ä¼šè¿‡æœŸ")]),s._v(", ç»„åè°ƒè€…ä¼šè®¤ä¸ºè¯¥æ¶ˆè´¹è€…å·²ç»å®•æœº, ç„¶åè§¦å‘é‡å¹³è¡¡. ä»æ¶ˆè´¹è€…å®•æœºåˆ°ä¼šè¯è¿‡æœŸæ˜¯æœ‰ä¸€å®šæ—¶é—´çš„, è¿™æ®µæ—¶é—´å†…è¯¥æ¶ˆè´¹è€…çš„åˆ†åŒºéƒ½ä¸èƒ½è¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹. å¯ä»¥è¿›è¡Œ"),t("strong",[s._v("ä¼˜é›…å…³é—­")]),s._v(", è¿™æ ·æ¶ˆè´¹è€…ä¼šå‘é€ç¦»å¼€çš„æ¶ˆæ¯ç»™ç»„åè°ƒè€…, è¿™æ ·ç»„åè°ƒè€…å¯ä»¥"),t("strong",[s._v("ç«‹å³è¿›è¡Œé‡å¹³è¡¡")]),s._v("è€Œä¸éœ€è¦ç­‰å¾…ä¼šè¯è¿‡æœŸ.")]),s._v(" "),t("p",[t("strong",[s._v("Kafka å°†å‘é€å¿ƒè·³ä¸æ‹‰å–æ¶ˆæ¯è¿›è¡Œåˆ†ç¦»")]),s._v(", è¿™æ ·å‘é€å¿ƒè·³çš„é¢‘ç‡ä¸å—æ‹‰å–çš„é¢‘ç‡å½±å“. é«˜ç‰ˆæœ¬çš„ Kafka æ”¯æŒé…ç½®ä¸€ä¸ªæ¶ˆè´¹è€…å¤šé•¿æ—¶é—´ä¸æ‹‰å–æ¶ˆæ¯ä½†ä»ç„¶ä¿æŒå­˜æ´», è¿™ä¸ªé…ç½®å¯ä»¥é¿å…æ´»é”(livelock). "),t("strong",[s._v("æ´»é”")]),s._v("æ˜¯æŒ‡åº”ç”¨æ²¡æœ‰æ•…éšœä½†æ˜¯ç”±äºæŸäº›åŸå› ä¸èƒ½è¿›ä¸€æ­¥æ¶ˆè´¹.")]),s._v(" "),t("h5",{attrs:{id:"_3-kafkaæ¶ˆè´¹æ¨¡å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-kafkaæ¶ˆè´¹æ¨¡å¼"}},[s._v("#")]),s._v(" 3.Kafkaæ¶ˆè´¹æ¨¡å¼")]),s._v(" "),t("p",[s._v("æ¶ˆè´¹è€…ä» Broker è·å–åˆ°æ•°æ®æœ‰ä¸¤ç§æ–¹å¼. 1."),t("strong",[s._v("push æ¨¡å¼")]),s._v(": Broker å‘æ¶ˆè´¹è€…"),t("strong",[s._v("æ¨é€æ•°æ®")]),s._v("; 2."),t("strong",[s._v("pull æ¨¡å¼")]),s._v(": æ¶ˆè´¹è€…ä» Broker "),t("strong",[s._v("æ‹‰å–æ•°æ®")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("push æ¨¡å¼")]),s._v("çš„ç›®æ ‡æ˜¯å°½å¯èƒ½ä»¥æœ€å¿«é€Ÿåº¦ä¼ é€’æ¶ˆæ¯, ä½†æ˜¯è¿™æ ·å¾ˆ"),t("strong",[s._v("å®¹æ˜“é€ æˆæ¶ˆè´¹è€…æ¥ä¸åŠå¤„ç†æ¶ˆæ¯")]),s._v(", å…¸å‹çš„è¡¨ç°å°±æ˜¯æ‹’ç»æœåŠ¡ä»¥åŠç½‘ç»œæ‹¥å¡. push æ¨¡å¼å¾ˆéš¾é€‚åº”æ¶ˆè´¹é€Ÿç‡ä¸åŒçš„æ¶ˆè´¹è€…, å› ä¸ºè¿™ç§æ¨¡å¼ä¸‹æ¶ˆæ¯å‘é€é€Ÿç‡ç”± broker å†³å®š. è€Œ "),t("strong",[s._v("pull æ¨¡å¼")]),s._v("åˆ™å¯ä»¥æ ¹æ®æ¶ˆè´¹è€…çš„"),t("strong",[s._v("æ¶ˆè´¹èƒ½åŠ›")]),s._v("ä»¥é€‚å½“çš„é€Ÿç‡æ¶ˆè´¹æ¶ˆæ¯.")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("å¯¹ Kafka è€Œè¨€, pull æ¨¡å¼æ›´åˆé€‚. æ¶ˆè´¹è€…å¯ä»¥è‡ªå·±æ§åˆ¶æ¶ˆè´¹æ¶ˆæ¯çš„é€Ÿç‡")])]),s._v(", ä¹Ÿå¯ä»¥è‡ªå·±æ§åˆ¶æ¶ˆè´¹æ–¹å¼: å³å¯æ‰¹é‡æ¶ˆè´¹ä¹Ÿå¯é€æ¡æ¶ˆè´¹, åŒæ—¶è¿˜èƒ½é€‰æ‹©ä¸åŒçš„æäº¤æ–¹å¼ä»è€Œå®ç°ä¸åŒçš„ä¼ è¾“è¯­ä¹‰.")]),s._v(" "),t("h5",{attrs:{id:"_4-æ¶ˆè´¹ä½ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-æ¶ˆè´¹ä½ç½®"}},[s._v("#")]),s._v(" 4.æ¶ˆè´¹ä½ç½®")]),s._v(" "),t("p",[s._v("åˆ†åŒºä¸­çš„"),t("strong",[s._v("æ¶ˆæ¯å¯ä»¥è¢«ä¸åŒçš„æ¶ˆè´¹ç»„å¤šæ¬¡æ¶ˆè´¹")]),s._v(", é‚£åˆ†åŒºä¸­è¢«æ¶ˆè´¹çš„æ¶ˆæ¯æ˜¯ä½•æ—¶åˆ é™¤çš„? åˆ†åŒºåˆæ˜¯å¦‚ä½•çŸ¥é“ä¸€ä¸ªæ¶ˆè´¹ç»„å½“å‰æ¶ˆè´¹çš„ä½ç½®å‘¢?")]),s._v(" "),t("p",[s._v("Partition ä¼šä¸º"),t("strong",[s._v("æ¯ä¸ªæ¶ˆè´¹ç»„ä¿å­˜ä¸€ä¸ªåç§»é‡")]),s._v(", è®°å½•"),t("strong",[s._v("æ¶ˆè´¹ç»„æ¶ˆè´¹åˆ°çš„ä½ç½®")]),s._v(". å¦‚ä¸‹å›¾:")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703212811956.png",alt:""}})]),s._v(" "),t("p",[s._v("æ— è®ºæ¶ˆæ¯æ˜¯å¦è¢«æ¶ˆè´¹, "),t("mark",[t("strong",[s._v("åˆ†åŒºä»ä¸åˆ é™¤æ¶ˆæ¯, é™¤éæ¶ˆæ¯åˆ°æœŸ")])]),s._v(". å¦‚è®¾ç½®ä¿ç•™æ—¶é—´ä¸º 2 å¤©, åˆ™æ¶ˆæ¯å‘å¸ƒ 2 å¤©å†…ä»»ä½•æ¶ˆè´¹ç»„éƒ½å¯ä»¥æ¶ˆè´¹, 2 å¤©åæ¶ˆæ¯è‡ªåŠ¨è¢«åˆ é™¤.")]),s._v(" "),t("h5",{attrs:{id:"_5-æ¶ˆæ¯æ¶ˆè´¹é¡ºåº"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-æ¶ˆæ¯æ¶ˆè´¹é¡ºåº"}},[s._v("#")]),s._v(" 5.æ¶ˆæ¯æ¶ˆè´¹é¡ºåº")]),s._v(" "),t("p",[s._v("åœ¨ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„è¿‡ç¨‹ä¸­ç»å¸¸æœ‰ä¸šåŠ¡åœºæ™¯éœ€è¦"),t("strong",[s._v("ä¸¥æ ¼ä¿è¯")]),s._v("æ¶ˆæ¯çš„æ¶ˆè´¹é¡ºåº, æ¯”å¦‚åŒæ—¶å‘äº† 2 ä¸ªæ¶ˆæ¯, è¿™ 2 ä¸ªæ¶ˆæ¯å¯¹åº”çš„æ“ä½œåˆ†åˆ«å¯¹åº”çš„æ•°æ®åº“æ“ä½œæ˜¯: æ›´æ”¹ç”¨æˆ·ä¼šå‘˜ç­‰çº§, æ ¹æ®ä¼šå‘˜ç­‰çº§è®¡ç®—è®¢å•ä»·æ ¼. å‡å¦‚è¿™ä¸¤æ¡æ¶ˆæ¯çš„æ¶ˆè´¹é¡ºåºä¸ä¸€æ ·é€ æˆçš„æœ€ç»ˆç»“æœå°±ä¼šæˆªç„¶ä¸åŒ.")]),s._v(" "),t("p",[s._v("Kafka ä¸­ä¸€ä¸ª topic çš„æ¶ˆæ¯æ˜¯"),t("strong",[s._v("è¢«æ‰“æ•£åˆ†é…åˆ°å¤šä¸ªåˆ†åŒºä¸­å­˜å‚¨çš„")]),s._v(", æ¶ˆè´¹ç»„åœ¨æ¶ˆè´¹æ—¶éœ€è¦ä»ä¸åŒåˆ†åŒºè·å–æ¶ˆæ¯, é‚£æœ€ç»ˆå¦‚ä½•é‡å»ºå‡º Topic ä¸­æ¶ˆæ¯çš„"),t("strong",[s._v("é¡ºåº")]),s._v("? ç­”æ¡ˆæ˜¯: "),t("strong",[s._v("æ²¡æœ‰åŠæ³•")]),s._v(". "),t("mark",[t("strong",[s._v("Kafka åªä¼šä¿è¯åœ¨åŒä¸€ä¸ªåˆ†åŒºå†…æ¶ˆæ¯æ˜¯æœ‰åºçš„, è€Œä¸èƒ½ä¿è¯ Topic(ä¸»é¢˜) ä¸­æ‰€æœ‰ Partition(åˆ†åŒº) çš„å…¨å±€æœ‰åºæ€§")])]),s._v(".")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703211238314.png",alt:""}})]),s._v(" "),t("p",[s._v("æ¶ˆæ¯åœ¨è¢«è¿½åŠ åˆ°åˆ†åŒºçš„æ—¶å€™éƒ½ä¼š"),t("strong",[s._v("åˆ†é…ä¸€ä¸ªç‰¹å®šçš„åç§»é‡")]),s._v("(offset), åç§»é‡è¡¨ç¤ºæ¶ˆè´¹è€…å½“å‰æ¶ˆè´¹åˆ°åˆ†åŒºçš„æ‰€åœ¨ä½ç½®. Kafka "),t("strong",[s._v("é€šè¿‡åç§»é‡æ¥ä¿è¯æ¶ˆæ¯åœ¨åˆ†åŒºå†…çš„é¡ºåºæ€§")]),s._v(".")]),s._v(" "),t("p",[s._v("Kafka å‘é€ä¸€æ¡æ¶ˆæ¯çš„æ—¶å€™, å¯ä»¥æŒ‡å®š "),t("strong",[s._v("topic, partition, key, data")]),s._v(" ç­‰å‚æ•°. å¦‚æœå‘é€æ¶ˆæ¯æ—¶æŒ‡å®šäº† Partition å‚æ•°, åˆ™æ‰€æœ‰æ¶ˆæ¯éƒ½"),t("strong",[s._v("ä¼šè¢«å‘é€åˆ°æŒ‡å®šçš„åˆ†åŒº")]),s._v(". å¹¶ä¸”åŒä¸€ä¸ª key çš„æ¶ˆæ¯å¯ä»¥"),t("strong",[s._v("ä¿è¯åªå‘é€åˆ°åŒä¸€ä¸ªåˆ†åŒº")]),s._v(". è¿™é‡Œå¯ä»¥é‡‡ç”¨è¡¨/å¯¹è±¡çš„ id æ¥ä½œä¸º key.")]),s._v(" "),t("h5",{attrs:{id:"_6-offsetçš„ç»´æŠ¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-offsetçš„ç»´æŠ¤"}},[s._v("#")]),s._v(" 6.offsetçš„ç»´æŠ¤")]),s._v(" "),t("p",[s._v("ç”±äºæ¶ˆè´¹è€…åœ¨æ¶ˆè´¹è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°æ–­ç”µå®•æœºç­‰æ•…éšœ, æ•…éšœæ¢å¤å, éœ€è¦ä»æ•…éšœå‰çš„ä½ç½®ç»§ç»­æ¶ˆè´¹, æ‰€ä»¥æ¶ˆè´¹è€…éœ€è¦å®æ—¶è®°å½•è‡ªå·±æ¶ˆè´¹åˆ°äº†å“ªä¸ª "),t("strong",[s._v("offset")]),s._v(", ä»¥ä¾¿æ•…éšœæ¢å¤åç»§ç»­æ¶ˆè´¹.")]),s._v(" "),t("p",[t("strong",[s._v("group + topic + partition æ‰èƒ½ç¡®å®šä¸€ä¸ª offset!")])]),s._v(" "),t("p",[s._v("æ¶ˆè´¹è€…é»˜è®¤"),t("strong",[s._v("å°† offset ä¿å­˜åœ¨ Kafka æœ¬åœ°ä¸€ä¸ªå†…ç½®çš„ topic ä¸­")]),s._v(", è¯¥ topic ä¸º  "),t("strong",[s._v("__consumer_offsets")]),s._v("(æ­¤æ—¶æ¶ˆè´¹è€…å¯¹äº offset ç›¸å½“äºç”Ÿäº§è€…).")]),s._v(" "),t("h4",{attrs:{id:"å¸¸è§æ¶ˆè´¹é—®é¢˜è§£å†³ğŸŒŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¸¸è§æ¶ˆè´¹é—®é¢˜è§£å†³ğŸŒŸ"}},[s._v("#")]),s._v(" å¸¸è§æ¶ˆè´¹é—®é¢˜è§£å†³ğŸŒŸ")]),s._v(" "),t("p",[s._v("æ¶ˆæ¯é˜Ÿåˆ—åº”è¯¥è€ƒè™‘çš„ä¸€äº›å¯èƒ½å‡ºç°çš„æ¶ˆè´¹é—®é¢˜æœ‰:")]),s._v(" "),t("ul",[t("li",[s._v("**å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±? **")]),s._v(" "),t("li",[s._v("**å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹? **")])]),s._v(" "),t("h5",{attrs:{id:"_1-ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±-å¯é æ€§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±-å¯é æ€§"}},[s._v("#")]),s._v(" 1.ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±/å¯é æ€§")]),s._v(" "),t("h6",{attrs:{id:"_1-ç”Ÿäº§è€…ä¸¢å¤±æ¶ˆæ¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ç”Ÿäº§è€…ä¸¢å¤±æ¶ˆæ¯"}},[s._v("#")]),s._v(" (1)ç”Ÿäº§è€…ä¸¢å¤±æ¶ˆæ¯")]),s._v(" "),t("p",[s._v("ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ä¹‹å, æ¶ˆæ¯å¯èƒ½å› ä¸º"),t("strong",[s._v("ç½‘ç»œé—®é¢˜")]),s._v("å¹¶æ²¡æœ‰å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—, æ‰€ä»¥ä¸èƒ½è®¤ä¸ºå‘é€æ¶ˆæ¯å°±ä¸€å®šä¼šæˆåŠŸ. ä¸ºç¡®å®šæ¶ˆæ¯æ˜¯å¦å‘é€æˆåŠŸ, "),t("strong",[s._v("éœ€è¦åˆ¤æ–­æ¶ˆæ¯å‘é€çš„ç»“æœ")]),s._v(". å¯ä»¥"),t("strong",[s._v("æ·»åŠ å›è°ƒå‡½æ•°, å¦‚æœæ¶ˆæ¯å‘é€å¤±è´¥, æ£€æŸ¥å¤±è´¥åŸå› åé‡æ–°å‘é€å³å¯")]),s._v("!")]),s._v(" "),t("p",[s._v("æ¨èä¸ºç”Ÿäº§è€…çš„ "),t("strong",[s._v("retries(é‡è¯•æ¬¡æ•°)è®¾ç½®ä¸€ä¸ªæ¯”è¾ƒåˆç†çš„å€¼")]),s._v(", ä¸€èˆ¬æ˜¯ "),t("strong",[s._v("3")]),s._v(", ä¸ºä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ä¹Ÿå¯ä»¥è®¾ç½®æ¯”è¾ƒå¤§ä¸€ç‚¹. è®¾ç½®å®Œæˆå, å½“å‡ºç°ç½‘ç»œé—®é¢˜æ—¶èƒ½å¤Ÿ"),t("strong",[s._v("è‡ªåŠ¨é‡è¯•æ¶ˆæ¯å‘é€")]),s._v(", é¿å…æ¶ˆæ¯ä¸¢å¤±.")]),s._v(" "),t("h6",{attrs:{id:"_2-æ¶ˆè´¹è€…ä¸¢å¤±æ¶ˆæ¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-æ¶ˆè´¹è€…ä¸¢å¤±æ¶ˆæ¯"}},[s._v("#")]),s._v(" (2)æ¶ˆè´¹è€…ä¸¢å¤±æ¶ˆæ¯")]),s._v(" "),t("p",[s._v("å½“æ¶ˆè´¹è€…"),t("strong",[s._v("æ‹‰å–")]),s._v("åˆ°äº†åˆ†åŒºçš„æŸä¸ªæ¶ˆæ¯ä¹‹å, "),t("strong",[s._v("æ¶ˆè´¹è€…ä¼šè‡ªåŠ¨æäº¤ offset")]),s._v(". è‡ªåŠ¨æäº¤å¯èƒ½å­˜åœ¨é—®é¢˜, å³å½“æ¶ˆè´¹è€…åˆšæ‹¿åˆ°è¿™ä¸ªæ¶ˆæ¯å‡†å¤‡è¿›è¡ŒçœŸæ­£æ¶ˆè´¹çš„æ—¶å€™, çªç„¶æŒ‚äº†, "),t("strong",[s._v("æ¶ˆæ¯å®é™…ä¸Šå¹¶æ²¡æœ‰è¢«æ¶ˆè´¹, ä½† offset å´è¢«è‡ªåŠ¨æäº¤äº†")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("è§£å†³åŠæ³•ä¹Ÿæ¯”è¾ƒç²—æš´, å…³é—­è‡ªåŠ¨æäº¤ offset, æ¯æ¬¡åœ¨çœŸæ­£æ¶ˆè´¹å®Œæ¶ˆæ¯ä¹‹åå†è‡ªå·±æ‰‹åŠ¨æäº¤ offset.")]),s._v(" "),t("strong",[t("strong",[s._v("ä½†è¿™æ ·ä¼šå¸¦æ¥æ¶ˆæ¯è¢«")])]),s._v("â€‹"),t("strong",[s._v("é‡å¤æ¶ˆè´¹")]),s._v("çš„é—®é¢˜. æ¯”å¦‚åˆšåˆšæ¶ˆè´¹å®Œæ¶ˆæ¯åè¿˜æ²¡æäº¤ offset, ç»“æœæ¶ˆè´¹è€…æŒ‚äº†, æ¶ˆè´¹è€…æ¢å¤åä¼šå†æ¬¡æ‹‰å–å¹¶æ¶ˆè´¹å‰ä¸€æ¬¡çš„æ¶ˆæ¯, é€ æˆé‡å¤æ¶ˆè´¹.")]),s._v(" "),t("h6",{attrs:{id:"_3-kafkaè‡ªèº«ä¸¢å¤±æ¶ˆæ¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-kafkaè‡ªèº«ä¸¢å¤±æ¶ˆæ¯"}},[s._v("#")]),s._v(" (3)Kafkaè‡ªèº«ä¸¢å¤±æ¶ˆæ¯")]),s._v(" "),t("p",[s._v("Kafka ä¸ºåˆ†åŒºå¼•å…¥äº†å¤šå‰¯æœ¬(Replica)æœºåˆ¶. å¦‚æœ leader å‰¯æœ¬æ‰€åœ¨çš„ broker çªç„¶æŒ‚æ‰, é‚£å°±éœ€è¦ä» follower å‰¯æœ¬é‡æ–°é€‰å‡ºä¸€ä¸ª leader. "),t("strong",[s._v("å¦‚æœæŒ‚æ‰çš„ leader æ•°æ®è¿˜æœ‰ä¸€äº›æ²¡æœ‰è¢« follower å‰¯æœ¬çš„åŒæ­¥çš„è¯, å°±ä¼šé€ æˆæ¶ˆæ¯ä¸¢å¤±")]),s._v(".")]),s._v(" "),t("p",[s._v("è§£å†³æ–¹æ³•:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("è®¾ç½® acks = all")]),s._v(". acks æ˜¯ä¸ºç”Ÿäº§è€…é…ç½®çš„å‚æ•°. acks é»˜è®¤å€¼ä¸º 1, ä»£è¡¨æ¶ˆæ¯è¢« leader æ¥æ”¶ä¹‹åå°±ç®—å‘é€æˆåŠŸ. é…ç½® "),t("strong",[s._v("acks = all")]),s._v(" ä»£è¡¨åˆ™"),t("strong",[s._v("æ‰€æœ‰å‰¯æœ¬éƒ½è¦æ¥æ”¶åˆ°è¯¥æ¶ˆæ¯")]),s._v("ä¹‹åè¯¥æ¶ˆæ¯æ‰ç®—å‘é€æˆåŠŸ.")]),s._v(" "),t("li",[t("strong",[s._v("è®¾ç½® replication.factor >= 3")]),s._v(". å¯ä»¥ä¿è¯æ¯ä¸ªåˆ†åŒºè‡³å°‘æœ‰ 3 ä¸ªå‰¯æœ¬. è™½ç„¶é€ æˆäº†æ•°æ®å†—ä½™, ä½†æé«˜äº†æ•°æ®å®‰å…¨æ€§.")]),s._v(" "),t("li",[t("strong",[s._v("è®¾ç½® min.insync.replicas > 1")]),s._v(". è¿™ä¸ªé…ç½®ä»£è¡¨æ¶ˆæ¯è‡³å°‘è¦è¢«å†™å…¥åˆ° "),t("strong",[s._v("2 ä¸ªå‰¯æœ¬")]),s._v("æ‰ç®—æ˜¯è¢«æˆåŠŸå‘é€. min.insync.replicas é»˜è®¤å€¼ä¸º 1, ç”Ÿäº§ç¯å¢ƒä¸­åº”å°½é‡é¿å…ä½¿ç”¨é»˜è®¤å€¼. ä½†ä¸ºäº†ä¿è¯æ•´ä¸ª Kafka æœåŠ¡çš„é«˜å¯ç”¨æ€§, éœ€è¦ç¡®ä¿ "),t("strong",[s._v("replication.factor > min.insync.replicas")]),s._v(". ä¸ºä»€ä¹ˆ? å› ä¸ºåœ¨ä¸¤è€…ç›¸ç­‰çš„æƒ…å†µä¸‹, åªè¦æœ‰ä¸€ä¸ªå‰¯æœ¬æŒ‚æ‰, æ•´ä¸ªåˆ†åŒºå°±æ— æ³•æ­£å¸¸å·¥ä½œäº†. è¿™æ˜æ˜¾è¿åé«˜å¯ç”¨æ€§! ä¸€èˆ¬æ¨èè®¾ç½®ä¸º "),t("strong",[s._v("replication.factor = min.insync.replicas + 1")]),s._v(".")])]),s._v(" "),t("h5",{attrs:{id:"_2-ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹"}},[s._v("#")]),s._v(" 2.ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆè´¹")]),s._v(" "),t("p",[s._v("å¦‚ä½•ä¿è¯æ¶ˆæ¯"),t("strong",[s._v("ä¸è¢«é‡å¤æ¶ˆè´¹")]),s._v(", ä¹Ÿå°±æ˜¯ä¿è¯æ¶ˆæ¯æ¶ˆè´¹çš„"),t("strong",[s._v("å¹‚ç­‰æ€§")]),s._v(".")]),s._v(" "),t("h6",{attrs:{id:"_1-é‡å¤æ¶ˆè´¹é—®é¢˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-é‡å¤æ¶ˆè´¹é—®é¢˜"}},[s._v("#")]),s._v(" (1)é‡å¤æ¶ˆè´¹é—®é¢˜")]),s._v(" "),t("p",[t("strong",[s._v("æ¯ä¸ªæ¶ˆæ¯")]),s._v("è¢«å†™è¿›å»åéƒ½æœ‰ä¸€ä¸ª "),t("strong",[s._v("offset")]),s._v(", ä»£è¡¨æ¶ˆæ¯é¡ºåº. å½“æ¶ˆè´¹è€…æ¶ˆè´¹è¯¥æ•°æ®ä¹‹å, ä¼šæŠŠ"),t("strong",[s._v("è‡ªå·±æ¶ˆè´¹è¿‡çš„æ¶ˆæ¯çš„ offset è¿›è¡Œæäº¤")]),s._v(", ä»£è¡¨å·²ç»æ¶ˆè´¹è¿‡äº†. ä¸‹æ¬¡è¦æ˜¯é‡å¯, å°±ä¼šç»§ç»­ä»ä¸Šæ¬¡"),t("strong",[s._v("æ¶ˆè´¹åˆ°çš„ offset")]),s._v(" ç»§ç»­æ¶ˆè´¹.")]),s._v(" "),t("p",[s._v("å¦‚æœç›´æ¥æ¶ˆè´¹è€…çªç„¶æŒ‚åˆ°åå†é‡å¯, å°±å¯èƒ½å¯¼è‡´æ¶ˆè´¹è€…å·²ç»æ¶ˆè´¹äº†æ¶ˆæ¯, ä½†"),t("strong",[s._v("æ²¡æ¥å¾—åŠæäº¤ offset")]),s._v(". ç­‰é‡å¯ä¹‹å, å°‘æ•°æ¶ˆæ¯å°±ä¼š"),t("strong",[s._v("å†æ¬¡æ¶ˆè´¹ä¸€æ¬¡")]),s._v(".")]),s._v(" "),t("p",[s._v("å…¶ä»– MQ ä¹Ÿä¼šæœ‰é‡å¤æ¶ˆè´¹çš„é—®é¢˜, éœ€è¦é’ˆå¯¹å®é™…åœºæ™¯æ¥è€ƒè™‘å¦‚ä½•"),t("strong",[s._v("ä¿è¯é‡å¤æ¶ˆè´¹çš„å¹‚ç­‰æ€§")]),s._v(".")]),s._v(" "),t("h6",{attrs:{id:"_2-ä¿è¯å¹‚ç­‰æ€§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ä¿è¯å¹‚ç­‰æ€§"}},[s._v("#")]),s._v(" (2)ä¿è¯å¹‚ç­‰æ€§")]),s._v(" "),t("p",[t("strong",[s._v("æ€ä¹ˆä¿è¯æ¶ˆæ¯é˜Ÿåˆ—æ¶ˆè´¹çš„å¹‚ç­‰æ€§?")]),s._v("  éœ€è¦ç»“åˆä¸šåŠ¡æ¥æ€è€ƒ.")]),s._v(" "),t("ul",[t("li",[s._v("é€šè¿‡ "),t("strong",[s._v("insertOrUpdate")]),s._v(" çš„æ–¹å¼è¿›è¡Œæ•°æ®å†™åº“.")]),s._v(" "),t("li",[s._v("å¯¹äºæ¶ˆæ¯å¯ä»¥å•ç‹¬"),t("strong",[s._v("å»ºè¡¨")]),s._v(", ç”¨äºå­˜å‚¨æ¶ˆæ¯æ¶ˆè´¹è®°å½•. ç”Ÿäº§è€…å‘é€æ¶ˆæ¯å‰"),t("strong",[s._v("åˆ¤æ–­åº“ä¸­æ˜¯å¦æœ‰è®°å½•")]),s._v(", æ²¡æœ‰è®°å½•åˆ™å…ˆå…¥åº“, çŠ¶æ€ä¸º"),t("strong",[s._v("å¾…æ¶ˆè´¹")]),s._v(", å‘é€æ¶ˆæ¯æ—¶æŠŠä¸»é”® id å¸¦ä¸Š. æ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯æ—¶é€šè¿‡ä¸»é”® id æŸ¥è¯¢è®°å½•è¡¨, åˆ¤æ–­æ¶ˆæ¯çŠ¶æ€æ˜¯å¦å·²æ¶ˆè´¹. è‹¥æ²¡æœ‰æ¶ˆè´¹, åˆ™å¤„ç†æ¶ˆæ¯, å¤„ç†å®Œå, æ›´æ–°æ¶ˆæ¯è®°å½•çš„çŠ¶æ€ä¸ºå·²æ¶ˆè´¹.")])]),s._v(" "),t("h4",{attrs:{id:"å¯é æ€§ğŸŒŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¯é æ€§ğŸŒŸ"}},[s._v("#")]),s._v(" å¯é æ€§ğŸŒŸ")]),s._v(" "),t("h5",{attrs:{id:"_1-æ¦‚è¿°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ¦‚è¿°"}},[s._v("#")]),s._v(" 1.æ¦‚è¿°")]),s._v(" "),t("p",[s._v("Kafka ä¸­çš„å¯é æ€§ä¿è¯æœ‰å¦‚ä¸‹å››ç‚¹:")]),s._v(" "),t("ul",[t("li",[s._v("å¯¹äº"),t("strong",[s._v("ä¸€ä¸ªåˆ†åŒº")]),s._v("æ¥è¯´, å®ƒçš„"),t("strong",[s._v("æ¶ˆæ¯æ˜¯æœ‰åº")]),s._v("çš„.")]),s._v(" "),t("li",[s._v("å½“æ¶ˆæ¯å†™å…¥æ‰€æœ‰ "),t("strong",[s._v("in-sync çŠ¶æ€çš„å‰¯æœ¬")]),s._v("å, æ¶ˆæ¯æ‰ä¼šè®¤ä¸º"),t("strong",[s._v("å·²æäº¤(committed)")]),s._v(" . è¿™é‡Œçš„å†™å…¥æœ‰å¯èƒ½åªæ˜¯å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿçš„"),t("strong",[s._v("ç¼“å­˜")]),s._v(", ä¸ä¸€å®šåˆ·æ–°åˆ°ç£ç›˜. ç”Ÿäº§è€…å¯ä»¥ç­‰å¾…ä¸åŒæ—¶æœºçš„ç¡®è®¤, æ¯”å¦‚ç­‰å¾…åˆ†åŒºä¸»å‰¯æœ¬"),t("strong",[s._v("å†™å…¥å³è¿”å›")]),s._v(", æˆ–è€…ç­‰å¾…æ‰€æœ‰ in-sync çŠ¶æ€å‰¯æœ¬å†™å…¥æ‰è¿”å›.")]),s._v(" "),t("li",[s._v("ä¸€æ—¦æ¶ˆæ¯å·²æäº¤, åªè¦æœ‰ä¸€ä¸ªå‰¯æœ¬å­˜æ´», æ•°æ®å°±ä¸ä¼šä¸¢å¤±.")]),s._v(" "),t("li",[s._v("æ¶ˆè´¹è€…åªèƒ½"),t("strong",[s._v("è¯»å–åˆ°å·²æäº¤")]),s._v("çš„æ¶ˆæ¯.")])]),s._v(" "),t("p",[s._v("å¯é æ€§ä¸æ˜¯æ— å¿çš„, å®ƒä¸ç³»ç»Ÿå¯ç”¨æ€§, ååé‡, å»¶è¿Ÿæ¯æ¯ç›¸å…³, å› æ­¤å¾€å¾€éœ€è¦åšæƒè¡¡, åªè¿½æ±‚å¯é æ€§å¹¶ä¸å®é™….")]),s._v(" "),t("h5",{attrs:{id:"_2-å¤šå‰¯æœ¬æœºåˆ¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å¤šå‰¯æœ¬æœºåˆ¶"}},[s._v("#")]),s._v(" 2.å¤šå‰¯æœ¬æœºåˆ¶")]),s._v(" "),t("p",[s._v("Kafka ä¸ºåˆ†åŒºå¼•å…¥äº†"),t("strong",[s._v("å¤šå‰¯æœ¬(Replica)æœºåˆ¶")]),s._v(". åˆ†åŒºä¸­çš„å¤šä¸ªå‰¯æœ¬ä¹‹é—´ä¼šæœ‰ä¸€ä¸ª leader å‰¯æœ¬, å…¶ä»–å‰¯æœ¬ç§°ä¸º "),t("strong",[s._v("follower")]),s._v(" å‰¯æœ¬. å‘é€çš„æ¶ˆæ¯ä¼š"),t("strong",[s._v("è¢«å‘é€åˆ° leader å‰¯æœ¬")]),s._v(", ç„¶å follower å‰¯æœ¬æ‰èƒ½ä» leader å‰¯æœ¬ä¸­"),t("strong",[s._v("æ‹‰å–æ¶ˆæ¯è¿›è¡ŒåŒæ­¥")]),s._v(".")]),s._v(" "),t("p",[s._v("ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…"),t("strong",[s._v("åªä¸ leader å‰¯æœ¬äº¤äº’")]),s._v(". å…¶ä»–å‰¯æœ¬åªæ˜¯ leader å‰¯æœ¬çš„"),t("strong",[s._v("æ‹·è´")]),s._v(", å®ƒä»¬çš„å­˜åœ¨åªæ˜¯ä¸ºäº†"),t("strong",[s._v("ä¿è¯æ¶ˆæ¯å­˜å‚¨çš„å®‰å…¨æ€§")]),s._v(". å½“ leader å‰¯æœ¬å‘ç”Ÿæ•…éšœæ—¶ä¼šä» follower ä¸­"),t("strong",[s._v("é€‰ä¸¾å‡ºä¸€ä¸ª leader")]),s._v(". follower å‰¯æœ¬å¦‚æœä¸ leader åŒæ­¥ç¨‹åº¦è¾¾ä¸åˆ°è¦æ±‚åˆ™æ— æ³•å‚ä¸ leader é€‰ä¸¾.")]),s._v(" "),t("p",[t("strong",[s._v("å¤šå‰¯æœ¬æœºåˆ¶çš„å¥½å¤„")]),s._v(":")]),s._v(" "),t("ul",[t("li",[s._v("é€šè¿‡ç»™ç‰¹å®š Topic æŒ‡å®šå¤šä¸ªåˆ†åŒº, è€Œå„ä¸ªåˆ†åŒºå¯ä»¥"),t("strong",[s._v("åˆ†å¸ƒåœ¨ä¸åŒçš„ Broker ä¸Š")]),s._v(", è¿™æ ·èƒ½æä¾›è¾ƒå¥½çš„å¹¶å‘èƒ½åŠ›("),t("strong",[s._v("è´Ÿè½½å‡è¡¡")]),s._v(").")]),s._v(" "),t("li",[s._v("åˆ†åŒºå¯ä»¥æŒ‡å®šå¯¹åº”çš„ Replica æ•°é‡, è¿™å¯ä»¥æé«˜æ¶ˆæ¯å­˜å‚¨"),t("strong",[s._v("å®‰å…¨æ€§")]),s._v(", æé«˜å®¹ç¾èƒ½åŠ›, ä¸è¿‡ä¹Ÿç›¸åº”çš„å¢åŠ äº†æ‰€éœ€çš„å­˜å‚¨ç©ºé—´.")])]),s._v(" "),t("h5",{attrs:{id:"_3-å‰¯æœ¬æ•°æ®åŒæ­¥ç­–ç•¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-å‰¯æœ¬æ•°æ®åŒæ­¥ç­–ç•¥"}},[s._v("#")]),s._v(" 3.å‰¯æœ¬æ•°æ®åŒæ­¥ç­–ç•¥")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[t("strong",[s._v("æ–¹æ¡ˆ")])]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[t("strong",[s._v("ä¼˜ç‚¹")])]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[t("strong",[s._v("ç¼ºç‚¹")])])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[t("strong",[s._v("åŠæ•°ä»¥ä¸Šå®ŒæˆåŒæ­¥, å°±å‘é€ ack")])]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("å»¶è¿Ÿä½")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("é€‰ä¸¾æ–°çš„ leader æ—¶, å®¹å¿ n å°èŠ‚ç‚¹çš„æ•…éšœ, éœ€è¦ 2n + 1 ä¸ªå‰¯æœ¬")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[t("strong",[s._v("å…¨éƒ¨å®ŒæˆåŒæ­¥, æ‰å‘é€ ack")])]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("é€‰ä¸¾æ–° leader æ—¶, å®¹å¿ n å°èŠ‚ç‚¹çš„æ•…éšœ, éœ€è¦ n + 1 ä¸ªå‰¯æœ¬")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("å»¶è¿Ÿé«˜")])])])]),s._v(" "),t("p",[s._v("Kafka é€‰æ‹©äº†"),t("strong",[s._v("ç¬¬äºŒç§æ–¹æ¡ˆ")]),s._v(", åŸå› å¦‚ä¸‹:")]),s._v(" "),t("ul",[t("li",[s._v("åŒæ ·ä¸ºäº†å®¹å¿ n å°èŠ‚ç‚¹çš„æ•…éšœ, ç¬¬ä¸€ç§æ–¹æ¡ˆéœ€è¦ 2n + 1 ä¸ªå‰¯æœ¬, è€Œç¬¬äºŒç§æ–¹æ¡ˆåªéœ€è¦ n + 1 ä¸ªå‰¯æœ¬, Kafka çš„æ¯ä¸ªåˆ†åŒºéƒ½æœ‰å¤§é‡æ•°æ®, ç¬¬ä¸€ç§æ–¹æ¡ˆä¼šé€ æˆå¤§é‡æ•°æ®å†—ä½™.")]),s._v(" "),t("li",[s._v("è™½ç„¶ç¬¬äºŒç§æ–¹æ¡ˆçš„ç½‘ç»œå»¶è¿Ÿä¼šæ¯”è¾ƒé«˜, ä½†ç½‘ç»œå»¶è¿Ÿå¯¹ Kafka çš„å½±å“è¾ƒå°(ä¸€èˆ¬åœ¨åŒä¸€ç½‘ç»œç¯å¢ƒä¸‹ä¼ è¾“).")])]),s._v(" "),t("h4",{attrs:{id:"kafkaä¸zookeeper"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kafkaä¸zookeeper"}},[s._v("#")]),s._v(" Kafkaä¸Zookeeper")]),s._v(" "),t("p",[s._v("ZooKeeper ä¸»è¦ä¸º Kafka æä¾›"),t("strong",[s._v("å…ƒæ•°æ®ç®¡ç†")]),s._v("çš„åŠŸèƒ½.")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("Broker æ³¨å†Œ")]),s._v(": Zookeeper ä¸Šæœ‰ä¸€ä¸ªä¸“é—¨"),t("strong",[s._v("ç”¨æ¥è¿›è¡Œ Broker æœåŠ¡å™¨åˆ—è¡¨è®°å½•")]),s._v("çš„èŠ‚ç‚¹. æ¯ä¸ª Broker å¯åŠ¨æ—¶, éƒ½ä¼šåˆ° Zookeeper ä¸Šè¿›è¡Œ"),t("strong",[s._v("æ³¨å†Œ")]),s._v(", å³åˆ°  "),t("strong",[s._v("/brokers/ids")]),s._v(" ä¸‹åˆ›å»ºå±äºè‡ªå·±çš„èŠ‚ç‚¹. æ¯ä¸ª Broker å°±ä¼šå°†è‡ªå·±çš„ IP åœ°å€å’Œç«¯å£ç­‰ä¿¡æ¯è®°å½•åˆ°è¯¥èŠ‚ç‚¹ä¸­.")]),s._v(" "),t("li",[t("strong",[s._v("Topic æ³¨å†Œ")]),s._v(": åœ¨ Kafka ä¸­, åŒä¸€ä¸ª Topic çš„æ¶ˆæ¯ä¼šè¢«"),t("strong",[s._v("åˆ†æˆå¤šä¸ªåˆ†åŒºå¹¶å°†å…¶åˆ†å¸ƒåœ¨å¤šä¸ª Broker ä¸Š")]),s._v(", è¿™äº›åˆ†åŒºä¿¡æ¯åŠä¸ Broker çš„"),t("strong",[s._v("å¯¹åº”å…³ç³»ä¹Ÿæ˜¯ç”± Zookeeper ç»´æŠ¤")]),s._v(". æ¯”å¦‚åˆ›å»ºäº†ä¸€ä¸ªåå­—ä¸º "),t("strong",[s._v("my-topic")]),s._v(" çš„ä¸»é¢˜å¹¶ä¸”å®ƒæœ‰ä¸¤ä¸ªåˆ†åŒº, å¯¹åº”åˆ° Zookeeper ä¸­ä¼šåˆ›å»ºä¸‹é¢çš„æ–‡ä»¶å¤¹:  "),t("strong",[s._v("/brokers/topics/my-topic/Partitions/0, /brokers/topics/my-topic/Partitions/1")]),s._v(".")]),s._v(" "),t("li",[t("strong",[s._v("è´Ÿè½½å‡è¡¡")]),s._v(": å¯¹äºåŒä¸€ä¸ª Topic çš„ä¸åŒåˆ†åŒº, Kafka ä¼š"),t("strong",[s._v("å°½åŠ›å°†è¿™äº›åˆ†åŒºåˆ†å¸ƒåˆ°ä¸åŒçš„ Broker æœåŠ¡å™¨ä¸Š")]),s._v(". å½“ç”Ÿäº§è€…äº§ç”Ÿæ¶ˆæ¯åä¹Ÿä¼šå°½é‡æŠ•é€’åˆ°ä¸åŒ Broker çš„åˆ†åŒºé‡Œé¢. å½“æ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹æ—¶, Zookeeper å¯ä»¥æ ¹æ®å½“å‰çš„åˆ†åŒºæ•°é‡ä»¥åŠæ¶ˆè´¹è€…æ•°é‡æ¥å®ç°"),t("strong",[s._v("åŠ¨æ€è´Ÿè½½å‡è¡¡")]),s._v(".")])]),s._v(" "),t("h4",{attrs:{id:"kafkaä¸å­˜å‚¨å®ç°ğŸŒŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kafkaä¸å­˜å‚¨å®ç°ğŸŒŸ"}},[s._v("#")]),s._v(" Kafkaä¸å­˜å‚¨å®ç°ğŸŒŸ")]),s._v(" "),t("h5",{attrs:{id:"_1-kafkaæ¶ˆæ¯å­˜å‚¨æ–¹å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-kafkaæ¶ˆæ¯å­˜å‚¨æ–¹å¼"}},[s._v("#")]),s._v(" 1.Kafkaæ¶ˆæ¯å­˜å‚¨æ–¹å¼")]),s._v(" "),t("p",[s._v("Kafka çš„æ¶ˆæ¯æ˜¯"),t("strong",[s._v("å­˜å‚¨åœ¨äºæ–‡ä»¶ç³»ç»Ÿ")]),s._v("ä¹‹ä¸Šçš„. Kafka é«˜åº¦ä¾èµ–æ–‡ä»¶ç³»ç»Ÿæ¥"),t("strong",[s._v("å­˜å‚¨å’Œç¼“å­˜")]),s._v('æ¶ˆæ¯. æœ‰çš„äººè®¤ä¸º "ç£ç›˜æ˜¯ç¼“æ…¢çš„", æ‰€ä»¥å¯¹è¿™æ ·çš„è®¾è®¡æŒæœ‰æ€€ç–‘æ€åº¦. å®é™…ä¸Šç£ç›˜å¯ä»¥æ¯”é¢„æƒ³çš„å¿«å¾ˆå¤šæˆ–æ…¢å¾ˆå¤š, è¿™å–å†³äºå®ƒä»¬å¦‚ä½•è¢«ä½¿ç”¨; ä¸€ä¸ªå¥½çš„ç£ç›˜ç»“æ„è®¾è®¡å¯ä»¥ä½¿ä¹‹ä¸ç½‘ç»œé€Ÿåº¦ä¸€æ ·å¿«.')]),s._v(" "),t("p",[s._v("ç°ä»£çš„æ“ä½œç³»ç»Ÿé’ˆå¯¹"),t("strong",[s._v("ç£ç›˜çš„è¯»å†™")]),s._v('å·²ç»åšäº†ä¸€äº›ä¼˜åŒ–æ–¹æ¡ˆæ¥åŠ å¿«ç£ç›˜çš„è®¿é—®é€Ÿåº¦. æ¯”å¦‚ "'),t("strong",[s._v("é¢„è¯»")]),s._v('" ä¼šæå‰å°†ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ç£ç›˜æ•°æ®å—è¯»å…¥å†…å­˜. "'),t("strong",[s._v("åå†™")]),s._v('" ä¼šå°†å¾ˆå¤šå°çš„é€»è¾‘å†™æ“ä½œåˆå¹¶èµ·æ¥ç»„åˆæˆä¸€ä¸ªå¤§çš„ç‰©ç†å†™æ“ä½œ. å¹¶ä¸”æ“ä½œç³»ç»Ÿè¿˜ä¼šå°†ä¸»å†…å­˜å‰©ä½™çš„æ‰€æœ‰ç©ºé—²å†…å­˜ç©ºé—´éƒ½ç”¨ä½œ'),t("strong",[s._v("ç£ç›˜ç¼“å­˜")]),s._v(", æ‰€æœ‰çš„ç£ç›˜è¯»å†™æ“ä½œéƒ½ä¼šç»è¿‡ç»Ÿä¸€çš„ç£ç›˜ç¼“å­˜(é™¤äº†ç›´æ¥ I/O ä¼šç»•è¿‡ç£ç›˜ç¼“å­˜). ç»¼åˆè¿™å‡ ç‚¹ä¼˜åŒ–ç‰¹ç‚¹, å¦‚æœæ˜¯é’ˆå¯¹ç£ç›˜çš„"),t("mark",[t("strong",[s._v("é¡ºåºè®¿é—®")])]),s._v("â€‹, æŸäº›æƒ…å†µä¸‹å®ƒå¯èƒ½æ¯”éšæœºçš„å†…å­˜è®¿é—®éƒ½è¦å¿«, ç”šè‡³å¯ä»¥å’Œç½‘ç»œé€Ÿåº¦ç›¸å·®æ— å‡ .")]),s._v(" "),t("p",[t("strong",[s._v("Topic å…¶å®æ˜¯é€»è¾‘ä¸Šçš„æ¦‚å¿µ, é¢å‘æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…, ç‰©ç†ä¸Šå­˜å‚¨çš„å…¶å®æ˜¯ Partition")]),s._v(", æ¯ä¸€ä¸ª Partition æœ€ç»ˆå¯¹åº”ä¸€ä¸ª"),t("strong",[s._v("ç›®å½•, é‡Œé¢å­˜å‚¨æ‰€æœ‰çš„æ¶ˆæ¯å’Œç´¢å¼•æ–‡ä»¶")]),s._v(". é»˜è®¤æƒ…å†µä¸‹, æ¯ä¸ª Topic åœ¨åˆ›å»ºæ—¶å¦‚æœä¸æŒ‡å®š Partition æ•°é‡æ—¶åªä¼šåˆ›å»º 1 ä¸ª Partition. æ¯”å¦‚åˆ›å»ºä¸€ä¸ª Topic åå­—ä¸º test, æ²¡æœ‰æŒ‡å®š Partition çš„æ•°é‡æ—¶ä¼šé»˜è®¤åˆ›å»ºä¸€ä¸ª "),t("strong",[s._v("test-0 çš„æ–‡ä»¶å¤¹")]),s._v(", è¿™é‡Œçš„å‘½åè§„åˆ™æ˜¯: "),t("code",[s._v("<topic_name>-<partition_id>")]),s._v("â€‹.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703211238314.png",alt:""}})]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("ä»»ä½•å‘å¸ƒåˆ° Partition çš„æ¶ˆæ¯éƒ½ä¼šè¢«è¿½åŠ åˆ° Partition æ•°æ®æ–‡ä»¶çš„å°¾éƒ¨, è¿™æ ·çš„é¡ºåºå†™ç£ç›˜æ“ä½œè®© Kafka çš„æ•ˆç‡éå¸¸é«˜")])]),s._v(". ç»éªŒè¯, "),t("strong",[s._v("é¡ºåºå†™ç£ç›˜")]),s._v("æ•ˆç‡å¯èƒ½æ¯”éšæœºå†™å†…å­˜è¿˜è¦é«˜, è¿™æ˜¯ Kafka é«˜ååç‡çš„ä¸€ä¸ªé‡è¦ä¿è¯.")]),s._v(" "),t("p",[s._v("æ¯ä¸€æ¡æ¶ˆæ¯è¢«å‘é€åˆ° Broker ä¸­, ä¼š"),t("strong",[s._v("æ ¹æ® Partition è§„åˆ™")]),s._v("é€‰æ‹©è¢«å­˜å‚¨åˆ°å“ªä¸€ä¸ª Partition. å¦‚æœ Partition è§„åˆ™è®¾ç½®çš„åˆç†, æ‰€æœ‰æ¶ˆæ¯å¯ä»¥å‡åŒ€åˆ†å¸ƒåˆ°ä¸åŒçš„ Partition ä¸­.")]),s._v(" "),t("h5",{attrs:{id:"_2-åº•å±‚å­˜å‚¨ç»†èŠ‚"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-åº•å±‚å­˜å‚¨ç»†èŠ‚"}},[s._v("#")]),s._v(" 2.åº•å±‚å­˜å‚¨ç»†èŠ‚")]),s._v(" "),t("p",[s._v("å‡è®¾ Kafka é›†ç¾¤"),t("strong",[s._v("åªæœ‰ä¸€ä¸ª Broker")]),s._v(', åˆ›å»º 2 ä¸ª Topic åç§°åˆ†åˆ«ä¸º: "topic1" å’Œ "topic2", Partition æ•°é‡åˆ†åˆ«ä¸º 1, 2, é‚£ä¹ˆçš„'),t("strong",[s._v("æ ¹ç›®å½•")]),s._v("ä¸‹å°±ä¼šåˆ›å»ºå¦‚ä¸‹"),t("strong",[s._v("ä¸‰ä¸ªæ–‡ä»¶å¤¹")]),s._v(":")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" --topic1-0\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" --topic2-0\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" --topic2-1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("åœ¨ Kafka çš„"),t("strong",[s._v("æ–‡ä»¶å­˜å‚¨")]),s._v("ä¸­, "),t("strong",[s._v("åŒä¸€ä¸ª Topic ä¸‹æœ‰å¤šä¸ªä¸åŒçš„ Partition")]),s._v(", æ¯ä¸ª Partition éƒ½ä¸ºä¸€ä¸ª"),t("strong",[s._v("ç›®å½•")]),s._v(", è€Œæ¯ä¸€ä¸ªç›®å½•åˆè¢«å¹³å‡åˆ†é…æˆå¤šä¸ªå¤§å°ç›¸ç­‰çš„ "),t("strong",[s._v("Segment File")]),s._v(", Segment File åˆç”± "),t("strong",[s._v("index file å’Œ data file ç»„æˆ")]),s._v(", å®ƒä»¬æ€»æ˜¯"),t("strong",[s._v("æˆå¯¹å‡ºç°")]),s._v(', åç¼€ ".index" è¡¨ç¤º'),t("strong",[s._v("ç´¢å¼•æ–‡ä»¶")]),s._v(', ".log" è¡¨ç¤º'),t("strong",[s._v("æ•°æ®æ–‡ä»¶")]),s._v(". "),t("strong",[s._v("ç´¢å¼•æ–‡ä»¶ä¸­çš„å…ƒæ•°æ®æŒ‡å‘å¯¹åº”æ•°æ®æ–‡ä»¶ä¸­")]),s._v(" message çš„ç‰©ç†åç§»åœ°å€.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703213719650.png",alt:""}})]),s._v(" "),t("p",[s._v("å‡è®¾è®¾ç½®æ¯ä¸ª Segment å¤§å°ä¸º 500 MB, å¹¶å¯åŠ¨ç”Ÿäº§è€…å‘ topic1 å‘é€å¤§é‡æ¶ˆæ¯, topic1-0 æ–‡ä»¶å¤¹ä¸­å°±ä¼šäº§ç”Ÿç±»ä¼¼å¦‚ä¸‹çš„ä¸€äº›æ–‡ä»¶:")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" --topic1-0 \n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--00000000000000000000.index")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--00000000000000000000.log")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--00000000000000368769.index")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--00000000000000368769.log")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--00000000000000737337.index")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--00000000000000737337.log")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--00000000000001105814.index")]),s._v(" \n   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--00000000000001105814.log")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" --topic2-0 \n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" --topic2-1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[t("strong",[s._v("Segment æ˜¯ Kafka æ–‡ä»¶å­˜å‚¨çš„æœ€å°å•ä½. "),t("strong",[s._v("â€‹"),t("strong",[t("strong",[s._v("Segment æ–‡ä»¶å‘½åè§„åˆ™: Partition å…¨å±€çš„ç¬¬ä¸€ä¸ª Segment "),t("strong",[t("strong",[s._v("â€‹")])])]),s._v("ä» 0")])])]),s._v("â€‹ **** å¼€å§‹, åç»­æ¯ä¸ª Segment æ–‡ä»¶åä¸ºä¸Šä¸€ä¸ª Segment æ–‡ä»¶****â€‹"),t("strong",[s._v("æœ€åä¸€æ¡æ¶ˆæ¯çš„ offset å€¼")]),s._v(". æ•°å€¼æœ€å¤§ä¸º 64 ä½ long å¤§å°, 19 ä½æ•°å­—å­—ç¬¦é•¿åº¦, æ²¡æœ‰æ•°å­—ç”¨ 0 å¡«å……. å¦‚ 00000000000000368769.index å’Œ 00000000000000368769.log.")]),s._v(" "),t("p",[s._v("ä»¥ä¸Šé¢çš„ä¸€å¯¹ Segment File ä¸ºä¾‹, è¯´æ˜ä¸€ä¸‹"),t("strong",[s._v("ç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶å¯¹åº”å…³ç³»")]),s._v(".")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220703214601780.png",alt:""}})]),s._v(" "),t("p",[s._v("å…¶ä¸­ä»¥ç´¢å¼•æ–‡ä»¶ä¸­å…ƒæ•°æ® "),t("code",[s._v("<3, 497>")]),s._v("â€‹ ä¸ºä¾‹, åœ¨æ•°æ®æ–‡ä»¶ä¸­è¡¨ç¤ºç¬¬ 3 ä¸ª message(åœ¨å…¨å±€ Partition è¡¨ç¤ºç¬¬ 368769 + 3 = 368772 ä¸ª message)ä»¥åŠè¯¥æ¶ˆæ¯çš„ç‰©ç†åç§»åœ°å€ä¸º 497.")]),s._v(" "),t("p",[s._v("æ³¨æ„è¯¥ index æ–‡ä»¶å¹¶ä¸æ˜¯ä» 0 å¼€å§‹, ä¹Ÿä¸æ˜¯æ¯æ¬¡é€’å¢ 1 çš„, è¿™æ˜¯å› ä¸º Kafka é‡‡å–"),t("strong",[s._v("ç¨€ç–ç´¢å¼•å­˜å‚¨")]),s._v("çš„æ–¹å¼, æ¯éš”ä¸€å®šå­—èŠ‚çš„æ•°æ®å»ºç«‹ä¸€æ¡ç´¢å¼•, å®ƒå‡å°‘äº†ç´¢å¼•æ–‡ä»¶å¤§å°, ä½¿å¾—èƒ½å¤ŸæŠŠ index æ˜ å°„åˆ°å†…å­˜, é™ä½äº†æŸ¥è¯¢æ—¶çš„ç£ç›˜ IO å¼€é”€, åŒæ—¶ä¹Ÿå¹¶æ²¡æœ‰ç»™æŸ¥è¯¢å¸¦æ¥å¤ªå¤šçš„æ—¶é—´æ¶ˆè€—.")]),s._v(" "),t("p",[s._v("å› ä¸ºå…¶æ–‡ä»¶åä¸ºä¸Šä¸€ä¸ª Segment æœ€åä¸€æ¡æ¶ˆæ¯çš„ offset, æ‰€ä»¥å½“éœ€è¦æŸ¥æ‰¾ä¸€ä¸ªæŒ‡å®š offset çš„æ¶ˆæ¯æ—¶, é€šè¿‡åœ¨æ‰€æœ‰ segment çš„æ–‡ä»¶åä¸­è¿›è¡Œ"),t("strong",[s._v("äºŒåˆ†æŸ¥æ‰¾")]),s._v("å°±èƒ½æ‰¾åˆ°å®ƒå½’å±çš„ Segment æ–‡ä»¶, å†åœ¨å…¶ index æ–‡ä»¶ä¸­æ‰¾åˆ°å…¶å¯¹åº”åˆ°æ–‡ä»¶ä¸Šçš„ç‰©ç†ä½ç½®, å°±èƒ½è·å–è¯¥æ¶ˆæ¯.")]),s._v(" "),t("p",[s._v("ç”±äºæ¶ˆæ¯åœ¨ Partition çš„ Segment æ•°æ®æ–‡ä»¶ä¸­æ˜¯"),t("strong",[s._v("é¡ºåºè¯»å†™")]),s._v("çš„, ä¸”æ¶ˆæ¯æ¶ˆè´¹åä¸ä¼šåˆ é™¤(åˆ é™¤ç­–ç•¥æ˜¯é’ˆå¯¹è¿‡æœŸçš„ Segment æ–‡ä»¶), è¿™ç§é¡ºåºç£ç›˜ IO å­˜å‚¨è®¾è®¡å¸ˆ Kafka é«˜æ€§èƒ½å¾ˆé‡è¦çš„åŸå› .")]),s._v(" "),t("blockquote",[t("p",[s._v("Kafkaå¦‚ä½•å‡†ç¡®çš„çŸ¥é“messageçš„åç§»?")])]),s._v(" "),t("p",[s._v("åœ¨ Kafka å®šä¹‰äº†æ ‡å‡†çš„æ•°æ®å­˜å‚¨ç»“æ„, åœ¨ Partition ä¸­çš„"),t("strong",[s._v("æ¯ä¸€æ¡ message éƒ½åŒ…å«äº†ä»¥ä¸‹ä¸‰ä¸ªå±æ€§")]),s._v(":")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("offset")]),s._v(": è¡¨ç¤ºæ¶ˆæ¯åœ¨å½“å‰ Partition ä¸­çš„åç§»é‡, æ˜¯ä¸€ä¸ªé€»è¾‘å€¼, å”¯ä¸€ç¡®å®šäº† Partition ä¸­çš„ä¸€æ¡ message, å¯ä»¥ç®€å•è®¤ä¸ºæ˜¯ä¸€ä¸ª id.")]),s._v(" "),t("li",[t("strong",[s._v("MessageSize")]),s._v(": è¡¨ç¤º message å†…å®¹ data çš„å¤§å°.")]),s._v(" "),t("li",[t("strong",[s._v("data")]),s._v(": message çš„å…·ä½“å†…å®¹.")])]),s._v(" "),t("h4",{attrs:{id:"kafkaé«˜æ•ˆè¯»å†™æ•°æ®ğŸŒŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kafkaé«˜æ•ˆè¯»å†™æ•°æ®ğŸŒŸ"}},[s._v("#")]),s._v(" Kafkaé«˜æ•ˆè¯»å†™æ•°æ®ğŸŒŸ")]),s._v(" "),t("h5",{attrs:{id:"_1-é¡ºåºå†™ç£ç›˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-é¡ºåºå†™ç£ç›˜"}},[s._v("#")]),s._v(" 1.é¡ºåºå†™ç£ç›˜")]),s._v(" "),t("p",[s._v("ç”Ÿäº§è€…çš„æ¶ˆæ¯å†™å…¥åˆ° log æ–‡ä»¶çš„è¿‡ç¨‹æ˜¯"),t("strong",[s._v("è¿½åŠ åˆ°æ–‡ä»¶æœ«ç«¯çš„é¡ºåºå†™")]),s._v(". åŒæ ·çš„ç£ç›˜, é¡ºåºå†™èƒ½åˆ° "),t("strong",[s._v("600M/s")]),s._v(", è€Œéšæœºå†™åªæœ‰ "),t("strong",[s._v("100k/s")]),s._v(". è¿™ä¸ç£ç›˜çš„æœºæ¢°æœºæ„æœ‰å…³, é¡ºåºå†™ä¹‹æ‰€ä»¥å¿«, æ˜¯å› ä¸ºå…¶çœå»äº†å¤§é‡ç£å¤´å¯»å€çš„æ—¶é—´.")]),s._v(" "),t("h5",{attrs:{id:"_2-é›¶æ‹·è´æŠ€æœ¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-é›¶æ‹·è´æŠ€æœ¯"}},[s._v("#")]),s._v(" 2.é›¶æ‹·è´æŠ€æœ¯")]),s._v(" "),t("p",[s._v("Kafka çš„æ¶ˆæ¯ä¼šæœ‰"),t("strong",[s._v("å¤šä¸ªè®¢é˜…è€…")]),s._v(', ç”Ÿäº§è€…å‘å¸ƒçš„æ¶ˆæ¯ä¼šè¢«ä¸åŒçš„æ¶ˆè´¹è€…å¤šæ¬¡æ¶ˆè´¹, ä¸ºä¼˜åŒ–è¿™ä¸ªæµç¨‹, Kafka ä½¿ç”¨äº† "'),t("strong",[s._v("é›¶æ‹·è´æŠ€æœ¯")]),s._v('".')]),s._v(" "),t("p",[s._v('"é›¶æ‹·è´æŠ€æœ¯" åªç”¨å°†'),t("strong",[s._v("ç£ç›˜æ–‡ä»¶çš„æ•°æ®å¤åˆ¶åˆ°é¡µé¢ç¼“å­˜ä¸­ä¸€æ¬¡")]),s._v(", ç„¶åå°†æ•°æ®"),t("strong",[s._v("ä»é¡µé¢ç¼“å­˜ç›´æ¥å‘é€åˆ°ç½‘ç»œä¸­")]),s._v("(å‘é€ç»™ä¸åŒçš„è®¢é˜…è€…æ—¶, éƒ½å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªé¡µé¢ç¼“å­˜), é¿å…äº†é‡å¤å¤åˆ¶æ“ä½œ.")]),s._v(" "),t("p",[t("strong",[s._v('å¦‚æœæœ‰ 10 ä¸ªæ¶ˆè´¹è€…, ä¼ ç»Ÿæ–¹å¼ä¸‹, æ•°æ®å¤åˆ¶æ¬¡æ•°ä¸º 4 * 10 = 40 æ¬¡, è€Œä½¿ç”¨ "é›¶æ‹·è´" åªéœ€è¦ 1 + 10 = 11 æ¬¡, ä¸€æ¬¡ä¸ºä»ç£ç›˜å¤åˆ¶åˆ°é¡µé¢ç¼“å­˜, 10 æ¬¡å³ 10 ä¸ªæ¶ˆè´¹è€…å„è‡ªè¯»å–ä¸€æ¬¡é¡µé¢ç¼“å­˜')]),s._v(".")]),s._v(" "),t("h4",{attrs:{id:"kafkaäº‹åŠ¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kafkaäº‹åŠ¡"}},[s._v("#")]),s._v(" Kafkaäº‹åŠ¡")]),s._v(" "),t("p",[s._v("Kafka ä» 0.11 ç‰ˆæœ¬å¼€å§‹å¼•å…¥äº†"),t("strong",[s._v("äº‹åŠ¡")]),s._v(". äº‹åŠ¡å¯ä»¥ä¿è¯ Kafka åœ¨ "),t("strong",[s._v("Exactly Once è¯­ä¹‰")]),s._v("çš„åŸºç¡€ä¸Š, ç”Ÿäº§å’Œæ¶ˆè´¹å¯ä»¥"),t("strong",[s._v("è·¨åˆ†åŒºå’Œä¼šè¯, è¦ä¹ˆå…¨éƒ¨æˆåŠŸ, è¦ä¹ˆå…¨éƒ¨å¤±è´¥")]),s._v(".")]),s._v(" "),t("h5",{attrs:{id:"_1-ç”Ÿäº§è€…äº‹åŠ¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ç”Ÿäº§è€…äº‹åŠ¡"}},[s._v("#")]),s._v(" 1.ç”Ÿäº§è€…äº‹åŠ¡")]),s._v(" "),t("p",[s._v("ä¸ºäº†å®ç°è·¨åˆ†åŒºè·¨ä¼šè¯çš„äº‹åŠ¡, éœ€è¦å¼•å…¥ä¸€ä¸ª"),t("strong",[s._v("å…¨å±€å”¯ä¸€çš„ Transaction ID(ä¸€å®šæ˜¯å®¢æˆ·ç«¯ç»™çš„)")]),s._v(" , å¹¶å°†ç”Ÿäº§è€…è·å¾—çš„ PID å’Œ Transaction ID ç»‘å®š. è¿™æ ·å½“ç”Ÿäº§è€…é‡å¯åå°±å¯ä»¥é€šè¿‡æ­£åœ¨è¿›è¡Œçš„ Transaction ID è·å¾—åŸæ¥çš„ PID.")]),s._v(" "),t("p",[s._v("ä¸ºç®¡ç† Transaction, Kafka å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ç»„ä»¶ "),t("strong",[s._v("Transaction Coordinator")]),s._v(". ç”Ÿäº§è€…å°±æ˜¯é€šè¿‡ä¸ Transaction Coordinator äº¤äº’è·å¾— Transaction ID å¯¹åº”çš„ä»»åŠ¡çŠ¶æ€. Transaction Coordinator è¿˜è´Ÿè´£å°†äº‹åŠ¡æ‰€æœ‰å†™å…¥ Kafka çš„ä¸€ä¸ªå†…éƒ¨ Topic, è¿™æ ·å³ä½¿æ•´ä¸ªæœåŠ¡é‡å¯, ç”±äºäº‹åŠ¡çŠ¶æ€å¾—åˆ°ä¿å­˜, è¿›è¡Œä¸­çš„äº‹åŠ¡çŠ¶æ€å¯ä»¥å¾—åˆ°æ¢å¤, ä»è€Œç»§ç»­è¿›è¡Œ.")]),s._v(" "),t("h5",{attrs:{id:"_2-æ¶ˆè´¹è€…äº‹åŠ¡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-æ¶ˆè´¹è€…äº‹åŠ¡"}},[s._v("#")]),s._v(" 2.æ¶ˆè´¹è€…äº‹åŠ¡")]),s._v(" "),t("p",[s._v("å¯¹äºæ¶ˆè´¹è€…è€Œè¨€, äº‹åŠ¡çš„ä¿è¯å°±ä¼šç›¸å¯¹è¾ƒå¼±, å°¤å…¶æ˜¯"),t("strong",[s._v("æ— æ³•ä¿è¯ Commit çš„ä¿¡æ¯è¢«ç²¾ç¡®æ¶ˆè´¹")]),s._v(". è¿™æ˜¯ç”±äºæ¶ˆè´¹è€…å¯ä»¥é€šè¿‡ offset è®¿é—®ä»»æ„ä¿¡æ¯, è€Œä¸”ä¸åŒçš„ Segment File ç”Ÿå‘½å‘¨æœŸä¸åŒ, åŒä¸€äº‹åŠ¡çš„æ¶ˆæ¯å¯èƒ½ä¼šå‡ºç°é‡å¯åè¢«åˆ é™¤çš„æƒ…å†µ.")]),s._v(" "),t("h3",{attrs:{id:"åŸºæœ¬ä½¿ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŸºæœ¬ä½¿ç”¨"}},[s._v("#")]),s._v(" åŸºæœ¬ä½¿ç”¨")]),s._v(" "),t("h4",{attrs:{id:"ç”Ÿäº§è€…api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç”Ÿäº§è€…api"}},[s._v("#")]),s._v(" ç”Ÿäº§è€…API")]),s._v(" "),t("h5",{attrs:{id:"_1-æ¶ˆæ¯å‘é€æµç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ¶ˆæ¯å‘é€æµç¨‹"}},[s._v("#")]),s._v(" 1.æ¶ˆæ¯å‘é€æµç¨‹")]),s._v(" "),t("p",[s._v("Producer å‘é€æ¶ˆæ¯é‡‡ç”¨çš„æ˜¯"),t("strong",[s._v("å¼‚æ­¥å‘é€")]),s._v("çš„æ–¹å¼. æ¶ˆæ¯å‘é€çš„è¿‡ç¨‹æ¶‰åŠä¸¤ä¸ªçº¿ç¨‹: "),t("strong",[s._v("main çº¿ç¨‹å’Œ Sender çº¿ç¨‹")]),s._v(", ä»¥åŠä¸€ä¸ªçº¿ç¨‹å…±äº«å˜é‡: "),t("strong",[s._v("RecordAccumulator")]),s._v("(æ¥æ”¶å™¨).")]),s._v(" "),t("p",[t("strong",[s._v("main çº¿ç¨‹å°†æ¶ˆæ¯å‘é€ç»™ RecordAccumulator, Sender çº¿ç¨‹ä¸æ–­ä» RecordAccumulator ä¸­æ‹‰å–æ¶ˆæ¯å‘é€åˆ° Kafka broker.")])]),s._v(" "),t("p",[s._v("ç›¸å…³å‚æ•°:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("batch.size")]),s._v(": åªæœ‰æ•°æ®ç§¯ç´¯åˆ° batch.size ä¹‹å, sender æ‰ä¼šå‘é€æ•°æ®.")]),s._v(" "),t("li",[t("strong",[s._v("linger.ms")]),s._v(": å¦‚æœæ•°æ®è¿Ÿè¿Ÿæœªè¾¾åˆ° batch.size, sender ç­‰å¾… linger.time ä¹‹åä¹Ÿä¼šå‘é€æ•°æ®.")])]),s._v(" "),t("h5",{attrs:{id:"_2-å¼‚æ­¥å‘é€api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å¼‚æ­¥å‘é€api"}},[s._v("#")]),s._v(" 2.å¼‚æ­¥å‘é€API")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("KafkaProducer")]),s._v(": éœ€è¦åˆ›å»ºä¸€ä¸ªç”Ÿäº§è€…å¯¹è±¡, ç”¨äºå‘é€æ•°æ®.")]),s._v(" "),t("li",[t("strong",[s._v("ProducerConfig")]),s._v(": è·å–æ‰€éœ€çš„é…ç½®å‚æ•°.")]),s._v(" "),t("li",[t("strong",[s._v("ProducerRecord")]),s._v(": æ¯æ¡æ•°æ®éƒ½è¦å°è£…æˆä¸€ä¸ª "),t("strong",[s._v("ProducerRecord")]),s._v(" å¯¹è±¡.")])]),s._v(" "),t("h6",{attrs:{id:"_1-ä¸å¸¦å›è°ƒå‡½æ•°çš„å¼‚æ­¥-asyncproducer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ä¸å¸¦å›è°ƒå‡½æ•°çš„å¼‚æ­¥-asyncproducer"}},[s._v("#")]),s._v(" (1)ä¸å¸¦å›è°ƒå‡½æ•°çš„å¼‚æ­¥(AsyncProducer)")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** ä¸å¸¦å›è°ƒå‡½æ•°çš„å¼‚æ­¥Producer API */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AsyncProducer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),s._v(" props "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BOOTSTRAP_SERVERS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hadoop101:9092,hadoop102:9092,hadoop103:9092"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("KEY_SERIALIZER_CLASS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringSerializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("VALUE_SERIALIZER_CLASS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringSerializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ACKS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"all"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RETRIES_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("LINGER_MS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é…ç½®æ‹¦æˆªå™¨")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é€šè¿‡é…ç½®åˆ›å»ºKafkaProducerå¯¹è±¡")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaProducer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" producer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaProducer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerRecord")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" record "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerRecord")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            producer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        producer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("h6",{attrs:{id:"_2-å¸¦å›è°ƒå‡½æ•°çš„å¼‚æ­¥-callbackproducer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å¸¦å›è°ƒå‡½æ•°çš„å¼‚æ­¥-callbackproducer"}},[s._v("#")]),s._v(" (2)å¸¦å›è°ƒå‡½æ•°çš„å¼‚æ­¥(CallbackProducer)")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** å¸¦å›è°ƒå‡½æ•°çš„å¼‚æ­¥Producer API */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CallbackProducer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),s._v(" props "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BOOTSTRAP_SERVERS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.72.133:9092"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("KEY_SERIALIZER_CLASS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringSerializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("VALUE_SERIALIZER_CLASS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringSerializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ACKS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"all"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RETRIES_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaProducer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" producer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaProducer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerRecord")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" record "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerRecord")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            producer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Callback")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("onCompletion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RecordMetadata")]),s._v(" recordMetadata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"success:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" recordMetadata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("topic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                                           "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" recordMetadata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("partition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                                           "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" recordMetadata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("offset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        producer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("h5",{attrs:{id:"_3-åŒæ­¥å‘é€api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-åŒæ­¥å‘é€api"}},[s._v("#")]),s._v(" 3.åŒæ­¥å‘é€API")]),s._v(" "),t("h6",{attrs:{id:"_1-åŒæ­¥å‘é€-syncproducer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-åŒæ­¥å‘é€-syncproducer"}},[s._v("#")]),s._v(" (1)åŒæ­¥å‘é€(SyncProducer)")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** åŒæ­¥ Producer API */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SyncProducer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExecutionException")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åˆ›å»ºpropertieså¯¹è±¡ç”¨äºå­˜æ”¾é…ç½®")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),s._v(" props "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ·»åŠ é…ç½®")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BOOTSTRAP_SERVERS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hadoop101:9092,hadoop102:9092,hadoop103:9092"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("KEY_SERIALIZER_CLASS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringSerializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("VALUE_SERIALIZER_CLASS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringSerializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ACKS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"all"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("RETRIES_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é‡è¯•æ¬¡æ•°")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("LINGER_MS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é€šè¿‡å·²æœ‰é…ç½®åˆ›å»ºkafkaProducerå¯¹è±¡")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaProducer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" producer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaProducer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¾ªç¯è°ƒç”¨ send æ–¹æ³•ä¸æ–­å‘é€æ•°æ®")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerRecord")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" record "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ProducerRecord")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é€šè¿‡get()æ–¹æ³•å®ç°åŒæ­¥æ•ˆæœ")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RecordMetadata")]),s._v(" metadata "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" producer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("metadata "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"success:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" metadata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("topic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                        metadata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("partition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" metadata"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("offset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        producer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å…³é—­ç”Ÿäº§è€…å¯¹è±¡")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("h4",{attrs:{id:"æ¶ˆè´¹è€…api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ¶ˆè´¹è€…api"}},[s._v("#")]),s._v(" æ¶ˆè´¹è€…API")]),s._v(" "),t("p",[s._v("æ¶ˆè´¹è€…æ¶ˆè´¹æ•°æ®æ—¶çš„å¯é æ€§æ˜¯æ¯”è¾ƒå®¹æ˜“ä¿è¯çš„, å› ä¸ºæ•°æ®åœ¨ Kafka ä¸­æ˜¯"),t("strong",[s._v("æŒä¹…åŒ–")]),s._v("çš„, æ•…ä¸€èˆ¬ä¸ç”¨æ‹…å¿ƒæ•°æ®ä¸¢å¤±é—®é¢˜.")]),s._v(" "),t("p",[s._v("ç”±äºæ¶ˆè´¹è€…åœ¨æ¶ˆè´¹è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°æ–­ç”µå®•æœºç­‰æ•…éšœ, æ‰€ä»¥ "),t("strong",[s._v("offset çš„ç»´æŠ¤æ˜¯æ¶ˆè´¹è€…æ¶ˆè´¹æ•°æ®æ—¶å¿…é¡»è€ƒè™‘çš„é—®é¢˜")]),s._v(".")]),s._v(" "),t("h5",{attrs:{id:"_1-è‡ªåŠ¨æäº¤offset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-è‡ªåŠ¨æäº¤offset"}},[s._v("#")]),s._v(" 1.è‡ªåŠ¨æäº¤offset")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("KafkaConsumer")]),s._v(": éœ€è¦åˆ›å»ºä¸€ä¸ªæ¶ˆè´¹è€…å¯¹è±¡, ç”¨äºæ¶ˆè´¹æ•°æ®.")]),s._v(" "),t("li",[t("strong",[s._v("ConsumerConfig")]),s._v(": è·å–æ‰€éœ€çš„é…ç½®å‚æ•°.")]),s._v(" "),t("li",[t("strong",[s._v("ConsuemrRecord")]),s._v(": æ¯æ¡æ•°æ®éƒ½è¢«å°è£…æˆä¸€ä¸ª ConsumerRecord å¯¹è±¡.")])]),s._v(" "),t("p",[s._v("ä¸ºäº†èƒ½ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘, Kafka æä¾›äº†"),t("strong",[s._v("è‡ªåŠ¨æäº¤ offset")]),s._v(" çš„åŠŸèƒ½. è‡ªåŠ¨æäº¤ offset çš„ç›¸å…³å‚æ•°:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("enable.auto.commit")]),s._v(": æ˜¯å¦å¼€å¯è‡ªåŠ¨æäº¤ offset åŠŸèƒ½.")]),s._v(" "),t("li",[t("strong",[s._v("auto.commit.interval.ms")]),s._v(": è‡ªåŠ¨æäº¤ offset çš„æ—¶é—´é—´éš”.")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** è‡ªåŠ¨æäº¤ offset */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AutoCommitOffset")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),s._v(" props "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BOOTSTRAP_SERVERS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hadoop101:9092,hadoop102:9092"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("KEY_DESERIALIZER_CLASS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringDeserializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("VALUE_DESERIALIZER_CLASS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringDeserializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GROUP_ID_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tian"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// groupid")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("AUTO_OFFSET_RESET_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"earliest"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        \n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// é…ç½®è‡ªåŠ¨æäº¤")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ENABLE_AUTO_COMMIT_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" consumer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("subscribe")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("asList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ·»åŠ éœ€è¦æ¶ˆè´¹çš„ topic")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerRecords")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" records "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("poll")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerRecord")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" record "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" records"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("finally")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åœ¨æ­»å¾ªç¯ä¸­æ— æ³•è°ƒç”¨ close æ–¹æ³•, æ‰€ä»¥éœ€è¦ä½¿ç”¨ finally")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("p",[s._v("ä½†è‡ªåŠ¨æäº¤å¯èƒ½å¼•èµ·"),t("strong",[s._v("æ¶ˆæ¯æ¶ˆè´¹å¤±è´¥")]),s._v("çš„é—®é¢˜.")]),s._v(" "),t("h5",{attrs:{id:"_2-æ‰‹åŠ¨æäº¤offset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-æ‰‹åŠ¨æäº¤offset"}},[s._v("#")]),s._v(" 2.æ‰‹åŠ¨æäº¤offset")]),s._v(" "),t("p",[s._v("Kafka è¿˜æä¾›äº†æ‰‹åŠ¨æäº¤ offset çš„ API. æ‰‹åŠ¨æäº¤ offset çš„æ–¹æ³•æœ‰ä¸¤ç§: åˆ†åˆ«æ˜¯ "),t("strong",[s._v("commitSync")]),s._v("("),t("strong",[s._v("åŒæ­¥æäº¤")]),s._v(")å’Œ "),t("strong",[s._v("commitAsync")]),s._v("("),t("strong",[s._v("å¼‚æ­¥æäº¤")]),s._v("). ä¸¤è€…çš„ç›¸åŒç‚¹æ˜¯, éƒ½ä¼šå°†"),t("strong",[s._v("æœ¬æ¬¡ poll çš„ä¸€æ‰¹æ•°æ®æœ€é«˜çš„åç§»é‡æäº¤")]),s._v("; ä¸åŒç‚¹æ˜¯, commitSync "),t("strong",[s._v("é˜»å¡å½“å‰çº¿ç¨‹")]),s._v(", ä¸€ç›´åˆ°æäº¤æˆåŠŸ, å¹¶ä¸”ä¼šè‡ªåŠ¨å¤±è´¥å……å®(ç”±ä¸å¯æ§å› ç´ å¯¼è‡´, ä¹Ÿä¼šå‡ºç°æäº¤å¤±è´¥); è€Œ commitAsync åˆ™æ²¡æœ‰å¤±è´¥é‡è¯•æœºåˆ¶, æ•…æœ‰å¯èƒ½æäº¤å¤±è´¥.")]),s._v(" "),t("h6",{attrs:{id:"_1-åŒæ­¥æäº¤commitsync-offset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-åŒæ­¥æäº¤commitsync-offset"}},[s._v("#")]),s._v(" (1)åŒæ­¥æäº¤commitSync offset")]),s._v(" "),t("p",[s._v("ç”±äºåŒæ­¥æäº¤ offset æœ‰å¤±è´¥é‡è¯•æœºåˆ¶, "),t("strong",[s._v("æ•…æ›´åŠ å¯é ")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** åŒæ­¥æ‰‹åŠ¨æäº¤ offset */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CustomComsumer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),s._v(" props "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bootstrap.servers"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hadoop102:9092"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//Kafka é›†ç¾¤")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"group.id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¶ˆè´¹è€…ç»„, åªè¦ group.id ç›¸åŒ, å°±å±äºåŒä¸€ä¸ªæ¶ˆè´¹è€…ç»„")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å…³é—­è‡ªåŠ¨æäº¤ offset")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enable.auto.commit"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"false"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"key.deserializer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"org.apache.kafka.common.serialization.StringDeserializer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value.deserializer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"org.apache.kafka.common.serialization.StringDeserializer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" consumer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("subscribe")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("asList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¶ˆè´¹è€…è®¢é˜…ä¸»é¢˜")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¶ˆè´¹è€…æ‹‰å–æ•°æ®")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerRecords")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" records "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("poll")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerRecord")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" record "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" records"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"offset = %d, key = %s, value = %s%n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("offset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("key")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("commitSync")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// åŒæ­¥æäº¤, å½“å‰çº¿ç¨‹ä¼šé˜»å¡ç›´åˆ°offsetæäº¤æˆåŠŸ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("h6",{attrs:{id:"_2-å¼‚æ­¥æäº¤commitasync-offset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å¼‚æ­¥æäº¤commitasync-offset"}},[s._v("#")]),s._v(" (2)å¼‚æ­¥æäº¤commitAsync offset")]),s._v(" "),t("p",[s._v("è™½ç„¶åŒæ­¥æäº¤ offset æ›´å¯é ä¸€äº›, ä½†æ˜¯ç”±äºå…¶ä¼š"),t("strong",[s._v("é˜»å¡å½“å‰çº¿ç¨‹")]),s._v("ç›´åˆ°æäº¤æˆåŠŸ, å› æ­¤"),t("strong",[s._v("ååé‡ä¼šå—åˆ°å¾ˆå¤§çš„å½±å“")]),s._v(". æ›´å¤šæƒ…å†µä¸‹, ä¼šé€‰ç”¨å¼‚æ­¥æäº¤ offset çš„æ–¹å¼.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** å¼‚æ­¥æ‰‹åŠ¨æäº¤ offset */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AsyncManualCommitOffset")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),s._v(" props "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("BOOTSTRAP_SERVERS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hadoop101:9092"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GROUP_ID_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tian"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ENABLE_AUTO_COMMIT_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("KEY_DESERIALIZER_CLASS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringDeserializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerConfig")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("VALUE_DESERIALIZER_CLASS_CONFIG")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringDeserializer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" consumer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("subscribe")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("asList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerRecords")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" records "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("poll")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerRecord")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" record "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" records"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"offset:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("offset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("\n                        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"key:"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("key")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("commitAsync")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OffsetCommitCallback")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("onComplete")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TopicPartition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OffsetAndMetadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" map"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" e"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("e "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"commit failed for "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" map"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¼‚æ­¥æäº¤")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("h5",{attrs:{id:"_3-è‡ªå®šä¹‰å­˜å‚¨offset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-è‡ªå®šä¹‰å­˜å‚¨offset"}},[s._v("#")]),s._v(" 3.è‡ªå®šä¹‰å­˜å‚¨offset")]),s._v(" "),t("p",[s._v("offset é»˜è®¤å­˜å‚¨åœ¨ Kafka çš„ä¸€ä¸ª"),t("strong",[s._v("å†…ç½®çš„ topic ä¸­")]),s._v(". é™¤æ­¤ä¹‹å¤–, Kafka è¿˜å¯ä»¥é€‰æ‹©"),t("strong",[s._v("è‡ªå®šä¹‰å­˜å‚¨ offset")]),s._v(".")]),s._v(" "),t("p",[s._v("offset çš„ç»´æŠ¤æ˜¯ç›¸å½“ç¹ççš„, å› ä¸ºéœ€è¦è€ƒè™‘åˆ°æ¶ˆè´¹è€…çš„ "),t("strong",[s._v("Rebalance")]),s._v(". å½“æœ‰æ–°çš„æ¶ˆè´¹è€…åŠ å…¥æ¶ˆè´¹è€…ç»„, å·²æœ‰çš„æ¶ˆè´¹è€…æ¨å‡ºæ¶ˆè´¹è€…ç»„æˆ–è€…æ‰€è®¢é˜…çš„ä¸»é¢˜çš„åˆ†åŒºå‘ç”Ÿå˜åŒ–, å°±ä¼š"),t("strong",[s._v("è§¦å‘åˆ°åˆ†åŒºçš„é‡æ–°åˆ†é…, é‡æ–°åˆ†é…çš„è¿‡ç¨‹å«åš Rebalance.")])]),s._v(" "),t("p",[s._v("æ¶ˆè´¹è€…å‘ç”Ÿ Rebalance ä¹‹å, æ¯ä¸ª"),t("strong",[s._v("æ¶ˆè´¹è€…æ¶ˆè´¹çš„åˆ†åŒºå°±ä¼šå‘ç”Ÿå˜åŒ–")]),s._v(". å› æ­¤æ¶ˆè´¹è€…è¦é¦–å…ˆè·å–åˆ°è‡ªå·±è¢«é‡æ–°åˆ†é…åˆ°çš„åˆ†åŒº, å¹¶ä¸”å®šä½åˆ°æ¯ä¸ªåˆ†åŒº"),t("strong",[s._v("æœ€è¿‘æäº¤çš„ offset ä½ç½®")]),s._v("ç»§ç»­æ¶ˆè´¹.")]),s._v(" "),t("p",[s._v("è¦å®ç°è‡ªå®šä¹‰å­˜å‚¨ offset, éœ€è¦å€ŸåŠ© "),t("strong",[s._v("ConsumerRebalanceListener")]),s._v(". ç¤ºä¾‹ä»£ç å¦‚ä¸‹, å…¶ä¸­æäº¤å’Œè·å– offset çš„æ–¹æ³•, éœ€è¦æ ¹æ®æ‰€é€‰çš„ offset å­˜å‚¨ç³»ç»Ÿè‡ªè¡Œå®ç°.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/** è‡ªå®šä¹‰å­˜å‚¨offset */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("CustomConsumer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TopicPartition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" currentOffset "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("HashMap")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),s._v(" props "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bootstrap.servers"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hadoop102:9092"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Kafkaé›†ç¾¤")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"group.id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¶ˆè´¹è€…ç»„, åªè¦group.idç›¸åŒ, å°±å±äºåŒä¸€ä¸ªæ¶ˆè´¹è€…ç»„")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å…³é—­è‡ªåŠ¨æäº¤offset")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enable.auto.commit"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"false"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"key.deserializer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"org.apache.kafka.common.serialization.StringDeserializer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value.deserializer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"org.apache.kafka.common.serialization.StringDeserializer"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" consumer "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("KafkaConsumer")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("props"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¶ˆè´¹è€…è®¢é˜…ä¸»é¢˜")]),s._v("\n        consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("subscribe")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Arrays")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("asList")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"first"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerRebalanceListener")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            \n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¯¥æ–¹æ³•ä¼šåœ¨Rebalanceä¹‹å‰è°ƒç”¨")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("onPartitionsRevoked")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Collection")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TopicPartition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" partitions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("commitOffset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("currentOffset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¯¥æ–¹æ³•ä¼šåœ¨Rebalanceä¹‹åè°ƒç”¨")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("onPartitionsAssigned")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Collection")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TopicPartition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" partitions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                currentOffset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TopicPartition")]),s._v(" partition "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" partitions"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å®šä½åˆ°æœ€è¿‘æäº¤çš„offsetä½ç½®ç»§ç»­æ¶ˆè´¹")]),s._v("\n                    consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seek")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("partition"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOffset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("partition"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¶ˆè´¹è€…æ‹‰å–æ•°æ®")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerRecords")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" records "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" consumer"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("poll")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ConsumerRecord")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" record "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" records"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"offset = %d, key = %s, value = %s%n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("offset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("key")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("value")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                currentOffset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("put")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TopicPartition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("topic")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("partition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" record"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("offset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("commitOffset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("currentOffset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å–æŸåˆ†åŒºçš„æœ€æ–°offset")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getOffset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TopicPartition")]),s._v(" partition"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æäº¤è¯¥æ¶ˆè´¹è€…æ‰€æœ‰åˆ†åŒºçš„offset")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("commitOffset")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Map")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TopicPartition")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Long")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" currentOffset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br")])]),t("p",[s._v("â€")]),s._v(" "),t("h4",{attrs:{id:"å‚è€ƒèµ„æ–™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒèµ„æ–™"}},[s._v("#")]),s._v(" å‚è€ƒèµ„æ–™")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://www.infoq.cn/article/kafka-analysis-part-1",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.infoq.cn/article/kafka-analysis-part-1"),t("OutboundLink")],1),s._v(" - Kafka è®¾è®¡è§£æ(ä¸€): Kafka èƒŒæ™¯åŠæ¶æ„ä»‹ç»")]),s._v(" "),t("li",[t("a",{attrs:{href:"http://www.dengshenyu.com/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/2017/11/06/kafka-Meet-Kafka.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://www.dengshenyu.com/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/2017/11/06/kafka-Meet-Kafka.html"),t("OutboundLink")],1),s._v(" - Kafkaç³»åˆ—(ä¸€)åˆè¯†Kafka")]),s._v(" "),t("li",[t("a",{attrs:{href:"https://lotabout.me/2018/kafka-introduction/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://lotabout.me/2018/kafka-introduction/"),t("OutboundLink")],1),s._v(" - Kafka å…¥é—¨ä»‹ç»")]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.zhihu.com/question/28925721",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.zhihu.com/question/28925721"),t("OutboundLink")],1),s._v(" - Kafka ä¸­çš„ Topic ä¸ºä»€ä¹ˆè¦è¿›è¡Œåˆ†åŒº? - çŸ¥ä¹")]),s._v(" "),t("li",[t("a",{attrs:{href:"https://blog.joway.io/posts/kafka-design-practice/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.joway.io/posts/kafka-design-practice/"),t("OutboundLink")],1),s._v(" - Kafka çš„è®¾è®¡ä¸å®è·µæ€è€ƒ")]),s._v(" "),t("li",[t("a",{attrs:{href:"http://www.dengshenyu.com/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/2017/11/21/kafka-data-delivery.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://www.dengshenyu.com/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/2017/11/21/kafka-data-delivery.html"),t("OutboundLink")],1),s._v(" - Kafkaç³»åˆ—(å…­)å¯é çš„æ•°æ®ä¼ è¾“")]),s._v(" "),t("li",[t("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=Mzg2OTA0Njk0OA==&mid=2247486269&idx=2&sn=ec00417ad641dd8c3d145d74cafa09ce&chksm=cea244f6f9d5cde0c8eb233fcc4cf82e11acd06446719a7af55230649863a3ddd95f78d111de&token=1633957262&lang=zh_CN#rd",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kafkaç³»åˆ—ç¬¬ä¸‰ç¯‡!10 åˆ†é’Ÿå­¦ä¼šå¦‚ä½•åœ¨ Spring Boot ç¨‹åºä¸­ä½¿ç”¨ Kafka ä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—?"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://segmentfault.com/a/1190000012990954",target:"_blank",rel:"noopener noreferrer"}},[s._v("CentOS7 ä¸‹ Kafka çš„å®‰è£…ä»‹ç» - ä¸ªäººæ–‡ç«  - SegmentFault æ€å¦"),t("OutboundLink")],1)]),s._v(" "),t("li",[s._v("éå¸¸é‡è¦: "),t("a",{attrs:{href:"https://blog.csdn.net/qq_25868207/article/details/81516024",target:"_blank",rel:"noopener noreferrer"}},[s._v("kafka è¸©å‘ä¹‹æ¶ˆè´¹è€…æ”¶ä¸åˆ°æ¶ˆæ¯ - kris - CSDN åšå®¢"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://blog.csdn.net/u010391342/article/details/81430402",target:"_blank",rel:"noopener noreferrer"}},[s._v("kafka å®‰è£…æ­å»º(æ•´åˆ springBoot ä½¿ç”¨) - u010391342 çš„åšå®¢ - CSDN åšå®¢"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.cnblogs.com/ALittleMoreLove/archive/2018/07/31/9396745.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Zookeeper+Kafka çš„å•èŠ‚ç‚¹é…ç½® - ç´«è½©å¼¦æœˆ - åšå®¢å›­"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://blog.csdn.net/sweatOtt/article/details/86714272",target:"_blank",rel:"noopener noreferrer"}},[s._v("@KafkaListener æ³¨è§£è§£å¯† - laomei - CSDN åšå®¢"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.jianshu.com/p/ac03f126980e",target:"_blank",rel:"noopener noreferrer"}},[s._v("ä½¿ç”¨Dockerå¿«é€Ÿæ­å»ºKafkaå¼€å‘ç¯å¢ƒ - ç®€ä¹¦"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://docs.spring.io/spring-kafka/reference/html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Spring for Apache Kafka"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://docs.spring.io/spring-kafka/docs/2.2.8.RELEASE/api/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Overview (Spring Kafka 2.2.8.RELEASE API)"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.jianshu.com/p/7a284bf4efc9",target:"_blank",rel:"noopener noreferrer"}},[s._v("SpringBootæ•´åˆKafkaå®ç°å‘å¸ƒè®¢é˜… - ç®€ä¹¦"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"http://www.mydlq.club/article/34/",target:"_blank",rel:"noopener noreferrer"}},[s._v("SpringBoot é›†æˆ Spring For Kafka æ“ä½œ Kafka è¯¦è§£ Â· å°è±†ä¸ä¸ªäººåšå®¢"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://developer.aliyun.com/article/868759",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://developer.aliyun.com/article/868759"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=r.exports}}]);