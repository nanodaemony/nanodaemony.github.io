(window.webpackJsonp=window.webpackJsonp||[]).push([[167],{495:function(s,a,t){"use strict";t.r(a);var n=t(4),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_3-jvm监控与故障处理工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-jvm监控与故障处理工具"}},[s._v("#")]),s._v(" 3.JVM监控与故障处理工具")]),s._v(" "),a("p",[s._v("给一个系统定位问题可以分析**运行日志, 异常堆栈, GC日志, 线程快照文件(threaddump/javacore文件), 堆转储快照(heapdump/hprof文件)**等内容.")]),s._v(" "),a("h4",{attrs:{id:"jdk的命令行工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jdk的命令行工具"}},[s._v("#")]),s._v(" JDK的命令行工具")]),s._v(" "),a("p",[s._v("这些命令在 JDK 安装目录下的 "),a("strong",[s._v("bin")]),s._v(" 目录下:")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[s._v("名称")]),s._v(" "),a("th",{staticStyle:{"text-align":"center"}},[s._v("主要作用")])])]),s._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("strong",[s._v("jps")])]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("Jvm Process Status Tool, 显示指定系统内所有的 HotSpot 虚拟机"),a("strong",[s._v("进程")])])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("strong",[s._v("jstat")])]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("Jvm Statistics Monitoring Tool, 用于收集 HotSpot "),a("strong",[s._v("虚拟机各方面的运行数据")])])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("strong",[s._v("jinfo")])]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("Configuration Info for Java, 显示"),a("strong",[s._v("虚拟机配置")]),s._v("信息")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("strong",[s._v("jmap")])]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("Memory Map for Java, 生成虚拟机的"),a("strong",[s._v("内存转储快照")]),s._v("(heapdump 文件)")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("strong",[s._v("jhat")])]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("Jvm Heap Dump Browser, 用于"),a("strong",[s._v("分析 heapmap 文件")]),s._v(", 它会建立一个服务器让用户可以在浏览器上查看分析结果")])]),s._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("strong",[s._v("jstack")])]),s._v(" "),a("td",{staticStyle:{"text-align":"center"}},[s._v("Stack Trace for Java, 显示虚拟机的"),a("strong",[s._v("线程快照")])])])])]),s._v(" "),a("h5",{attrs:{id:"_1-jps获取虚拟机进程状况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-jps获取虚拟机进程状况"}},[s._v("#")]),s._v(" 1.jps获取虚拟机进程状况")]),s._v(" "),a("p",[s._v("jps 可以列出正在运行的"),a("strong",[s._v("虚拟机进程")]),s._v(", 并显示虚拟机执行"),a("strong",[s._v("主类名称")]),s._v("以及这些进程的本地虚拟机"),a("strong",[s._v("唯一 ID")]),s._v(". 看到 ID 之后就能定位到某个 Java 应用, 然后进行后续操作. jps 命令格式:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("jps "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("可选参数"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("hostid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("可选参数选项说明如下:")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-q")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不输出类名, Jar名和传入main方法的参数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出传入main方法的参数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出main类或Jar的全限名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出传入JVM的参数")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("不加参数:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jps\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" leo-homework-server.jar\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11336")]),s._v(" Jps\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("jps -l")]),s._v(": 输出"),a("strong",[s._v("主类的全名")]),s._v(", 如果进程执行的是 "),a("strong",[s._v("Jar 包")]),s._v(", 输出 Jar 路径.")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jps "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" leo-homework-server/target/leo-homework-server.jar\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11358")]),s._v(" sun.tools.jps.Jps\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("jps -v")]),s._v(": 输出虚拟机进程启动时 "),a("strong",[s._v("JVM 参数")]),s._v(".")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jps "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" leo-homework-server.jar "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Xms6g")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Xmx6g")]),s._v(" -Xloggc:/home/shared/log/gc.log "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCDateStamps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseG1GC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxGCPauseMillis")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("256m "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:-OmitStackTraceInFastThrow")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:-PrintGCDetails")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-verbose:gc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dcom.sun.management.jmxremote.port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dcom.sun.management.jmxremote.login.config")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("FenbiConfig "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Djava.security.auth.login.config")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/jmx_ldap.config "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dcom.sun.management.jmxremote.ssl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false -javaagent:/lib/skywalking-BETA/agent/skywalking-agent.jar -javaagent:/home/shared/files/agent.jar "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dxmiast.projectname")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("leo-homework "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dxmiast.nodename")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("leo-homework "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dxmiast.ip")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.130")]),s._v(".8.20 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dxmiast.port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9090")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dxmiast.region")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dxmiast.token")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("puzWfJyx9qVZxk19Xb5b5LQ "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dxmiast.delayhooktime.ms")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("300000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11382")]),s._v(" Jps "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dapplication.home")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/java/jdk1.8.0_202 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Xms8m")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h5",{attrs:{id:"_2-jstat监视虚拟机各种运行状态信息-常用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-jstat监视虚拟机各种运行状态信息-常用"}},[s._v("#")]),s._v(" 2.jstat监视虚拟机各种运行状态信息(常用)")]),s._v(" "),a("h6",{attrs:{id:"_1-概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-概述"}},[s._v("#")]),s._v(" (1)概述")]),s._v(" "),a("p",[s._v("jstat 是用于监视虚拟机各种"),a("strong",[s._v("运行状态信息")]),s._v("的命令行工具. 它可以显示本地或者远程虚拟机进程中的"),a("strong",[s._v("类装载, 内存, 垃圾回收, JIT 编译")]),s._v("等运行数据, 可以查看"),a("strong",[s._v("堆内存各部分的使用量, 以及加载类的数量")]),s._v(", 在仅提供了纯文本控制台环境的服务器上, 它将是"),a("strong",[s._v("运行期定位虚拟机性能问题的首选工具")]),s._v(". "),a("strong",[s._v("==非常重要==")]),s._v("! ! ! 可以用于"),a("strong",[s._v("内存分配调优")]),s._v(", 需要用熟悉!")]),s._v(" "),a("p",[s._v("jstat 的命令格式:")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("jstat "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("命令选项"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("间隔时间"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("毫秒"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("查询次数"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("常见的 "),a("strong",[s._v("命令选项")]),s._v(" 如下, 这里每个参数输出属性不一样, 有需要再去找资料.")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("jstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" pid \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示ClassLoader的相关信息")]),s._v("\njstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compiler pid \t        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示JIT编译的相关信息")]),s._v("\njstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gc pid   \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示与GC相关的堆信息")]),s._v("\njstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gccapacity pid \t        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示整个堆内存的容量及使用情况")]),s._v("\njstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gcnew pid \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示新生代信息")]),s._v("\njstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gcnewcapacity pid \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示新生代大小与使用情况")]),s._v("\njstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gcold pid \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示老年代和永久代的信息")]),s._v("\njstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gcoldcapacity pid \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示老年代的大小")]),s._v("\njstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gcpermcapacity pid \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示永久代大小")]),s._v("\njstat "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("gcutil pid \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 显示垃圾收集信息")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("根据这些参数可以对各个堆区参数进行查看, 出来的参数大同小异.")]),s._v(" "),a("p",[s._v("例子 1:")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ jstat "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-gc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jstat "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-gc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-h3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT   \n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960832.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2467840.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("470878.4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198644.7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1845")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.301")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.673")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960832.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2473984.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("470878.4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198644.7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1845")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.301")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.673")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960832.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2480128.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("470878.4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198644.7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1845")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.301")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.673")]),s._v("\n S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT   \n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960832.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2482176.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("470878.4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198644.7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1845")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.301")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.673")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960832.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2486272.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("470878.4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198644.7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1845")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.301")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.673")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960832.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2488320.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("470878.4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198644.7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1845")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.301")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.673")]),s._v("\n S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT   \n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960832.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2492416.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("470878.4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198644.7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1845")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.301")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.673")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960832.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2498560.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("470878.4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198644.7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1845")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.301")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.673")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960832.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2500608.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("470878.4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198644.7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1845")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.301")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.673")]),s._v("\n S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT   \n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3960832.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2729984.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("470878.4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198644.7")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.4")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1845")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.301")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.673")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("表示分析"),a("strong",[s._v("进程 id 为 6")]),s._v(" 的 "),a("strong",[s._v("GC")]),s._v(" 情况, 每隔 1000ms 打印一次记录, 打印 10 次停止, 每 3 行后打印指标头部.")]),s._v(" "),a("p",[s._v("例子 2: 需要每 1000 毫秒查询一次进程 6 垃圾收集状况, 一共查询 10 次, 命令如下.")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ jstat "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-gcutil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jstat "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-gcutil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n  S0     S1     E      O      M     CCS    YGC     YGCT    FGC    FGCT     GCT   \n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.02")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.24")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.63")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94.37")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.323")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.694")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.13")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.24")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.63")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94.37")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.323")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.694")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.18")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.24")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.63")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94.37")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.323")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.694")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.18")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.24")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.63")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94.37")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.323")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.694")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.39")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.24")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.63")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94.37")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.323")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.694")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.49")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.24")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.63")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94.37")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.323")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.694")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.49")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.24")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.63")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94.37")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.323")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.694")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.64")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.24")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.63")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94.37")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.323")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.694")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.64")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.24")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.63")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94.37")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.323")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.694")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.75")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.24")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.63")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("94.37")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1846")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.323")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.694")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h6",{attrs:{id:"_2-垃圾回收统计"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-垃圾回收统计"}},[s._v("#")]),s._v(" (2)垃圾回收统计")]),s._v(" "),a("p",[a("strong",[s._v("jstat -gc pid 最常用")]),s._v(", 可以评估程序内存使用及 "),a("strong",[s._v("GC 压力整体情况")]),s._v(", 需记住!")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ jstat "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-gc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("结果如下:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jstat "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-gc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT   \n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3962880.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12288.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2326528.0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("472219.0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("205568.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("198645.4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23296.0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21984.9")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1847")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("51.344")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.371")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("52.716")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ul",[a("li",[s._v("S0C: 第一个幸存区的大小, 单位 KB.")]),s._v(" "),a("li",[s._v("S1C: 第二个幸存区的大小.")]),s._v(" "),a("li",[s._v("S0U: 第一个幸存区的使用大小.")]),s._v(" "),a("li",[s._v("S1U: 第二个幸存区的使用大小.")]),s._v(" "),a("li",[s._v("EC: 伊甸园区的大小.")]),s._v(" "),a("li",[s._v("EU: 伊甸园区的使用大小.")]),s._v(" "),a("li",[s._v("OC: 老年代大小.")]),s._v(" "),a("li",[s._v("OU: 老年代使用大小.")]),s._v(" "),a("li",[s._v("MC: 方法区大小(元空间).")]),s._v(" "),a("li",[s._v("MU: 方法区使用大小.")]),s._v(" "),a("li",[s._v("CCSC: 压缩类空间大小.")]),s._v(" "),a("li",[s._v("CCSU: 压缩类空间使用大小.")]),s._v(" "),a("li",[s._v("YGC: 年轻代垃圾回收"),a("strong",[s._v("次数")]),s._v(", 启动以来总共的次数.")]),s._v(" "),a("li",[s._v("YGCT: 年轻代垃圾回收消耗时间, 单位 s, YGC 的"),a("strong",[s._v("总时间")]),s._v(".")]),s._v(" "),a("li",[s._v("FGC: 老年代垃圾回收总次数.")]),s._v(" "),a("li",[s._v("FGCT: 老年代垃圾回收消耗时间, 单位 s, FGC "),a("strong",[s._v("总时间")]),s._v(".")]),s._v(" "),a("li",[s._v("GCT: 垃圾回收消耗总时间, 单位 s, 全部 GC 的"),a("strong",[s._v("总时间")]),s._v(".")])]),s._v(" "),a("p",[s._v("根据这些参数就可以看 JVM 的状态, 并评估当前系统的压力, 用于"),a("strong",[s._v("调优")]),s._v("!")]),s._v(" "),a("h5",{attrs:{id:"_3-jinfo实时查看与调整虚拟机各项参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-jinfo实时查看与调整虚拟机各项参数"}},[s._v("#")]),s._v(" 3.jinfo实时查看与调整虚拟机各项参数")]),s._v(" "),a("p",[s._v("查看正在运行的 Java 进程的扩展参数.")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("jinfo pid")]),s._v(": 输出当前 JVM 进程的"),a("strong",[s._v("全部参数和系统属性")]),s._v(". 第一部分是系统属性, 第二部分是 JVM 参数.")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jinfo "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\nAttaching to process ID "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(", please wait"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nDebugger attached successfully.\nServer compiler detected.\nJVM version is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.202")]),s._v("-b08\n  \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Java参数  ")]),s._v("\nJava System Properties:\n\njava.vendor "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Oracle Corporation\nos.name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Linux\nsun.boot.class.path "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/java/jdk1.8.0_202/jre/lib/resources.jar:/usr/java/jdk1.8.0_202/jre/lib/rt.jar:/usr/java/jdk1.8.0_202/jre/lib/sunrsasign.jar:/usr/java/jdk1.8.0_202/jre/lib/jsse.jar:/usr/java/jdk1.8.0_202/jre/lib/jce.jar:/usr/java/jdk1.8.0_202/jre/lib/charsets.jar:/usr/java/jdk1.8.0_202/jre/lib/jfr.jar:/usr/java/jdk1.8.0_202/jre/classes\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 省略....")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 虚拟机参数 ")]),s._v("\nVM Flags:\nNon-default VM flags: "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:CICompilerCount")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:ConcGCThreads")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:G1HeapRegionSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4194304")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+HeapDumpOnOutOfMemoryError")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:HeapDumpPath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("null "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:InitialHeapSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9663676416")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+ManagementServer")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MarkStackSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4194304")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxGCPauseMillis")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxHeapSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9663676416")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxNewSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5796528128")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("268435456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MinHeapDeltaBytes")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4194304")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:-OmitStackTraceInFastThrow")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCDateStamps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCDetails")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCTimeStamps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseCompressedClassPointers")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseCompressedOops")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseFastUnorderedTimeStamps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseG1GC")]),s._v(" \nCommand line:  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Xmx9g")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Xms9g")]),s._v(" -Xloggc:/home/shared/log/gc.log "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCDateStamps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseG1GC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxGCPauseMillis")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("256m "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:-OmitStackTraceInFastThrow")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCDetails")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-verbose:gc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+HeapDumpOnOutOfMemoryError")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:HeapDumpPath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/oom-dump/leo-cm-ocr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dcom.sun.management.jmxremote.port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dcom.sun.management.jmxremote.login.config")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("FenbiConfig "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Djava.security.auth.login.config")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/jmx_ldap.config "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dcom.sun.management.jmxremote.ssl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false -javaagent:/lib/skywalking-BETA/agent/skywalking-agent.jar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("jinfo -flags pid")]),s._v(": 单独查看 "),a("strong",[s._v("JVM 参数")]),s._v(".")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jinfo "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flags")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\nAttaching to process ID "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(", please wait"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nDebugger attached successfully.\nServer compiler detected.\nJVM version is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.202")]),s._v("-b08\nNon-default VM flags: "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:CICompilerCount")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:ConcGCThreads")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:G1HeapRegionSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4194304")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+HeapDumpOnOutOfMemoryError")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:HeapDumpPath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("null "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:InitialHeapSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9663676416")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+ManagementServer")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MarkStackSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4194304")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxGCPauseMillis")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxHeapSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9663676416")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxNewSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5796528128")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("268435456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MinHeapDeltaBytes")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4194304")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:-OmitStackTraceInFastThrow")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCDateStamps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCDetails")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCTimeStamps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseCompressedClassPointers")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseCompressedOops")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseFastUnorderedTimeStamps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseG1GC")]),s._v(" \nCommand line:  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Xmx9g")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Xms9g")]),s._v(" -Xloggc:/home/shared/log/gc.log "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCDateStamps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+UseG1GC")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxGCPauseMillis")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MetaspaceSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("256m "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:-OmitStackTraceInFastThrow")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGCDetails")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-verbose:gc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+HeapDumpOnOutOfMemoryError")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:HeapDumpPath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/oom-dump/leo-cm-ocr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dcom.sun.management.jmxremote.port")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9999")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dcom.sun.management.jmxremote.login.config")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("FenbiConfig "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Djava.security.auth.login.config")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/jmx_ldap.config "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Dcom.sun.management.jmxremote.ssl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("false -javaagent:/lib/skywalking-BETA/agent/skywalking-agent.jar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("jinfo -flag name vmid")]),s._v(": 输出"),a("strong",[s._v("对应名称的参数")]),s._v("的具体值. 比如输出 MaxHeapSize, 查看当前 JVM 进程是否开启打印 GC 日志.")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jinfo  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flag")]),s._v(" MaxHeapSize "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:MaxHeapSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9663676416")]),s._v("\n$ jinfo  "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-flag")]),s._v(" PrintGC "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-XX:+PrintGC")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("info -sysprops pid")]),s._v(": 单独查看系统属性.")])]),s._v(" "),a("h5",{attrs:{id:"_4-jmap生成堆转储快照"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-jmap生成堆转储快照"}},[s._v("#")]),s._v(" 4.jmap生成堆转储快照")]),s._v(" "),a("p",[s._v("jmap 可以用来查看内存信息, 实例个数以及占用内存大小.")]),s._v(" "),a("p",[s._v("jmap 命令用于生成"),a("strong",[s._v("堆转储快照")]),s._v(". jmap 的作用并不仅仅为了获取 "),a("strong",[s._v("dump 文件")]),s._v(", 它还可以查询 finalize 执行队列, 堆和永久代的详细信息. "),a("strong",[s._v("如空间使用率, 当前用的是哪种收集器等")]),s._v(".")]),s._v(" "),a("p",[s._v("主要用处:")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("堆信息")]),s._v(".")]),s._v(" "),a("li",[a("strong",[s._v("查看实例个数与占用内存大小")])]),s._v(" "),a("li",[a("strong",[s._v("堆内存 dump 文件")]),s._v(".")])]),s._v(" "),a("p",[s._v("jmap 的命令格式:")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ jmap "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("进程号"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h6",{attrs:{id:"_1-查看堆信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-查看堆信息"}},[s._v("#")]),s._v(" (1)查看堆信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-heap")]),s._v(" pid\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("执行结果:")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-heap")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\nAttaching to process ID "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(", please wait"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nDebugger attached successfully.\nServer compiler detected.\nJVM version is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.202")]),s._v("-b08\n\nusing thread-local object allocation.\nGarbage-First "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("G1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" GC with "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" thread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nHeap Configuration:\n   MinHeapFreeRatio         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v("\n   MaxHeapFreeRatio         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("70")]),s._v("\n   MaxHeapSize              "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6442450944")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6144")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   NewSize                  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1363144")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".2999954223632812MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   MaxNewSize               "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3865051136")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3686")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   OldSize                  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5452592")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(".1999969482421875MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   NewRatio                 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n   SurvivorRatio            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n   MetaspaceSize            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("268435456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("256")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   CompressedClassSpaceSize "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1073741824")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   MaxMetaspaceSize         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17592186044415")]),s._v(" MB\n   G1HeapRegionSize         "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097152")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nHeap Usage:\nG1 Heap:\n   regions  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3072")]),s._v("\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6442450944")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6144")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1620983032")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1545")]),s._v(".8898849487305MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4821467912")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4598")]),s._v(".1101150512695MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.160968179504078")]),s._v("% used\nG1 Young Generation:\nEden Space:\n   regions  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("548")]),s._v("\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4057989120")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3870")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1149239296")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1096")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2908749824")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2774")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28.320413436692508")]),s._v("% used\nSurvivor Space:\n   regions  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097152")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2097152")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.0")]),s._v("% used\nG1 Old Generation:\n   regions  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("229")]),s._v("\n   capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2382364672")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2272")]),s._v(".0MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   used     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("469646584")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("447")]),s._v(".88988494873047MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("free")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1912718088")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1824")]),s._v(".1101150512695MB"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19.713463245982854")]),s._v("% used\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br")])]),a("h6",{attrs:{id:"_2-查看实例个数与占用内存大小"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-查看实例个数与占用内存大小"}},[s._v("#")]),s._v(" (2)查看实例个数与占用内存大小")]),s._v(" "),a("p",[s._v("使用 -"),a("strong",[s._v("histo")]),s._v(" 参数"),a("strong",[s._v("查看实例个数与占用内存大小")]),s._v(".")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ jmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-histo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n\n num     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#instances         #bytes  class name")]),s._v("\n----------------------------------------------\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("658")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4189056")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("I\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(":          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1197")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1177576")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("B\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(":          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7504")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("816120")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("C\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(":          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5779")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("138696")]),s._v("  java.lang.String\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("691")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("78976")]),s._v("  java.lang.Class\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(":          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1298")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("61136")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Ljava.lang.Object"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("791")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31640")]),s._v("  java.util.TreeMap"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$Entry")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("634")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25360")]),s._v("  java.util.LinkedHashMap"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$Entry")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("456")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22144")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Ljava.lang.String"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("368")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11776")]),s._v("  java.util.HashMap"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$Node")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":            "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("38")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11584")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Ljava.util.HashMap"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$Node")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("152")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10944")]),s._v("  java.lang.reflect.Field\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("388")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9312")]),s._v("  java.lang.StringBuilder\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("251")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8032")]),s._v("  java.io.File\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("242")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7744")]),s._v("  java.util.Hashtable"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$Entry")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6848")]),s._v("  java.net.URL\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("253")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6072")]),s._v("  java.lang.StringBuffer\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("ul",[a("li",[s._v("num: 序号.")]),s._v(" "),a("li",[s._v("instances: 实例"),a("strong",[s._v("数量")]),s._v(".")]),s._v(" "),a("li",[s._v("bytes: 占用空间大小.")]),s._v(" "),a("li",[s._v("class name: 类名称, 这里 "),a("strong",[s._v("[C -> char[], [S -> short[], [I -> int[], [B -> byte[], [[I -> int[][]")]),s._v(".")])]),s._v(" "),a("h6",{attrs:{id:"_3-获取堆转储文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-获取堆转储文件"}},[s._v("#")]),s._v(" (3)获取堆转储文件")]),s._v(" "),a("p",[a("strong",[s._v("示例")]),s._v(": 生成指定应用程序的"),a("strong",[s._v("堆专储快照文件")]),s._v(". 后面可以通过 jhat, mat 等工具"),a("strong",[s._v("分析")]),s._v("该 dump 文件.")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("$ jmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-dump:format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b,file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("heap.hprof "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\nDumping heap to /home/shared/apps/leo-homework/heap.hprof "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nHeap dump "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" created\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("JDK 提供 "),a("strong",[s._v("jhat 与 jmap")]),s._v(" 搭配使用, 来"),a("strong",[s._v("分析 dump 生成的堆快照")]),s._v(". jhat 内置了一个微型服务器, 生成 dump 文件的分析结果后, 可以在"),a("strong",[s._v("浏览器")]),s._v("中查看. 访问 http://localhost:7000/ 即可.")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ jhat heap.hprof\nReading from heap.hprof"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nDump "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" created Sat May 04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":30:31 CST "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("\nSnapshot read, resolving"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nResolving "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("131419")]),s._v(" objects"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nChasing references, "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("expect")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" dots"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\nEliminating duplicate references"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\nSnapshot resolved.\nStarted HTTP server on port "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7000")]),s._v("\nServer is ready.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h5",{attrs:{id:"_5-jstack生成线程快照"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-jstack生成线程快照"}},[s._v("#")]),s._v(" 5.jstack生成线程快照")]),s._v(" "),a("p",[a("strong",[s._v("jstack")]),s._v(" 命令用于生成虚拟机当前时刻的"),a("strong",[s._v("线程快照")]),s._v(", 一般称为 "),a("strong",[s._v("threaddump")]),s._v(" 文件. 线程快照就是当前虚拟机内每一条线程正在执行的"),a("strong",[s._v("方法堆栈集合")]),s._v(", 生成线程快照的主要目的是"),a("strong",[s._v("定位线程出现长时间停顿的原因")]),s._v(", 如"),a("strong",[s._v("线程死锁, 死循环, 请求外部资源导致长时间等待")]),s._v("等. 线程出现"),a("strong",[s._v("停顿")]),s._v("的时候通过 jstack 来查看各个线程的调用堆栈, 就可以知道没有响应的线程到底在后台做些什么事情.")]),s._v(" "),a("p",[s._v("jstack 命令格式:")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ jstack "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("option"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" vmid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("进程号"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h6",{attrs:{id:"_1-死锁分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-死锁分析"}},[s._v("#")]),s._v(" (1)死锁分析")]),s._v(" "),a("p",[a("strong",[s._v("下面是一个线程死锁的代码. 通过 jstack 命令进行死锁检查, 输出死锁信息, 找到发生死锁的线程.")])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DeadLockDemo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" resource1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 资源 1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" resource2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 资源 2")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 锁定资源1")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resource1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentThread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"获取资源1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 睡眠等待")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentThread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"等待资源2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 请求资源2")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resource2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentThread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"获取资源2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"线程 1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 锁定资源1")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resource2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentThread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"获取资源2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 睡眠等待")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("InterruptedException")]),s._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentThread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"等待资源1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 请求资源2")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("resource1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentThread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"获取资源1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"线程 2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br")])]),a("p",[s._v("两个线程互相等待资源, 造成死锁. 输出:")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("Thread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("线程 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1,5")]),s._v(",main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("获取资源1\nThread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("线程 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2,5")]),s._v(",main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("获取资源2\nThread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("线程 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1,5")]),s._v(",main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("等待资源2\nThread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("线程 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2,5")]),s._v(",main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("等待资源1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("查看指定进程号的线程快照")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ jstack "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("输出的部分内容如下:")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("$  jps                                              \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29408")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Launcher")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29409")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DeadLockDemo")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 测试进程")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("424")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29016")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RemoteMavenServer36")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("426")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29420")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Jps")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// jstack分析测试进程")]),s._v("\n$ jstack "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29409")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ....")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 找到一个死锁情况")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Found")]),s._v(" one "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Java")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("level deadlock"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"线程 2"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("lock")]),s._v(" monitor "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00007fadc08334a8")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("object "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x000000076ac965f0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  which is held by "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"线程 1"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"线程 1"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("lock")]),s._v(" monitor "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00007fadc0830c18")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("object "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x000000076ac96600")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  which is held by "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"线程 2"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Java")]),s._v(" stack information "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the threads listed above"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"线程 2"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nano"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deadlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("DeadLockDemo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lambda$main$"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DeadLockDemo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("lock")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("0x000000076ac965f0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" locked "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("0x000000076ac96600"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nano"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deadlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("DeadLockDemo")]),s._v("$$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lambda")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500977346.")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Unknown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("748")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"线程 1"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n        at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nano"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deadlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("DeadLockDemo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lambda$main$"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DeadLockDemo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" waiting "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("lock")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("0x000000076ac96600"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" locked "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("0x000000076ac965f0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("a "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("nano"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deadlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("DeadLockDemo")]),s._v("$$"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Lambda")]),s._v("$"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1338668845.")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Unknown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("748")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Found")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" deadlock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br")])]),a("p",[a("strong",[s._v("jstack 命令")]),s._v("已经找到发生死锁的线程具体信息.")]),s._v(" "),a("p",[s._v("还可以用 "),a("strong",[s._v("Visual VM")]),s._v(" 自动检测死锁.")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20200622105956372.png",alt:"image-20200622105956372"}})]),s._v(" "),a("h4",{attrs:{id:"jdk可视化工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jdk可视化工具"}},[s._v("#")]),s._v(" JDK可视化工具")]),s._v(" "),a("p",[s._v("JDK 中除了提供大量的命令行工具外, 还有两个功能强大的可视化工具: "),a("strong",[s._v("JConsole 和 Visual VM")]),s._v(". JConsole 不介绍了.")]),s._v(" "),a("p",[s._v("Visual VM 是一个集成多个 JDK 命令行工具的可视化工具. Visual VM 基于 NetBeans 平台开发, 它具备了插件扩展功能的特性, 通过插件的扩展, 可用于显示虚拟机进程及进程的配置和环境信息(jps, jinfo), 监视应用程序的 CPU, GC, 堆, 方法区及线程的信息(jstat, jstack)等. VisualVM 在 JDK/bin 目录下.")]),s._v(" "),a("p",[a("strong",[s._v("生产环境少用可视化的工具")]),s._v(", 比较耗性能.")]),s._v(" "),a("ul",[a("li",[s._v("生成, 浏览堆转储快照.")]),s._v(" "),a("li",[s._v("分析程序性能.")])]),s._v(" "),a("h4",{attrs:{id:"堆转储文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#堆转储文件"}},[s._v("#")]),s._v(" 堆转储文件")]),s._v(" "),a("h5",{attrs:{id:"_1-概述-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-概述-2"}},[s._v("#")]),s._v(" 1.概述")]),s._v(" "),a("p",[a("strong",[s._v("Heap Dump")]),s._v(" 也叫"),a("strong",[s._v("堆转储文件")]),s._v(", 是一个 Java 进程在"),a("strong",[s._v("某个时间点上的内存快照")]),s._v(". Heap Dump 有多种类型, 不过总体上 Heap Dump 在触发快照的时候都保存了 Java 对象和类的信息. 通常在"),a("strong",[s._v("写 Heap Dump 文件")]),s._v("前会"),a("strong",[s._v("触发一次 Full GC")]),s._v(", 所以 Heap Dump 文件中保存的是 "),a("strong",[s._v("Full GC 后")]),s._v("留下的对象信息.")]),s._v(" "),a("h5",{attrs:{id:"_2-堆转储的用途"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-堆转储的用途"}},[s._v("#")]),s._v(" 2.堆转储的用途")]),s._v(" "),a("p",[s._v("一般在 Heap Dump 文件中可以获取到如下信息:")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("对象信息")]),s._v(": 类, 成员变量, 直接量以及引用值.")]),s._v(" "),a("li",[a("strong",[s._v("类信息")]),s._v(": 类加载器, 名称, 超类, 静态成员.")]),s._v(" "),a("li",[a("strong",[s._v("GC Roots")]),s._v(": JVM 可达的对象.")]),s._v(" "),a("li",[a("strong",[s._v("线程栈以及本地变量")]),s._v(": 获取快照时的线程栈信息, 以及局部变量的详细信息.")])]),s._v(" "),a("p",[s._v("因此可以分析如下问题:")]),s._v(" "),a("ul",[a("li",[s._v("找出"),a("strong",[s._v("内存泄漏")]),s._v("的原因.")]),s._v(" "),a("li",[s._v("找出重复引用的 jar 或类.")]),s._v(" "),a("li",[s._v("分析"),a("strong",[s._v("集合")]),s._v("的使用.")]),s._v(" "),a("li",[s._v("分析"),a("strong",[s._v("类加载器")]),s._v(".")])]),s._v(" "),a("p",[s._v("对 Heap Dump 的分析就是对应用的内存使用进行分析, 从而更加合理地使用内存.")]),s._v(" "),a("h5",{attrs:{id:"_3-获取堆转储文件-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-获取堆转储文件-2"}},[s._v("#")]),s._v(" 3.获取堆转储文件")]),s._v(" "),a("p",[s._v("(1) "),a("strong",[s._v("设置虚拟机参数-XX:+HeapDumpOnOutOfMemoryError")]),s._v(": 设置此参数可以在发生 "),a("strong",[s._v("OutOfMemoryError")]),s._v(" 后获取到一份 HPROF 二进制 Heap Dump 文件, 生成的文件会直接写入到工作目录.")]),s._v(" "),a("p",[s._v("可以设置"),a("strong",[s._v("内存溢出自动导出")]),s._v(" dump 文件(内存很大的时候, 可能会导不出来).")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("-XX:+HeapDumpOnOutOfMemoryError")])]),s._v(" "),a("li",[a("strong",[s._v("-XX:HeapDumpPath=Path")])])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("OOMTest")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" list "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// JVM参数设置  ")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// -Xms10M -Xmx10M -XX:+PrintGCDetails -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=D:\\jvm.dump ")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" list "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" j "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n         list"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("randomUUID")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("j"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("randomUUID")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("(2) "),a("strong",[s._v("使用 jmap 工具")]),s._v(": 算是用的"),a("strong",[s._v("最多")]),s._v("的方式. 参考前述内容即可.")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("jmap "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dump"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("format"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("filename"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hprof"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("pid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("(3) "),a("strong",[s._v("使用 JConsole 工具")])]),s._v(" "),a("h4",{attrs:{id:"jstat调优实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jstat调优实例"}},[s._v("#")]),s._v(" jstat调优实例")]),s._v(" "),a("p",[a("strong",[s._v("用 jstat gc -pid 命令")]),s._v("可以计算出如下一些"),a("strong",[s._v("关键数据")]),s._v(", 先给自己的系统设置一些"),a("strong",[s._v("初始性的 JVM 参数")]),s._v(", 比如堆内存大小, 年轻代大小, Eden 和 Survivor 的比例, 老年代的大小, 大对象的阈值, 大龄对象进入老年代的阈值等.")]),s._v(" "),a("p",[a("strong",[s._v("年轻代对象增长的速率")])]),s._v(" "),a("p",[s._v("可以执行命令 "),a("strong",[s._v("jstat -gc pid 1000 10")]),s._v("(每隔 1 秒执行 1 次命令, 共执行 10 次), 通过观察 "),a("strong",[s._v("EU")]),s._v("(eden 区的使用)来估算每秒 eden 大概"),a("strong",[s._v("新增多少对象")]),s._v(", 如果系统负载不高, 可以把频率 1 秒换成 1 分钟, 甚至 10 分钟来观察整体情况. 注意, 一般系统可能有高峰期和日常期, 所以需要在不同的时间分别估算不同情况下对象增长速率.")]),s._v(" "),a("p",[a("strong",[s._v("Young GC 的触发频率和每次耗时")])]),s._v(" "),a("p",[s._v("知道年轻代对象增长速率后就能根据 Eden 区的大小推算出 Young GC 大概多久触发一次, Young GC 的平均耗时可以通过 "),a("strong",[s._v("YGCT/YGC")]),s._v(" 公式算出, 根据结果大概就能知道"),a("strong",[s._v("系统大概多久会因为 Young GC 的执行而卡顿多久")]),s._v(".")]),s._v(" "),a("p",[a("strong",[s._v("每次 Young GC 后有多少对象存活和进入老年代")])]),s._v(" "),a("p",[s._v("由于前面步骤已经大概知道 Young GC 的频率, 假设是每 5 分钟一次, 那么可以执行命令 jstat -gc pid 300000 10, 观察每次结果中 "),a("strong",[s._v("Eden")]),s._v(", "),a("strong",[s._v("Survivor 和老年代")]),s._v("使用的变化情况, 在每次 GC 后 Eden 区使用一般会大幅减少, Survivor 和老年代都有可能增长, 这些增长的对象就是每次 Young GC 后存活的对象, 同时还可以看出每次 Young GC 后进去老年代大概多少对象, 从而可以推算出"),a("strong",[s._v("老年代对象增长速率.")])]),s._v(" "),a("p",[a("strong",[s._v("Full GC 的触发频率和每次耗时")])]),s._v(" "),a("p",[s._v("知道了老年代对象的增长速率就可以推算出 "),a("strong",[s._v("Full GC 的触发频率")]),s._v("了, Full GC 的每次耗时可以用公式 "),a("strong",[s._v("FGCT/FGC")]),s._v(" 计算得出.")]),s._v(" "),a("p",[a("strong",[s._v("优化思路")]),s._v("其实简单来说就是"),a("strong",[s._v("尽量让每次 Young GC 后的存活对象小于 Survivor 区域的 50%, 都留存在年轻代里. 尽量别让对象进入老年代. 尽量减少 Full GC 的频率, 避免频繁 Full GC 对 JVM 性能的影响.")])]),s._v(" "),a("h4",{attrs:{id:"gc日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gc日志"}},[s._v("#")]),s._v(" GC日志")]),s._v(" "),a("h5",{attrs:{id:"_1-概述-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-概述-3"}},[s._v("#")]),s._v(" 1.概述")]),s._v(" "),a("p",[s._v("可以通过一些配置把运行过程中的 "),a("strong",[s._v("GC 日志全部打印")]),s._v("出来, 然后分析 GC 日志得到关键性指标, 分析 GC 原因, 调优 JVM 参数. 常见参数如下.")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGC")]),s._v(" \t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出GC日志")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCDetails")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出GC的详细日志")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCTimeStamps")]),s._v(" \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出GC的时间戳(以基准时间的形式)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCDateStamps")]),s._v(" \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出GC的时间戳(以日期的形式, 如 2013-05-04T21:53:59.234+0800)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintHeapAtGC")]),s._v(" \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在进行GC的前后打印出堆的信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xloggc")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/logs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 日志文件的输出路径")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("比如 "),a("strong",[s._v("Spring Boot")]),s._v(" 程序启动时添加:")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[s._v("‐"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCDetails")]),s._v(" ‐"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCTimeStamps")]),s._v(" ‐"),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCDateStamps")]),s._v(" ‐"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xloggc")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("/gc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("Tomcat 则直接加在 "),a("strong",[s._v("JAVA_OPTS")]),s._v(" 变量里.")]),s._v(" "),a("h5",{attrs:{id:"_2-日志分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-日志分析"}},[s._v("#")]),s._v(" 2.日志分析")]),s._v(" "),a("p",[s._v("一份摘自《深入理解 Java 虚拟机》中的一段 "),a("strong",[s._v("GC 日志")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33.125")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GC")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DefNew")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3324")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("152K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3712")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0025925")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3324")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("152K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11904")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0031680")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.667")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Full")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GC")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Tenured")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("K")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("210K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10240")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0149142")]),s._v("secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4603")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("210K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19456")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Perm")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2999")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("2999K")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21248")]),s._v("K"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0150007")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(" sys"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" real"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.02")]),s._v(" secs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("分析:")]),s._v(" "),a("ul",[a("li",[s._v('首先 "33.125" 和 "100.667" 这个数值的意义是代表 GC 发生的'),a("strong",[s._v("时间")]),s._v(", 该数字是 GC 启动以来的时间.")]),s._v(" "),a("li",[s._v('"GC" 和 "Full GC" 则代表这次 GC 发生的'),a("strong",[s._v("类型")]),s._v(", 如果为 Full GC, 则代表这次 GC 是 Stop The World 的. 如果通过 System.gc() 方法触发的则会显示 Full GC(System).")]),s._v(" "),a("li",[s._v('"DefNew, Tenured, Perm" 表示 GC 发生的'),a("strong",[s._v("区域")]),s._v(", 这里显示的区域名称与使用的 GC 收集器是密切相关的.")]),s._v(" "),a("li",[s._v('"3324K-＞152K(3712K)" 代表 '),a("strong",[s._v("GC 前")]),s._v("该区域内已使用的"),a("strong",[s._v("容量")]),s._v(" -> "),a("strong",[s._v("GC 后")]),s._v("该区域内已使用的容量(该区域内的总容量).")]),s._v(" "),a("li",[s._v('"0.0025925 secs" 表示这次 GC 所占用的时间单位为'),a("strong",[s._v("秒")]),s._v(".")]),s._v(" "),a("li",[s._v('"3324K->152K(11904K)" 则是 '),a("strong",[s._v("GC 前")]),s._v(" Java 堆已使用容量 -＞ "),a("strong",[s._v("GC 后")]),s._v(" Java 堆已使用容量(Java 堆总容量).")]),s._v(" "),a("li",[s._v('"[Times:user=0.01 sys=0.00, real=0.02 secs]" 里的 user, sys, real 分别代表用户态消耗 CPU 的时间和内核态消耗的 CPU 的时间和操作开始到结束所经历的时间.')])]),s._v(" "),a("p",[a("strong",[s._v("再看一个 GC 日志:")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20200622152448238-3129000.png",alt:"image-20200622152448238"}})]),s._v(" "),a("p",[s._v("可以看到图中"),a("strong",[s._v("第一行红框")]),s._v(", 是"),a("strong",[s._v("项目的配置参数")]),s._v(". 这里不仅配置了打印 GC 日志, 还有相关的 VM 内存参数.")]),s._v(" "),a("p",[a("strong",[s._v("第二行红框")]),s._v("中的是在这个 GC 时间点"),a("strong",[s._v("发生 GC 之后相关 GC 情况")]),s._v(".")]),s._v(" "),a("ul",[a("li",[s._v('"2.909" 这是具体发生 GC 的时间点. 这是时间戳是从 JVM '),a("strong",[s._v("启动开始计算")]),s._v("的, 前面还有具体的发生时间日期.")]),s._v(" "),a("li",[s._v('"Full GC(Metadata GC Threshold)" 指这是一次 Full GC, 括号里是 GC 的原因, "PSYoungGen" 是年轻代的 GC, "ParOldGen" 是老年代的 GC, "Metaspace" 是元空间的 GC.')]),s._v(" "),a("li",[s._v('"6160K->0K(141824K)": 这三个数字分别对应 GC 之前占用年轻代的大小, GC 之后年轻代占用, 以及整个年轻代的大小.')]),s._v(" "),a("li",[s._v('"112K->6056K(95744K)": 这三个数字分别对应 GC 之前占用老年代的大小, GC 之后老年代占用, 以及整个老年代的大小.')]),s._v(" "),a("li",[s._v('"6272K->6056K(237568K)": 这三个数字分别对应 GC 之前占用堆内存的大小, GC 之后堆内存占用, 以及整个堆内存的大小.')]),s._v(" "),a("li",[s._v('"20516K->20516K(1069056K)": 这三个数字分别对应 GC 之前占用元空间内存的大小, GC 之后元空间内存占用, 以及整个元空间内存的大小.')]),s._v(" "),a("li",[s._v('"0.0209707" 是该时间点 GC 总耗费时间.')])]),s._v(" "),a("p",[s._v("从日志可以发现几次 Full GC 都是由于元空间不够导致的, 所以可以将元空间调大点.")]),s._v(" "),a("p",[s._v("通过上面的这些参数就能知道 GC 的垃圾收集情况. 但是如果 GC 日志"),a("strong",[s._v("过多且繁杂")]),s._v(", 有时候为了发现问题往往需要连续运行很久, 比如几个周, 这就会有很多的 GC 日志, 直接去看就不现实, 可以使用可视化工具 "),a("strong",[s._v("gceasy")]),s._v(" 进行分析. 可以看到堆内存在 GC 之前和之后的变化, 以及其他信息.")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20200622154910625.png",alt:""}})]),s._v(" "),a("p",[s._v("‍")]),s._v(" "),a("h4",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" "),a("strong",[s._v("参考资料")])]),s._v(" "),a("ul",[a("li",[s._v("虚拟机性能监控与故障处理工具: "),a("a",{attrs:{href:"http://blog.csdn.net/wsyw126/article/details/62422005",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://blog.csdn.net/wsyw126/article/details/62422005"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("堆转储分析: "),a("a",{attrs:{href:"https://blog.csdn.net/hehmxy/article/details/89114116",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://blog.csdn.net/hehmxy/article/details/89114116"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);