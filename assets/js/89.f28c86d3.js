(window.webpackJsonp=window.webpackJsonp||[]).push([[89],{403:function(s,t,a){"use strict";a.r(t);var n=a(7),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_51-çº¿ç¨‹å®‰å…¨ä¸å†…ç½®é”ä¼˜åŒ–ğŸŒ¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_51-çº¿ç¨‹å®‰å…¨ä¸å†…ç½®é”ä¼˜åŒ–ğŸŒ¼"}},[s._v("#")]),s._v(" 51.çº¿ç¨‹å®‰å…¨ä¸å†…ç½®é”ä¼˜åŒ–ğŸŒ¼")]),s._v(" "),t("p",[s._v("æœ¬èŠ‚å¯¹åº”ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹çš„ç¬¬åä¸‰ç« ")]),s._v(" "),t("h4",{attrs:{id:"æ¦‚è¿°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ¦‚è¿°"}},[s._v("#")]),s._v(" æ¦‚è¿°")]),s._v(" "),t("p",[s._v("åœ¨è½¯ä»¶ä¸šå‘å±•çš„åˆæœŸ, ç¨‹åºç¼–å†™éƒ½æ˜¯ä»¥ç®—æ³•ä¸ºæ ¸å¿ƒçš„, ç¨‹åºå‘˜ä¼šæŠŠæ•°æ®å’Œè¿‡ç¨‹åˆ†åˆ«ä½œä¸ºç‹¬ç«‹çš„éƒ¨åˆ†æ¥è€ƒè™‘, æ•°æ®ä»£è¡¨é—®é¢˜ç©ºé—´ä¸­çš„å®¢ä½“, ç¨‹åºä»£ç åˆ™ç”¨äºå¤„ç†è¿™äº›æ•°æ®, è¿™ç§æ€ç»´æ–¹å¼ç›´æ¥ç«™åœ¨è®¡ç®—æœºçš„è§’åº¦å»æŠ½è±¡é—®é¢˜å’Œè§£å†³é—®é¢˜, è¢«ç§°ä¸º"),t("strong",[s._v("é¢å‘è¿‡ç¨‹")]),s._v("çš„ç¼–ç¨‹æ€æƒ³. ä¸æ­¤ç›¸å¯¹, é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³åˆ™ç«™åœ¨ç°å®ä¸–ç•Œçš„è§’åº¦å»æŠ½è±¡å’Œè§£å†³é—®é¢˜, å®ƒæŠŠæ•°æ®å’Œè¡Œä¸ºéƒ½çœ‹ä½œå¯¹è±¡çš„ä¸€éƒ¨åˆ†, è¿™æ ·å¯ä»¥è®©ç¨‹åºå‘˜èƒ½ä»¥ç¬¦åˆç°å®ä¸–ç•Œçš„æ€ç»´æ–¹å¼æ¥ç¼–å†™å’Œç»„ç»‡ç¨‹åº.")]),s._v(" "),t("p",[s._v('é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³æå¤§åœ°æå‡äº†ç°ä»£è½¯ä»¶å¼€å‘çš„æ•ˆç‡å’Œè½¯ä»¶å¯ä»¥è¾¾åˆ°çš„è§„æ¨¡, ä½†æ˜¯ç°å®ä¸–ç•Œä¸è®¡ç®—æœºä¸–ç•Œä¹‹é—´ä¸å¯é¿å…åœ°å­˜åœ¨ä¸€äº›å·®å¼‚. ä¾‹å¦‚, äººä»¬å¾ˆéš¾æƒ³è±¡ç°å®ä¸­çš„å¯¹è±¡åœ¨ä¸€é¡¹å·¥ä½œè¿›è¡ŒæœŸé—´, ä¼šè¢«ä¸åœåœ°ä¸­æ–­å’Œåˆ‡æ¢, å¯¹è±¡çš„å±æ€§(æ•°æ®)å¯èƒ½ä¼šåœ¨ä¸­æ–­æœŸé—´è¢«ä¿®æ”¹å’Œå˜è„, è€Œè¿™äº›äº‹ä»¶åœ¨è®¡ç®—æœºä¸–ç•Œä¸­æ˜¯å†æ™®é€šä¸è¿‡çš„äº‹æƒ…. æœ‰æ—¶å€™, è‰¯å¥½çš„è®¾è®¡åŸåˆ™ä¸å¾—ä¸å‘ç°å®åšå‡ºä¸€äº›å¦¥å, å¤§å®¶å¿…é¡»ä¿è¯ç¨‹åºåœ¨è®¡ç®—æœºä¸­æ­£ç¡®æ— è¯¯åœ°è¿è¡Œ, ç„¶åå†è€ƒè™‘å¦‚ä½•å°†ä»£ç ç»„ç»‡å¾—æ›´å¥½, è®©ç¨‹åºè¿è¡Œå¾—æ›´å¿«. å¯¹äºæœ¬ç« çš„ä¸»é¢˜ "é«˜æ•ˆå¹¶å‘" æ¥è¯´, é¦–å…ˆéœ€è¦ä¿è¯å¹¶å‘çš„æ­£ç¡®æ€§, ç„¶ååœ¨æ­¤åŸºç¡€ä¸Šæ¥å®ç°é«˜æ•ˆ. æœ¬ç« å°±å…ˆä»'),t("strong",[s._v("å¦‚ä½•ä¿è¯å¹¶å‘çš„æ­£ç¡®æ€§åŠå¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨è¯´èµ·")]),s._v(".")]),s._v(" "),t("h4",{attrs:{id:"çº¿ç¨‹å®‰å…¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#çº¿ç¨‹å®‰å…¨"}},[s._v("#")]),s._v(" çº¿ç¨‹å®‰å…¨")]),s._v(" "),t("p",[s._v('ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜(Java Concurrency In Practice)ã€‹ä¸º "çº¿ç¨‹å®‰å…¨" åšå‡ºäº†ä¸€ä¸ªæ¯”è¾ƒæ°å½“çš„å®šä¹‰: "'),t("strong",[s._v("å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ä¸€ä¸ªå¯¹è±¡æ—¶, å¦‚æœä¸ç”¨è€ƒè™‘è¿™äº›çº¿ç¨‹åœ¨è¿è¡Œæ—¶ç¯å¢ƒä¸‹çš„è°ƒåº¦å’Œäº¤æ›¿æ‰§è¡Œ, ä¹Ÿä¸éœ€è¦è¿›è¡Œé¢å¤–çš„åŒæ­¥, æˆ–è€…åœ¨è°ƒç”¨æ–¹è¿›è¡Œä»»ä½•å…¶ä»–çš„åè°ƒæ“ä½œ, è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„è¡Œä¸ºéƒ½å¯ä»¥è·å¾—æ­£ç¡®çš„ç»“æœ, é‚£å°±ç§°è¿™ä¸ªå¯¹è±¡æ˜¯çº¿ç¨‹å®‰å…¨çš„")]),s._v('".')]),s._v(" "),t("p",[s._v("è¿™ä¸ªå®šä¹‰å°±å¾ˆä¸¥è°¨è€Œä¸”æœ‰å¯æ“ä½œæ€§, å®ƒè¦æ±‚çº¿ç¨‹å®‰å…¨çš„ä»£ç éƒ½å¿…é¡»"),t("strong",[s._v("å…·å¤‡ä¸€ä¸ªå…±åŒç‰¹å¾")]),s._v(": "),t("strong",[s._v("ä»£ç æœ¬èº«å°è£…äº†æ‰€æœ‰å¿…è¦çš„æ­£ç¡®æ€§ä¿éšœæ‰‹æ®µ(å¦‚äº’æ–¥åŒæ­¥ç­‰), ä»¤è°ƒç”¨è€…æ— é¡»å…³å¿ƒå¤šçº¿ç¨‹ä¸‹çš„è°ƒç”¨é—®é¢˜, æ›´æ— é¡»è‡ªå·±å®ç°ä»»ä½•æªæ–½æ¥ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ­£ç¡®è°ƒç”¨")]),s._v('. è¿™ç‚¹å¬èµ·æ¥ç®€å•, ä½†å…¶å®å¹¶ä¸å®¹æ˜“åšåˆ°, åœ¨è®¸å¤šåœºæ™¯ä¸­, éƒ½ä¼šå°†è¿™ä¸ªå®šä¹‰å¼±åŒ–ä¸€äº›. å¦‚æœæŠŠ "è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„è¡Œä¸º" é™å®šä¸º "å•æ¬¡è°ƒç”¨", è¿™ä¸ªå®šä¹‰çš„å…¶ä»–æè¿°èƒ½å¤Ÿæˆç«‹çš„è¯, é‚£ä¹ˆå°±å·²ç»å¯ä»¥ç§°å®ƒæ˜¯çº¿ç¨‹å®‰å…¨äº†. ä¸ºä»€ä¹ˆè¦å¼±åŒ–è¿™ä¸ªå®šä¹‰? ç°åœ¨å…ˆæš‚ä¸”æ”¾ä¸‹è¿™ä¸ªé—®é¢˜, ç¨åå†è¯¦ç»†æ¢è®¨.')]),s._v(" "),t("h5",{attrs:{id:"_1-javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨"}},[s._v("#")]),s._v(" 1.Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨")]),s._v(" "),t("p",[s._v("å‰é¢å·²ç»æœ‰äº†çº¿ç¨‹å®‰å…¨çš„ä¸€ä¸ªå¯æ“ä½œçš„å®šä¹‰, é‚£æ¥ä¸‹æ¥å°±è®¨è®ºä¸€ä¸‹: "),t("strong",[s._v("åœ¨ Java è¯­è¨€ä¸­, çº¿ç¨‹å®‰å…¨å…·ä½“æ˜¯å¦‚ä½•ä½“ç°çš„? æœ‰å“ªäº›æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„")]),s._v("? è¿™é‡Œè®¨è®ºçš„çº¿ç¨‹å®‰å…¨, å°†ä»¥å¤šä¸ªçº¿ç¨‹ä¹‹é—´å­˜åœ¨å…±äº«æ•°æ®è®¿é—®ä¸ºå‰æ. å› ä¸ºå¦‚æœæ ¹æœ¬ä¸å­˜åœ¨å¤šçº¿ç¨‹, åˆæˆ–è€…ä¸€æ®µä»£ç æ ¹æœ¬ä¸ä¼šä¸å…¶ä»–çº¿ç¨‹å…±äº«æ•°æ®, é‚£ä¹ˆä»çº¿ç¨‹å®‰å…¨çš„è§’åº¦ä¸Šçœ‹, ç¨‹åºæ˜¯ä¸²è¡Œæ‰§è¡Œè¿˜æ˜¯å¤šçº¿ç¨‹æ‰§è¡Œå¯¹å®ƒæ¥è¯´æ˜¯æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«çš„.")]),s._v(" "),t("p",[s._v("ä¸ºäº†æ›´æ·±å…¥åœ°ç†è§£çº¿ç¨‹å®‰å…¨, åœ¨è¿™é‡Œå¯ä»¥ä¸æŠŠçº¿ç¨‹å®‰å…¨å½“ä½œä¸€ä¸ªéçœŸå³å‡çš„äºŒå…ƒæ’ä»–é€‰é¡¹æ¥çœ‹å¾…, è€Œæ˜¯æŒ‰ç…§çº¿ç¨‹å®‰å…¨çš„  "),t("strong",[s._v('"å®‰å…¨ç¨‹åº¦" ç”±å¼ºè‡³å¼±æ¥æ’åº')]),s._v(", å¯ä»¥å°† Java è¯­è¨€ä¸­å„ç§æ“ä½œå…±äº«çš„æ•°æ®åˆ†ä¸ºä»¥ä¸‹äº”ç±»: "),t("mark",[t("strong",[s._v("ä¸å¯å˜, ç»å¯¹çº¿ç¨‹å®‰å…¨, ç›¸å¯¹çº¿ç¨‹å®‰å…¨, çº¿ç¨‹å…¼å®¹å’Œçº¿ç¨‹å¯¹ç«‹")])]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("ä¸‹é¢ä»‹ç»çš„å°±æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨, å¦‚ä½•ç†è§£çº¿ç¨‹å®‰å…¨çš„ç²’åº¦?")])]),s._v(" "),t("h6",{attrs:{id:"_1-ä¸å¯å˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ä¸å¯å˜"}},[s._v("#")]),s._v(" (1)ä¸å¯å˜")]),s._v(" "),t("p",[s._v("åœ¨ Java è¯­è¨€é‡Œé¢(ç‰¹æŒ‡ JDK 5 ä»¥å, å³ Java å†…å­˜æ¨¡å‹è¢«ä¿®æ­£ä¹‹åçš„ Java è¯­è¨€), "),t("strong",[s._v("ä¸å¯å˜(Immutable)çš„å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„, æ— è®ºæ˜¯å¯¹è±¡çš„æ–¹æ³•å®ç°è¿˜æ˜¯æ–¹æ³•çš„è°ƒç”¨è€…, éƒ½ä¸éœ€è¦å†è¿›è¡Œä»»ä½•çº¿ç¨‹å®‰å…¨ä¿éšœæªæ–½")]),s._v('. å‰é¢è®²è§£ "final å…³é”®å­—å¸¦æ¥çš„å¯è§æ€§" æ—¶æ›¾ç»æåˆ°è¿‡è¿™ä¸€ç‚¹: '),t("strong",[s._v("åªè¦ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡è¢«æ­£ç¡®åœ°æ„å»ºå‡ºæ¥(å³æ²¡æœ‰å‘ç”Ÿ this å¼•ç”¨é€ƒé€¸çš„æƒ…å†µ), é‚£å…¶å¤–éƒ¨çš„å¯è§çŠ¶æ€æ°¸è¿œéƒ½ä¸ä¼šæ”¹å˜, æ°¸è¿œéƒ½ä¸ä¼šçœ‹åˆ°å®ƒåœ¨å¤šä¸ªçº¿ç¨‹ä¹‹ä¸­å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€")]),s._v('. "ä¸å¯å˜" å¸¦æ¥çš„å®‰å…¨æ€§æ˜¯æœ€ç›´æ¥, æœ€çº¯ç²¹çš„.')]),s._v(" "),t("p",[s._v("Java è¯­è¨€ä¸­, "),t("strong",[s._v("å¦‚æœå¤šçº¿ç¨‹å…±äº«çš„æ•°æ®æ˜¯ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹, é‚£ä¹ˆåªè¦åœ¨å®šä¹‰æ—¶ä½¿ç”¨ final å…³é”®å­—ä¿®é¥°å®ƒå°±å¯ä»¥ä¿è¯å®ƒæ˜¯ä¸å¯å˜çš„")]),s._v(". å¦‚æœå…±äº«æ•°æ®æ˜¯ä¸€ä¸ªå¯¹è±¡, ç”±äº Java è¯­è¨€ç›®å‰æš‚æ—¶è¿˜æ²¡æœ‰æä¾›å€¼ç±»å‹çš„æ”¯æŒ, é‚£å°±éœ€è¦å¯¹è±¡è‡ªè¡Œä¿è¯å…¶è¡Œä¸ºä¸ä¼šå¯¹å…¶çŠ¶æ€äº§ç”Ÿä»»ä½•å½±å“æ‰è¡Œ. å¦‚æœè¯»è€…æ²¡æƒ³æ˜ç™½è¿™å¥è¯æ‰€æŒ‡çš„æ„æ€, ä¸å¦¨ç±»æ¯” java.lang.String ç±»çš„å¯¹è±¡å®ä¾‹, å®ƒæ˜¯ä¸€ä¸ª"),t("strong",[s._v("å…¸å‹çš„ä¸å¯å˜å¯¹è±¡")]),s._v(", ç”¨æˆ·è°ƒç”¨å®ƒçš„ substring(), replace() å’Œ concat() è¿™äº›æ–¹æ³•éƒ½"),t("strong",[s._v("ä¸ä¼šå½±å“å®ƒåŸæ¥çš„å€¼, åªä¼šè¿”å›ä¸€ä¸ªæ–°æ„é€ çš„å­—ç¬¦ä¸²å¯¹è±¡")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("ä¿è¯å¯¹è±¡è¡Œä¸ºä¸å½±å“è‡ªå·±çŠ¶æ€çš„é€”å¾„æœ‰å¾ˆå¤šç§, æœ€ç®€å•çš„ä¸€ç§å°±æ˜¯æŠŠå¯¹è±¡é‡Œé¢å¸¦æœ‰çŠ¶æ€çš„å˜é‡éƒ½å£°æ˜ä¸º final, è¿™æ ·åœ¨æ„é€ å‡½æ•°ç»“æŸä¹‹å, å®ƒå°±æ˜¯ä¸å¯å˜çš„")]),s._v(", ä¾‹å¦‚ä»£ç æ¸…å• 13-1 ä¸­æ‰€ç¤ºçš„ java.lang.Integer æ„é€ å‡½æ•°, å®ƒé€šè¿‡å°†å†…éƒ¨çŠ¶æ€å˜é‡ value å®šä¹‰ä¸º final æ¥ä¿éšœçŠ¶æ€ä¸å˜.")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»£ç æ¸…å•13-1 JDK ä¸­ Integer ç±»çš„æ„é€ å‡½æ•°")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * The value of the <code>Integer</code>.\n * @serial\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Constructs a newly allocated <code>Integer</code> object that\n * represents the specified <code>int</code> value.\n *\n * @param   value   the value to be represented by the\n * <code>Integer</code> object.\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("åœ¨ Java ç±»åº“ API ä¸­ç¬¦åˆ"),t("strong",[s._v("ä¸å¯å˜è¦æ±‚çš„ç±»å‹")]),s._v(", é™¤äº†ä¸Šé¢æåˆ°çš„ String ä¹‹å¤–, å¸¸ç”¨çš„è¿˜æœ‰æšä¸¾ç±»å‹åŠ java.lang.Number çš„éƒ¨åˆ†å­ç±», å¦‚ Long å’Œ Double ç­‰æ•°å€¼åŒ…è£…ç±»å‹, BigInteger å’Œ BigDecimal ç­‰å¤§æ•°æ®ç±»å‹. ä½†åŒä¸º Number å­ç±»å‹çš„åŸå­ç±» AtomicInteger å’Œ AtomicLong åˆ™æ˜¯å¯å˜çš„, è¯»è€…ä¸å¦¨çœ‹çœ‹è¿™ä¸¤ä¸ªåŸå­ç±»çš„æºç , æƒ³ä¸€æƒ³ä¸ºä»€ä¹ˆå®ƒä»¬è¦è®¾è®¡æˆå¯å˜çš„.")]),s._v(" "),t("h6",{attrs:{id:"_2-ç»å¯¹çº¿ç¨‹å®‰å…¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ç»å¯¹çº¿ç¨‹å®‰å…¨"}},[s._v("#")]),s._v(" (2)ç»å¯¹çº¿ç¨‹å®‰å…¨")]),s._v(" "),t("p",[s._v('ç»å¯¹çš„çº¿ç¨‹å®‰å…¨èƒ½å¤Ÿå®Œå…¨æ»¡è¶³çº¿ç¨‹å®‰å…¨çš„å®šä¹‰, è¿™ä¸ªå®šä¹‰å…¶å®æ˜¯å¾ˆä¸¥æ ¼çš„, ä¸€ä¸ªç±»è¦è¾¾åˆ° "ä¸ç®¡è¿è¡Œæ—¶ç¯å¢ƒå¦‚ä½•, è°ƒç”¨è€…éƒ½ä¸éœ€è¦ä»»ä½•é¢å¤–çš„åŒæ­¥æªæ–½" å¯èƒ½éœ€è¦ä»˜å‡ºéå¸¸é«˜æ˜‚çš„, ç”šè‡³ä¸åˆ‡å®é™…çš„ä»£ä»·. åœ¨ Java API ä¸­æ ‡æ³¨è‡ªå·±æ˜¯çº¿ç¨‹å®‰å…¨çš„ç±», å¤§å¤šæ•°éƒ½ä¸æ˜¯ç»å¯¹çš„çº¿ç¨‹å®‰å…¨. å¯ä»¥é€šè¿‡ Java API ä¸­ä¸€ä¸ªä¸æ˜¯ "ç»å¯¹çº¿ç¨‹å®‰å…¨" çš„ "çº¿ç¨‹å®‰å…¨ç±»å‹" æ¥çœ‹çœ‹è¿™ä¸ªè¯­å¢ƒé‡Œçš„ "'),t("strong",[s._v("ç»å¯¹")]),s._v('" ç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ„æ€.')]),s._v(" "),t("p",[s._v("å¦‚æœè¯´ java.util.Vector æ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å®¹å™¨, ç›¸ä¿¡æ‰€æœ‰çš„ Java ç¨‹åºå‘˜å¯¹æ­¤éƒ½ä¸ä¼šæœ‰å¼‚è®®, å› ä¸ºå®ƒçš„ add(), get() å’Œ size() ç­‰æ–¹æ³•éƒ½æ˜¯è¢« synchronized ä¿®é¥°çš„, å°½ç®¡è¿™æ ·æ•ˆç‡ä¸é«˜, ä½†ä¿è¯äº†å…·å¤‡åŸå­æ€§, å¯è§æ€§å’Œæœ‰åºæ€§. ä¸è¿‡, å³ä½¿å®ƒæ‰€æœ‰çš„æ–¹æ³•éƒ½è¢«ä¿®é¥°æˆ synchronized, ä¹Ÿä¸æ„å‘³ç€è°ƒç”¨å®ƒçš„æ—¶å€™å°±æ°¸è¿œéƒ½ä¸å†éœ€è¦åŒæ­¥æ‰‹æ®µäº†, è¯·çœ‹çœ‹ä»£ç æ¸…å• 13-2 ä¸­çš„æµ‹è¯•ä»£ç .")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»£ç æ¸…å•13-2 å¯¹ Vector çº¿ç¨‹å®‰å…¨çš„æµ‹è¯•")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vector")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" vector "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vector")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Integer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),s._v(" removeThread "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Runnable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("remove")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),s._v(" printThread "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Runnable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        removeThread"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        printThread"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¸è¦åŒæ—¶äº§ç”Ÿè¿‡å¤šçš„çº¿ç¨‹, å¦åˆ™ä¼šå¯¼è‡´æ“ä½œç³»ç»Ÿå‡æ­»")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("activeCount")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("p",[s._v("è¿è¡Œç»“æœå¦‚ä¸‹:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('Exception in thread "Thread-132" java.lang.ArrayIndexOutOfBoundsException:\nArray index out of range: 17\n    at java.util.Vector.remove(Vector.java:777)\n    at org.fenixsoft.mulithread.VectorTest$1.run(VectorTest.java:21)\n    at java.lang.Thread.run(Thread.java:662)\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("å¾ˆæ˜æ˜¾, å°½ç®¡è¿™é‡Œä½¿ç”¨åˆ°çš„ Vector çš„ get(), remove() å’Œ size() æ–¹æ³•éƒ½æ˜¯åŒæ­¥çš„, ä½†æ˜¯åœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸­, å¦‚æœä¸åœ¨"),t("strong",[s._v("æ–¹æ³•è°ƒç”¨ç«¯åšé¢å¤–çš„åŒæ­¥æªæ–½")]),s._v(", ä½¿ç”¨è¿™æ®µä»£ç ä»ç„¶æ˜¯"),t("strong",[s._v("ä¸å®‰å…¨")]),s._v("çš„. å› ä¸ºå¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹æ°å¥½åœ¨é”™è¯¯çš„æ—¶é—´é‡Œåˆ é™¤äº†ä¸€ä¸ªå…ƒç´ , å¯¼è‡´åºå· i å·²ç»ä¸å†å¯ç”¨, å†ç”¨ i è®¿é—®æ•°ç»„å°±ä¼šæŠ›å‡ºä¸€ä¸ª ArrayIndexOutOfBoundsException å¼‚å¸¸. å¦‚æœè¦ä¿è¯è¿™æ®µä»£ç èƒ½æ­£ç¡®æ‰§è¡Œä¸‹å», æ‰€ä»¥ä¸å¾—ä¸æŠŠ removeThread å’Œ printThread çš„å®šä¹‰æ”¹æˆä»£ç æ¸…å• 13-3 æ‰€ç¤ºçš„è¿™æ ·.")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»£ç æ¸…å•13-3 å¿…é¡»åŠ å…¥åŒæ­¥ä¿è¯ Vector è®¿é—®çš„çº¿ç¨‹å®‰å…¨æ€§")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),s._v(" removeThread "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Runnable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("remove")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),s._v(" printThread "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Runnable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("synchronized")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("size")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("vector"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("p",[s._v("å‡å¦‚ Vector ä¸€å®šè¦åšåˆ°ç»å¯¹çš„çº¿ç¨‹å®‰å…¨, é‚£å°±å¿…é¡»"),t("strong",[s._v("åœ¨å®ƒå†…éƒ¨ç»´æŠ¤ä¸€ç»„ä¸€è‡´æ€§çš„å¿«ç…§è®¿é—®æ‰è¡Œ")]),s._v(", æ¯æ¬¡å¯¹å…¶ä¸­å…ƒç´ è¿›è¡Œæ”¹åŠ¨éƒ½è¦äº§ç”Ÿæ–°çš„å¿«ç…§, è¿™æ ·è¦ä»˜å‡ºçš„æ—¶é—´å’Œç©ºé—´æˆæœ¬éƒ½æ˜¯éå¸¸å¤§çš„.")]),s._v(" "),t("h6",{attrs:{id:"_3-ç›¸å¯¹çº¿ç¨‹å®‰å…¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-ç›¸å¯¹çº¿ç¨‹å®‰å…¨"}},[s._v("#")]),s._v(" (3)ç›¸å¯¹çº¿ç¨‹å®‰å…¨")]),s._v(" "),t("p",[t("strong",[s._v("ç›¸å¯¹çº¿ç¨‹å®‰å…¨å°±æ˜¯é€šå¸¸æ„ä¹‰ä¸Šæ‰€è®²çš„çº¿ç¨‹å®‰å…¨, å®ƒéœ€è¦ä¿è¯å¯¹è¿™ä¸ªå¯¹è±¡å•æ¬¡çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„")]),s._v(", åœ¨è°ƒç”¨çš„æ—¶å€™ä¸éœ€è¦è¿›è¡Œé¢å¤–çš„ä¿éšœæªæ–½, ä½†æ˜¯å¯¹äºä¸€äº›ç‰¹å®šé¡ºåºçš„è¿ç»­è°ƒç”¨, å°±å¯èƒ½éœ€è¦åœ¨è°ƒç”¨ç«¯ä½¿ç”¨é¢å¤–çš„åŒæ­¥æ‰‹æ®µæ¥ä¿è¯è°ƒç”¨çš„æ­£ç¡®æ€§. ä»£ç æ¸…å• 13-2 å’Œä»£ç æ¸…å• 13-3 å°±æ˜¯ç›¸å¯¹çº¿ç¨‹å®‰å…¨çš„æ¡ˆä¾‹.")]),s._v(" "),t("p",[t("strong",[s._v("åœ¨ Java è¯­è¨€ä¸­, å¤§éƒ¨åˆ†å£°ç§°çº¿ç¨‹å®‰å…¨çš„ç±»éƒ½å±äºè¿™ç§ç±»å‹")]),s._v(", ä¾‹å¦‚ Vector, HashTable, Collections çš„ synchronizedCollection() æ–¹æ³•åŒ…è£…çš„é›†åˆç­‰.")]),s._v(" "),t("h6",{attrs:{id:"_4-çº¿ç¨‹å…¼å®¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-çº¿ç¨‹å…¼å®¹"}},[s._v("#")]),s._v(" (4)çº¿ç¨‹å…¼å®¹")]),s._v(" "),t("p",[t("strong",[s._v("çº¿ç¨‹å…¼å®¹æ˜¯æŒ‡å¯¹è±¡æœ¬èº«å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„, ä½†æ˜¯å¯ä»¥é€šè¿‡åœ¨è°ƒç”¨ç«¯æ­£ç¡®åœ°ä½¿ç”¨åŒæ­¥æ‰‹æ®µæ¥ä¿è¯å¯¹è±¡åœ¨å¹¶å‘ç¯å¢ƒä¸­å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨")]),s._v(". å¹³å¸¸è¯´ä¸€ä¸ªç±»ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„, é€šå¸¸å°±æ˜¯æŒ‡è¿™ç§æƒ…å†µ. Java ç±»åº“ API ä¸­å¤§éƒ¨åˆ†çš„ç±»éƒ½æ˜¯çº¿ç¨‹å…¼å®¹çš„, å¦‚ä¸å‰é¢çš„ Vector å’Œ HashTable ç›¸å¯¹åº”çš„é›†åˆç±» ArrayList å’Œ HashMap ç­‰.")]),s._v(" "),t("h6",{attrs:{id:"_5-çº¿ç¨‹å¯¹ç«‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-çº¿ç¨‹å¯¹ç«‹"}},[s._v("#")]),s._v(" (5)çº¿ç¨‹å¯¹ç«‹")]),s._v(" "),t("p",[t("strong",[s._v("çº¿ç¨‹å¯¹ç«‹æ˜¯æŒ‡ä¸ç®¡è°ƒç”¨ç«¯æ˜¯å¦é‡‡å–äº†åŒæ­¥æªæ–½, éƒ½æ— æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å¹¶å‘ä½¿ç”¨ä»£ç ")]),s._v(". ç”±äº Java è¯­è¨€å¤©ç”Ÿå°±æ”¯æŒå¤šçº¿ç¨‹çš„ç‰¹æ€§, çº¿ç¨‹å¯¹ç«‹è¿™ç§æ’æ–¥å¤šçº¿ç¨‹çš„ä»£ç æ˜¯å¾ˆå°‘å‡ºç°çš„, è€Œä¸”é€šå¸¸éƒ½æ˜¯æœ‰å®³çš„, åº”å½“å°½é‡é¿å….")]),s._v(" "),t("p",[s._v("ä¸€ä¸ªçº¿ç¨‹å¯¹ç«‹çš„ä¾‹å­æ˜¯ Thread ç±»çš„ suspend() å’Œ resume() æ–¹æ³•. å¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æŒæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡, ä¸€ä¸ªå°è¯•å»ä¸­æ–­çº¿ç¨‹, ä¸€ä¸ªå°è¯•å»æ¢å¤çº¿ç¨‹, åœ¨å¹¶å‘è¿›è¡Œçš„æƒ…å†µä¸‹, æ— è®ºè°ƒç”¨æ—¶æ˜¯å¦è¿›è¡Œäº†åŒæ­¥, ç›®æ ‡çº¿ç¨‹éƒ½å­˜åœ¨æ­»é”é£é™©. å‡å¦‚ suspend() ä¸­æ–­çš„çº¿ç¨‹å°±æ˜¯å³å°†è¦æ‰§è¡Œ resume() çš„é‚£ä¸ªçº¿ç¨‹, é‚£å°±è‚¯å®šè¦äº§ç”Ÿæ­»é”äº†. ä¹Ÿæ­£æ˜¯è¿™ä¸ªåŸå› , "),t("strong",[s._v("suspend() å’Œ resume() æ–¹æ³•éƒ½å·²ç»è¢«å£°æ˜åºŸå¼ƒ")]),s._v("äº†. å¸¸è§çš„çº¿ç¨‹å¯¹ç«‹çš„æ“ä½œè¿˜æœ‰ System.setIn(), Sytem.setOut() å’Œ System.runFinalizersOnExit() ç­‰.")]),s._v(" "),t("h5",{attrs:{id:"_2-çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•"}},[s._v("#")]),s._v(" 2.çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•")]),s._v(" "),t("p",[s._v("äº†è§£è¿‡"),t("strong",[s._v("ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨")]),s._v("ä¹‹å, ç´§æ¥ç€çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯åº”è¯¥"),t("strong",[s._v("å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨")]),s._v(". è¿™å¬èµ·æ¥ä¼¼ä¹æ˜¯ä¸€ä»¶ç”±ä»£ç å¦‚ä½•ç¼–å†™æ¥å†³å®šçš„äº‹æƒ…, ä¸åº”è¯¥å‡ºç°åœ¨è®²è§£ Java è™šæ‹Ÿæœºçš„ä¹¦é‡Œ. ç¡®å®, å¦‚ä½•å®ç°çº¿ç¨‹å®‰å…¨ä¸ä»£ç ç¼–å†™æœ‰å¾ˆå¤§çš„å…³ç³», ä½†è™šæ‹Ÿæœºæä¾›çš„åŒæ­¥å’Œé”æœºåˆ¶ä¹Ÿèµ·åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨. åœ¨æœ¬èŠ‚ä¸­, å¦‚ä½•ç¼–å†™ä»£ç å®ç°çº¿ç¨‹å®‰å…¨, ä»¥åŠè™šæ‹Ÿæœºå¦‚ä½•å®ç°åŒæ­¥ä¸é”è¿™ä¸¤æ–¹é¢éƒ½ä¼šæ¶‰åŠ, ç›¸å¯¹è€Œè¨€æ›´åé‡åè€…ä¸€äº›, åªè¦è¯»è€…æ˜ç™½äº† "),t("strong",[s._v("Java è™šæ‹Ÿæœºçº¿ç¨‹å®‰å…¨æªæ–½çš„åŸç†ä¸è¿ä½œè¿‡ç¨‹")]),s._v(", è‡ªå·±å†å»æ€è€ƒä»£ç å¦‚ä½•ç¼–å†™å°±ä¸æ˜¯ä¸€ä»¶å›°éš¾çš„äº‹æƒ…äº†.")]),s._v(" "),t("p",[s._v("åŒæ­¥æ˜¯æŒ‡åœ¨å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«æ•°æ®æ—¶, ä¿è¯å…±äº«æ•°æ®åœ¨åŒä¸€ä¸ªæ—¶åˆ»åªè¢«ä¸€ä¸ª(æˆ–è€…æ˜¯ä¸€äº›, ä½¿ç”¨ä¿¡å·é‡çš„æ—¶å€™)çº¿ç¨‹ä½¿ç”¨.")]),s._v(" "),t("p",[s._v("ä¿è¯çº¿ç¨‹é—´çš„"),t("strong",[s._v("å®‰å…¨åŒæ­¥")]),s._v("æœ‰ä»¥ä¸‹å‡ ç§å®ç°æ–¹å¼:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("é˜»å¡åŒæ­¥")]),s._v("(æ‚²è§‚ç­–ç•¥): Synchronized, ReentrantLock.")]),s._v(" "),t("li",[t("strong",[s._v("éé˜»å¡åŒæ­¥")]),s._v("(ä¹è§‚ç­–ç•¥): CAS.")]),s._v(" "),t("li",[t("strong",[s._v("æ— åŒæ­¥")]),s._v(": ThreadLocal, æ ˆå°é—­, ä¸å¯å˜ç±».")])]),s._v(" "),t("h6",{attrs:{id:"_1-äº’æ–¥-é˜»å¡åŒæ­¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-äº’æ–¥-é˜»å¡åŒæ­¥"}},[s._v("#")]),s._v(" (1)äº’æ–¥/é˜»å¡åŒæ­¥")]),s._v(" "),t("p",[s._v("äº’æ–¥åŒæ­¥é¢ä¸´çš„ä¸»è¦é—®é¢˜æ˜¯è¿›è¡Œçº¿ç¨‹é˜»å¡å’Œå”¤é†’æ‰€å¸¦æ¥çš„æ€§èƒ½å¼€é”€, å› æ­¤è¿™ç§åŒæ­¥ä¹Ÿè¢«ç§°ä¸º"),t("mark",[t("strong",[s._v("é˜»å¡åŒæ­¥")])]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("äº’æ–¥åŒæ­¥")]),s._v("æ˜¯ä¸€ç§æœ€å¸¸è§ä¹Ÿæ˜¯æœ€ä¸»è¦çš„å¹¶å‘æ­£ç¡®æ€§ä¿éšœæ‰‹æ®µ. "),t("strong",[s._v("åŒæ­¥æ˜¯æŒ‡åœ¨å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«æ•°æ®æ—¶, ä¿è¯å…±äº«æ•°æ®åœ¨åŒä¸€ä¸ªæ—¶åˆ»åªè¢«ä¸€æ¡(æˆ–è€…æ˜¯ä¸€äº›, å½“ä½¿ç”¨ä¿¡å·é‡çš„æ—¶å€™)çº¿ç¨‹ä½¿ç”¨")]),s._v(". è€Œäº’æ–¥æ˜¯å®ç°åŒæ­¥çš„ä¸€ç§æ‰‹æ®µ, "),t("strong",[s._v("ä¸´ç•ŒåŒº(Critical Section), äº’æ–¥é‡(Mutex)å’Œä¿¡å·é‡(Semaphore)")]),s._v(' éƒ½æ˜¯å¸¸è§çš„äº’æ–¥å®ç°æ–¹å¼. å› æ­¤åœ¨ "äº’æ–¥åŒæ­¥" è¿™å››ä¸ªå­—é‡Œé¢, '),t("mark",[t("strong",[s._v("äº’æ–¥æ˜¯å› , åŒæ­¥æ˜¯æœ; äº’æ–¥æ˜¯æ–¹æ³•, åŒæ­¥æ˜¯ç›®çš„")])]),s._v(".")]),s._v(" "),t("p",[s._v("äº’æ–¥åŒæ­¥å¯ä»¥ä½¿ç”¨ "),t("strong",[s._v("synchronized")]),s._v(" å’Œ "),t("strong",[s._v("ReentrantLock")]),s._v(" å®ç°. å®ƒæ˜¯ä¸€ç§"),t("strong",[s._v("æ‚²è§‚")]),s._v("çš„å¹¶å‘ç­–ç•¥, ä¸»è¦çš„é—®é¢˜å°±æ˜¯çº¿ç¨‹"),t("strong",[s._v("é˜»å¡å’Œå”¤é†’")]),s._v("å¯èƒ½å¸¦æ¥æ€§èƒ½é—®é¢˜.")]),s._v(" "),t("blockquote",[t("p",[s._v("synchronized")])]),s._v(" "),t("p",[s._v("å‚è€ƒ: synchronizedåŸç†è§£æ")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("åœ¨ Java é‡Œé¢, æœ€åŸºæœ¬çš„äº’æ–¥åŒæ­¥æ‰‹æ®µå°±æ˜¯ synchronized å…³é”®å­—, è¿™æ˜¯ä¸€ç§å—ç»“æ„çš„åŒæ­¥è¯­æ³•. synchronized å…³é”®å­—ç»è¿‡ Javac ç¼–è¯‘ä¹‹å, ä¼šåœ¨åŒæ­¥å—çš„å‰ååˆ†åˆ«å½¢æˆ monitorenter å’Œ monitorexit è¿™ä¸¤ä¸ªå­—èŠ‚ç æŒ‡ä»¤. è¿™ä¸¤ä¸ªå­—èŠ‚ç æŒ‡ä»¤éƒ½éœ€è¦ä¸€ä¸ª reference ç±»å‹çš„å‚æ•°æ¥æŒ‡æ˜è¦é”å®šå’Œè§£é”çš„å¯¹è±¡. å¦‚æœ Java æºç ä¸­çš„ synchronized æ˜ç¡®æŒ‡å®šäº†å¯¹è±¡å‚æ•°, é‚£å°±ä»¥è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ä½œä¸º reference; å¦‚æœæ²¡æœ‰æ˜ç¡®æŒ‡å®š, é‚£å°†æ ¹æ® synchronized ä¿®é¥°çš„æ–¹æ³•ç±»å‹(å¦‚å®ä¾‹æ–¹æ³•æˆ–ç±»æ–¹æ³•), æ¥å†³å®šæ˜¯å–ä»£ç æ‰€åœ¨çš„å¯¹è±¡å®ä¾‹è¿˜æ˜¯å–ç±»å‹å¯¹åº”çš„ Class å¯¹è±¡æ¥ä½œä¸ºçº¿ç¨‹è¦æŒæœ‰çš„é”.")])])]),s._v(" "),t("p",[s._v("æ ¹æ®ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹çš„è¦æ±‚, åœ¨æ‰§è¡Œ monitorenter æŒ‡ä»¤æ—¶, é¦–å…ˆè¦å»å°è¯•è·å–å¯¹è±¡çš„é”. å¦‚æœè¿™ä¸ªå¯¹è±¡æ²¡è¢«é”å®š, æˆ–è€…å½“å‰çº¿ç¨‹å·²ç»æŒæœ‰äº†é‚£ä¸ªå¯¹è±¡çš„é”, å°±æŠŠ"),t("strong",[s._v("é”çš„è®¡æ•°å™¨çš„å€¼å¢åŠ ä¸€")]),s._v(", è€Œåœ¨æ‰§è¡Œ monitorexit æŒ‡ä»¤æ—¶ä¼šå°†"),t("strong",[s._v("é”è®¡æ•°å™¨çš„å€¼å‡ä¸€")]),s._v(". ä¸€æ—¦è®¡æ•°å™¨çš„å€¼ä¸ºé›¶, é”éšå³å°±è¢«é‡Šæ”¾äº†. å¦‚æœè·å–å¯¹è±¡é”å¤±è´¥, é‚£å½“å‰çº¿ç¨‹å°±åº”å½“è¢«é˜»å¡ç­‰å¾…, ç›´åˆ°è¯·æ±‚é”å®šçš„å¯¹è±¡è¢«æŒæœ‰å®ƒçš„çº¿ç¨‹é‡Šæ”¾ä¸ºæ­¢.")]),s._v(" "),t("p",[s._v("ä»åŠŸèƒ½ä¸Šçœ‹, æ ¹æ®ä»¥ä¸Šã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹å¯¹ monitorenter å’Œ monitorexit çš„è¡Œä¸ºæè¿°, å¯ä»¥å¾—å‡ºä¸¤ä¸ªå…³äº synchronized çš„ç›´æ¥æ¨è®º, è¿™æ˜¯ä½¿ç”¨å®ƒæ—¶éœ€ç‰¹åˆ«æ³¨æ„çš„:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("è¢« synchronized ä¿®é¥°çš„åŒæ­¥å—å¯¹åŒä¸€æ¡çº¿ç¨‹æ¥è¯´æ˜¯å¯é‡å…¥çš„. è¿™æ„å‘³ç€åŒä¸€çº¿ç¨‹åå¤è¿›å…¥åŒæ­¥å—ä¹Ÿä¸ä¼šå‡ºç°è‡ªå·±æŠŠè‡ªå·±é”æ­»çš„æƒ…å†µ")]),s._v(".")]),s._v(" "),t("li",[t("strong",[s._v("è¢« synchronized ä¿®é¥°çš„åŒæ­¥å—åœ¨æŒæœ‰é”çš„çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å¹¶é‡Šæ”¾é”ä¹‹å‰, ä¼šæ— æ¡ä»¶åœ°é˜»å¡åé¢å…¶ä»–çº¿ç¨‹çš„è¿›å…¥")]),s._v(". è¿™æ„å‘³ç€æ— æ³•åƒå¤„ç†æŸäº›æ•°æ®åº“ä¸­çš„é”é‚£æ ·, å¼ºåˆ¶å·²è·å–é”çš„çº¿ç¨‹é‡Šæ”¾é”; ä¹Ÿæ— æ³•å¼ºåˆ¶æ­£åœ¨ç­‰å¾…é”çš„çº¿ç¨‹ä¸­æ–­ç­‰å¾…æˆ–è¶…æ—¶é€€å‡º.")])]),s._v(" "),t("p",[s._v("ä»æ‰§è¡Œæˆæœ¬çš„è§’åº¦çœ‹, æŒæœ‰é”æ˜¯ä¸€ä¸ª"),t("strong",[s._v("é‡é‡çº§")]),s._v("(Heavy-Weight)çš„æ“ä½œ. åœ¨ä¸»æµ Java è™šæ‹Ÿæœºå®ç°ä¸­, Java çš„çº¿ç¨‹æ˜¯æ˜ å°„åˆ°æ“ä½œç³»ç»Ÿçš„åŸç”Ÿå†…æ ¸çº¿ç¨‹ä¹‹ä¸Šçš„, "),t("mark",[t("strong",[s._v("å¦‚æœè¦é˜»å¡æˆ–å”¤é†’ä¸€æ¡çº¿ç¨‹, åˆ™éœ€è¦æ“ä½œç³»ç»Ÿæ¥å¸®å¿™å®Œæˆ, è¿™å°±ä¸å¯é¿å…åœ°é™·å…¥ç”¨æˆ·æ€åˆ°æ ¸å¿ƒæ€çš„è½¬æ¢ä¸­, è¿›è¡Œè¿™ç§çŠ¶æ€è½¬æ¢éœ€è¦è€—è´¹å¾ˆå¤šçš„å¤„ç†å™¨æ—¶é—´")])]),s._v(". å°¤å…¶æ˜¯å¯¹äºä»£ç ç‰¹åˆ«ç®€å•çš„åŒæ­¥å—(è­¬å¦‚è¢« synchronized ä¿®é¥°çš„ getter() æˆ– setter() æ–¹æ³•), çŠ¶æ€è½¬æ¢æ¶ˆè€—çš„æ—¶é—´ç”šè‡³ä¼šæ¯”ç”¨æˆ·ä»£ç æœ¬èº«æ‰§è¡Œçš„æ—¶é—´è¿˜è¦é•¿. å› æ­¤æ‰è¯´, synchronized æ˜¯ Java è¯­è¨€ä¸­ä¸€ä¸ªé‡é‡çº§çš„æ“ä½œ, æœ‰ç»éªŒçš„ç¨‹åºå‘˜éƒ½åªä¼šåœ¨ç¡®å®å¿…è¦çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨è¿™ç§æ“ä½œ. è€Œè™šæ‹Ÿæœºæœ¬èº«ä¹Ÿä¼šè¿›è¡Œä¸€äº›ä¼˜åŒ–, è­¬å¦‚åœ¨é€šçŸ¥æ“ä½œç³»ç»Ÿé˜»å¡çº¿ç¨‹ä¹‹å‰åŠ å…¥ä¸€æ®µè‡ªæ—‹ç­‰å¾…è¿‡ç¨‹, ä»¥é¿å…é¢‘ç¹åœ°åˆ‡å…¥æ ¸å¿ƒæ€ä¹‹ä¸­. ç¨åä¼šä¸“é—¨ä»‹ç» Java è™šæ‹Ÿæœºé”ä¼˜åŒ–çš„æªæ–½.")]),s._v(" "),t("blockquote",[t("p",[s._v("ReentrantLock")])]),s._v(" "),t("p",[s._v("è¿˜å¯ä»¥ä½¿ç”¨ JUC åŒ…ä¸­çš„ "),t("strong",[s._v("ReentrantLock")]),s._v(" å®ç°äº’æ–¥åŒæ­¥. ç›¸æ¯” synchronized, ReentrantLock å¢åŠ äº†ä¸€äº›é«˜çº§åŠŸèƒ½, ä¸»è¦ä»¥ä¸‹ 3 é¡¹: ç­‰å¾…å¯ä¸­æ–­, å¯å®ç°å…¬å¹³é”, ä»¥åŠé”å¯ä»¥ç»‘å®šå¤šä¸ªæ¡ä»¶(å‚è€ƒ: ç›¸æ¯”synchronizedçš„æ‹“å±•åŠŸèƒ½).")]),s._v(" "),t("h6",{attrs:{id:"_2-éé˜»å¡åŒæ­¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-éé˜»å¡åŒæ­¥"}},[s._v("#")]),s._v(" (2)éé˜»å¡åŒæ­¥")]),s._v(" "),t("p",[s._v("ä»è§£å†³é—®é¢˜çš„æ–¹å¼ä¸Šçœ‹, äº’æ–¥åŒæ­¥å±äºä¸€ç§"),t("strong",[s._v("æ‚²è§‚çš„å¹¶å‘ç­–ç•¥")]),s._v(", å…¶æ€»æ˜¯è®¤ä¸º"),t("strong",[s._v("åªè¦ä¸å»åšæ­£ç¡®çš„åŒæ­¥æªæ–½(ä¾‹å¦‚åŠ é”), é‚£å°±è‚¯å®šä¼šå‡ºç°é—®é¢˜, æ— è®ºå…±äº«çš„æ•°æ®æ˜¯å¦çœŸçš„ä¼šå‡ºç°ç«äº‰, å®ƒéƒ½ä¼šè¿›è¡ŒåŠ é”")]),s._v("(è¿™é‡Œè®¨è®ºçš„æ˜¯æ¦‚å¿µæ¨¡å‹, å®é™…ä¸Šè™šæ‹Ÿæœºä¼šä¼˜åŒ–æ‰å¾ˆå¤§ä¸€éƒ¨åˆ†ä¸å¿…è¦çš„åŠ é”), è¿™å°†ä¼šå¯¼è‡´ç”¨æˆ·æ€åˆ°æ ¸å¿ƒæ€è½¬æ¢, ç»´æŠ¤é”è®¡æ•°å™¨å’Œæ£€æŸ¥æ˜¯å¦æœ‰è¢«é˜»å¡çš„çº¿ç¨‹éœ€è¦è¢«å”¤é†’ç­‰å¼€é”€.")]),s._v(" "),t("p",[s._v("éšç€ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•, å·²ç»æœ‰äº†å¦å¤–ä¸€ä¸ªé€‰æ‹©: "),t("mark",[t("strong",[s._v("åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚å¹¶å‘ç­–ç•¥")])]),s._v(", é€šä¿—åœ°è¯´å°±æ˜¯"),t("strong",[s._v("ä¸ç®¡é£é™©, å…ˆè¿›è¡Œæ“ä½œ, å¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®, é‚£æ“ä½œå°±ç›´æ¥æˆåŠŸäº†; å¦‚æœå…±äº«çš„æ•°æ®çš„ç¡®è¢«äº‰ç”¨, äº§ç”Ÿäº†å†²çª, é‚£å†è¿›è¡Œå…¶ä»–çš„è¡¥å¿æªæ–½, æœ€å¸¸ç”¨çš„è¡¥å¿æªæ–½æ˜¯ä¸æ–­åœ°é‡è¯•, ç›´åˆ°å‡ºç°æ²¡æœ‰ç«äº‰çš„å…±äº«æ•°æ®ä¸ºæ­¢")]),s._v(". è¿™ç§ä¹è§‚å¹¶å‘ç­–ç•¥çš„å®ç°ä¸å†éœ€è¦æŠŠçº¿ç¨‹é˜»å¡æŒ‚èµ·, å› æ­¤è¿™ç§åŒæ­¥æ“ä½œè¢«ç§°ä¸º"),t("mark",[t("strong",[s._v("éé˜»å¡åŒæ­¥")])]),s._v(", ä½¿ç”¨è¿™ç§æªæ–½çš„ä»£ç ä¹Ÿå¸¸è¢«ç§°ä¸º"),t("strong",[s._v("æ— é”(Lock-Free)ç¼–ç¨‹")]),s._v(".")]),s._v(" "),t("p",[s._v('ä¸ºä»€ä¹ˆç¬”è€…è¯´ä½¿ç”¨ä¹è§‚å¹¶å‘ç­–ç•¥éœ€è¦ "ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•"? å› ä¸ºå¿…é¡»'),t("mark",[t("strong",[s._v("è¦æ±‚æ“ä½œå’Œå†²çªæ£€æµ‹è¿™ä¸¤ä¸ªæ­¥éª¤å…·å¤‡åŸå­æ€§")])]),s._v(". é ä»€ä¹ˆæ¥ä¿è¯åŸå­æ€§? å¦‚æœè¿™é‡Œå†ä½¿ç”¨äº’æ–¥åŒæ­¥æ¥ä¿è¯å°±å®Œå…¨å¤±å»æ„ä¹‰äº†, "),t("strong",[s._v("æ‰€ä»¥åªèƒ½é ç¡¬ä»¶æ¥å®ç°è¿™ä»¶äº‹æƒ…, ç¡¬ä»¶ä¿è¯æŸäº›ä»è¯­ä¹‰ä¸Šçœ‹èµ·æ¥éœ€è¦å¤šæ¬¡æ“ä½œçš„è¡Œä¸ºå¯ä»¥åªé€šè¿‡ä¸€æ¡å¤„ç†å™¨æŒ‡ä»¤å°±èƒ½å®Œæˆ")]),s._v(", è¿™ç±»æŒ‡ä»¤å¸¸ç”¨çš„æœ‰:")]),s._v(" "),t("ul",[t("li",[s._v("æµ‹è¯•å¹¶è®¾ç½®(Test-and-Set);")]),s._v(" "),t("li",[s._v("è·å–å¹¶å¢åŠ (Fetch-and-Increment);")]),s._v(" "),t("li",[s._v("äº¤æ¢(Swap);")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("æ¯”è¾ƒå¹¶äº¤æ¢")])]),s._v("(Compare-and-Swap, ä¸‹æ–‡ç§° "),t("strong",[s._v("CAS")]),s._v(");")]),s._v(" "),t("li",[s._v("åŠ è½½é“¾æ¥/æ¡ä»¶å‚¨å­˜(Load-Linked/Store-Conditional, ä¸‹æ–‡ç§° LL/SC).")])]),s._v(" "),t("p",[s._v("å…¶ä¸­, å‰é¢çš„ä¸‰æ¡æ˜¯ 20 ä¸–çºªå°±å·²ç»å­˜åœ¨äºå¤§å¤šæ•°æŒ‡ä»¤é›†ä¹‹ä¸­çš„å¤„ç†å™¨æŒ‡ä»¤, åé¢çš„ä¸¤æ¡æ˜¯ç°ä»£å¤„ç†å™¨æ–°å¢çš„, è€Œä¸”è¿™ä¸¤æ¡æŒ‡ä»¤çš„ç›®çš„å’ŒåŠŸèƒ½ä¹Ÿæ˜¯ç±»ä¼¼çš„. åœ¨ IA64, x86 æŒ‡ä»¤é›†ä¸­æœ‰ç”¨ cmpxchg æŒ‡ä»¤å®Œæˆçš„ CAS åŠŸèƒ½, åœ¨ SPARC-TSO ä¸­ä¹Ÿæœ‰ç”¨ casa æŒ‡ä»¤å®ç°çš„, è€Œåœ¨ ARM å’Œ PowerPC æ¶æ„ä¸‹, åˆ™éœ€è¦ä½¿ç”¨ä¸€å¯¹ ldrex/strex æŒ‡ä»¤æ¥å®Œæˆ LL/SC çš„åŠŸèƒ½. å› ä¸º "),t("strong",[s._v("Java é‡Œæœ€ç»ˆæš´éœ²å‡ºæ¥çš„æ˜¯ CAS æ“ä½œ")]),s._v(", æ‰€ä»¥ä»¥ CAS æŒ‡ä»¤ä¸ºä¾‹è¿›è¡Œè®²è§£.")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("CAS æŒ‡ä»¤éœ€è¦æœ‰ä¸‰ä¸ªæ“ä½œæ•°, åˆ†åˆ«æ˜¯å†…å­˜ä½ç½®(åœ¨ Java ä¸­å¯ä»¥ç®€å•åœ°ç†è§£ä¸ºå˜é‡çš„å†…å­˜åœ°å€, ç”¨ V è¡¨ç¤º), æ—§çš„é¢„æœŸå€¼(ç”¨ A è¡¨ç¤º)å’Œå‡†å¤‡è®¾ç½®çš„æ–°å€¼(ç”¨ B è¡¨ç¤º). CAS æŒ‡ä»¤æ‰§è¡Œæ—¶, å½“ä¸”ä»…å½“ V ç¬¦åˆ A æ—¶, å¤„ç†å™¨æ‰ä¼šç”¨ B æ›´æ–° V çš„å€¼, å¦åˆ™å®ƒå°±ä¸æ‰§è¡Œæ›´æ–°. ä½†æ˜¯, ä¸ç®¡æ˜¯å¦æ›´æ–°äº† V çš„å€¼, éƒ½ä¼šè¿”å› V çš„æ—§å€¼, ä¸Šè¿°çš„å¤„ç†è¿‡ç¨‹æ˜¯ä¸€ä¸ªåŸå­æ“ä½œ, æ‰§è¡ŒæœŸé—´ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹ä¸­æ–­")])]),s._v(".")]),s._v(" "),t("p",[s._v("åœ¨ JDK 5 ä¹‹å, Java ç±»åº“ä¸­æ‰å¼€å§‹ä½¿ç”¨ CAS æ“ä½œ, è¯¥æ“ä½œç”± sun.misc.Unsafe ç±»é‡Œé¢çš„ "),t("strong",[s._v("compareAndSwapInt()")]),s._v("  å’Œ "),t("strong",[s._v("compareAndSwapLong()")]),s._v("  ç­‰å‡ ä¸ªæ–¹æ³•åŒ…è£…æä¾›. HotSpot è™šæ‹Ÿæœºåœ¨å†…éƒ¨å¯¹è¿™äº›æ–¹æ³•åšäº†ç‰¹æ®Šå¤„ç†, "),t("strong",[s._v("å³æ—¶ç¼–è¯‘å‡ºæ¥çš„ç»“æœå°±æ˜¯ä¸€æ¡å¹³å°ç›¸å…³çš„å¤„ç†å™¨ CAS æŒ‡ä»¤")]),s._v(", æ²¡æœ‰æ–¹æ³•è°ƒç”¨çš„è¿‡ç¨‹, æˆ–è€…å¯ä»¥è®¤ä¸ºæ˜¯æ— æ¡ä»¶å†…è”è¿›å»äº†. ä¸è¿‡ç”±äº Unsafe ç±»åœ¨è®¾è®¡ä¸Šå°±ä¸æ˜¯æä¾›ç»™ç”¨æˆ·ç¨‹åºè°ƒç”¨çš„ç±»("),t("code",[s._v("Unsafe::getUnsafe()")]),s._v("â€‹ çš„ä»£ç ä¸­é™åˆ¶äº†åªæœ‰å¯åŠ¨ç±»åŠ è½½å™¨(Bootstrap ClassLoader)åŠ è½½çš„ Class æ‰èƒ½è®¿é—®å®ƒ), å› æ­¤åœ¨ JDK 9 ä¹‹å‰åªæœ‰ Java ç±»åº“å¯ä»¥ä½¿ç”¨ CAS, è­¬å¦‚ J.U.C åŒ…é‡Œé¢çš„æ•´æ•°åŸå­ç±», å…¶ä¸­çš„ compareAndSet() å’Œ getAndIncrement() ç­‰æ–¹æ³•éƒ½ä½¿ç”¨äº† Unsafe ç±»çš„ CAS æ“ä½œæ¥å®ç°. è€Œå¦‚æœç”¨æˆ·ç¨‹åºä¹Ÿæœ‰ä½¿ç”¨ CAS æ“ä½œçš„éœ€æ±‚, é‚£è¦ä¹ˆå°±"),t("strong",[s._v("é‡‡ç”¨åå°„æ‰‹æ®µçªç ´ Unsafe çš„è®¿é—®é™åˆ¶")]),s._v(", è¦ä¹ˆå°±åªèƒ½é€šè¿‡ Java ç±»åº“ API æ¥é—´æ¥ä½¿ç”¨å®ƒ. ç›´åˆ° JDK 9 ä¹‹å, Java ç±»åº“æ‰åœ¨ "),t("strong",[s._v("VarHandle ç±»é‡Œå¼€æ”¾äº†é¢å‘ç”¨æˆ·ç¨‹åºä½¿ç”¨çš„ CAS æ“ä½œ")]),s._v(".")]),s._v(" "),t("p",[s._v("ä¸‹é¢å°†ç”¨ä¸€æ®µåœ¨å‰é¢ç« èŠ‚ä¸­æ²¡æœ‰è§£å†³çš„é—®é¢˜ä»£ç æ¥ä»‹ç»å¦‚ä½•é€šè¿‡ CAS æ“ä½œé¿å…é˜»å¡åŒæ­¥. æµ‹è¯•çš„ä»£ç å¦‚ä»£ç æ¸…å• 12-1 æ‰€ç¤º, ä¸ºäº†èŠ‚çœç‰ˆé¢å°±ä¸é‡å¤è´´åˆ°è¿™é‡Œäº†. è¿™æ®µä»£ç é‡Œæ›¾ç»é€šè¿‡ 20 ä¸ªçº¿ç¨‹è‡ªå¢ 10000 æ¬¡çš„æ“ä½œæ¥è¯æ˜ volatile å˜é‡ä¸å…·å¤‡åŸå­æ€§, é‚£ä¹ˆå¦‚ä½•æ‰èƒ½è®©å®ƒ"),t("strong",[s._v("å…·å¤‡åŸå­æ€§")]),s._v("å‘¢? ä¹‹å‰çš„è§£å†³æ–¹æ¡ˆæ˜¯æŠŠ race++ æ“ä½œæˆ– increase() æ–¹æ³•ç”¨åŒæ­¥å—åŒ…è£¹èµ·æ¥, è¿™æ¯«æ— ç–‘é—®æ˜¯ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ, ä½†æ˜¯å¦‚æœæ”¹æˆä»£ç æ¸…å• 13-4 æ‰€ç¤ºçš„å†™æ³•, æ•ˆç‡å°†ä¼šæé«˜è®¸å¤š.")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»£ç æ¸…å•13-4 Atomic çš„åŸå­è‡ªå¢è¿ç®—")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Atomic å˜é‡è‡ªå¢è¿ç®—æµ‹è¯•\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AtomicTest")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AtomicInteger")]),s._v(" race "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AtomicInteger")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("increase")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        race"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("incrementAndGet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THREADS_COUNT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" threads "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THREADS_COUNT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("THREADS_COUNT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            threads"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Runnable")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("run")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("increase")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n                    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            threads"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("activeCount")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("yield")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("race"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br")])]),t("p",[s._v("è¿è¡Œç»“æœå¦‚ä¸‹:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("200000\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("ä½¿ç”¨ AtomicInteger ä»£æ›¿ int å")]),s._v(", ç¨‹åºè¾“å‡ºäº†æ­£ç¡®çš„ç»“æœ, è¿™ä¸€åˆ‡éƒ½è¦"),t("strong",[s._v("å½’åŠŸäº incrementAndGet() æ–¹æ³•çš„åŸå­æ€§")]),s._v(". å®ƒçš„å®ç°å…¶å®éå¸¸ç®€å•, å¦‚ä»£ç æ¸…å• 13-5 æ‰€ç¤º.")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»£ç æ¸…å•13-5 incrementAndGet()æ–¹æ³•çš„ JDK æºç ")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Atomically increment by one the current value.\n * @return the updated value\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("incrementAndGet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" current "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" next "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" current "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CAS")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("compareAndSet")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("current"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" next"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" next"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[t("strong",[s._v("incrementAndGet() æ–¹æ³•åœ¨ä¸€ä¸ªæ— é™å¾ªç¯ä¸­, ä¸æ–­å°è¯•å°†ä¸€ä¸ªæ¯”å½“å‰å€¼å¤§ä¸€çš„æ–°å€¼èµ‹å€¼ç»™è‡ªå·±. å¦‚æœå¤±è´¥äº†, é‚£è¯´æ˜åœ¨æ‰§è¡Œ CAS æ“ä½œçš„æ—¶å€™, æ—§å€¼å·²ç»å‘ç”Ÿæ”¹å˜, äºæ˜¯å†æ¬¡å¾ªç¯è¿›è¡Œä¸‹ä¸€æ¬¡æ“ä½œ, ç›´åˆ°è®¾ç½®æˆåŠŸä¸ºæ­¢")]),s._v(".")]),s._v(" "),t("p",[s._v('å°½ç®¡ CAS çœ‹èµ·æ¥å¾ˆç¾å¥½, æ—¢ç®€å•åˆé«˜æ•ˆ, ä½†æ˜¾ç„¶è¿™ç§æ“ä½œæ— æ³•æ¶µç›–äº’æ–¥åŒæ­¥çš„æ‰€æœ‰ä½¿ç”¨åœºæ™¯, å¹¶ä¸” CAS ä»è¯­ä¹‰ä¸Šæ¥è¯´å¹¶ä¸æ˜¯çœŸæ­£å®Œç¾çš„, å®ƒå­˜åœ¨ä¸€ä¸ªé€»è¾‘æ¼æ´: å¦‚æœä¸€ä¸ªå˜é‡ V åˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯ A å€¼, å¹¶ä¸”åœ¨å‡†å¤‡èµ‹å€¼çš„æ—¶å€™æ£€æŸ¥åˆ°å®ƒä»ç„¶ä¸º A å€¼, é‚£å°±èƒ½è¯´æ˜å®ƒçš„å€¼æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹æ”¹å˜è¿‡äº†å—? è¿™æ˜¯ä¸èƒ½çš„, å› ä¸ºå¦‚æœåœ¨è¿™æ®µæœŸé—´å®ƒçš„å€¼æ›¾ç»è¢«æ”¹æˆ B, åæ¥åˆè¢«æ”¹å›ä¸º A, é‚£ CAS æ“ä½œå°±ä¼šè¯¯è®¤ä¸ºå®ƒä»æ¥æ²¡æœ‰è¢«æ”¹å˜è¿‡. è¿™ä¸ªæ¼æ´ç§°ä¸º CAS æ“ä½œçš„ "'),t("mark",[t("strong",[s._v("ABA é—®é¢˜")])]),s._v('". J.U.C åŒ…ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, æä¾›äº†ä¸€ä¸ª'),t("strong",[s._v("å¸¦æœ‰æ ‡è®°çš„åŸå­å¼•ç”¨ç±» AtomicStampedReference")]),s._v(", å®ƒå¯ä»¥é€šè¿‡æ§åˆ¶å˜é‡å€¼çš„ç‰ˆæœ¬æ¥ä¿è¯ CAS çš„æ­£ç¡®æ€§. ä¸è¿‡ç›®å‰æ¥è¯´è¿™ä¸ªç±»å¤„äºç›¸å½“é¸¡è‚‹çš„ä½ç½®, å¤§éƒ¨åˆ†æƒ…å†µä¸‹ ABA é—®é¢˜ä¸ä¼šå½±å“ç¨‹åºå¹¶å‘çš„æ­£ç¡®æ€§, å¦‚æœéœ€è¦è§£å†³ ABA é—®é¢˜, æ”¹ç”¨ä¼ ç»Ÿçš„äº’æ–¥åŒæ­¥å¯èƒ½ä¼šæ¯”åŸå­ç±»æ›´ä¸ºé«˜æ•ˆ.")]),s._v(" "),t("h6",{attrs:{id:"_3-æ— åŒæ­¥æ–¹æ¡ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-æ— åŒæ­¥æ–¹æ¡ˆ"}},[s._v("#")]),s._v(" (3)æ— åŒæ­¥æ–¹æ¡ˆ")]),s._v(" "),t("p",[t("strong",[s._v("è¦ä¿è¯çº¿ç¨‹å®‰å…¨, ä¹Ÿå¹¶éä¸€å®šè¦è¿›è¡Œé˜»å¡æˆ–éé˜»å¡åŒæ­¥")]),s._v(", åŒæ­¥ä¸çº¿ç¨‹å®‰å…¨ä¸¤è€…æ²¡æœ‰å¿…ç„¶çš„è”ç³». "),t("strong",[s._v("åŒæ­¥åªæ˜¯ä¿éšœå­˜åœ¨å…±äº«æ•°æ®äº‰ç”¨æ—¶æ­£ç¡®æ€§çš„æ‰‹æ®µ, å¦‚æœèƒ½è®©ä¸€ä¸ªæ–¹æ³•æœ¬æ¥å°±ä¸æ¶‰åŠå…±äº«æ•°æ®, é‚£å®ƒè‡ªç„¶å°±ä¸éœ€è¦ä»»ä½•åŒæ­¥æªæ–½å»ä¿è¯å…¶æ­£ç¡®æ€§, å› æ­¤ä¼šæœ‰ä¸€äº›ä»£ç å¤©ç”Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„")]),s._v(".")]),s._v(" "),t("blockquote",[t("p",[s._v("å¯é‡å…¥ä»£ç (Reentrant Code)")])]),s._v(" "),t("p",[s._v("å¯é‡å…¥ä»£ç ä»£ç åˆç§°çº¯ä»£ç (Pure Code), æ˜¯æŒ‡å¯ä»¥åœ¨ä»£ç æ‰§è¡Œçš„"),t("strong",[s._v("ä»»ä½•æ—¶åˆ»ä¸­æ–­å®ƒ")]),s._v(", è½¬è€Œå»æ‰§è¡Œå¦å¤–ä¸€æ®µä»£ç (åŒ…æ‹¬é€’å½’è°ƒç”¨å®ƒæœ¬èº«), è€Œåœ¨æ§åˆ¶æƒè¿”å›å, åŸæ¥çš„ç¨‹åºä¸ä¼šå‡ºç°ä»»ä½•é”™è¯¯, ä¹Ÿä¸ä¼šå¯¹ç»“æœæœ‰æ‰€å½±å“.")]),s._v(" "),t("p",[s._v("åœ¨ç‰¹æŒ‡å¤šçº¿ç¨‹çš„ä¸Šä¸‹æ–‡è¯­å¢ƒé‡Œ(ä¸æ¶‰åŠä¿¡å·é‡ç­‰å› ç´ ), å¯ä»¥è®¤ä¸ºå¯é‡å…¥ä»£ç æ˜¯çº¿ç¨‹å®‰å…¨ä»£ç çš„ä¸€ä¸ªçœŸå­é›†, è¿™æ„å‘³ç€ç›¸å¯¹çº¿ç¨‹å®‰å…¨æ¥è¯´, å¯é‡å…¥æ€§æ˜¯æ›´ä¸ºåŸºç¡€çš„ç‰¹æ€§, å®ƒå¯ä»¥ä¿è¯ä»£ç çº¿ç¨‹å®‰å…¨, å³"),t("strong",[s._v("æ‰€æœ‰å¯é‡å…¥çš„ä»£ç éƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„")]),s._v(", ä½†å¹¶éæ‰€æœ‰çš„çº¿ç¨‹å®‰å…¨çš„ä»£ç éƒ½æ˜¯å¯é‡å…¥çš„.")]),s._v(" "),t("p",[t("strong",[s._v("å¯é‡å…¥ä»£ç æœ‰ä¸€äº›å…±åŒçš„ç‰¹å¾, ä¾‹å¦‚, ä¸ä¾èµ–å…¨å±€å˜é‡, å­˜å‚¨åœ¨å †ä¸Šçš„æ•°æ®å’Œå…¬ç”¨çš„ç³»ç»Ÿèµ„æº, ç”¨åˆ°çš„çŠ¶æ€é‡éƒ½ç”±å‚æ•°ä¸­ä¼ å…¥, ä¸è°ƒç”¨éå¯é‡å…¥çš„æ–¹æ³•ç­‰")]),s._v(". å¯ä»¥é€šè¿‡ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„åŸåˆ™æ¥åˆ¤æ–­ä»£ç æ˜¯å¦å…·å¤‡å¯é‡å…¥æ€§: "),t("mark",[t("strong",[s._v("å¦‚æœä¸€ä¸ªæ–¹æ³•çš„è¿”å›ç»“æœæ˜¯å¯ä»¥é¢„æµ‹çš„, åªè¦è¾“å…¥äº†ç›¸åŒçš„æ•°æ®, å°±éƒ½èƒ½è¿”å›ç›¸åŒçš„ç»“æœ, é‚£å®ƒå°±æ»¡è¶³å¯é‡å…¥æ€§çš„è¦æ±‚, å½“ç„¶ä¹Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„")])]),s._v(".")]),s._v(" "),t("blockquote",[t("p",[s._v("çº¿ç¨‹æœ¬åœ°å­˜å‚¨(ThreadLocal)")])]),s._v(" "),t("p",[s._v("çº¿ç¨‹æœ¬åœ°å­˜å‚¨(Thread Local Storage): å¦‚æœä¸€æ®µä»£ç ä¸­æ‰€éœ€è¦çš„æ•°æ®å¿…é¡»ä¸å…¶ä»–ä»£ç å…±äº«, é‚£å°±çœ‹çœ‹è¿™äº›å…±äº«æ•°æ®çš„ä»£ç æ˜¯å¦èƒ½ä¿è¯åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œ. å¦‚æœèƒ½ä¿è¯, å°±å¯ä»¥"),t("strong",[s._v("æŠŠå…±äº«æ•°æ®çš„å¯è§èŒƒå›´é™åˆ¶åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¹‹å†…")]),s._v(", è¿™æ ·æ— é¡»åŒæ­¥ä¹Ÿèƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´ä¸å‡ºç°æ•°æ®äº‰ç”¨çš„é—®é¢˜.")]),s._v(" "),t("p",[s._v('ç¬¦åˆè¿™ç§ç‰¹ç‚¹çš„åº”ç”¨å¹¶ä¸å°‘è§, å¤§éƒ¨åˆ†ä½¿ç”¨æ¶ˆè´¹é˜Ÿåˆ—çš„æ¶æ„æ¨¡å¼(å¦‚ "ç”Ÿäº§è€…-æ¶ˆè´¹è€…" æ¨¡å¼)éƒ½ä¼šå°†äº§å“çš„æ¶ˆè´¹è¿‡ç¨‹é™åˆ¶åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ¶ˆè´¹å®Œ, å…¶ä¸­æœ€é‡è¦çš„ä¸€ç§åº”ç”¨å®ä¾‹å°±æ˜¯ç»å…¸ Web äº¤äº’æ¨¡å‹ä¸­çš„ "ä¸€ä¸ªè¯·æ±‚å¯¹åº”ä¸€ä¸ªæœåŠ¡å™¨çº¿ç¨‹"(Thread-per-Request)çš„å¤„ç†æ–¹å¼, è¿™ç§å¤„ç†æ–¹å¼çš„å¹¿æ³›åº”ç”¨ä½¿å¾—å¾ˆå¤š Web æœåŠ¡ç«¯åº”ç”¨éƒ½å¯ä»¥'),t("strong",[s._v("ä½¿ç”¨çº¿ç¨‹æœ¬åœ°å­˜å‚¨")]),s._v("æ¥è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜.")]),s._v(" "),t("p",[s._v('Java è¯­è¨€ä¸­, å¦‚æœä¸€ä¸ªå˜é‡è¦è¢«å¤šçº¿ç¨‹è®¿é—®, å¯ä»¥ä½¿ç”¨ volatile å…³é”®å­—å°†å®ƒå£°æ˜ä¸º "æ˜“å˜çš„"; å¦‚æœä¸€ä¸ªå˜é‡åªè¦è¢«æŸä¸ªçº¿ç¨‹ç‹¬äº«, Java ä¸­å°±æ²¡æœ‰ç±»ä¼¼ C++ ä¸­ __declspec(thread) è¿™æ ·çš„å…³é”®å­—å»ä¿®é¥°, ä¸è¿‡è¿˜æ˜¯å¯ä»¥é€šè¿‡ '),t("mark",[t("strong",[s._v("java.lang.ThreadLocal")])]),s._v(" ç±»æ¥å®ç°çº¿ç¨‹æœ¬åœ°å­˜å‚¨çš„åŠŸèƒ½. "),t("mark",[t("strong",[s._v("æ¯ä¸€ä¸ªçº¿ç¨‹çš„ Thread å¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ª ThreadLocalMap å¯¹è±¡, è¿™ä¸ªå¯¹è±¡å­˜å‚¨äº†ä¸€ç»„ä»¥ ThreadLocal.threadLocalHashCode ä¸ºé”®, ä»¥æœ¬åœ°çº¿ç¨‹å˜é‡ä¸ºå€¼çš„ K-V å€¼å¯¹, ThreadLocal å¯¹è±¡å°±æ˜¯å½“å‰çº¿ç¨‹çš„ ThreadLocalMap çš„è®¿é—®å…¥å£, æ¯ä¸€ä¸ª ThreadLocal å¯¹è±¡éƒ½åŒ…å«äº†ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ threadLocalHashCode å€¼, ä½¿ç”¨è¿™ä¸ªå€¼å°±å¯ä»¥åœ¨çº¿ç¨‹ K-V å€¼å¯¹ä¸­æ‰¾å›å¯¹åº”çš„æœ¬åœ°çº¿ç¨‹å˜é‡")])]),s._v(". (å‚è€ƒ: ThreadLocalåŸºç¡€)")]),s._v(" "),t("blockquote",[t("p",[s._v("æ ˆå°é—­")])]),s._v(" "),t("p",[s._v("å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ª"),t("strong",[s._v("æ–¹æ³•çš„å±€éƒ¨å˜é‡")]),s._v("æ—¶, ä¸ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜, å› ä¸ºå±€éƒ¨å˜é‡å­˜å‚¨åœ¨"),t("strong",[s._v("è™šæ‹Ÿæœºæ ˆ")]),s._v("ä¸­, å±äº"),t("strong",[s._v("çº¿ç¨‹ç§æœ‰å˜é‡")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StackClosedExample")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ–¹æ³•å†…éƒ¨å±€éƒ¨å˜é‡")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" cnt "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            cnt"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cnt"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StackClosedExample")]),s._v(" example "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StackClosedExample")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ExecutorService")]),s._v(" executorService "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Executors")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("newCachedThreadPool")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    executorService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("execute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" example"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    executorService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("execute")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" example"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    executorService"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"language-html line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-html"}},[t("code",[s._v("100\n100\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("blockquote",[t("p",[s._v("ä¸å¯å˜ç±»")])]),s._v(" "),t("p",[s._v("ä¸å¯å˜("),t("strong",[s._v("Immutable")]),s._v(")çš„å¯¹è±¡ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„, ä¸éœ€è¦é‡‡å–ä»»ä½•çš„çº¿ç¨‹å®‰å…¨ä¿éšœæªæ–½. å‚è€ƒ: ä¸å¯å˜ç±».")]),s._v(" "),t("h4",{attrs:{id:"å†…ç½®é”ä¼˜åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å†…ç½®é”ä¼˜åŒ–"}},[s._v("#")]),s._v(" å†…ç½®é”ä¼˜åŒ–")]),s._v(" "),t("p",[s._v("åœ¨æ—©æœŸ synchronized æ˜¯é‡é‡çº§çš„é”ä¸”æ•ˆç‡ä½, å› ä¸º monitor æ˜¯"),t("strong",[s._v("ä¾èµ–åº•å±‚æ“ä½œç³»ç»Ÿ")]),s._v("æ¥å®ç°çš„, è€Œæ“ä½œç³»ç»Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„è½¬æ¢éœ€è¦ä»ç”¨æˆ·æ€è½¬æ¢åˆ°å†…æ ¸æ€, è¿™ä¸ªè½¬æ¢è¦æµªè´¹å¾ˆå¤šæ—¶é—´.")]),s._v(" "),t("p",[s._v("å› æ­¤, HotSpot è™šæ‹Ÿæœºå¼€å‘å›¢é˜Ÿåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸ŠèŠ±è´¹äº†å¤§é‡çš„èµ„æºå»å®ç°å„ç§é”ä¼˜åŒ–æŠ€æœ¯, å¦‚"),t("mark",[t("strong",[s._v("é€‚åº”æ€§è‡ªæ—‹(Adaptive Spinning), é”æ¶ˆé™¤(Lock Elimination), é”è†¨èƒ€(Lock Coarsening), è½»é‡çº§é”(Lightweight Locking), åå‘é”(Biased Locking)")])]),s._v(" ç­‰, è¿™äº›æŠ€æœ¯éƒ½æ˜¯ä¸ºäº†åœ¨çº¿ç¨‹ä¹‹é—´æ›´é«˜æ•ˆåœ°å…±äº«æ•°æ®åŠè§£å†³ç«äº‰é—®é¢˜, ä»è€Œæé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡.")]),s._v(" "),t("h5",{attrs:{id:"_1-è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹"}},[s._v("#")]),s._v(" 1.è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹")]),s._v(" "),t("p",[s._v("å‰é¢è®¨è®ºäº’æ–¥åŒæ­¥çš„æ—¶å€™, æåˆ°äº†"),t("strong",[s._v("äº’æ–¥åŒæ­¥å¯¹æ€§èƒ½æœ€å¤§çš„å½±å“æ˜¯é˜»å¡çš„å®ç°")]),s._v(", æŒ‚èµ·çº¿ç¨‹å’Œæ¢å¤çº¿ç¨‹çš„æ“ä½œéƒ½éœ€è¦è½¬å…¥å†…æ ¸æ€ä¸­å®Œæˆ, è¿™äº›æ“ä½œç»™ Java è™šæ‹Ÿæœºçš„å¹¶å‘æ€§èƒ½å¸¦æ¥äº†å¾ˆå¤§çš„å‹åŠ›. åŒæ—¶, è™šæ‹Ÿæœºçš„å¼€å‘å›¢é˜Ÿä¹Ÿæ³¨æ„åˆ°åœ¨è®¸å¤šåº”ç”¨ä¸Š, "),t("strong",[s._v("å…±äº«æ•°æ®çš„é”å®šçŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´, ä¸ºäº†è¿™æ®µæ—¶é—´å»æŒ‚èµ·å’Œæ¢å¤çº¿ç¨‹å¹¶ä¸å€¼å¾—")]),s._v('. ç°åœ¨ç»å¤§å¤šæ•°çš„ä¸ªäººç”µè„‘å’ŒæœåŠ¡å™¨éƒ½æ˜¯å¤šè·¯(æ ¸)å¤„ç†å™¨ç³»ç»Ÿ, å¦‚æœç‰©ç†æœºå™¨æœ‰ä¸€ä¸ªä»¥ä¸Šçš„å¤„ç†å™¨æˆ–è€…å¤„ç†å™¨æ ¸å¿ƒ, èƒ½è®©ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„çº¿ç¨‹åŒæ—¶å¹¶è¡Œæ‰§è¡Œ, å°±å¯ä»¥è®©åé¢è¯·æ±‚é”çš„é‚£ä¸ªçº¿ç¨‹ "ç¨ç­‰ä¸€ä¼š", ä½†ä¸æ”¾å¼ƒå¤„ç†å™¨çš„æ‰§è¡Œæ—¶é—´, çœ‹çœ‹æŒæœ‰é”çš„çº¿ç¨‹æ˜¯å¦å¾ˆå¿«å°±ä¼šé‡Šæ”¾é”. '),t("mark",[t("strong",[s._v("ä¸ºäº†è®©çº¿ç¨‹ç­‰å¾…, åªé¡»è®©çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªå¿™å¾ªç¯(è‡ªæ—‹), è¿™é¡¹æŠ€æœ¯å°±æ˜¯æ‰€è°“çš„è‡ªæ—‹é”")])]),s._v(".")]),s._v(" "),t("p",[s._v("è‡ªæ—‹é”åœ¨ JDK 1.4.2 ä¸­å°±å·²ç»å¼•å…¥, åªä¸è¿‡é»˜è®¤æ˜¯å…³é—­çš„, å¯ä»¥ä½¿ç”¨ "),t("code",[s._v("-XX: +UseSpinning")]),s._v("â€‹ å‚æ•°æ¥å¼€å¯, åœ¨ JDK 6 ä¸­å°±å·²ç»æ”¹ä¸ºé»˜è®¤å¼€å¯äº†. è‡ªæ—‹ç­‰å¾…ä¸èƒ½ä»£æ›¿é˜»å¡, ä¸”å…ˆä¸è¯´å¯¹å¤„ç†å™¨æ•°é‡çš„è¦æ±‚, è‡ªæ—‹ç­‰å¾…æœ¬èº«è™½ç„¶é¿å…äº†çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€, "),t("strong",[s._v("ä½†å®ƒæ˜¯è¦å ç”¨å¤„ç†å™¨æ—¶é—´çš„")]),s._v(", æ‰€ä»¥å¦‚æœé”è¢«å ç”¨çš„æ—¶é—´å¾ˆçŸ­, è‡ªæ—‹ç­‰å¾…çš„æ•ˆæœå°±ä¼šéå¸¸å¥½, åä¹‹å¦‚æœé”è¢«å ç”¨çš„æ—¶é—´å¾ˆé•¿, é‚£ä¹ˆè‡ªæ—‹çš„çº¿ç¨‹åªä¼šç™½ç™½æ¶ˆè€—å¤„ç†å™¨èµ„æº, è€Œä¸ä¼šåšä»»ä½•æœ‰ä»·å€¼çš„å·¥ä½œ, è¿™å°±ä¼šå¸¦æ¥æ€§èƒ½çš„æµªè´¹. å› æ­¤"),t("strong",[s._v("è‡ªæ—‹ç­‰å¾…çš„æ—¶é—´å¿…é¡»æœ‰ä¸€å®šçš„é™åº¦, å¦‚æœè‡ªæ—‹è¶…è¿‡äº†é™å®šçš„æ¬¡æ•°ä»ç„¶æ²¡æœ‰æˆåŠŸè·å¾—é”, å°±åº”å½“ä½¿ç”¨ä¼ ç»Ÿçš„æ–¹å¼å»æŒ‚èµ·çº¿ç¨‹")]),s._v(". è‡ªæ—‹æ¬¡æ•°çš„é»˜è®¤å€¼æ˜¯åæ¬¡, ç”¨æˆ·ä¹Ÿå¯ä»¥ä½¿ç”¨å‚æ•° "),t("code",[s._v("-XX: PreBlockSpin")]),s._v("â€‹ æ¥è‡ªè¡Œæ›´æ”¹.")]),s._v(" "),t("p",[s._v("ä¸è¿‡æ— è®ºæ˜¯é»˜è®¤å€¼è¿˜æ˜¯ç”¨æˆ·æŒ‡å®šçš„è‡ªæ—‹æ¬¡æ•°, å¯¹æ•´ä¸ª Java è™šæ‹Ÿæœºä¸­æ‰€æœ‰çš„é”æ¥è¯´éƒ½æ˜¯ç›¸åŒçš„. åœ¨ JDK 6 ä¸­å¯¹è‡ªæ—‹é”çš„ä¼˜åŒ–, å¼•å…¥äº†"),t("strong",[s._v("è‡ªé€‚åº”çš„è‡ªæ—‹")]),s._v('. è‡ªé€‚åº”æ„å‘³ç€è‡ªæ—‹çš„æ—¶é—´ä¸å†æ˜¯å›ºå®šçš„äº†, è€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šçš„. å¦‚æœåœ¨åŒä¸€ä¸ªé”å¯¹è±¡ä¸Š, è‡ªæ—‹ç­‰å¾…åˆšåˆšæˆåŠŸè·å¾—è¿‡é”, å¹¶ä¸”æŒæœ‰é”çš„çº¿ç¨‹æ­£åœ¨è¿è¡Œä¸­, é‚£ä¹ˆè™šæ‹Ÿæœºå°±ä¼šè®¤ä¸ºè¿™æ¬¡è‡ªæ—‹ä¹Ÿå¾ˆæœ‰å¯èƒ½å†æ¬¡æˆåŠŸ, è¿›è€Œå…è®¸è‡ªæ—‹ç­‰å¾…æŒç»­ç›¸å¯¹æ›´é•¿çš„æ—¶é—´, æ¯”å¦‚æŒç»­ 100 æ¬¡å¿™å¾ªç¯. å¦ä¸€æ–¹é¢, å¦‚æœå¯¹äºæŸä¸ªé”, è‡ªæ—‹å¾ˆå°‘æˆåŠŸè·å¾—è¿‡é”, é‚£åœ¨ä»¥åè¦è·å–è¿™ä¸ªé”æ—¶å°†æœ‰å¯èƒ½ç›´æ¥çœç•¥æ‰è‡ªæ—‹è¿‡ç¨‹, ä»¥é¿å…æµªè´¹å¤„ç†å™¨èµ„æº. æœ‰äº†è‡ªé€‚åº”è‡ªæ—‹, éšç€ç¨‹åºè¿è¡Œæ—¶é—´çš„å¢é•¿åŠæ€§èƒ½ç›‘æ§ä¿¡æ¯çš„ä¸æ–­å®Œå–„, è™šæ‹Ÿæœºå¯¹ç¨‹åºé”çš„çŠ¶å†µé¢„æµ‹å°±ä¼šè¶Šæ¥è¶Šç²¾å‡†, è™šæ‹Ÿæœºå°±ä¼šå˜å¾—è¶Šæ¥è¶Š "èªæ˜" äº†.')]),s._v(" "),t("p",[s._v("å…¸å‹åœºæ™¯å¦‚ä¸‹, T1 çº¿ç¨‹å…ˆè¿›å…¥åˆ°åŒæ­¥é€»è¾‘ä¸­, å½“ T2 éœ€è¦è¿›åˆ°åŒæ­¥å—é€»è¾‘æ—¶, åœ¨ç«äº‰ä¸æ¿€çƒˆçš„æƒ…å†µä¸‹, æ— éœ€è¿›è¡Œé˜»å¡("),t("strong",[s._v("æ”¾å¼ƒ CPU ä½¿ç”¨æƒ")]),s._v("), è€Œåªéœ€è¦è¿›è¡Œè‡ªæ—‹("),t("strong",[s._v("ä¸æ”¾å¼ƒ CPU ä½¿ç”¨æƒ")]),s._v("), ç­‰åˆ° T1 é€€å‡ºåŒæ­¥é€»è¾‘ä¹‹å, T2 å†ç›´æ¥è¿›å…¥åŒæ­¥é€»è¾‘, è€Œæ— éœ€å†æ¬¡ç«äº‰é”.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220601232020635.png",alt:"image-20220601232020635"}})]),s._v(" "),t("p",[s._v("è‡ªæ—‹é”è™½ç„¶èƒ½é¿å…è¿›å…¥é˜»å¡çŠ¶æ€ä»è€Œå‡å°‘å¼€é”€, ä½†æ˜¯å®ƒéœ€è¦è¿›è¡Œå¿™å¾ªç¯æ“ä½œ"),t("strong",[s._v("å ç”¨ CPU")]),s._v(" æ—¶é—´, å®ƒåªé€‚ç”¨äºå…±äº«æ•°æ®çš„"),t("strong",[s._v("é”å®šçŠ¶æ€å¾ˆçŸ­")]),s._v("çš„åœºæ™¯. å¦‚æœå¤ªé•¿å°±å¤ªå¤šçš„å¿™å¾ªç¯äº†.")]),s._v(" "),t("h5",{attrs:{id:"_2-é”æ¶ˆé™¤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-é”æ¶ˆé™¤"}},[s._v("#")]),s._v(" 2.é”æ¶ˆé™¤")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("é”æ¶ˆé™¤")])]),s._v("â€‹"),t("strong",[s._v("æ˜¯æŒ‡è™šæ‹Ÿæœºå³æ—¶ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶, å¯¹ä¸€äº›ä»£ç è¦æ±‚åŒæ­¥, ä½†æ˜¯å¯¹è¢«")]),s._v("â€‹"),t("mark",[t("strong",[s._v("æ£€æµ‹åˆ°ä¸å¯èƒ½å­˜åœ¨å…±äº«æ•°æ®ç«äº‰çš„é”è¿›è¡Œæ¶ˆé™¤")])]),s._v("â€‹ "),t("strong",[s._v(". é”æ¶ˆé™¤çš„ä¸»è¦åˆ¤å®šä¾æ®æ¥æºäº")]),s._v("â€‹"),t("mark",[t("strong",[s._v("é€ƒé€¸åˆ†æ")])]),s._v("â€‹"),t("strong",[s._v("çš„æ•°æ®æ”¯æŒ, å¦‚æœåˆ¤æ–­åˆ°ä¸€æ®µä»£ç ä¸­, åœ¨å †ä¸Šçš„æ‰€æœ‰æ•°æ®éƒ½ä¸ä¼šé€ƒé€¸å‡ºå»è¢«å…¶ä»–çº¿ç¨‹è®¿é—®åˆ°, é‚£å°±å¯ä»¥æŠŠå®ƒä»¬å½“ä½œæ ˆä¸Šæ•°æ®å¯¹å¾…, è®¤ä¸ºå®ƒä»¬æ˜¯çº¿ç¨‹ç§æœ‰çš„, åŒæ­¥åŠ é”è‡ªç„¶å°±æ— é¡»å†è¿›è¡Œ")]),s._v(".")]),s._v(" "),t("p",[s._v("ä¹Ÿè®¸è¯»è€…ä¼šæœ‰ç–‘é—®, å˜é‡æ˜¯å¦é€ƒé€¸, å¯¹äºè™šæ‹Ÿæœºæ¥è¯´æ˜¯éœ€è¦ä½¿ç”¨å¤æ‚çš„è¿‡ç¨‹é—´åˆ†ææ‰èƒ½ç¡®å®šçš„, ä½†æ˜¯ç¨‹åºå‘˜è‡ªå·±åº”è¯¥æ˜¯å¾ˆæ¸…æ¥šçš„, æ€ä¹ˆä¼šåœ¨æ˜çŸ¥é“ä¸å­˜åœ¨æ•°æ®äº‰ç”¨çš„æƒ…å†µä¸‹è¿˜è¦æ±‚åŒæ­¥å‘¢? è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ˜¯: "),t("strong",[s._v("æœ‰è®¸å¤šåŒæ­¥æªæ–½å¹¶ä¸æ˜¯ç¨‹åºå‘˜è‡ªå·±åŠ å…¥çš„")]),s._v(", åŒæ­¥çš„ä»£ç åœ¨ Java ç¨‹åºä¸­å‡ºç°çš„é¢‘ç¹ç¨‹åº¦ä¹Ÿè®¸è¶…è¿‡äº†å¤§å®¶çš„æƒ³è±¡.")]),s._v(" "),t("p",[s._v("çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­, è¿™æ®µéå¸¸ç®€å•çš„ä»£ç ä»…ä»…æ˜¯è¾“å‡ºä¸‰ä¸ªå­—ç¬¦ä¸²ç›¸åŠ çš„ç»“æœ, æ— è®ºæ˜¯æºä»£ç å­—é¢ä¸Š, è¿˜æ˜¯ç¨‹åºè¯­ä¹‰ä¸Šéƒ½æ²¡æœ‰è¿›è¡ŒåŒæ­¥.")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»£ç æ¸…å•13-6 ä¸€æ®µçœ‹èµ·æ¥æ²¡æœ‰åŒæ­¥çš„ä»£ç ")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("concatString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" s1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" s2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" s3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("ç”±äº String æ˜¯ä¸€ä¸ªä¸å¯å˜çš„ç±», å¯¹å­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œæ€»æ˜¯é€šè¿‡"),t("strong",[s._v("ç”Ÿæˆæ–°çš„ String å¯¹è±¡")]),s._v("æ¥è¿›è¡Œçš„, å› æ­¤ Javac ç¼–è¯‘å™¨ä¼šå¯¹ String è¿æ¥åšè‡ªåŠ¨ä¼˜åŒ–. åœ¨ JDK 5 ä¹‹å‰, å­—ç¬¦ä¸²åŠ æ³•ä¼šè½¬åŒ–ä¸º StringBuffer å¯¹è±¡çš„è¿ç»­ append() æ“ä½œ, åœ¨ JDK 5 åŠä»¥åçš„ç‰ˆæœ¬ä¸­, ä¼šè½¬åŒ–ä¸º StringBuilder å¯¹è±¡çš„è¿ç»­ append() æ“ä½œ. å› æ­¤ StringBuffer ç±»æ˜¯é€šè¿‡ç»™æ–¹æ³•åŠ  "),t("strong",[s._v("synchronized")]),s._v(" å…³é”®å­—ä¿è¯çš„çº¿ç¨‹å®‰å…¨, å‚è€ƒ: StringBufferç±» . å³ä»£ç æ¸…å• 13-6 æ‰€ç¤ºçš„ä»£ç å¯èƒ½ä¼šå˜æˆä»£ç æ¸…å• 13-7 æ‰€ç¤ºçš„æ ·å­.")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»£ç æ¸…å•13-7 Javacè½¬åŒ–åçš„å­—ç¬¦ä¸²è¿æ¥æ“ä½œ")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("concatString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" s3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringBuffer")]),s._v(" sb "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StringBuffer")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    sb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("append")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    sb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("append")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    sb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("append")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("s3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" sb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("toString")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("ç°åœ¨å¤§å®¶è¿˜è®¤ä¸ºè¿™æ®µä»£ç æ²¡æœ‰æ¶‰åŠåŒæ­¥å—? è¿™é‡Œæ¯ä¸ª StringBuffer.append() æ–¹æ³•ä¸­éƒ½æœ‰ä¸€ä¸ªåŒæ­¥å—, é”å°±æ˜¯ sb å¯¹è±¡. è™šæ‹Ÿæœºè§‚å¯Ÿå˜é‡ sb, ç»è¿‡é€ƒé€¸åˆ†æåä¼šå‘ç°å®ƒçš„åŠ¨æ€ä½œç”¨åŸŸè¢«é™åˆ¶åœ¨ concatString() æ–¹æ³•å†…éƒ¨. ä¹Ÿå°±æ˜¯ sb çš„æ‰€æœ‰å¼•ç”¨éƒ½æ°¸è¿œä¸ä¼šé€ƒé€¸åˆ° concatString() æ–¹æ³•ä¹‹å¤–, å…¶ä»–çº¿ç¨‹æ— æ³•è®¿é—®åˆ°å®ƒ, æ‰€ä»¥è¿™é‡Œè™½ç„¶æœ‰é”, ä½†æ˜¯å¯ä»¥è¢«å®‰å…¨åœ°æ¶ˆé™¤æ‰. "),t("strong",[s._v("åœ¨è§£é‡Šæ‰§è¡Œæ—¶è¿™é‡Œä»ç„¶ä¼šåŠ é”, ä½†åœ¨ç»è¿‡æœåŠ¡ç«¯ç¼–è¯‘å™¨çš„å³æ—¶ç¼–è¯‘ä¹‹å, è¿™æ®µä»£ç å°±ä¼šå¿½ç•¥æ‰€æœ‰çš„åŒæ­¥æªæ–½è€Œç›´æ¥æ‰§è¡Œ")]),s._v(".")]),s._v(" "),t("h5",{attrs:{id:"_3-é”ç²—åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-é”ç²—åŒ–"}},[s._v("#")]),s._v(" 3.é”ç²—åŒ–")]),s._v(" "),t("p",[s._v("åŸåˆ™ä¸Š, åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™, æ€»æ˜¯æ¨èå°†åŒæ­¥å—çš„ä½œç”¨èŒƒå›´é™åˆ¶å¾—å°½é‡å°, "),t("strong",[s._v("åªåœ¨å…±äº«æ•°æ®çš„å®é™…ä½œç”¨åŸŸä¸­æ‰è¿›è¡ŒåŒæ­¥, è¿™æ ·æ˜¯ä¸ºäº†ä½¿å¾—éœ€è¦åŒæ­¥çš„æ“ä½œæ•°é‡å°½å¯èƒ½å˜å°‘, å³ä½¿å­˜åœ¨é”ç«äº‰, ç­‰å¾…é”çš„çº¿ç¨‹ä¹Ÿèƒ½å°½å¯èƒ½å¿«åœ°æ‹¿åˆ°é”")]),s._v(".")]),s._v(" "),t("p",[s._v("å¤§å¤šæ•°æƒ…å†µä¸‹, ä¸Šé¢çš„åŸåˆ™éƒ½æ˜¯æ­£ç¡®çš„, ä½†æ˜¯å¦‚æœä¸€ç³»åˆ—çš„è¿ç»­æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”, ç”šè‡³åŠ é”æ“ä½œæ˜¯å‡ºç°åœ¨å¾ªç¯ä½“ä¹‹ä¸­çš„, é‚£å³ä½¿æ²¡æœ‰çº¿ç¨‹ç«äº‰, é¢‘ç¹åœ°è¿›è¡Œäº’æ–¥åŒæ­¥æ“ä½œä¹Ÿä¼šå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½æŸè€—.")]),s._v(" "),t("p",[s._v("ä»£ç æ¸…å• 13-7 æ‰€ç¤ºè¿ç»­çš„ append() æ–¹æ³•å°±å±äºè¿™ç±»æƒ…å†µ. "),t("strong",[s._v("å¦‚æœè™šæ‹Ÿæœºæ¢æµ‹åˆ°æœ‰è¿™æ ·ä¸€ä¸²é›¶ç¢çš„æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åŠ é”, å°†ä¼šæŠŠåŠ é”åŒæ­¥çš„èŒƒå›´æ‰©å±•(ç²—åŒ–)åˆ°æ•´ä¸ªæ“ä½œåºåˆ—çš„å¤–éƒ¨")]),s._v(", ä»¥ä»£ç æ¸…å• 13-7 ä¸ºä¾‹, å°±æ˜¯æ‰©å±•åˆ°ç¬¬ä¸€ä¸ª append() æ“ä½œä¹‹å‰ç›´è‡³æœ€åä¸€ä¸ª append() æ“ä½œä¹‹å, è¿™æ ·"),t("strong",[s._v("åªéœ€è¦åŠ é”ä¸€æ¬¡")]),s._v("å°±å¯ä»¥äº†.")]),s._v(" "),t("h5",{attrs:{id:"_4-è½»é‡çº§é”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-è½»é‡çº§é”"}},[s._v("#")]),s._v(" 4.è½»é‡çº§é”")]),s._v(" "),t("p",[s._v('è½»é‡çº§é”æ˜¯ JDK 6 æ—¶åŠ å…¥çš„æ–°å‹é”æœºåˆ¶, å®ƒåå­—ä¸­çš„ "è½»é‡çº§" æ˜¯ç›¸å¯¹äºä½¿ç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é‡æ¥å®ç°çš„ä¼ ç»Ÿé”è€Œè¨€çš„, å› æ­¤ä¼ ç»Ÿçš„é”æœºåˆ¶å°±è¢«ç§°ä¸º "é‡é‡çº§" é”. ä¸è¿‡, éœ€è¦å¼ºè°ƒä¸€ç‚¹, è½»é‡çº§é”å¹¶ä¸æ˜¯ç”¨æ¥ä»£æ›¿é‡é‡çº§é”çš„, å®ƒè®¾è®¡çš„'),t("strong",[s._v("åˆè¡·æ˜¯åœ¨æ²¡æœ‰å¤šçº¿ç¨‹ç«äº‰çš„å‰æä¸‹, å‡å°‘ä¼ ç»Ÿçš„é‡é‡çº§é”ä½¿ç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é‡äº§ç”Ÿçš„æ€§èƒ½æ¶ˆè€—")]),s._v(".")]),s._v(" "),t("p",[s._v("è¦ç†è§£è½»é‡çº§é”, ä»¥åŠåé¢ä¼šè®²åˆ°çš„åå‘é”çš„åŸç†å’Œè¿ä½œè¿‡ç¨‹, å¿…é¡»è¦å¯¹ HotSpot è™šæ‹Ÿæœºå¯¹è±¡çš„å†…å­˜å¸ƒå±€(å°¤å…¶æ˜¯å¯¹è±¡å¤´éƒ¨åˆ†)æœ‰æ‰€äº†è§£. HotSpot è™šæ‹Ÿæœºçš„"),t("strong",[s._v("å¯¹è±¡å¤´")]),s._v("(Object Header)åˆ†ä¸ºä¸¤éƒ¨åˆ†, "),t("strong",[s._v("ç¬¬ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®, å¦‚å“ˆå¸Œç (HashCode), GC åˆ†ä»£å¹´é¾„(Generational GC Age)ç­‰")]),s._v('. è¿™éƒ¨åˆ†æ•°æ®çš„é•¿åº¦åœ¨ 32 ä½å’Œ 64 ä½çš„ Java è™šæ‹Ÿæœºä¸­åˆ†åˆ«ä¼šå ç”¨ 32 ä¸ªæˆ– 64 ä¸ªæ¯”ç‰¹, å®˜æ–¹ç§°å®ƒä¸º "'),t("strong",[s._v("Mark Word")]),s._v('". è¿™éƒ¨åˆ†æ˜¯'),t("strong",[s._v("å®ç°è½»é‡çº§é”å’Œåå‘é”çš„å…³é”®")]),s._v(". å¦å¤–ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨æŒ‡å‘æ–¹æ³•åŒºå¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆ, å¦‚æœæ˜¯æ•°ç»„å¯¹è±¡, è¿˜ä¼šæœ‰ä¸€ä¸ªé¢å¤–çš„éƒ¨åˆ†ç”¨äºå­˜å‚¨æ•°ç»„é•¿åº¦. è¿™äº›å¯¹è±¡å†…å­˜å¸ƒå±€çš„è¯¦ç»†å†…å®¹å‚è€ƒ(å¯¹è±¡å¤´), åœ¨æ­¤ä¸å†èµ˜è¿°, åªé’ˆå¯¹é”çš„è§’åº¦åšè¿›ä¸€æ­¥ç»†åŒ–.")]),s._v(" "),t("p",[s._v("ç”±äºå¯¹è±¡å¤´ä¿¡æ¯æ˜¯ä¸å¯¹è±¡è‡ªèº«å®šä¹‰çš„æ•°æ®æ— å…³çš„é¢å¤–å­˜å‚¨æˆæœ¬, è€ƒè™‘åˆ° Java è™šæ‹Ÿæœºçš„ç©ºé—´ä½¿ç”¨æ•ˆç‡, Mark Word è¢«è®¾è®¡æˆ"),t("strong",[s._v("ä¸€ä¸ªéå›ºå®šçš„åŠ¨æ€æ•°æ®ç»“æ„")]),s._v(", ä»¥ä¾¿åœ¨æå°çš„ç©ºé—´å†…å­˜å‚¨å°½é‡å¤šçš„ä¿¡æ¯. å®ƒä¼šæ ¹æ®å¯¹è±¡çš„çŠ¶æ€å¤ç”¨è‡ªå·±çš„å­˜å‚¨ç©ºé—´. ä¾‹å¦‚åœ¨ 32 ä½çš„ HotSpot è™šæ‹Ÿæœºä¸­, å¯¹è±¡æœªè¢«é”å®šçš„çŠ¶æ€ä¸‹, Mark Word çš„ 32 ä¸ªæ¯”ç‰¹ç©ºé—´é‡Œçš„ 25 ä¸ªæ¯”ç‰¹å°†ç”¨äºå­˜å‚¨å¯¹è±¡å“ˆå¸Œç , "),t("strong",[s._v("4 ä¸ªæ¯”ç‰¹ç”¨äºå­˜å‚¨å¯¹è±¡åˆ†ä»£å¹´é¾„, 2 ä¸ªæ¯”ç‰¹ç”¨äºå­˜å‚¨é”æ ‡å¿—ä½, è¿˜æœ‰ 1 ä¸ªæ¯”ç‰¹å›ºå®šä¸º 0(è¿™è¡¨ç¤ºæœªè¿›å…¥åå‘æ¨¡å¼)")]),s._v(" . å¯¹è±¡é™¤äº†æœªè¢«é”å®šçš„æ­£å¸¸çŠ¶æ€å¤–, è¿˜æœ‰è½»é‡çº§é”å®š, é‡é‡çº§é”å®š, GC æ ‡è®°, å¯åå‘ç­‰å‡ ç§ä¸åŒçŠ¶æ€, è¿™äº›çŠ¶æ€ä¸‹å¯¹è±¡å¤´çš„å­˜å‚¨å†…å®¹å¦‚è¡¨ 13-1 æ‰€ç¤º.")]),s._v(" "),t("blockquote",[t("p",[s._v("è¡¨13-1 HotSpot è™šæ‹Ÿæœºå¯¹è±¡å¤´ Mark Word")])]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00231-20240302133505-lyzzin2.jpg",alt:""}})]),s._v(" "),t("p",[s._v("ç®€å•å›é¡¾äº†å¯¹è±¡çš„å†…å­˜å¸ƒå±€å, æ¥ä¸‹æ¥å°±å¯ä»¥ä»‹ç»è½»é‡çº§é”çš„å·¥ä½œè¿‡ç¨‹äº†: "),t("strong",[s._v('åœ¨ä»£ç å³å°†è¿›å…¥åŒæ­¥å—çš„æ—¶å€™, å¦‚æœæ­¤åŒæ­¥å¯¹è±¡æ²¡æœ‰è¢«é”å®š(é”æ ‡å¿—ä½ä¸º "01" çŠ¶æ€), è™šæ‹Ÿæœºé¦–å…ˆå°†åœ¨å½“å‰çº¿ç¨‹çš„æ ˆå¸§ä¸­å»ºç«‹ä¸€ä¸ªåä¸ºé”è®°å½•(Lock Record)çš„ç©ºé—´, ç”¨äºå­˜å‚¨é”å¯¹è±¡ç›®å‰çš„ Mark Word çš„æ‹·è´')]),s._v("(å®˜æ–¹ä¸ºè¿™ä»½æ‹·è´åŠ äº†ä¸€ä¸ª Displaced å‰ç¼€, å³ Displaced Mark Word), è¿™æ—¶å€™çº¿ç¨‹å †æ ˆä¸å¯¹è±¡å¤´çš„çŠ¶æ€å¦‚å›¾ 13-3 æ‰€ç¤º.")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00232-20240302133505-bgjkskz.jpg",alt:"",title:"å›¾13-3ã€€è½»é‡çº§é” CAS æ“ä½œä¹‹å‰å †æ ˆä¸å¯¹è±¡çš„çŠ¶æ€"}})]),s._v(" "),t("p",[s._v("ç„¶å, è™šæ‹Ÿæœºå°†ä½¿ç”¨ CAS æ“ä½œå°è¯•æŠŠå¯¹è±¡çš„ Mark Word æ›´æ–°ä¸ºæŒ‡å‘ Lock Record çš„æŒ‡é’ˆ. å¦‚æœè¿™ä¸ªæ›´æ–°åŠ¨ä½œæˆåŠŸäº†, å³ä»£è¡¨"),t("strong",[s._v("è¯¥çº¿ç¨‹æ‹¥æœ‰äº†è¿™ä¸ªå¯¹è±¡çš„é”")]),s._v(', å¹¶ä¸”å¯¹è±¡ Mark Word çš„é”æ ‡å¿—ä½(Mark Word çš„æœ€åä¸¤ä¸ªæ¯”ç‰¹)å°†è½¬å˜ä¸º "'),t("strong",[s._v("00")]),s._v('", è¡¨ç¤º'),t("strong",[s._v("æ­¤å¯¹è±¡å¤„äºè½»é‡çº§é”å®šçŠ¶æ€")]),s._v(". è¿™æ—¶å€™çº¿ç¨‹å †æ ˆä¸å¯¹è±¡å¤´çš„çŠ¶æ€å¦‚å›¾ 13-4 æ‰€ç¤º.")]),s._v(" "),t("p",[t("strong",[s._v("å¦‚æœè¿™ä¸ªæ›´æ–°æ“ä½œå¤±è´¥äº†, é‚£å°±æ„å‘³ç€è‡³å°‘å­˜åœ¨ä¸€æ¡çº¿ç¨‹ä¸å½“å‰çº¿ç¨‹ç«äº‰è·å–è¯¥å¯¹è±¡çš„é”")]),s._v(". è™šæ‹Ÿæœºé¦–å…ˆä¼šæ£€æŸ¥å¯¹è±¡çš„ Mark Word æ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„æ ˆå¸§, å¦‚æœæ˜¯, è¯´æ˜å½“å‰çº¿ç¨‹å·²ç»æ‹¥æœ‰äº†è¿™ä¸ªå¯¹è±¡çš„é”, é‚£ç›´æ¥è¿›å…¥åŒæ­¥å—ç»§ç»­æ‰§è¡Œå°±å¯ä»¥äº†, å¦åˆ™å°±è¯´æ˜è¿™ä¸ªé”å¯¹è±¡å·²ç»è¢«å…¶ä»–çº¿ç¨‹æŠ¢å äº†. "),t("strong",[s._v('å¦‚æœå‡ºç°ä¸¤æ¡ä»¥ä¸Šçš„çº¿ç¨‹äº‰ç”¨åŒä¸€ä¸ªé”çš„æƒ…å†µ, é‚£è½»é‡çº§é”å°±ä¸å†æœ‰æ•ˆ, å¿…é¡»è¦è†¨èƒ€ä¸ºé‡é‡çº§é”, é”æ ‡å¿—çš„çŠ¶æ€å€¼å˜ä¸º "10"')]),s._v(" , æ­¤æ—¶ Mark Word ä¸­å­˜å‚¨çš„å°±æ˜¯æŒ‡å‘é‡é‡çº§é”(äº’æ–¥é‡)çš„æŒ‡é’ˆ, åé¢"),t("strong",[s._v("ç­‰å¾…é”çš„çº¿ç¨‹ä¹Ÿå¿…é¡»è¿›å…¥é˜»å¡çŠ¶æ€")]),s._v(".")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00233-20240302133505-2btbeuh.jpg",alt:"",title:"å›¾13-4ã€€è½»é‡çº§é” CAS æ“ä½œä¹‹åå †æ ˆä¸å¯¹è±¡çš„çŠ¶æ€"}})]),s._v(" "),t("p",[s._v("ä¸Šé¢æè¿°çš„æ˜¯"),t("strong",[s._v("è½»é‡çº§é”çš„åŠ é”è¿‡ç¨‹")]),s._v(", å®ƒçš„è§£é”è¿‡ç¨‹ä¹ŸåŒæ ·æ˜¯é€šè¿‡ CAS æ“ä½œæ¥è¿›è¡Œçš„, å¦‚æœå¯¹è±¡çš„ Mark Word ä»ç„¶æŒ‡å‘çº¿ç¨‹çš„é”è®°å½•, é‚£å°±ç”¨ CAS æ“ä½œæŠŠå¯¹è±¡å½“å‰çš„ Mark Word å’Œçº¿ç¨‹ä¸­å¤åˆ¶çš„ Displaced Mark Word æ›¿æ¢å›æ¥. å‡å¦‚èƒ½å¤ŸæˆåŠŸæ›¿æ¢, é‚£æ•´ä¸ªåŒæ­¥è¿‡ç¨‹å°±é¡ºåˆ©å®Œæˆäº†; å¦‚æœæ›¿æ¢å¤±è´¥, åˆ™è¯´æ˜æœ‰å…¶ä»–çº¿ç¨‹å°è¯•è¿‡è·å–è¯¥é”, å°±è¦åœ¨é‡Šæ”¾é”çš„åŒæ—¶, å”¤é†’è¢«æŒ‚èµ·çš„çº¿ç¨‹.")]),s._v(" "),t("p",[s._v('è½»é‡çº§é”èƒ½æå‡ç¨‹åºåŒæ­¥æ€§èƒ½çš„ä¾æ®æ˜¯ "'),t("strong",[s._v("å¯¹äºç»å¤§éƒ¨åˆ†çš„é”, åœ¨æ•´ä¸ªåŒæ­¥å‘¨æœŸå†…éƒ½æ˜¯ä¸å­˜åœ¨ç«äº‰çš„")]),s._v('" è¿™ä¸€ç»éªŒæ³•åˆ™. å¦‚æœæ²¡æœ‰ç«äº‰, è½»é‡çº§é”ä¾¿é€šè¿‡ CAS æ“ä½œæˆåŠŸé¿å…äº†ä½¿ç”¨äº’æ–¥é‡çš„å¼€é”€; ä½†å¦‚æœç¡®å®å­˜åœ¨é”ç«äº‰, é™¤äº†äº’æ–¥é‡çš„æœ¬èº«å¼€é”€å¤–, è¿˜é¢å¤–å‘ç”Ÿäº† CAS æ“ä½œçš„å¼€é”€. å› æ­¤'),t("strong",[s._v("åœ¨æœ‰ç«äº‰çš„æƒ…å†µä¸‹, è½»é‡çº§é”åè€Œä¼šæ¯”ä¼ ç»Ÿçš„é‡é‡çº§é”æ›´æ…¢")]),s._v(".")]),s._v(" "),t("h5",{attrs:{id:"_5-åå‘é”"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-åå‘é”"}},[s._v("#")]),s._v(" 5.åå‘é”")]),s._v(" "),t("p",[s._v("å½“ä¸€ä¸ªé”å¯¹è±¡"),t("strong",[s._v("æ‰åˆ›å»º")]),s._v("æ—¶, æ˜¯"),t("strong",[s._v("æ²¡æœ‰ä»»ä½•çº¿ç¨‹è·å¾—è¿‡è¿™ä¸ªé”")]),s._v("çš„, è¿™ä¸ªæ—¶å€™æ˜¯"),t("strong",[s._v("æ— é”çŠ¶æ€")]),s._v(". åå‘é”é€‚ç”¨äº"),t("strong",[s._v("åªæœ‰ä¸€ä¸ªçº¿ç¨‹")]),s._v("è®¿é—®çš„åœºæ™¯.")]),s._v(" "),t("p",[s._v("åå‘é”ä¹Ÿæ˜¯ JDK 6 ä¸­å¼•å…¥çš„ä¸€é¡¹é”ä¼˜åŒ–æªæ–½, å®ƒçš„ç›®çš„æ˜¯"),t("strong",[s._v("æ¶ˆé™¤æ•°æ®åœ¨æ— ç«äº‰æƒ…å†µä¸‹çš„åŒæ­¥åŸè¯­")]),s._v(", è¿›ä¸€æ­¥æé«˜ç¨‹åºçš„è¿è¡Œæ€§èƒ½. "),t("mark",[t("strong",[s._v("å¦‚æœè¯´è½»é‡çº§é”æ˜¯åœ¨æ— ç«äº‰çš„æƒ…å†µä¸‹ä½¿ç”¨ CAS æ“ä½œå»æ¶ˆé™¤åŒæ­¥ä½¿ç”¨çš„äº’æ–¥é‡, é‚£åå‘é”å°±æ˜¯åœ¨æ— ç«äº‰çš„æƒ…å†µä¸‹æŠŠæ•´ä¸ªåŒæ­¥éƒ½æ¶ˆé™¤æ‰, è¿ CAS æ“ä½œéƒ½ä¸å»åšäº†")])]),s._v(".")]),s._v(" "),t("p",[s._v('åå‘é”ä¸­çš„ "å", å°±æ˜¯åå¿ƒçš„ "å". å®ƒçš„æ„æ€æ˜¯è¿™ä¸ª'),t("strong",[s._v("é”ä¼šåå‘äºç¬¬ä¸€ä¸ªè·å¾—å®ƒçš„çº¿ç¨‹, å¦‚æœåœ¨æ¥ä¸‹æ¥çš„æ‰§è¡Œè¿‡ç¨‹ä¸­, è¯¥é”ä¸€ç›´æ²¡æœ‰è¢«å…¶ä»–çš„çº¿ç¨‹è·å–, åˆ™æŒæœ‰åå‘é”çš„çº¿ç¨‹å°†æ°¸è¿œä¸éœ€è¦å†è¿›è¡ŒåŒæ­¥")]),s._v(".")]),s._v(" "),t("p",[s._v("å¦‚æœç†è§£äº†å‰é¢è½»é‡çº§é”ä¸­å…³äºå¯¹è±¡å¤´ Mark Word ä¸çº¿ç¨‹ä¹‹é—´çš„æ“ä½œè¿‡ç¨‹, é‚£åå‘é”çš„åŸç†å°±ä¼šå¾ˆå®¹æ˜“ç†è§£. å‡è®¾å½“å‰è™šæ‹Ÿæœºå¯ç”¨äº†åå‘é”(å¯ç”¨å‚æ•° "),t("code",[s._v("-XX: +UseBiasedLocking")]),s._v("â€‹, è¿™æ˜¯è‡ª JDK 6 èµ· HotSpot è™šæ‹Ÿæœºçš„é»˜è®¤å€¼), é‚£ä¹ˆå½“é”å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«çº¿ç¨‹è·å–çš„æ—¶å€™, è™šæ‹Ÿæœºå°†ä¼š"),t("strong",[s._v('æŠŠå¯¹è±¡å¤´ä¸­çš„æ ‡å¿—ä½è®¾ç½®ä¸º "01"')]),s._v(' , æŠŠåå‘æ¨¡å¼è®¾ç½®ä¸º "1", è¡¨ç¤ºè¿›å…¥åå‘æ¨¡å¼. åŒæ—¶ä½¿ç”¨ CAS æ“ä½œ'),t("strong",[s._v("æŠŠè·å–åˆ°è¿™ä¸ªé”çš„çº¿ç¨‹çš„ ID è®°å½•åœ¨å¯¹è±¡çš„ Mark Word ä¹‹ä¸­")]),s._v(". å¦‚æœ CAS æ“ä½œæˆåŠŸ, "),t("strong",[s._v("æŒæœ‰åå‘é”çš„çº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—æ—¶, è™šæ‹Ÿæœºéƒ½å¯ä»¥ä¸å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œ")]),s._v("(ä¾‹å¦‚åŠ é”, è§£é”åŠå¯¹ Mark Word çš„æ›´æ–°æ“ä½œç­‰).")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("ä¸€æ—¦å‡ºç°å¦å¤–ä¸€ä¸ªçº¿ç¨‹å»å°è¯•è·å–è¿™ä¸ªé”çš„æƒ…å†µ, åå‘æ¨¡å¼å°±é©¬ä¸Šå®£å‘Šç»“æŸ")])]),s._v('. æ ¹æ®é”å¯¹è±¡ç›®å‰æ˜¯å¦å¤„äºè¢«é”å®šçš„çŠ¶æ€å†³å®šæ˜¯å¦æ’¤é”€åå‘(åå‘æ¨¡å¼è®¾ç½®ä¸º "0"), æ’¤é”€åæ ‡å¿—ä½æ¢å¤åˆ°æœªé”å®š(æ ‡å¿—ä½ä¸º "01")æˆ–è½»é‡çº§é”å®š(æ ‡å¿—ä½ä¸º "00")çš„çŠ¶æ€, åç»­çš„åŒæ­¥æ“ä½œå°±æŒ‰ç…§ä¸Šé¢ä»‹ç»çš„è½»é‡çº§é”é‚£æ ·å»æ‰§è¡Œ. åå‘é”, è½»é‡çº§é”çš„çŠ¶æ€è½¬åŒ–åŠå¯¹è±¡ Mark Word çš„å…³ç³»å¦‚å›¾ 13-5 æ‰€ç¤º.')]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00234-20240302133505-0qrez8g.jpg",alt:"",title:"å›¾13-5ã€€åå‘é”, è½»é‡çº§é”çš„çŠ¶æ€è½¬åŒ–åŠå¯¹è±¡ Mark Word çš„å…³ç³»"}})]),s._v(" "),t("p",[s._v("ç»†å¿ƒçš„è¯»è€…çœ‹åˆ°è¿™é‡Œå¯èƒ½ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜: å½“å¯¹è±¡è¿›å…¥åå‘çŠ¶æ€çš„æ—¶å€™, Mark Word å¤§éƒ¨åˆ†çš„ç©ºé—´(23ä¸ªæ¯”ç‰¹)éƒ½ç”¨äºå­˜å‚¨æŒæœ‰é”çš„çº¿ç¨‹ ID äº†, è¿™éƒ¨åˆ†ç©ºé—´å ç”¨äº†åŸæœ‰å­˜å‚¨å¯¹è±¡å“ˆå¸Œç çš„ä½ç½®, é‚£åŸæ¥å¯¹è±¡çš„å“ˆå¸Œç æ€ä¹ˆåŠå‘¢?")]),s._v(" "),t("p",[s._v("åœ¨ Java è¯­è¨€é‡Œé¢ä¸€ä¸ªå¯¹è±¡å¦‚æœè®¡ç®—è¿‡å“ˆå¸Œç , å°±åº”è¯¥ä¸€ç›´ä¿æŒè¯¥å€¼ä¸å˜(å¼ºçƒˆæ¨èä½†ä¸å¼ºåˆ¶, å› ä¸ºç”¨æˆ·å¯ä»¥é‡è½½ hashCode() æ–¹æ³•æŒ‰è‡ªå·±çš„æ„æ„¿è¿”å›å“ˆå¸Œç ), å¦åˆ™å¾ˆå¤šä¾èµ–å¯¹è±¡å“ˆå¸Œç çš„ API éƒ½å¯èƒ½å­˜åœ¨å‡ºé”™é£é™©. è€Œä½œä¸ºç»å¤§å¤šæ•°å¯¹è±¡å“ˆå¸Œç æ¥æºçš„ "),t("code",[s._v("Object::hashCode()")]),s._v("â€‹ æ–¹æ³•, è¿”å›çš„æ˜¯å¯¹è±¡çš„"),t("strong",[s._v("ä¸€è‡´æ€§å“ˆå¸Œç ")]),s._v(", è¿™ä¸ªå€¼æ˜¯èƒ½å¼ºåˆ¶ä¿è¯ä¸å˜çš„, å®ƒé€šè¿‡åœ¨å¯¹è±¡å¤´ä¸­å­˜å‚¨è®¡ç®—ç»“æœæ¥ä¿è¯ç¬¬ä¸€æ¬¡è®¡ç®—ä¹‹å, å†æ¬¡è°ƒç”¨è¯¥æ–¹æ³•å–åˆ°çš„å“ˆå¸Œç å€¼æ°¸è¿œä¸ä¼šå†å‘ç”Ÿæ”¹å˜. å› æ­¤, "),t("strong",[s._v("å½“ä¸€ä¸ªå¯¹è±¡å·²ç»è®¡ç®—è¿‡ä¸€è‡´æ€§å“ˆå¸Œç å, å®ƒå°±å†ä¹Ÿæ— æ³•è¿›å…¥åå‘é”çŠ¶æ€äº†")]),s._v('; è€Œå½“ä¸€ä¸ªå¯¹è±¡å½“å‰æ­£å¤„äºåå‘é”çŠ¶æ€, åˆæ”¶åˆ°éœ€è¦è®¡ç®—å…¶ä¸€è‡´æ€§å“ˆå¸Œç è¯·æ±‚æ—¶, å®ƒçš„åå‘çŠ¶æ€ä¼šè¢«ç«‹å³æ’¤é”€, å¹¶ä¸”é”ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”. åœ¨é‡é‡çº§é”çš„å®ç°ä¸­, å¯¹è±¡å¤´æŒ‡å‘äº†é‡é‡çº§é”çš„ä½ç½®, ä»£è¡¨é‡é‡çº§é”çš„ ObjectMonitor ç±»é‡Œæœ‰å­—æ®µå¯ä»¥è®°å½•éåŠ é”çŠ¶æ€(æ ‡å¿—ä½ä¸º "01")ä¸‹çš„ Mark Word, å…¶ä¸­è‡ªç„¶å¯ä»¥å­˜å‚¨åŸæ¥çš„å“ˆå¸Œç .')]),s._v(" "),t("p",[s._v("åå‘é”å¯ä»¥æé«˜å¸¦æœ‰åŒæ­¥ä½†æ— ç«äº‰çš„ç¨‹åºæ€§èƒ½, ä½†å®ƒåŒæ ·æ˜¯ä¸€ä¸ªå¸¦æœ‰æ•ˆç›Šæƒè¡¡(Trade Off)æ€§è´¨çš„ä¼˜åŒ–, ä¹Ÿå°±æ˜¯è¯´å®ƒå¹¶éæ€»æ˜¯å¯¹ç¨‹åºè¿è¡Œæœ‰åˆ©. "),t("strong",[s._v("å¦‚æœç¨‹åºä¸­å¤§å¤šæ•°çš„é”éƒ½æ€»æ˜¯è¢«å¤šä¸ªä¸åŒçš„çº¿ç¨‹è®¿é—®, é‚£åå‘æ¨¡å¼å°±æ˜¯å¤šä½™çš„")]),s._v(". åœ¨å…·ä½“é—®é¢˜å…·ä½“åˆ†æçš„å‰æä¸‹, æœ‰æ—¶å€™ä½¿ç”¨å‚æ•° "),t("code",[s._v("-XX: -UseBiasedLocking")]),s._v("â€‹ æ¥ç¦æ­¢åå‘é”ä¼˜åŒ–åè€Œå¯ä»¥æå‡æ€§èƒ½.")]),s._v(" "),t("h5",{attrs:{id:"_6-å†…ç½®é”ä¼˜åŒ–å‡çº§è¿‡ç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-å†…ç½®é”ä¼˜åŒ–å‡çº§è¿‡ç¨‹"}},[s._v("#")]),s._v(" 6.å†…ç½®é”ä¼˜åŒ–å‡çº§è¿‡ç¨‹")]),s._v(" "),t("p",[s._v("JDK6 å¼•å…¥äº†"),t("strong",[s._v("åå‘é”å’Œè½»é‡çº§é”")]),s._v(", ä»è€Œè®©é”æ‹¥æœ‰äº†"),t("strong",[s._v("å››ä¸ªçŠ¶æ€")]),s._v(": "),t("strong",[s._v("æ— é”çŠ¶æ€(unlocked), åå‘é”çŠ¶æ€(biasble), è½»é‡çº§é”çŠ¶æ€(lightweight locked)å’Œé‡é‡çº§é”çŠ¶æ€(inflated)")]),s._v(" .")]),s._v(" "),t("p",[s._v("å¯¹è±¡å¤´(å‚è€ƒ å¯¹è±¡å¤´)ä¸­åŒ…å«çš„ "),t("strong",[s._v("Mark Word")]),s._v(" åœ¨ä¸åŒçš„"),t("strong",[s._v("é”çŠ¶æ€")]),s._v("ä¸‹å­˜å‚¨çš„å†…å®¹ä¸åŒ, ä¼šéšç€é”å‡çº§è€Œå˜åŠ¨. åœ¨ "),t("strong",[s._v("32 ä½ JVM")]),s._v(" ä¸­æ˜¯è¿™ä¹ˆå­˜çš„:")]),s._v(" "),t("p",[s._v("â€‹"),t("img",{attrs:{src:"/img/image-20240623215550-0xepx9a.png",alt:"image"}}),s._v("â€‹")]),s._v(" "),t("p",[s._v("æ‰€ä»¥å†…ç½®é”æœ‰ 4 ç§çŠ¶æ€: "),t("strong",[s._v("æ— é”, åå‘é”, è½»é‡çº§é”, é‡é‡çº§é”")]),s._v(". é”å¯¹è±¡çš„çŠ¶æ€ä¸æ˜¯ä¸€æ¥å°±é‡é‡çº§çš„, è€Œæ˜¯æŒ‰ç…§å¦‚ä¸‹çš„é¡ºåºè¿›è¡Œè†¨èƒ€å‡çº§, å› æ­¤è¿™ä¹Ÿæ˜¯å¯¹å†…ç½®é”çš„ä¸€ç§"),t("strong",[s._v("ä¼˜åŒ–æªæ–½")]),s._v(".")]),s._v(" "),t("p",[s._v("å‡ ç§é”ä¼šéšç€"),t("strong",[s._v("ç«äº‰çš„æ¿€çƒˆè€Œé€æ¸å‡çº§")]),s._v(", æ³¨æ„é”"),t("strong",[s._v("å¯ä»¥å‡çº§ä¸å¯é™çº§")]),s._v(", è¿™ç§ç­–ç•¥æ˜¯ä¸ºäº†æé«˜è·å¾—é”å’Œé‡Šæ”¾é”çš„æ•ˆç‡.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220601231206114.png",alt:""}})]),s._v(" "),t("p",[s._v("ä¸‹å›¾"),t("strong",[s._v("å·¦ä¾§")]),s._v("æ˜¯ä¸€ä¸ªçº¿ç¨‹çš„"),t("strong",[s._v("è™šæ‹Ÿæœºæ ˆ")]),s._v(", å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†ç§°ä¸º "),t("strong",[s._v("Lock Record")]),s._v(" çš„åŒºåŸŸ, è¿™æ˜¯åœ¨"),t("strong",[s._v("è½»é‡çº§é”")]),s._v("è¿è¡Œè¿‡ç¨‹åˆ›å»ºçš„, ç”¨äºå­˜æ”¾"),t("strong",[s._v("é”å¯¹è±¡çš„ Mark Word")]),s._v(". è€Œå³ä¾§å°±æ˜¯ä¸€ä¸ª"),t("strong",[s._v("é”å¯¹è±¡")]),s._v(", åŒ…å«äº† "),t("strong",[s._v("Mark Word")]),s._v(" å’Œå…¶å®ƒä¿¡æ¯.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/1563602285907.png",alt:""}})]),s._v(" "),t("h5",{attrs:{id:"_7-é”è†¨èƒ€åçš„ä¼˜åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-é”è†¨èƒ€åçš„ä¼˜åŒ–"}},[s._v("#")]),s._v(" 7.é”è†¨èƒ€åçš„ä¼˜åŒ–")]),s._v(" "),t("p",[s._v("ç³»ç»Ÿ"),t("strong",[s._v("å¹¶å‘é«˜")]),s._v("çš„æ—¶å€™, å¯èƒ½å¯¼è‡´"),t("strong",[s._v("é”è†¨èƒ€å‡çº§")]),s._v(", JVM è§„å®š synchronized é”å‡çº§ä¹‹å"),t("strong",[s._v("æ— æ³•é”é™çº§")]),s._v(", "),t("strong",[s._v("é”çš„å‡çº§æ˜¯ä¸å¯é€†çš„")]),s._v("; å‡çº§ä¹‹å, å¦‚æœç³»ç»Ÿçš„å¹¶å‘ä¸‹æ¥äº†, è¿™æ— ç–‘é™ä½äº†ç³»ç»Ÿçš„å¤„ç†é€Ÿåº¦.")]),s._v(" "),t("p",[s._v("å› æ­¤å¯ä»¥è¿‡ä¸€æ®µæ—¶é—´çœ‹çœ‹å¹¶å‘åº¦, "),t("strong",[s._v("ç»Ÿè®¡å¹¶å‘åº¦å·²ç»å¾ˆä½")]),s._v(", å¹¶ä¸”è¿˜æ˜¯é‡é‡çº§é”, åˆ™å¯ä»¥è¿›è¡Œ"),t("mark",[t("strong",[s._v("é”å¯¹è±¡çš„åˆ‡æ¢")])]),s._v(". ä¹Ÿå°±æ˜¯æ¢ä¸€ä¸ªé”å¯¹è±¡, è¿™æ ·åˆå¼€å§‹åå‘é”çŠ¶æ€, æå‡äº†å¤„ç†é€Ÿåº¦; é”å¯¹è±¡åˆ‡æ¢æ—¶å€™, éœ€è¦æ³¨æ„å¹¶å‘æ“ä½œ.")]),s._v(" "),t("p",[s._v("å¯ä»¥ç”¨è¿™ä¸ªå·¥å…·åŒ…å¯ä»¥è·å–å¯¹è±¡çš„æ¶ˆæ¯å¤´è¯¦æƒ…, è·å–å½“å‰é”å¯¹è±¡æ˜¯å¦å¤„äºé‡é‡çº§é”çŠ¶æ€.")]),s._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.openjdk.jol"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("jol-core"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("0.9"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("â€")]),s._v(" "),t("h4",{attrs:{id:"æœ¬ç« å°ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æœ¬ç« å°ç»“"}},[s._v("#")]),s._v(" æœ¬ç« å°ç»“")]),s._v(" "),t("p",[s._v("æœ¬ç« ä»‹ç»äº†çº¿ç¨‹å®‰å…¨æ‰€æ¶‰åŠçš„æ¦‚å¿µå’Œåˆ†ç±», åŒæ­¥å®ç°çš„æ–¹å¼åŠè™šæ‹Ÿæœºçš„åº•å±‚è¿ä½œåŸç†, å¹¶ä¸”ä»‹ç»äº†è™šæ‹Ÿæœºä¸ºå®ç°é«˜æ•ˆå¹¶å‘æ‰€åšçš„ä¸€ç³»åˆ—é”ä¼˜åŒ–æªæ–½.")]),s._v(" "),t("p",[s._v("èƒ½å¤Ÿå†™å‡ºé«˜æ€§èƒ½, é«˜ä¼¸ç¼©æ€§çš„å¹¶å‘ç¨‹åºæ˜¯ä¸€é—¨è‰ºæœ¯, è€Œäº†è§£å¹¶å‘åœ¨ç³»ç»Ÿåº•å±‚æ˜¯å¦‚ä½•å®ç°çš„, åˆ™æ˜¯æŒæ¡è¿™é—¨è‰ºæœ¯çš„å‰ææ¡ä»¶, ä¹Ÿæ˜¯æˆé•¿ä¸ºé«˜çº§ç¨‹åºå‘˜çš„å¿…å¤‡çŸ¥è¯†ä¹‹ä¸€.")]),s._v(" "),t("p",[s._v("â€")])])}),[],!1,null,null,null);t.default=r.exports}}]);