(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{397:function(s,t,a){"use strict";a.r(t);var n=a(7),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_21-åƒåœ¾æ”¶é›†å™¨ä¸å†…å­˜åˆ†é…ç­–ç•¥ğŸŒ¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_21-åƒåœ¾æ”¶é›†å™¨ä¸å†…å­˜åˆ†é…ç­–ç•¥ğŸŒ¼"}},[s._v("#")]),s._v(" 21.åƒåœ¾æ”¶é›†å™¨ä¸å†…å­˜åˆ†é…ç­–ç•¥ğŸŒ¼")]),s._v(" "),t("p",[s._v("æœ¬èŠ‚æ˜¯ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹çš„ç¬¬ä¸‰ç« ")]),s._v(" "),t("p",[s._v("Java ä¸ C++ ä¹‹é—´æœ‰ä¸€å µç”±å†…å­˜åŠ¨æ€åˆ†é…å’Œåƒåœ¾æ”¶é›†æŠ€æœ¯æ‰€å›´æˆçš„é«˜å¢™, å¢™å¤–é¢çš„äººæƒ³è¿›å», å¢™é‡Œé¢çš„äººå´æƒ³å‡ºæ¥.")]),s._v(" "),t("h4",{attrs:{id:"æ¦‚è¿°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ¦‚è¿°"}},[s._v("#")]),s._v(" æ¦‚è¿°")]),s._v(" "),t("p",[s._v("è¯´èµ·åƒåœ¾æ”¶é›†(Garbage Collection, ä¸‹æ–‡ç®€ç§° GC), æœ‰ä¸å°‘äººæŠŠè¿™é¡¹æŠ€æœ¯å½“ä½œ Java è¯­è¨€çš„ä¼´ç”Ÿäº§ç‰©. äº‹å®ä¸Š, åƒåœ¾æ”¶é›†çš„å†å²è¿œè¿œæ¯” Java ä¹…è¿œ, åœ¨ 1960 å¹´è¯ç”Ÿçš„ Lisp æ˜¯ç¬¬ä¸€é—¨å¼€å§‹ä½¿ç”¨å†…å­˜åŠ¨æ€åˆ†é…å’Œåƒåœ¾æ”¶é›†æŠ€æœ¯çš„è¯­è¨€. å½“ Lisp è¿˜åœ¨èƒšèƒæ—¶æœŸæ—¶å°±æ€è€ƒè¿‡åƒåœ¾æ”¶é›†éœ€è¦å®Œæˆçš„ä¸‰ä»¶äº‹æƒ…:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("å“ªäº›å†…å­˜éœ€è¦å›æ”¶?")])]),s._v(" "),t("li",[t("strong",[s._v("ä»€ä¹ˆæ—¶å€™å›æ”¶?")])]),s._v(" "),t("li",[t("strong",[s._v("å¦‚ä½•å›æ”¶?")])])]),s._v(" "),t("p",[s._v('ç»è¿‡åŠä¸ªä¸–çºªçš„å‘å±•, ä»Šå¤©çš„å†…å­˜åŠ¨æ€åˆ†é…ä¸å†…å­˜å›æ”¶æŠ€æœ¯å·²ç»ç›¸å½“æˆç†Ÿ, ä¸€åˆ‡çœ‹èµ·æ¥éƒ½è¿›å…¥äº† "è‡ªåŠ¨åŒ–" æ—¶ä»£, é‚£ä¸ºä»€ä¹ˆè¿˜è¦å»äº†è§£åƒåœ¾æ”¶é›†å’Œå†…å­˜åˆ†é…? ç­”æ¡ˆå¾ˆç®€å•: '),t("strong",[s._v('å½“éœ€è¦æ’æŸ¥å„ç§å†…å­˜æº¢å‡º, å†…å­˜æ³„æ¼é—®é¢˜æ—¶, å½“åƒåœ¾æ”¶é›†æˆä¸ºç³»ç»Ÿè¾¾åˆ°æ›´é«˜å¹¶å‘é‡çš„ç“¶é¢ˆæ—¶, å°±å¿…é¡»å¯¹è¿™äº› "è‡ªåŠ¨åŒ–" çš„æŠ€æœ¯å®æ–½å¿…è¦çš„ç›‘æ§å’Œè°ƒèŠ‚')]),s._v(".")]),s._v(" "),t("blockquote",[t("p",[s._v("åƒåœ¾å›æ”¶çš„èŒƒå›´")])]),s._v(" "),t("p",[s._v("å‰é¢ä»‹ç»äº† Java å†…å­˜è¿è¡Œæ—¶åŒºåŸŸçš„å„ä¸ªéƒ¨åˆ†, "),t("strong",[s._v("å…¶ä¸­ç¨‹åºè®¡æ•°å™¨, è™šæ‹Ÿæœºæ ˆ, æœ¬åœ°æ–¹æ³•æ ˆ 3 ä¸ªåŒºåŸŸæ˜¯çº¿ç¨‹ç§æœ‰çš„, éšçº¿ç¨‹è€Œç”Ÿ, éšçº¿ç¨‹è€Œç­")]),s._v(", æ ˆä¸­çš„æ ˆå¸§éšç€æ–¹æ³•çš„è¿›å…¥å’Œé€€å‡ºè€Œæœ‰æ¡ä¸ç´Šåœ°æ‰§è¡Œç€å‡ºæ ˆå’Œå…¥æ ˆæ“ä½œ. æ¯ä¸€ä¸ªæ ˆå¸§ä¸­åˆ†é…å¤šå°‘å†…å­˜åŸºæœ¬ä¸Šæ˜¯åœ¨ç±»ç»“æ„ç¡®å®šä¸‹æ¥æ—¶å°±å·²çŸ¥çš„, å› æ­¤è¿™å‡ ä¸ªåŒºåŸŸçš„å†…å­˜åˆ†é…å’Œå›æ”¶éƒ½å…·å¤‡ç¡®å®šæ€§, åœ¨è¿™å‡ ä¸ªåŒºåŸŸå†…å°±ä¸éœ€è¦è¿‡å¤šè€ƒè™‘å¦‚ä½•å›æ”¶çš„é—®é¢˜, å½“æ–¹æ³•ç»“æŸæˆ–è€…çº¿ç¨‹ç»“æŸæ—¶, å†…å­˜è‡ªç„¶å°±è·Ÿéšç€å›æ”¶äº†.")]),s._v(" "),t("p",[s._v("è€Œ Java "),t("mark",[t("strong",[s._v("å †å’Œæ–¹æ³•åŒº")])]),s._v("è¿™ä¸¤ä¸ªåŒºåŸŸåˆ™æœ‰ç€å¾ˆæ˜¾è‘—çš„ä¸ç¡®å®šæ€§: "),t("strong",[s._v('ä¸€ä¸ªæ¥å£çš„å¤šä¸ªå®ç°ç±»éœ€è¦çš„å†…å­˜å¯èƒ½ä¼šä¸ä¸€æ ·, ä¸€ä¸ªæ–¹æ³•æ‰€æ‰§è¡Œçš„ä¸åŒæ¡ä»¶åˆ†æ”¯æ‰€éœ€è¦çš„å†…å­˜ä¹Ÿå¯èƒ½ä¸ä¸€æ ·, åªæœ‰å¤„äºè¿è¡ŒæœŸé—´, æ‰èƒ½çŸ¥é“ç¨‹åºç©¶ç«Ÿä¼šåˆ›å»ºå“ªäº›å¯¹è±¡, åˆ›å»ºå¤šå°‘ä¸ªå¯¹è±¡, è¿™éƒ¨åˆ†å†…å­˜çš„åˆ†é…å’Œå›æ”¶æ˜¯åŠ¨æ€çš„. åƒåœ¾æ”¶é›†å™¨æ‰€å…³æ³¨çš„æ­£æ˜¯è¿™éƒ¨åˆ†å†…å­˜è¯¥å¦‚ä½•ç®¡ç†, æœ¬æ–‡åç»­è®¨è®ºä¸­çš„ "å†…å­˜" åˆ†é…ä¸å›æ”¶ä¹Ÿä»…ä»…ç‰¹æŒ‡è¿™ä¸€éƒ¨åˆ†å†…å­˜')]),s._v(".")]),s._v(" "),t("h4",{attrs:{id:"åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯å›æ”¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯å›æ”¶"}},[s._v("#")]),s._v(" åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯å›æ”¶?")]),s._v(" "),t("p",[s._v("åœ¨å †é‡Œé¢å­˜æ”¾ç€ Java ä¸–ç•Œä¸­å‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹, åƒåœ¾æ”¶é›†å™¨åœ¨å¯¹å †è¿›è¡Œå›æ”¶å‰, ç¬¬ä¸€ä»¶äº‹æƒ…å°±æ˜¯è¦"),t("strong",[s._v('ç¡®å®šè¿™äº›å¯¹è±¡ä¹‹ä¸­å“ªäº›è¿˜ "å­˜æ´»" ç€, å“ªäº›å·²ç» "æ­»å»"')]),s._v(" (å³ä¸å¯èƒ½å†è¢«ä»»ä½•é€”å¾„ä½¿ç”¨çš„å¯¹è±¡)äº†.")]),s._v(" "),t("h5",{attrs:{id:"_1-å¼•ç”¨è®¡æ•°ç®—æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å¼•ç”¨è®¡æ•°ç®—æ³•"}},[s._v("#")]),s._v(" 1.å¼•ç”¨è®¡æ•°ç®—æ³•")]),s._v(" "),t("p",[s._v("ä¸ºå¯¹è±¡æ·»åŠ ä¸€ä¸ª"),t("strong",[s._v("å¼•ç”¨è®¡æ•°å™¨")]),s._v(", å½“å¯¹è±¡å¢åŠ ä¸€ä¸ªå¼•ç”¨æ—¶è®¡æ•°å™¨åŠ  1, å¼•ç”¨å¤±æ•ˆæ—¶å‡ 1, å¼•ç”¨è®¡æ•°ä¸º 0 çš„å¯¹è±¡å°±èƒ½è¢«å›æ”¶.")]),s._v(" "),t("p",[s._v("ä¸»æµè™šæ‹Ÿæœºä¸­å¹¶æ²¡æœ‰é€‰æ‹©è¿™ä¸ªç®—æ³•æ¥ç®¡ç†å†…å­˜, å› ä¸ºå®ƒå¾ˆéš¾è§£å†³å¯¹è±¡ä¹‹é—´"),t("strong",[s._v("ç›¸äº’å¾ªç¯å¼•ç”¨")]),s._v("çš„é—®é¢˜. åœ¨ä¸¤ä¸ªå¯¹è±¡å‡ºç°"),t("strong",[s._v("å¾ªç¯å¼•ç”¨")]),s._v("çš„æƒ…å†µä¸‹, æ­¤æ—¶å¼•ç”¨è®¡æ•°å™¨æ°¸è¿œä¸ä¸º 0, å¯¼è‡´"),t("strong",[s._v("æ— æ³•")]),s._v("å¯¹å®ƒä»¬è¿›è¡Œå›æ”¶, è¿›è€Œé€ æˆ"),t("strong",[s._v("å†…å­˜æ³„æ¼")]),s._v("é—®é¢˜.")]),s._v(" "),t("blockquote",[t("p",[s._v("å¼•ç”¨è®¡æ•°æ³•ç¼ºé™·ç¤ºä¾‹")])]),s._v(" "),t("p",[s._v("ä¸¾ä¸ªä¾‹å­,ä¸‹é¢å¯¹è±¡ a ä¸ b äº’ç›¸æŒæœ‰å¯¹æ–¹çš„å¼•ç”¨, å› æ­¤å½“æŠŠå¯¹ a ä¸ b çš„å¼•ç”¨å»é™¤ä¹‹å, ç”±äºä¸¤ä¸ªå¯¹è±¡è¿˜å­˜åœ¨äº’ç›¸ä¹‹é—´çš„å¼•ç”¨, å¦‚æœé‡‡ç”¨å¼•ç”¨è®¡æ•°æ³•å°±ä¼šå¯¼è‡´è¿™ä¸¤ä¸ªå¯¹è±¡æ— æ³•è¢«å›æ”¶.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReferenceCountingGC")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ONE_MB")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¿™ä¸ªæˆå‘˜å±æ€§çš„å”¯ä¸€æ„ä¹‰å°±æ˜¯å ç‚¹å†…å­˜, ä»¥ä¾¿èƒ½åœ¨ GC æ—¥å¿—ä¸­çœ‹æ¸…æ¥šæ˜¯å¦æœ‰å›æ”¶è¿‡")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" bigSize "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ONE_MB")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testGC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReferenceCountingGC")]),s._v(" a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReferenceCountingGC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReferenceCountingGC")]),s._v(" b "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ReferenceCountingGC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        b"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("instance "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" a"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        a "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        b "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‡è®¾åœ¨è¿™è¡Œå‘ç”Ÿ GC, objA å’Œ objB æ˜¯å¦èƒ½è¢«å›æ”¶? ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("è¿è¡Œç»“æœ:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[Full GC (System) [Tenured: 0K->210K(10240K), 0.0149142 secs] 4603K->210K(19456K), [Perm : 2999K->2999K(21248K)], 0.0150007 secs] [Times: user=0.01 sys=0.00, real=0.02 secs]\nHeap\n    def new generation   total 9216K, used 82K [0x00000000055e0000, 0x0000000005fe0000, 0x0000000005fe0000)\n    Eden space 8192K,   1% used [0x00000000055e0000, 0x00000000055f4850, 0x0000000005de0000)\n    from space 1024K,   0% used [0x0000000005de0000, 0x0000000005de0000, 0x0000000005ee0000)\n    to   space 1024K,   0% used [0x0000000005ee0000, 0x0000000005ee0000, 0x0000000005fe0000)\n    tenured generation   total 10240K, used 210K [0x0000000005fe0000, 0x00000000069e0000, 0x00000000069e0000)\n    the space 10240K,   2% used [0x0000000005fe0000, 0x0000000006014a18, 0x0000000006014c00, 0x00000000069e0000)\n    compacting perm gen  total 21248K, used 3016K [0x00000000069e0000, 0x0000000007ea0000, 0x000000000bde0000)\n    the space 21248K,  14% used [0x00000000069e0000, 0x0000000006cd2398, 0x0000000006cd2400, 0x0000000007ea0000)\n    No shared spaces configured.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v('ä»è¿è¡Œç»“æœä¸­å¯ä»¥æ¸…æ¥šçœ‹åˆ°å†…å­˜å›æ”¶æ—¥å¿—ä¸­åŒ…å« "4603K->210K", æ„å‘³ç€è™šæ‹Ÿæœº'),t("strong",[s._v("å·²ç»å›æ”¶äº†å®ƒä»¬")]),s._v(", è¿™ä¹Ÿä»ä¾§é¢è¯´æ˜äº† Java è™šæ‹Ÿæœºå¹¶ä¸æ˜¯é€šè¿‡å¼•ç”¨è®¡æ•°ç®—æ³•æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»çš„.")]),s._v(" "),t("h5",{attrs:{id:"_2-å¯è¾¾æ€§åˆ†æç®—æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å¯è¾¾æ€§åˆ†æç®—æ³•"}},[s._v("#")]),s._v(" 2.å¯è¾¾æ€§åˆ†æç®—æ³•")]),s._v(" "),t("p",[t("strong",[s._v("å¯è¾¾æ€§åˆ†æ(Reachability Analysis)ç®—æ³•")]),s._v("çš„åŸºæœ¬æ€è·¯å°±"),t("strong",[s._v('é€šè¿‡ä¸€ç³»åˆ—ç§°ä¸º "GC Roots" çš„æ ¹å¯¹è±¡ä½œä¸ºèµ·å§‹èŠ‚ç‚¹é›†, ä»è¿™äº›èŠ‚ç‚¹å¼€å§‹, æ ¹æ®å¼•ç”¨å…³ç³»å‘ä¸‹æœç´¢, æœç´¢è¿‡ç¨‹æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸º "å¼•ç”¨é“¾"(Reference Chain), å¦‚æœæŸä¸ªå¯¹è±¡åˆ° GC Roots é—´æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿, æˆ–è€…ç”¨å›¾è®ºçš„è¯æ¥è¯´å°±æ˜¯ä» GC Roots åˆ°è¿™ä¸ªå¯¹è±¡ä¸å¯è¾¾æ—¶, åˆ™è¯æ˜æ­¤å¯¹è±¡æ˜¯ä¸å¯èƒ½å†è¢«ä½¿ç”¨çš„')]),s._v(". è¿™æ˜¯ä¸»æµçš„æ–¹æ³•.")]),s._v(" "),t("p",[s._v("å¦‚ä¸‹å›¾æ‰€ç¤º, å¯¹è±¡ object4, object5 è™½ç„¶äº’æœ‰å…³è”, ä½†æ˜¯å®ƒä»¬åˆ° GC Roots æ˜¯ä¸å¯è¾¾çš„, å› æ­¤å®ƒä»¬å°†ä¼šè¢«åˆ¤å®šä¸ºå¯å›æ”¶çš„å¯¹è±¡.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521121813327.png",alt:""}})]),s._v(" "),t("p",[s._v("åœ¨ Java æŠ€æœ¯ä½“ç³»é‡Œé¢, "),t("strong",[s._v("å›ºå®šå¯ä½œä¸º GC Roots çš„å¯¹è±¡")]),s._v("åŒ…æ‹¬ä»¥ä¸‹å‡ ç§:")]),s._v(" "),t("ul",[t("li",[t("mark",[t("strong",[s._v("åœ¨è™šæ‹Ÿæœºæ ˆ(æ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨)ä¸­å¼•ç”¨çš„å¯¹è±¡, è­¬å¦‚å„ä¸ªçº¿ç¨‹è¢«è°ƒç”¨çš„æ–¹æ³•å †æ ˆä¸­ä½¿ç”¨åˆ°çš„å‚æ•°, å±€éƒ¨å˜é‡, ä¸´æ—¶å˜é‡ç­‰")])]),s._v(". å…¶å®å°±æ˜¯æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„å¯¹è±¡, è¿™äº›å¯¹è±¡å®é™…åˆ†é…åˆ°"),t("strong",[s._v("å †")]),s._v("ä¸­, æ–¹æ³•æ ˆä¸­ä¿å­˜ç€è¿™äº›å¯¹è±¡åˆ°å †åŒºçš„å¼•ç”¨. åœ¨ GC çš„æ—¶å€™, å¦‚æœè¿™ä¸ªæ–¹æ³•çš„æ ˆå¸§ä¾ç„¶æ˜¯æœ‰æ•ˆçš„, é‚£è¿™é‡Œé¢æŒ‡å‘çš„å¯¹è±¡å°±ä¸èƒ½è¢«å›æ”¶, å› æ­¤éœ€è¦ä»¥å®ƒä»¬ä¸º GC Root æ¥å¯»æ‰¾å­˜æ´»çš„å¯¹è±¡. ä½†æ˜¯å½“çº¿ç¨‹ç»“æŸä¹‹å, è¿™äº›å¯¹è±¡å°±æ²¡æœ‰ä»»ä½•å¼•ç”¨äº†.")]),s._v(" "),t("li",[t("strong",[s._v("åœ¨æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡, è­¬å¦‚ Java ç±»çš„å¼•ç”¨ç±»å‹é™æ€å˜é‡")]),s._v(". é™æ€å˜é‡æ‰€æŒ‡å‘çš„å¯¹è±¡ä¹Ÿæ˜¯åœ¨å †ä¸­çš„, å› æ­¤ä¼šç”¨é™æ€å˜é‡ä½œä¸º Root æ¥æ‰¾å †ä¸­çš„å­˜æ´»å¯¹è±¡.")]),s._v(" "),t("li",[t("strong",[s._v("åœ¨æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡, è­¬å¦‚å­—ç¬¦ä¸²å¸¸é‡æ± (String Table)é‡Œçš„å¼•ç”¨")]),s._v(".")]),s._v(" "),t("li",[s._v("åœ¨"),t("strong",[s._v("æœ¬åœ°æ–¹æ³•æ ˆä¸­ JNI(å³é€šå¸¸æ‰€è¯´çš„ Native æ–¹æ³•)å¼•ç”¨çš„å¯¹è±¡")]),s._v(".")]),s._v(" "),t("li",[s._v("Java è™šæ‹Ÿæœºå†…éƒ¨çš„å¼•ç”¨, å¦‚åŸºæœ¬æ•°æ®ç±»å‹å¯¹åº”çš„ Class å¯¹è±¡, ä¸€äº›å¸¸é©»çš„å¼‚å¸¸å¯¹è±¡(æ¯”å¦‚ NullPointExcepiton, OutOfMemoryError)ç­‰, è¿˜æœ‰ç³»ç»Ÿç±»åŠ è½½å™¨.")]),s._v(" "),t("li",[s._v("æ‰€æœ‰è¢«åŒæ­¥é”(synchronized å…³é”®å­—)æŒæœ‰çš„å¯¹è±¡.")]),s._v(" "),t("li",[s._v("åæ˜  Java è™šæ‹Ÿæœºå†…éƒ¨æƒ…å†µçš„ JMXBean, JVMTI ä¸­æ³¨å†Œçš„å›è°ƒ, æœ¬åœ°ä»£ç ç¼“å­˜ç­‰.")])]),s._v(" "),t("p",[s._v("GC Roots çš„èŠ‚ç‚¹ä¸»è¦åœ¨"),t("strong",[s._v("å…¨å±€æ€§çš„å¼•ç”¨")]),s._v("(ä¾‹å¦‚å¸¸é‡æˆ–ç±»é™æ€å±æ€§) ä¸"),t("strong",[s._v("æ‰§è¡Œä¸Šä¸‹æ–‡")]),s._v("(ä¾‹å¦‚æ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨) ä¸­.")]),s._v(" "),t("h5",{attrs:{id:"_3-finalize-å¯¹è±¡è‡ªæ•‘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-finalize-å¯¹è±¡è‡ªæ•‘"}},[s._v("#")]),s._v(" 3.finalize()å¯¹è±¡è‡ªæ•‘")]),s._v(" "),t("p",[s._v('å³ä½¿åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­åˆ¤å®šä¸ºä¸å¯è¾¾çš„å¯¹è±¡, ä¹Ÿä¸æ˜¯ "éæ­»ä¸å¯" çš„, è¿™æ—¶å€™å®ƒä»¬æš‚æ—¶è¿˜å¤„äº "'),t("strong",[s._v("ç¼“åˆ‘")]),s._v('" é˜¶æ®µ, è¦'),t("strong",[s._v("çœŸæ­£å®£å‘Šä¸€ä¸ªå¯¹è±¡æ­»äº¡, è‡³å°‘è¦ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("ç¬¬ä¸€æ¬¡æ ‡è®°")]),s._v(": "),t("strong",[s._v("å¦‚æœå¯¹è±¡åœ¨è¿›è¡Œå¯è¾¾æ€§åˆ†æåå‘ç°æ²¡æœ‰ä¸ GC Roots ç›¸è¿æ¥çš„å¼•ç”¨é“¾, é‚£å®ƒå°†ä¼šè¢«ç¬¬ä¸€æ¬¡æ ‡è®°, éšåè¿›è¡Œä¸€æ¬¡ç­›é€‰, ç­›é€‰çš„æ¡ä»¶æ˜¯æ­¤å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œ finalize() æ–¹æ³•")]),s._v('. å‡å¦‚å¯¹è±¡æ²¡æœ‰è¦†ç›– finalize() æ–¹æ³•, æˆ–è€… finalize() æ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨è¿‡, é‚£ä¹ˆè™šæ‹Ÿæœºå°†è¿™ä¸¤ç§æƒ…å†µéƒ½è§†ä¸º "æ²¡æœ‰å¿…è¦æ‰§è¡Œ". å½“å¯¹è±¡æ²¡æœ‰'),t("strong",[s._v("è¦†å†™")]),s._v(" finalize() æ–¹æ³•, æˆ– finalize() æ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœº"),t("strong",[s._v("è°ƒç”¨è¿‡")]),s._v("æ—¶, å¯¹è±¡å°†è¢«"),t("strong",[s._v("ç›´æ¥å›æ”¶")]),s._v(". å¦‚æœè¿™ä¸ªå¯¹è±¡è¢«åˆ¤å®šä¸ºç¡®æœ‰å¿…è¦æ‰§è¡Œ finalize() æ–¹æ³•, é‚£ä¹ˆè¯¥å¯¹è±¡å°†ä¼š"),t("strong",[s._v("è¢«æ”¾ç½®åœ¨ä¸€ä¸ªåä¸º F-Queue çš„é˜Ÿåˆ—ä¹‹ä¸­, å¹¶åœ¨ç¨åç”±ä¸€æ¡ç”±è™šæ‹Ÿæœºè‡ªåŠ¨å»ºç«‹çš„, ä½è°ƒåº¦ä¼˜å…ˆçº§çš„ Finalizer çº¿ç¨‹å»æ‰§è¡Œå®ƒä»¬çš„ finalize() æ–¹æ³•")]),s._v('. è¿™é‡Œæ‰€è¯´çš„ "æ‰§è¡Œ" æ˜¯æŒ‡è™šæ‹Ÿæœºä¼šè§¦å‘è¿™ä¸ªæ–¹æ³•å¼€å§‹è¿è¡Œ, ä½†'),t("strong",[s._v("å¹¶ä¸æ‰¿è¯º")]),s._v("ä¸€å®šä¼šç­‰å¾…å®ƒè¿è¡Œç»“æŸ. è¿™æ ·åšçš„åŸå› æ˜¯, å¦‚æœæŸä¸ªå¯¹è±¡çš„ finalize() æ–¹æ³•æ‰§è¡Œç¼“æ…¢, æˆ–è€…æ›´æç«¯åœ°å‘ç”Ÿäº†æ­»å¾ªç¯, å°†å¾ˆå¯èƒ½å¯¼è‡´ F-Queue é˜Ÿåˆ—ä¸­çš„å…¶ä»–å¯¹è±¡"),t("strong",[s._v("æ°¸ä¹…å¤„äºç­‰å¾…, ç”šè‡³å¯¼è‡´æ•´ä¸ªå†…å­˜å›æ”¶å­ç³»ç»Ÿçš„å´©æºƒ")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("ç¬¬äºŒæ¬¡æ ‡è®°")]),s._v(": å¦‚æœè¿™ä¸ªå¯¹è±¡è¦†å†™äº† finalize() æ–¹æ³•, é‚£ä¹ˆ finalize() æ–¹æ³•æ˜¯å¯¹è±¡é€ƒè„±æ­»äº¡å‘½è¿çš„æœ€åä¸€æ¬¡æœºä¼š, ç¨åæ”¶é›†å™¨å°†å¯¹ F-Queue ä¸­çš„å¯¹è±¡è¿›è¡Œ"),t("strong",[s._v("ç¬¬äºŒæ¬¡å°è§„æ¨¡")]),s._v("çš„æ ‡è®°, å¦‚æœå¯¹è±¡è¦åœ¨ finalize() ä¸­æˆåŠŸæ‹¯æ•‘è‡ªå·±, "),t("strong",[s._v("è¦é‡æ–°ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹å…³è”å³å¯")]),s._v(", è­¬å¦‚æŠŠè‡ªå·±(this å…³é”®å­—)èµ‹å€¼ç»™æŸä¸ªç±»å˜é‡æˆ–è€…å¯¹è±¡çš„æˆå‘˜å˜é‡, é‚£åœ¨ç¬¬äºŒæ¬¡æ ‡è®°æ—¶å®ƒå°†è¢«"),t("strong",[s._v("ç§»å‡º")]),s._v(' "å³å°†å›æ”¶" çš„é›†åˆ; å¦‚æœå¯¹è±¡è¿™æ—¶å€™è¿˜æ²¡æœ‰é€ƒè„±, é‚£åŸºæœ¬ä¸Šå®ƒå°±çœŸçš„è¦è¢«å›æ”¶äº†.')]),s._v(" "),t("p",[t("strong",[s._v("æ€»ç»“å¦‚ä½•è‡ªæˆ‘æ•‘èµ:")])]),s._v(" "),t("ol",[t("li",[s._v("å¯¹è±¡"),t("strong",[s._v("è¦†å†™")]),s._v("äº† "),t("strong",[s._v("finalize()")]),s._v("  æ–¹æ³•(è¿™æ ·åœ¨è¢«"),t("strong",[s._v("åˆ¤æ­»åæ‰ä¼šè°ƒç”¨æ­¤æ–¹æ³•")]),s._v(", æ‰æœ‰æœºä¼šåšæœ€åçš„æ•‘èµ).")]),s._v(" "),t("li",[s._v("åœ¨ "),t("strong",[s._v("finalize()")]),s._v("  æ–¹æ³•ä¸­"),t("strong",[s._v('é‡æ–°å¼•ç”¨åˆ° "GC  Roots" é“¾')]),s._v("ä¸Š(å¦‚æŠŠå½“å‰å¯¹è±¡çš„å¼•ç”¨ this èµ‹å€¼ç»™æŸå¯¹è±¡çš„ç±»å˜é‡/æˆå‘˜å˜é‡, é‡æ–°å»ºç«‹å¯è¾¾çš„å¼•ç”¨).")])]),s._v(" "),t("blockquote",[t("p",[s._v("ä¸€æ¬¡å¯¹è±¡è‡ªæˆ‘æ‹¯æ•‘çš„ç¤ºä¾‹")])]),s._v(" "),t("p",[s._v("ä¸‹é¢çš„ä»£ç å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¯¹è±¡çš„ finalize() è¢«æ‰§è¡Œ, ä½†æ˜¯å®ƒä»ç„¶å¯ä»¥å­˜æ´».")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * æ­¤ä»£ç æ¼”ç¤ºäº†ä¸¤ç‚¹: \n * 1.å¯¹è±¡å¯ä»¥åœ¨è¢« GC æ—¶è‡ªæˆ‘æ‹¯æ•‘. \n * 2.è¿™ç§è‡ªæ•‘çš„æœºä¼šåªæœ‰ä¸€æ¬¡, å› ä¸ºä¸€ä¸ªå¯¹è±¡çš„ finalize()æ–¹æ³•æœ€å¤šåªä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FinalizeEscapeGC")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FinalizeEscapeGC")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SAVE_HOOK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isAlive")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes, i am still alive :)"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Override")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("finalize")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Throwable")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("super")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("finalize")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"finalize method executed!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FinalizeEscapeGC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SAVE_HOOK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Throwable")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SAVE_HOOK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FinalizeEscapeGC")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¯¹è±¡ç¬¬ä¸€æ¬¡æˆåŠŸæ‹¯æ•‘è‡ªå·±")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SAVE_HOOK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å› ä¸º Finalizer æ–¹æ³•ä¼˜å…ˆçº§å¾ˆä½, æš‚åœ0.5ç§’, ä»¥ç­‰å¾…å®ƒ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SAVE_HOOK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SAVE_HOOK")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isAlive")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no, i am dead :("')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¸‹é¢è¿™æ®µä»£ç ä¸ä¸Šé¢çš„å®Œå…¨ç›¸åŒ, ä½†æ˜¯è¿™æ¬¡è‡ªæ•‘å´å¤±è´¥äº†")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SAVE_HOOK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å› ä¸º Finalizer æ–¹æ³•ä¼˜å…ˆçº§å¾ˆä½, æš‚åœ0.5ç§’, ä»¥ç­‰å¾…å®ƒ")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Thread")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SAVE_HOOK")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SAVE_HOOK")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("isAlive")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no, i am dead :("')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br")])]),t("p",[s._v("è¿è¡Œç»“æœ:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("finalize method executed!\nyes, i am still alive :)\nno, i am dead :(\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("ä»ä»£ç è¿è¡Œç»“æœå¯ä»¥çœ‹åˆ°, SAVE_HOOK å¯¹è±¡çš„ finalize() æ–¹æ³•ç¡®å®è¢«åƒåœ¾æ”¶é›†å™¨è§¦å‘è¿‡, å¹¶ä¸”åœ¨è¢«æ”¶é›†å‰æˆåŠŸé€ƒè„±äº†.")]),s._v(" "),t("p",[s._v("å¦å¤–ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹å°±æ˜¯, ä»£ç ä¸­æœ‰ä¸¤æ®µå®Œå…¨ä¸€æ ·çš„ä»£ç ç‰‡æ®µ, æ‰§è¡Œç»“æœå´æ˜¯ä¸€æ¬¡é€ƒè„±æˆåŠŸ, ä¸€æ¬¡å¤±è´¥äº†. "),t("strong",[s._v("è¿™æ˜¯å› ä¸ºä»»ä½•ä¸€ä¸ªå¯¹è±¡çš„ finalize() æ–¹æ³•éƒ½åªä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡, å¦‚æœå¯¹è±¡é¢ä¸´ä¸‹ä¸€æ¬¡å›æ”¶, å®ƒçš„ finalize() æ–¹æ³•ä¸ä¼šè¢«å†æ¬¡æ‰§è¡Œ, å› æ­¤ç¬¬äºŒæ®µä»£ç çš„è‡ªæ•‘è¡ŒåŠ¨å¤±è´¥äº†")]),s._v(".")]),s._v(" "),t("p",[s._v("è¿˜æœ‰ä¸€ç‚¹éœ€è¦ç‰¹åˆ«è¯´æ˜, ä¸Šé¢å…³äºå¯¹è±¡æ­»äº¡æ—¶ finalize() æ–¹æ³•çš„æè¿°å¯èƒ½å¸¦ç‚¹æ‚²æƒ…çš„è‰ºæœ¯åŠ å·¥, è¿™é‡Œå¹¶ä¸é¼“åŠ±å¤§å®¶ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¥æ‹¯æ•‘å¯¹è±¡. ç›¸å, ç¬”è€…å»ºè®®å¤§å®¶"),t("strong",[s._v("å°½é‡é¿å…ä½¿ç”¨å®ƒ")]),s._v(", å› ä¸ºå®ƒçš„è¿è¡Œä»£ä»·é«˜æ˜‚, ä¸ç¡®å®šæ€§å¤§, "),t("strong",[s._v("æ— æ³•ä¿è¯å„ä¸ªå¯¹è±¡çš„è°ƒç”¨é¡ºåº")]),s._v(', å¦‚ä»Šå·²è¢«å®˜æ–¹æ˜ç¡®å£°æ˜ä¸ºä¸æ¨èä½¿ç”¨çš„è¯­æ³•. æœ‰äº›æ•™æä¸­æè¿°å®ƒé€‚åˆåš "å…³é—­å¤–éƒ¨èµ„æº" ä¹‹ç±»çš„æ¸…ç†æ€§å·¥ä½œ, è¿™å®Œå…¨æ˜¯å¯¹ finalize() æ–¹æ³•ç”¨é€”çš„ä¸€ç§è‡ªæˆ‘å®‰æ…°. '),t("strong",[s._v("finalize() èƒ½åšçš„æ‰€æœ‰å·¥ä½œ, ä½¿ç”¨ try-finally æˆ–è€…å…¶ä»–æ–¹å¼éƒ½å¯ä»¥åšå¾—æ›´å¥½, æ›´åŠæ—¶, æ‰€ä»¥å»ºè®®å¤§å®¶å®Œå…¨å¯ä»¥å¿˜æ‰ Java è¯­è¨€é‡Œé¢çš„è¿™ä¸ªæ–¹æ³•")]),s._v(".")]),s._v(" "),t("h4",{attrs:{id:"å¼•ç”¨ç±»å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¼•ç”¨ç±»å‹"}},[s._v("#")]),s._v(" å¼•ç”¨ç±»å‹")]),s._v(" "),t("p",[s._v('æ— è®ºæ˜¯é€šè¿‡å¼•ç”¨è®¡æ•°ç®—æ³•åˆ¤æ–­å¯¹è±¡çš„å¼•ç”¨æ•°é‡, è¿˜æ˜¯é€šè¿‡å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¼•ç”¨é“¾å¯è¾¾, åˆ¤å®šå¯¹è±¡æ˜¯å¦å­˜æ´»éƒ½å’Œ "'),t("strong",[s._v("å¼•ç”¨")]),s._v('" ç¦»ä¸å¼€å…³ç³». Java æä¾›äº†å››ç§å¼ºåº¦ä¸åŒçš„å¼•ç”¨ç±»å‹: '),t("strong",[s._v("å¼ºè½¯å¼±è™š")]),s._v("(å¼ºåº¦é€’å‡).")]),s._v(" "),t("h5",{attrs:{id:"_1-å¼•ç”¨ç±»å‹åˆ†ç±»"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å¼•ç”¨ç±»å‹åˆ†ç±»"}},[s._v("#")]),s._v(" 1.å¼•ç”¨ç±»å‹åˆ†ç±»")]),s._v(" "),t("blockquote",[t("p",[s._v("å¼ºå¼•ç”¨")])]),s._v(" "),t("p",[t("strong",[s._v("å¼ºå¼•ç”¨")]),s._v('æ˜¯æœ€ä¼ ç»Ÿçš„ "å¼•ç”¨" çš„å®šä¹‰, æ˜¯æŒ‡åœ¨ç¨‹åºä»£ç ä¹‹ä¸­æ™®éå­˜åœ¨çš„'),t("strong",[s._v("å¼•ç”¨èµ‹å€¼")]),s._v(".")]),s._v(" "),t("p",[s._v("æ— è®ºä»»ä½•æƒ…å†µä¸‹, "),t("strong",[s._v("åªè¦å¼ºå¼•ç”¨å…³ç³»è¿˜å­˜åœ¨, åƒåœ¾æ”¶é›†å™¨å°±æ°¸è¿œä¸ä¼šå›æ”¶æ‰è¢«å¼•ç”¨çš„å¯¹è±¡")]),s._v(". å½“å†…å­˜ç©ºé—´ä¸è¶³æ—¶, è™šæ‹Ÿæœº"),t("strong",[s._v("å®æ„¿")]),s._v("æŠ›å‡º OutOfMemoryError é”™è¯¯ä½¿ç¨‹åºå¼‚å¸¸ç»ˆæ­¢, ä¹Ÿ"),t("strong",[s._v("ä¸ä¼š")]),s._v("é éšæ„å›æ”¶å…·æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡æ¥è§£å†³å†…å­˜ä¸è¶³é—®é¢˜.")]),s._v(" "),t("p",[s._v("è¢«å¼ºå¼•ç”¨çš„å¯¹è±¡"),t("strong",[s._v("ä¸ä¼š")]),s._v("è¢«å›æ”¶. ä½¿ç”¨ new ä¸€ä¸ªæ–°å¯¹è±¡çš„æ–¹å¼æ¥åˆ›å»ºå¼ºå¼•ç”¨, æœ€æ™®é, ç±»ä¼¼"),t("strong",[s._v("ç”Ÿæ´»å¿…éœ€å“")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" obj "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("è½¯åº”ç”¨")])]),s._v(" "),t("p",[t("strong",[s._v("è½¯å¼•ç”¨")]),s._v("æ˜¯ç”¨æ¥æè¿°ä¸€äº›"),t("strong",[s._v("è¿˜æœ‰ç”¨, ä½†éå¿…é¡»çš„å¯¹è±¡")]),s._v(". è¢«"),t("strong",[s._v("è½¯å¼•ç”¨")]),s._v("å…³è”çš„å¯¹è±¡åªæœ‰åœ¨"),t("strong",[s._v("å†…å­˜ä¸å¤Ÿ")]),s._v("çš„æƒ…å†µä¸‹æ‰ä¼šè¢«å›æ”¶. æ­£å¸¸æƒ…å†µä¸ä¼šè¢«å›æ”¶, ä½†æ˜¯ "),t("strong",[s._v("GC åšå®Œ")]),s._v("åå‘ç°é‡Šæ”¾ä¸å‡ºç©ºé—´å­˜æ”¾æ–°çš„å¯¹è±¡, åˆ™ä¼šæŠŠè¿™äº›è½¯å¼•ç”¨çš„å¯¹è±¡å›æ”¶æ‰. å¦‚æœå†…å­˜è¶³å¤Ÿ, åƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶å®ƒ, å¦‚æœæ²¡æœ‰å›æ”¶, é‚£ä¹ˆå°±å¯ä»¥ç»§ç»­ä½¿ç”¨. "),t("strong",[s._v("ç±»ä¼¼å¯æœ‰å¯æ— çš„ç”Ÿæ´»ç”¨å“")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("è½¯å¼•ç”¨å¯ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜.")]),s._v("  æ¯”å¦‚å¯ä»¥ç”¨äºç¼“å­˜æµè§ˆå™¨çš„å†å²é¡µé¢å®ç°åé€€æŒ‰é’®.")]),s._v(" "),t("p",[s._v("ä½¿ç”¨ "),t("strong",[s._v("SoftReference")]),s._v(" ç±»æ¥åˆ›å»ºè½¯å¼•ç”¨.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" obj "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SoftReference")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" sf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("SoftReference")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("obj"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nobj "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä½¿å¯¹è±¡åªè¢«è½¯å¼•ç”¨å…³è”")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("blockquote",[t("p",[s._v("å¼±å¼•ç”¨")])]),s._v(" "),t("p",[t("strong",[s._v("å¼±å¼•ç”¨")]),s._v("ä¹Ÿæ˜¯ç”¨æ¥æè¿°é‚£äº›"),t("strong",[s._v("éå¿…é¡»å¯¹è±¡, ä½†æ˜¯å®ƒçš„å¼ºåº¦æ¯”è½¯å¼•ç”¨æ›´å¼±ä¸€äº›, è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡åªèƒ½ç”Ÿå­˜åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å‘ç”Ÿä¸ºæ­¢")]),s._v(". å½“åƒåœ¾æ”¶é›†å™¨å¼€å§‹å·¥ä½œ, æ— è®ºå½“å‰å†…å­˜æ˜¯å¦è¶³å¤Ÿ, éƒ½ä¼šå›æ”¶æ‰åªè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡.")]),s._v(" "),t("p",[s._v("ä½¿ç”¨ "),t("strong",[s._v("WeakReference")]),s._v(" ç±»æ¥åˆ›å»ºå¼±å¼•ç”¨.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" obj "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("WeakReference")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" wf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("WeakReference")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("obj"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nobj "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("blockquote",[t("p",[s._v("è™šå¼•ç”¨")])]),s._v(" "),t("p",[t("strong",[s._v("è™šå¼•ç”¨")]),s._v('ä¹Ÿç§°ä¸º "å¹½çµå¼•ç”¨" æˆ–è€… "å¹»å½±å¼•ç”¨", å®ƒæ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³». ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰è™šå¼•ç”¨çš„å­˜åœ¨, å®Œå…¨ä¸ä¼šå¯¹å…¶ç”Ÿå­˜æ—¶é—´æ„æˆå½±å“, ä¹Ÿ'),t("strong",[s._v("æ— æ³•")]),s._v("é€šè¿‡è™šå¼•ç”¨æ¥å–å¾—ä¸€ä¸ªå¯¹è±¡å®ä¾‹. "),t("strong",[s._v("ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„åªæ˜¯ä¸ºäº†èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥")]),s._v(".")]),s._v(" "),t("p",[s._v("ä½¿ç”¨ "),t("strong",[s._v("PhantomReference")]),s._v(" æ¥åˆ›å»ºè™šå¼•ç”¨.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" obj "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PhantomReference")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" pf "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PhantomReference")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("obj"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nobj "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h5",{attrs:{id:"_2-å¼•ç”¨é˜Ÿåˆ—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å¼•ç”¨é˜Ÿåˆ—"}},[s._v("#")]),s._v(" 2.å¼•ç”¨é˜Ÿåˆ—")]),s._v(" "),t("p",[t("strong",[s._v("è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨")]),s._v("éƒ½å¯ä»¥å’Œä¸€ä¸ª"),t("strong",[s._v("å¼•ç”¨é˜Ÿåˆ—")]),s._v("(ReferenceQueue) è”åˆä½¿ç”¨, å¦‚æœè½¯å¼•ç”¨æˆ–å¼±å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡"),t("strong",[s._v("è¢«åƒåœ¾å›æ”¶")]),s._v(", è™šæ‹Ÿæœºå°±ä¼šæŠŠè¿™ä¸ªè½¯å¼•ç”¨æˆ–å¼±å¼•ç”¨åŠ å…¥åˆ°"),t("strong",[s._v("ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­")]),s._v(". è™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—(ReferenceQueue) è”åˆä½¿ç”¨. å½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶, å¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨, å°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰, æŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­. ç¨‹åºå¯ä»¥é€šè¿‡åˆ¤æ–­å¼•ç”¨é˜Ÿåˆ—ä¸­æ˜¯å¦å·²ç»åŠ å…¥äº†è™šå¼•ç”¨, æ¥äº†è§£è¢«å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦å°†è¦è¢«åƒåœ¾å›æ”¶. ç¨‹åºå¦‚æœå‘ç°æŸä¸ªè™šå¼•ç”¨å·²ç»è¢«åŠ å…¥åˆ°å¼•ç”¨é˜Ÿåˆ—, é‚£ä¹ˆå°±å¯ä»¥åœ¨æ‰€å¼•ç”¨çš„å¯¹è±¡çš„å†…å­˜è¢«å›æ”¶ä¹‹å‰é‡‡å–å¿…è¦çš„è¡ŒåŠ¨.")]),s._v(" "),t("h4",{attrs:{id:"å›æ”¶æ–¹æ³•åŒº"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å›æ”¶æ–¹æ³•åŒº"}},[s._v("#")]),s._v(" å›æ”¶æ–¹æ³•åŒº")]),s._v(" "),t("p",[s._v("æœ‰äº›äººè®¤ä¸º"),t("strong",[s._v("æ–¹æ³•åŒº")]),s._v("(å¦‚ HotSpot è™šæ‹Ÿæœºä¸­çš„å…ƒç©ºé—´æˆ–è€…æ°¸ä¹…ä»£)æ˜¯æ²¡æœ‰åƒåœ¾æ”¶é›†è¡Œä¸ºçš„, ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹ä¸­æåˆ°è¿‡"),t("strong",[s._v("å¯ä»¥ä¸è¦æ±‚è™šæ‹Ÿæœºåœ¨æ–¹æ³•åŒºä¸­å®ç°åƒåœ¾æ”¶é›†")]),s._v(", äº‹å®ä¸Šä¹Ÿç¡®å®æœ‰æœªå®ç°æˆ–æœªèƒ½å®Œæ•´å®ç°æ–¹æ³•åŒºç±»å‹å¸è½½çš„æ”¶é›†å™¨å­˜åœ¨(å¦‚ ZGC æ”¶é›†å™¨å°±ä¸æ”¯æŒç±»å¸è½½), "),t("strong",[s._v('æ–¹æ³•åŒºåƒåœ¾æ”¶é›†çš„ "æ€§ä»·æ¯”" é€šå¸¸ä¹Ÿæ˜¯æ¯”è¾ƒä½çš„')]),s._v(": åœ¨ Java å †ä¸­, å°¤å…¶æ˜¯åœ¨æ–°ç”Ÿä»£ä¸­, å¯¹å¸¸è§„åº”ç”¨è¿›è¡Œä¸€æ¬¡åƒåœ¾æ”¶é›†é€šå¸¸å¯ä»¥å›æ”¶ 70% è‡³ 99% çš„å†…å­˜ç©ºé—´, ç›¸æ¯”ä¹‹ä¸‹, æ–¹æ³•åŒºå›æ”¶å›¿äº"),t("strong",[s._v("è‹›åˆ»çš„åˆ¤å®šæ¡ä»¶")]),s._v(", å…¶åŒºåŸŸåƒåœ¾æ”¶é›†çš„å›æ”¶æˆæœå¾€å¾€è¿œä½äºæ­¤.")]),s._v(" "),t("p",[s._v("ä½†æ˜¯ä¸ºäº†é¿å…å†…å­˜æº¢å‡º, "),t("strong",[s._v("åœ¨å¤§é‡ä½¿ç”¨åå°„, åŠ¨æ€ä»£ç†, CGLib ç­‰å­—èŠ‚ç æ¡†æ¶, åŠ¨æ€ç”Ÿæˆ JSP ä»¥åŠ OSGi è¿™ç±»é¢‘ç¹è‡ªå®šä¹‰ç±»åŠ è½½å™¨çš„åœºæ™¯ä¸­, é€šå¸¸éƒ½éœ€è¦ Java è™šæ‹Ÿæœºå…·å¤‡ç±»å‹å¸è½½çš„èƒ½åŠ›, ä»¥ä¿è¯ä¸ä¼šå¯¹æ–¹æ³•åŒºé€ æˆè¿‡å¤§çš„å†…å­˜å‹åŠ›")]),s._v(".")]),s._v(" "),t("p",[s._v("æ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†ä¸»è¦å›æ”¶ä¸¤éƒ¨åˆ†å†…å®¹: "),t("mark",[t("strong",[s._v("åºŸå¼ƒçš„å¸¸é‡å’Œä¸å†ä½¿ç”¨çš„ç±»å‹")])]),s._v(".")]),s._v(" "),t("blockquote",[t("p",[s._v("å¦‚ä½•åˆ¤æ–­å¸¸é‡æ˜¯åºŸå¼ƒçš„å¸¸é‡?")])]),s._v(" "),t("p",[s._v('å›æ”¶åºŸå¼ƒå¸¸é‡ä¸å›æ”¶ Java å †ä¸­çš„å¯¹è±¡éå¸¸ç±»ä¼¼. ä¸¾ä¸ªå¸¸é‡æ± ä¸­å­—é¢é‡å›æ”¶çš„ä¾‹å­, å‡å¦‚ä¸€ä¸ªå­—ç¬¦ä¸² "java" æ›¾ç»è¿›å…¥å¸¸é‡æ± ä¸­, ä½†æ˜¯å½“å‰ç³»ç»Ÿåˆæ²¡æœ‰ä»»ä½•ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡çš„å€¼æ˜¯ "java", æ¢å¥è¯è¯´, '),t("strong",[s._v('å·²ç»æ²¡æœ‰ä»»ä½•å­—ç¬¦ä¸²å¯¹è±¡å¼•ç”¨å¸¸é‡æ± ä¸­çš„ "java" å¸¸é‡, ä¸”è™šæ‹Ÿæœºä¸­ä¹Ÿæ²¡æœ‰å…¶ä»–åœ°æ–¹å¼•ç”¨è¿™ä¸ªå­—é¢é‡')]),s._v('. å¦‚æœåœ¨è¿™æ—¶å‘ç”Ÿå†…å­˜å›æ”¶, è€Œä¸”åƒåœ¾æ”¶é›†å™¨åˆ¤æ–­ç¡®æœ‰å¿…è¦çš„è¯, è¿™ä¸ª "java" å¸¸é‡å°±å°†ä¼šè¢«ç³»ç»Ÿæ¸…ç†å‡ºå¸¸é‡æ± . å¸¸é‡æ± ä¸­å…¶ä»–ç±»(æ¥å£), æ–¹æ³•, å­—æ®µçš„ç¬¦å·å¼•ç”¨ä¹Ÿä¸æ­¤ç±»ä¼¼.')]),s._v(" "),t("blockquote",[t("p",[s._v("å¦‚ä½•åˆ¤æ–­ç±»æ˜¯æ— ç”¨çš„ç±»?")])]),s._v(" "),t("p",[s._v('åˆ¤å®šä¸€ä¸ªå¸¸é‡æ˜¯å¦ "åºŸå¼ƒ" è¿˜æ˜¯ç›¸å¯¹ç®€å•, è€Œè¦'),t("strong",[s._v('åˆ¤å®šä¸€ä¸ªç±»å‹æ˜¯å¦å±äº "ä¸å†è¢«ä½¿ç”¨çš„ç±»" çš„æ¡ä»¶å°±æ¯”è¾ƒè‹›åˆ»')]),s._v("äº†.")]),s._v(" "),t("p",[s._v("éœ€è¦åŒæ—¶æ»¡è¶³ä¸‹é¢ä¸‰ä¸ªæ¡ä»¶:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶")]),s._v(", ä¹Ÿå°±æ˜¯ Java å †ä¸­ä¸å­˜åœ¨è¯¥ç±»åŠå…¶ä»»ä½•æ´¾ç”Ÿå­ç±»çš„å®ä¾‹.")]),s._v(" "),t("li",[t("strong",[s._v("åŠ è½½è¯¥ç±»çš„ç±»åŠ è½½å™¨å·²ç»è¢«å›æ”¶")]),s._v(", è¿™ä¸ªæ¡ä»¶é™¤éæ˜¯ç»è¿‡ç²¾å¿ƒè®¾è®¡çš„å¯æ›¿æ¢ç±»åŠ è½½å™¨çš„åœºæ™¯, å¦‚ OSGi, JSP çš„é‡åŠ è½½ç­‰, å¦åˆ™é€šå¸¸æ˜¯å¾ˆéš¾è¾¾æˆçš„.")]),s._v(" "),t("li",[t("strong",[s._v("è¯¥ç±»å¯¹åº”çš„ java.lang.Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨")]),s._v(", æ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•.")])]),s._v(" "),t("p",[s._v('Java è™šæ‹Ÿæœºè¢«å…è®¸å¯¹æ»¡è¶³ä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶çš„æ— ç”¨ç±»è¿›è¡Œå›æ”¶, è¿™é‡Œè¯´çš„ä»…ä»…æ˜¯ "è¢«å…è®¸", è€Œå¹¶ä¸æ˜¯å’Œå¯¹è±¡ä¸€æ ·, æ²¡æœ‰å¼•ç”¨äº†å°±å¿…ç„¶ä¼šå›æ”¶. å…³äºæ˜¯å¦è¦å¯¹ç±»å‹è¿›è¡Œå›æ”¶, HotSpot è™šæ‹Ÿæœºæä¾›äº† '),t("code",[s._v("-Xnoclassgc")]),s._v("â€‹ å‚æ•°è¿›è¡Œæ§åˆ¶, è¿˜å¯ä»¥ä½¿ç”¨ "),t("code",[s._v("-verbose: class")]),s._v("â€‹ ä»¥åŠ "),t("code",[s._v("-XX: +TraceClass-Loading, -XX: +TraceClassUnLoading")]),s._v("â€‹ æŸ¥çœ‹ç±»åŠ è½½å’Œå¸è½½ä¿¡æ¯.")]),s._v(" "),t("h4",{attrs:{id:"åƒåœ¾æ”¶é›†ç®—æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åƒåœ¾æ”¶é›†ç®—æ³•"}},[s._v("#")]),s._v(" åƒåœ¾æ”¶é›†ç®—æ³•")]),s._v(" "),t("p",[s._v("åƒåœ¾æ”¶é›†ç®—æ³•çš„å®ç°æ¶‰åŠå¤§é‡çš„ç¨‹åºç»†èŠ‚, ä¸”å„ä¸ªå¹³å°çš„è™šæ‹Ÿæœºæ“ä½œå†…å­˜çš„æ–¹æ³•éƒ½æœ‰å·®å¼‚, åœ¨æœ¬èŠ‚ä¸­æš‚ä¸è¿‡å¤šè®¨è®ºç®—æ³•å®ç°, åªé‡ç‚¹ä»‹ç»"),t("strong",[s._v("åˆ†ä»£æ”¶é›†ç†è®ºå’Œå‡ ç§ç®—æ³•æ€æƒ³åŠå…¶å‘å±•è¿‡ç¨‹")]),s._v(".")]),s._v(" "),t("p",[s._v("ä¸»è¦ä»‹ç»å››ç§ç®—æ³•. å››ç§ç®—æ³•å¯ä»¥åº”ç”¨åœ¨ä¸åŒçš„åŒºåŸŸåŠåœºåˆ.")]),s._v(" "),t("h5",{attrs:{id:"_1-åˆ†ä»£æ”¶é›†ç†è®º"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-åˆ†ä»£æ”¶é›†ç†è®º"}},[s._v("#")]),s._v(" 1.åˆ†ä»£æ”¶é›†ç†è®º")]),s._v(" "),t("h6",{attrs:{id:"_1-åˆ†ä»£æ”¶é›†ç†è®ºåŸºç¡€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-åˆ†ä»£æ”¶é›†ç†è®ºåŸºç¡€"}},[s._v("#")]),s._v(" (1)åˆ†ä»£æ”¶é›†ç†è®ºåŸºç¡€")]),s._v(" "),t("p",[s._v('å½“å‰å•†ä¸šè™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†å™¨, å¤§å¤šæ•°éƒ½éµå¾ªäº† "'),t("mark",[t("strong",[s._v("åˆ†ä»£æ”¶é›†")])]),s._v('"(Generational Collection) çš„ç†è®ºè¿›è¡Œè®¾è®¡, '),t("strong",[s._v("åˆ†ä»£æ”¶é›†åä¸ºç†è®º, å®è´¨æ˜¯ä¸€å¥—ç¬¦åˆå¤§å¤šæ•°ç¨‹åºè¿è¡Œå®é™…æƒ…å†µçš„ç»éªŒæ³•åˆ™")]),s._v(", å®ƒå»ºç«‹åœ¨ä¸¤ä¸ªåˆ†ä»£å‡è¯´ä¹‹ä¸Š:")]),s._v(" "),t("p",[s._v("(1)"),t("strong",[s._v("å¼±åˆ†ä»£å‡è¯´")]),s._v("(Weak Generational Hypothesis): "),t("strong",[s._v("ç»å¤§å¤šæ•°å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•ç­çš„")]),s._v(".")]),s._v(" "),t("p",[s._v("(2)"),t("strong",[s._v("å¼ºåˆ†ä»£å‡è¯´")]),s._v("(Strong Generational Hypothesis): "),t("strong",[s._v("ç†¬è¿‡è¶Šå¤šæ¬¡åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„å¯¹è±¡å°±è¶Šéš¾ä»¥æ¶ˆäº¡")]),s._v(".")]),s._v(" "),t("p",[s._v("è¿™ä¸¤ä¸ªåˆ†ä»£å‡è¯´å…±åŒå¥ å®šäº†å¤šæ¬¾å¸¸ç”¨çš„åƒåœ¾æ”¶é›†å™¨çš„ä¸€è‡´çš„è®¾è®¡åŸåˆ™: "),t("mark",[t("strong",[s._v("æ”¶é›†å™¨åº”è¯¥å°† Java å †åˆ’åˆ†å‡ºä¸åŒçš„åŒºåŸŸ, ç„¶åå°†å›æ”¶å¯¹è±¡ä¾æ®å…¶å¹´é¾„(å¹´é¾„å³å¯¹è±¡ç†¬è¿‡åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„æ¬¡æ•°)åˆ†é…åˆ°ä¸åŒçš„åŒºåŸŸä¹‹ä¸­å­˜å‚¨")])]),s._v(". æ˜¾è€Œæ˜“è§, å¦‚æœä¸€ä¸ªåŒºåŸŸä¸­å¤§å¤šæ•°å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•ç­, éš¾ä»¥ç†¬è¿‡åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„è¯, é‚£ä¹ˆæŠŠå®ƒä»¬é›†ä¸­æ”¾åœ¨ä¸€èµ·, æ¯æ¬¡å›æ”¶æ—¶åªå…³æ³¨å¦‚ä½•ä¿ç•™å°‘é‡å­˜æ´»è€Œä¸æ˜¯å»æ ‡è®°é‚£äº›å¤§é‡å°†è¦è¢«å›æ”¶çš„å¯¹è±¡, å°±èƒ½ä»¥è¾ƒä½ä»£ä»·å›æ”¶åˆ°å¤§é‡çš„ç©ºé—´; å¦‚æœå‰©ä¸‹çš„éƒ½æ˜¯éš¾ä»¥æ¶ˆäº¡çš„å¯¹è±¡, é‚£æŠŠå®ƒä»¬é›†ä¸­æ”¾åœ¨ä¸€å—, è™šæ‹Ÿæœºä¾¿å¯ä»¥ä½¿ç”¨è¾ƒä½çš„é¢‘ç‡æ¥å›æ”¶è¿™ä¸ªåŒºåŸŸ, è¿™å°±åŒæ—¶å…¼é¡¾äº†åƒåœ¾æ”¶é›†çš„æ—¶é—´å¼€é”€å’Œå†…å­˜çš„ç©ºé—´æœ‰æ•ˆåˆ©ç”¨.")]),s._v(" "),t("p",[s._v("åœ¨ Java å †åˆ’åˆ†å‡ºä¸åŒçš„åŒºåŸŸä¹‹å, "),t("strong",[s._v('åƒåœ¾æ”¶é›†å™¨æ‰å¯ä»¥æ¯æ¬¡åªå›æ”¶å…¶ä¸­æŸä¸€ä¸ªæˆ–è€…æŸäº›éƒ¨åˆ†çš„åŒºåŸŸâ€”â€”å› è€Œæ‰æœ‰äº† "Minor GC", "Major GC", "Full GC" è¿™æ ·çš„å›æ”¶ç±»å‹çš„åˆ’åˆ†')]),s._v("; ä¹Ÿæ‰èƒ½å¤Ÿé’ˆå¯¹ä¸åŒçš„åŒºåŸŸå®‰æ’ä¸é‡Œé¢å­˜å‚¨å¯¹è±¡å­˜äº¡ç‰¹å¾ç›¸åŒ¹é…çš„åƒåœ¾æ”¶é›†ç®—æ³•, å› è€Œå‘å±•å‡ºäº†  "),t("strong",[s._v('"æ ‡è®°-å¤åˆ¶ç®—æ³•", "æ ‡è®°-æ¸…é™¤ç®—æ³•", "æ ‡è®°-æ•´ç†ç®—æ³•"')]),s._v("  ç­‰é’ˆå¯¹æ€§çš„åƒåœ¾æ”¶é›†ç®—æ³•. ç°åœ¨åªéœ€è¦çŸ¥é“, "),t("strong",[s._v("è¿™ä¸€åˆ‡çš„å‡ºç°éƒ½å§‹äºåˆ†ä»£æ”¶é›†ç†è®º")]),s._v(".")]),s._v(" "),t("p",[s._v("æŠŠåˆ†ä»£æ”¶é›†ç†è®ºå…·ä½“æ”¾åˆ°ç°åœ¨çš„å•†ç”¨ Java è™šæ‹Ÿæœºé‡Œ, è®¾è®¡è€…ä¸€èˆ¬è‡³å°‘ä¼šæŠŠ Java å †åˆ’åˆ†ä¸º"),t("strong",[s._v("æ–°ç”Ÿä»£")]),s._v("(Young Generation)å’Œ"),t("strong",[s._v("è€å¹´ä»£")]),s._v("(Old Generation)ä¸¤ä¸ªåŒºåŸŸ. é¡¾åæ€ä¹‰, "),t("strong",[s._v("åœ¨æ–°ç”Ÿä»£ä¸­, æ¯æ¬¡åƒåœ¾æ”¶é›†æ—¶éƒ½å‘ç°æœ‰å¤§æ‰¹å¯¹è±¡æ­»å», è€Œæ¯æ¬¡å›æ”¶åå­˜æ´»çš„å°‘é‡å¯¹è±¡, å°†ä¼šé€æ­¥æ™‹å‡åˆ°è€å¹´ä»£ä¸­å­˜æ”¾")]),s._v('. HotSpot è™šæ‹Ÿæœºæºç é‡Œé¢å­˜åœ¨ç€ä¸€äº›åä¸º "*Generation" çš„å®ç°, å¦‚ "DefNewGeneration" å’Œ "ParNewGeneration" ç­‰, è¿™äº›å°±æ˜¯ HotSpot çš„ "åˆ†ä»£å¼åƒåœ¾æ”¶é›†å™¨æ¡†æ¶". åŸæœ¬ HotSpot é¼“åŠ±å¼€å‘è€…å°½é‡åœ¨è¿™ä¸ªæ¡†æ¶å†…å¼€å‘æ–°çš„åƒåœ¾æ”¶é›†å™¨, ä½†é™¤äº†æœ€æ—©æœŸçš„ä¸¤ç»„å››æ¬¾æ”¶é›†å™¨ä¹‹å¤–, åæ¥çš„å¼€å‘è€…å¹¶æ²¡æœ‰ç»§ç»­éµå¾ª. å¯¼è‡´æ­¤äº‹çš„åŸå› æœ‰å¾ˆå¤š, æœ€æ ¹æœ¬çš„æ˜¯åˆ†ä»£æ”¶é›†ç†è®ºä»åœ¨ä¸æ–­å‘å±•ä¹‹ä¸­, å¦‚ä½•å®ç°ä¹Ÿæœ‰è®¸å¤šç»†èŠ‚å¯ä»¥æ”¹è¿›, è¢«æ—¢å®šçš„ä»£ç æ¡†æ¶çº¦æŸåè€Œä¸ä¾¿. å…¶å®åªè¦ä»”ç»†æ€è€ƒä¸€ä¸‹, ä¹Ÿå¾ˆå®¹æ˜“å‘ç°åˆ†ä»£æ”¶é›†å¹¶éåªæ˜¯ç®€å•åˆ’åˆ†ä¸€ä¸‹å†…å­˜åŒºåŸŸé‚£ä¹ˆå®¹æ˜“, å®ƒè‡³å°‘å­˜åœ¨ä¸€ä¸ªæ˜æ˜¾çš„å›°éš¾: '),t("strong",[s._v("å¯¹è±¡ä¸æ˜¯å­¤ç«‹çš„, å¯¹è±¡ä¹‹é—´ä¼šå­˜åœ¨è·¨ä»£å¼•ç”¨")]),s._v(".")]),s._v(" "),t("p",[s._v("å‡å¦‚è¦ç°åœ¨è¿›è¡Œä¸€æ¬¡åªå±€é™äºæ–°ç”Ÿä»£åŒºåŸŸå†…çš„æ”¶é›†(Minor GC), ä½†æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡æ˜¯å®Œå…¨æœ‰å¯èƒ½è¢«è€å¹´ä»£æ‰€å¼•ç”¨çš„, ä¸ºäº†æ‰¾å‡ºè¯¥åŒºåŸŸä¸­çš„å­˜æ´»å¯¹è±¡, ä¸å¾—ä¸åœ¨å›ºå®šçš„ GC Roots ä¹‹å¤–, å†é¢å¤–éå†æ•´ä¸ªè€å¹´ä»£ä¸­æ‰€æœ‰å¯¹è±¡æ¥ç¡®ä¿å¯è¾¾æ€§åˆ†æç»“æœçš„æ­£ç¡®æ€§, åè¿‡æ¥ä¹Ÿæ˜¯ä¸€æ ·. éå†æ•´ä¸ªè€å¹´ä»£æ‰€æœ‰å¯¹è±¡çš„æ–¹æ¡ˆè™½ç„¶ç†è®ºä¸Šå¯è¡Œ, ä½†æ— ç–‘ä¼šä¸ºå†…å­˜å›æ”¶å¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½è´Ÿæ‹…. ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, å°±éœ€è¦å¯¹åˆ†ä»£æ”¶é›†ç†è®ºæ·»åŠ "),t("strong",[s._v("ç¬¬ä¸‰æ¡ç»éªŒæ³•åˆ™")]),s._v(":")]),s._v(" "),t("p",[s._v("(3)"),t("strong",[s._v("è·¨ä»£å¼•ç”¨å‡è¯´")]),s._v("(Intergenerational Reference Hypothesis): "),t("strong",[s._v("è·¨ä»£å¼•ç”¨ç›¸å¯¹äºåŒä»£å¼•ç”¨æ¥è¯´ä»…å æå°‘æ•°")]),s._v(".")]),s._v(" "),t("p",[s._v("è¿™å…¶å®æ˜¯å¯æ ¹æ®å‰ä¸¤æ¡å‡è¯´é€»è¾‘æ¨ç†å¾—å‡ºçš„éšå«æ¨è®º: "),t("strong",[s._v("å­˜åœ¨äº’ç›¸å¼•ç”¨å…³ç³»çš„ä¸¤ä¸ªå¯¹è±¡, æ˜¯åº”è¯¥å€¾å‘äºåŒæ—¶ç”Ÿå­˜æˆ–è€…åŒæ—¶æ¶ˆäº¡çš„")]),s._v(". ä¸¾ä¸ªä¾‹å­, å¦‚æœæŸä¸ªæ–°ç”Ÿä»£å¯¹è±¡å­˜åœ¨è·¨ä»£å¼•ç”¨, ç”±äºè€å¹´ä»£å¯¹è±¡éš¾ä»¥æ¶ˆäº¡, è¯¥å¼•ç”¨ä¼šä½¿å¾—æ–°ç”Ÿä»£å¯¹è±¡åœ¨æ”¶é›†æ—¶åŒæ ·å¾—ä»¥å­˜æ´», è¿›è€Œåœ¨å¹´é¾„å¢é•¿ä¹‹åæ™‹å‡åˆ°è€å¹´ä»£ä¸­, è¿™æ—¶è·¨ä»£å¼•ç”¨ä¹Ÿéšå³è¢«æ¶ˆé™¤äº†.")]),s._v(" "),t("p",[s._v("ä¾æ®è¿™æ¡å‡è¯´, å°±"),t("strong",[s._v("ä¸åº”å†ä¸ºäº†å°‘é‡çš„è·¨ä»£å¼•ç”¨å»æ‰«ææ•´ä¸ªè€å¹´ä»£")]),s._v(", ä¹Ÿä¸å¿…æµªè´¹ç©ºé—´ä¸“é—¨è®°å½•æ¯ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å­˜åœ¨åŠå­˜åœ¨å“ªäº›è·¨ä»£å¼•ç”¨, åªéœ€åœ¨æ–°ç”Ÿä»£ä¸Šå»ºç«‹ä¸€ä¸ª"),t("strong",[s._v("å…¨å±€çš„æ•°æ®ç»“æ„")]),s._v('(è¯¥ç»“æ„è¢«ç§°ä¸º "'),t("strong",[s._v("è®°å¿†é›†")]),s._v('", Remembered Set, å‚è€ƒ: è®°å¿†é›†ä¸å¡è¡¨), è¿™ä¸ªç»“æ„æŠŠè€å¹´ä»£åˆ’åˆ†æˆè‹¥å¹²å°å—, '),t("strong",[s._v("æ ‡è¯†å‡ºè€å¹´ä»£çš„å“ªä¸€å—å†…å­˜ä¼šå­˜åœ¨è·¨ä»£å¼•ç”¨")]),s._v(". æ­¤åå½“å‘ç”Ÿ Minor GC æ—¶, åªæœ‰åŒ…å«äº†è·¨ä»£å¼•ç”¨çš„å°å—å†…å­˜é‡Œçš„å¯¹è±¡æ‰ä¼šè¢«åŠ å…¥åˆ° GC Roots è¿›è¡Œæ‰«æ. è™½ç„¶è¿™ç§æ–¹æ³•éœ€è¦åœ¨å¯¹è±¡æ”¹å˜å¼•ç”¨å…³ç³»(å¦‚å°†è‡ªå·±æˆ–è€…æŸä¸ªå±æ€§èµ‹å€¼)æ—¶ç»´æŠ¤è®°å½•æ•°æ®çš„æ­£ç¡®æ€§, ä¼šå¢åŠ ä¸€äº›è¿è¡Œæ—¶çš„å¼€é”€, ä½†æ¯”èµ·æ”¶é›†æ—¶æ‰«ææ•´ä¸ªè€å¹´ä»£æ¥è¯´ä»ç„¶æ˜¯åˆ’ç®—çš„.")]),s._v(" "),t("h6",{attrs:{id:"_2-åŸºäºåˆ†ä»£æ”¶é›†çš„å †åŸºæœ¬ç»“æ„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-åŸºäºåˆ†ä»£æ”¶é›†çš„å †åŸºæœ¬ç»“æ„"}},[s._v("#")]),s._v(" (2)åŸºäºåˆ†ä»£æ”¶é›†çš„å †åŸºæœ¬ç»“æ„")]),s._v(" "),t("p",[s._v("Hotspot çš„å¾ˆå¤šè™šæ‹Ÿæœºéƒ½é‡‡ç”¨"),t("strong",[s._v("åˆ†ä»£åƒåœ¾æ”¶é›†ç®—æ³•")]),s._v(". æ‰€ä»¥å †è¿˜å¯ä»¥ç»†åˆ†ä¸º: "),t("strong",[s._v("æ–°ç”Ÿä»£å’Œè€å¹´ä»£")]),s._v(". å†ç»†è‡´ä¸€ç‚¹åˆ†çš„è¯åˆ†æˆ: Eden ç©ºé—´, From Survivor, To Survivor ç©ºé—´ç­‰. "),t("strong",[s._v("è¿›ä¸€æ­¥åˆ’åˆ†çš„ç›®çš„æ˜¯æ›´å¥½åœ°å›æ”¶å†…å­˜, æˆ–è€…æ›´å¿«åœ°åˆ†é…å†…å­˜")]),s._v(".")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220517230027658.png",alt:""}})]),s._v(" "),t("p",[s._v('ç»è¿‡ä¸€æ¬¡ GC å, Eden åŒºå’Œ "From" åŒºå·²ç»è¢«'),t("strong",[s._v("æ¸…ç©º")]),s._v('. è¿™ä¸ªæ—¶å€™, "From" å’Œ "To" ä¼š'),t("strong",[s._v("äº¤æ¢")]),s._v('ä»–ä»¬çš„è§’è‰²(å¤åˆ¶), ä¹Ÿå°±æ˜¯æ–°çš„ "To" å°±æ˜¯ä¸Šæ¬¡ GC å‰çš„ "From", æ–°çš„ "From" å°±æ˜¯ä¸Šæ¬¡ GC å‰çš„ "To".')]),s._v(" "),t("p",[s._v("ä¸ç®¡æ€æ ·, éƒ½ä¼šä¿è¯åä¸º "),t("strong",[s._v("To")]),s._v(" çš„ Survivor åŒºåŸŸæ˜¯"),t("strong",[s._v("ç©ºçš„")]),s._v('. Minor GC ä¼šä¸€ç›´é‡å¤è¿™æ ·çš„è¿‡ç¨‹, ç›´åˆ° "To" åŒºè¢«å¡«æ»¡, "To" åŒºè¢«å¡«æ»¡ä¹‹å, ä¼šå°†æ‰€æœ‰å¯¹è±¡ç§»åŠ¨åˆ°'),t("strong",[s._v("è€å¹´ä»£")]),s._v("ä¸­. è¿™ä¸¤ä¸ªåŒºä¸€æ¬¡"),t("strong",[s._v("åªç”¨ä¸€ä¸ª")]),s._v(", Minor GC æ—¶é‡‡ç”¨"),t("strong",[s._v("å¤åˆ¶ç®—æ³•")]),s._v("å°† Eden åŒºå’Œä¸€ä¸ª Survivor åŒºçš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ª Survivor åŒºä¸­. å› æ­¤åœ¨æ–°ç”Ÿä»£ä¸­åƒåœ¾å›æ”¶ç®—æ³•å¤šä¸º"),t("strong",[s._v("å¤åˆ¶ç®—æ³•")]),s._v(".")]),s._v(" "),t("p",[s._v("éœ€è¦æ³¨æ„, "),t("strong",[s._v("ä¸æ˜¯æ‰€æœ‰çš„åƒåœ¾æ”¶é›†å™¨éƒ½æ˜¯è¿™æ ·åˆ’åˆ†çš„, æ¯”å¦‚ ZGC æ”¶é›†å™¨, ç›®å‰å°±æ²¡æœ‰åˆ†ä»£æ”¶é›†çš„æ¦‚å¿µ, æ‰€ä»¥è‡ªç„¶ä¸ä¼šè¿™æ ·åˆ’åˆ†å †å†…å­˜")]),s._v(".")]),s._v(" "),t("h6",{attrs:{id:"_3-minor-gcä¸full-gc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-minor-gcä¸full-gc"}},[s._v("#")]),s._v(" (3)Minor GCä¸Full GC")]),s._v(" "),t("blockquote",[t("p",[s._v("åè¯å®šä¹‰")])]),s._v(" "),t("p",[s._v('åˆšæ‰å·²ç»æåˆ°äº† "Minor GC", åç»­æ–‡ä¸­è¿˜ä¼šå‡ºç°å…¶ä»–é’ˆå¯¹ä¸åŒåˆ†ä»£çš„ç±»ä¼¼åè¯, ä¸ºé¿å…è¯»è€…äº§ç”Ÿæ··æ·†, åœ¨è¿™é‡Œç»Ÿä¸€å®šä¹‰:')]),s._v(" "),t("p",[s._v("(1) "),t("strong",[s._v("éƒ¨åˆ†æ”¶é›†(Partial GC)")]),s._v(" : æŒ‡ç›®æ ‡ä¸æ˜¯å®Œæ•´æ”¶é›†æ•´ä¸ª Java å †çš„åƒåœ¾æ”¶é›†, å…¶ä¸­åˆåˆ†ä¸º:")]),s._v(" "),t("ul",[t("li",[t("mark",[t("strong",[s._v("æ–°ç”Ÿä»£æ”¶é›†(Minor GC/Young GC)")])]),s._v(" : æŒ‡ç›®æ ‡åªæ˜¯æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†.")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("è€å¹´ä»£æ”¶é›†(Major GC/Old GC)")])]),s._v(" : æŒ‡ç›®æ ‡åªæ˜¯è€å¹´ä»£çš„åƒåœ¾æ”¶é›†. ç›®å‰åªæœ‰ CMS æ”¶é›†å™¨ä¼šæœ‰å•ç‹¬æ”¶é›†è€å¹´ä»£çš„è¡Œä¸º.")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("æ··åˆæ”¶é›†(Mixed GC)")])]),s._v(" : æŒ‡ç›®æ ‡æ˜¯æ”¶é›†æ•´ä¸ªæ–°ç”Ÿä»£ä»¥åŠéƒ¨åˆ†è€å¹´ä»£çš„åƒåœ¾æ”¶é›†. ç›®å‰åªæœ‰ G1 æ”¶é›†å™¨ä¼šæœ‰è¿™ç§è¡Œä¸º.")])]),s._v(" "),t("p",[s._v("(2) "),t("strong",[s._v("æ•´å †æ”¶é›†(Full GC)")]),s._v(" : æ”¶é›†æ•´ä¸ª Java å †(è€å¹´ä»£ + å¹´è½»ä»£)å’Œæ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†.")]),s._v(" "),t("blockquote",[t("p",[s._v("Minor GCè§¦å‘æ¡ä»¶")])]),s._v(" "),t("p",[s._v("Minor GC å‘ç”Ÿåœ¨"),t("strong",[s._v("æ–°ç”Ÿä»£")]),s._v("ä¸Š, å› ä¸ºæ–°ç”Ÿä»£å¯¹è±¡å­˜æ´»æ—¶é—´å¾ˆçŸ­, å› æ­¤ Minor GC ä¼š"),t("strong",[s._v("é¢‘ç¹")]),s._v("æ‰§è¡Œ, æ‰§è¡Œé€Ÿåº¦ä¸€èˆ¬æ¯”è¾ƒå¿«.")]),s._v(" "),t("p",[t("strong",[s._v("Eden åŒºæ»¡äº†")]),s._v("å°±è§¦å‘äº† Minor GC.")]),s._v(" "),t("ul",[t("li",[s._v("æ–°ç”Ÿä»£ä¸­çš„åƒåœ¾æ”¶é›†åŠ¨ä½œ, é‡‡ç”¨çš„æ˜¯"),t("strong",[s._v("å¤åˆ¶ç®—æ³•")]),s._v(".")]),s._v(" "),t("li",[s._v("å¯¹äºè¾ƒå¤§çš„å¯¹è±¡, åœ¨ Minor GC çš„æ—¶å€™å¯ä»¥ç›´æ¥è¿›å…¥"),t("strong",[s._v("è€å¹´ä»£")]),s._v(".")])]),s._v(" "),t("blockquote",[t("p",[s._v("Full GCè§¦å‘æ¡ä»¶")])]),s._v(" "),t("p",[s._v("Full GC å‘ç”Ÿåœ¨"),t("strong",[s._v("è€å¹´ä»£")]),s._v("ä¸Š, è€å¹´ä»£å¯¹è±¡å­˜æ´»æ—¶é—´é•¿, å› æ­¤ Full GC "),t("strong",[s._v("å¾ˆå°‘æ‰§è¡Œ")]),s._v(", æ‰§è¡Œé€Ÿåº¦ä¼šæ¯” Minor GC æ…¢å¾ˆå¤š. å¸¸è§çš„è§¦å‘åŸå› :")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("è°ƒç”¨ System.gc()")]),s._v(" . è¿™ä¸ªæ–¹æ³•ä¼š"),t("strong",[s._v("å»ºè®®")]),s._v("è™šæ‹Ÿæœºæ‰§è¡Œ Full GC, ä½†æ˜¯è™šæ‹Ÿæœº"),t("strong",[s._v("ä¸ä¸€å®š")]),s._v("çœŸæ­£å»æ‰§è¡Œ. ä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼, è€Œæ˜¯è®©è™šæ‹Ÿæœºç®¡ç†å†…å­˜. (å¸¸è€ƒ)")]),s._v(" "),t("li",[s._v("è€å¹´ä»£ç©ºé—´ä¸è¶³.")]),s._v(" "),t("li",[s._v("è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥(å‚è€ƒ: è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶).")])]),s._v(" "),t("h5",{attrs:{id:"_2-æ ‡è®°-æ¸…é™¤ç®—æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-æ ‡è®°-æ¸…é™¤ç®—æ³•"}},[s._v("#")]),s._v(" 2.æ ‡è®°-æ¸…é™¤ç®—æ³•")]),s._v(" "),t("blockquote",[t("p",[s._v("æ ‡è®°-æ¸…é™¤ç®—æ³•çš„æµç¨‹")])]),s._v(" "),t("p",[s._v("æ ‡è®°-æ¸…é™¤(Mark-Sweep)ç®—æ³•ä¸»è¦åˆ†ä¸º"),t("strong",[s._v("æ ‡è®°")]),s._v("ä¸"),t("strong",[s._v("æ¸…é™¤")]),s._v("ä¸¤ä¸ªæ­¥éª¤.")]),s._v(" "),t("p",[t("strong",[s._v("é¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡, åœ¨æ ‡è®°å®Œæˆå, ç»Ÿä¸€å›æ”¶æ‰æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡, ä¹Ÿå¯ä»¥åè¿‡æ¥, æ ‡è®°å­˜æ´»çš„å¯¹è±¡, ç»Ÿä¸€å›æ”¶æ‰€æœ‰æœªè¢«æ ‡è®°çš„å¯¹è±¡")]),s._v(". æ ‡è®°è¿‡ç¨‹å°±æ˜¯å¯¹è±¡æ˜¯å¦å±äºåƒåœ¾çš„åˆ¤å®šè¿‡ç¨‹, è¿™åœ¨å‰ä¸€èŠ‚è®²è¿°åƒåœ¾å¯¹è±¡æ ‡è®°åˆ¤å®šç®—æ³•æ—¶å…¶å®å·²ç»ä»‹ç»è¿‡äº†.")]),s._v(" "),t("p",[s._v("ä¹‹æ‰€ä»¥è¯´å®ƒæ˜¯æœ€åŸºç¡€çš„æ”¶é›†ç®—æ³•, æ˜¯å› ä¸ºåç»­çš„æ”¶é›†ç®—æ³•å¤§å¤šéƒ½æ˜¯ä»¥æ ‡è®°-æ¸…é™¤ç®—æ³•ä¸ºåŸºç¡€, å¯¹å…¶ç¼ºç‚¹è¿›è¡Œæ”¹è¿›è€Œå¾—åˆ°çš„.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521125600745.png",alt:"",title:'"æ ‡è®°-æ¸…é™¤"ç®—æ³•ç¤ºæ„å›¾'}})]),s._v(" "),t("blockquote",[t("p",[s._v("æ ‡è®°-æ¸…é™¤ç®—æ³•çš„ç¼ºç‚¹")])]),s._v(" "),t("p",[s._v("æ ‡è®°-æ¸…é™¤ç®—æ³•çš„ä¸»è¦ç¼ºç‚¹æœ‰ä¸¤ä¸ª:")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("ç¬¬ä¸€ä¸ªæ˜¯æ‰§è¡Œæ•ˆç‡ä¸ç¨³å®š")]),s._v(". å¦‚æœ Java å †ä¸­åŒ…å«"),t("strong",[s._v("å¤§é‡å¯¹è±¡")]),s._v(", è€Œä¸”å…¶ä¸­å¤§éƒ¨åˆ†æ˜¯éœ€è¦è¢«å›æ”¶çš„, è¿™æ—¶å¿…é¡»è¿›è¡Œå¤§é‡æ ‡è®°å’Œæ¸…é™¤çš„åŠ¨ä½œ, å¯¼è‡´æ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªè¿‡ç¨‹çš„æ‰§è¡Œæ•ˆç‡éƒ½éšå¯¹è±¡æ•°é‡å¢é•¿è€Œé™ä½.")]),s._v(" "),t("li",[t("strong",[s._v("ç¬¬äºŒä¸ªæ˜¯å†…å­˜ç©ºé—´çš„ç¢ç‰‡åŒ–é—®é¢˜")]),s._v(". æ ‡è®°, æ¸…é™¤ä¹‹åä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡, ç©ºé—´ç¢ç‰‡å¤ªå¤šå¯èƒ½ä¼šå¯¼è‡´å½“ä»¥ååœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­éœ€è¦åˆ†é…è¾ƒå¤§å¯¹è±¡æ—¶æ— æ³•æ‰¾åˆ°è¶³å¤Ÿçš„è¿ç»­å†…å­˜è€Œä¸å¾—ä¸æå‰è§¦å‘å¦ä¸€æ¬¡åƒåœ¾æ”¶é›†åŠ¨ä½œ.")])]),s._v(" "),t("h5",{attrs:{id:"_3-æ ‡è®°-å¤åˆ¶ç®—æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-æ ‡è®°-å¤åˆ¶ç®—æ³•"}},[s._v("#")]),s._v(" 3.æ ‡è®°-å¤åˆ¶ç®—æ³•")]),s._v(" "),t("p",[s._v("æ ‡è®°-å¤åˆ¶ç®—æ³•å³å°†"),t("strong",[s._v("å†…å­˜")]),s._v("åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„"),t("strong",[s._v("ä¸¤å—")]),s._v(", æ¯æ¬¡"),t("strong",[s._v("åªä½¿ç”¨å…¶ä¸­ä¸€å—")]),s._v(", å½“è¿™ä¸€å—å†…å­˜ç”¨å®Œäº†å°±å°†è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°"),t("strong",[s._v("å¦ä¸€å—ä¸Šé¢")]),s._v(", ç„¶åå†æŠŠä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´è¿›è¡Œä¸€æ¬¡æ¸…ç†.")]),s._v(" "),t("p",[s._v("ä¸ºäº†è§£å†³æ ‡è®°-æ¸…é™¤ç®—æ³•"),t("strong",[s._v("é¢å¯¹å¤§é‡å¯å›æ”¶å¯¹è±¡æ—¶æ‰§è¡Œæ•ˆç‡ä½")]),s._v('çš„é—®é¢˜, æå‡ºäº†ä¸€ç§ç§°ä¸º "åŠåŒºå¤åˆ¶"(Semispace Copying)çš„åƒåœ¾æ”¶é›†ç®—æ³•, '),t("strong",[s._v("å®ƒå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—, æ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—")]),s._v(". å½“è¿™ä¸€å—çš„å†…å­˜ç”¨å®Œäº†, å°±å°†è¿˜å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢, ç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰. "),t("strong",[s._v("å¦‚æœå†…å­˜ä¸­å¤šæ•°å¯¹è±¡éƒ½æ˜¯å­˜æ´»çš„, è¿™ç§ç®—æ³•å°†ä¼šäº§ç”Ÿå¤§é‡çš„å†…å­˜é—´å¤åˆ¶çš„å¼€é”€, ä½†å¯¹äºå¤šæ•°å¯¹è±¡éƒ½æ˜¯å¯å›æ”¶çš„æƒ…å†µ, ç®—æ³•éœ€è¦å¤åˆ¶çš„å°±æ˜¯å å°‘æ•°çš„å­˜æ´»å¯¹è±¡, è€Œä¸”æ¯æ¬¡éƒ½æ˜¯é’ˆå¯¹æ•´ä¸ªåŠåŒºè¿›è¡Œå†…å­˜å›æ”¶, åˆ†é…å†…å­˜æ—¶ä¹Ÿå°±ä¸ç”¨è€ƒè™‘æœ‰ç©ºé—´ç¢ç‰‡çš„å¤æ‚æƒ…å†µ, åªè¦ç§»åŠ¨å †é¡¶æŒ‡é’ˆ, æŒ‰é¡ºåºåˆ†é…å³å¯")]),s._v(". è¿™æ ·å®ç°ç®€å•, è¿è¡Œé«˜æ•ˆ, ä¸è¿‡å…¶ç¼ºé™·ä¹Ÿæ˜¾è€Œæ˜“è§, è¿™ç§å¤åˆ¶å›æ”¶ç®—æ³•çš„ä»£ä»·æ˜¯"),t("strong",[s._v("å°†å¯ç”¨å†…å­˜ç¼©å°ä¸ºäº†åŸæ¥çš„ä¸€åŠ")]),s._v(", ç©ºé—´æµªè´¹æœªå…å¤ªå¤šäº†ä¸€ç‚¹.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521130236760.png",alt:""}})]),s._v(" "),t("p",[s._v('ç°åœ¨çš„å•†ç”¨ Java è™šæ‹Ÿæœºå¤§å¤šéƒ½ä¼˜å…ˆé‡‡ç”¨äº†è¿™ç§æ”¶é›†ç®—æ³•å»å›æ”¶æ–°ç”Ÿä»£, IBM å…¬å¸æ›¾æœ‰ä¸€é¡¹ä¸“é—¨ç ”ç©¶å¯¹æ–°ç”Ÿä»£ "æœç”Ÿå¤•ç­" çš„ç‰¹ç‚¹åšäº†æ›´é‡åŒ–çš„è¯ é‡Š--'),t("mark",[t("strong",[s._v("æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡æœ‰ 98% ç†¬ä¸è¿‡ç¬¬ä¸€è½®æ”¶é›†. å› æ­¤å¹¶ä¸éœ€è¦æŒ‰ç…§ 1âˆ¶1 çš„æ¯”ä¾‹æ¥åˆ’åˆ†æ–°ç”Ÿä»£çš„å†…å­˜ç©ºé—´")])]),s._v(".")]),s._v(" "),t("p",[s._v("HotSpot è™šæ‹Ÿæœºçš„ Serial, ParNew ç­‰æ–°ç”Ÿä»£æ”¶é›†å™¨å‡é‡‡ç”¨äº†è¿™ç§ç­–ç•¥æ¥è®¾è®¡æ–°ç”Ÿä»£çš„å†…å­˜å¸ƒå±€. å…·ä½“åšæ³•æ˜¯"),t("strong",[s._v("æŠŠæ–°ç”Ÿä»£åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„ Eden ç©ºé—´å’Œä¸¤å—è¾ƒå°çš„ Survivor ç©ºé—´, æ¯æ¬¡åˆ†é…å†…å­˜åªä½¿ç”¨ Eden å’Œå…¶ä¸­ä¸€å— Survivor")]),s._v(". å‘ç”Ÿåƒåœ¾æ”¶é›†æ—¶, å°† Eden å’Œ Survivor ä¸­ä»ç„¶å­˜æ´»çš„å¯¹è±¡ä¸€æ¬¡æ€§å¤åˆ¶åˆ°å¦å¤–ä¸€å— Survivor ç©ºé—´ä¸Š, ç„¶åç›´æ¥æ¸…ç†æ‰ Eden å’Œå·²ç”¨è¿‡çš„é‚£å— Survivor ç©ºé—´. "),t("strong",[s._v("HotSpot è™šæ‹Ÿæœºé»˜è®¤ Eden å’Œ Survivor çš„å¤§å°æ¯”ä¾‹æ˜¯")]),s._v(" "),t("mark",[t("strong",[s._v("8âˆ¶1")])]),s._v("â€‹ "),t("strong",[s._v(', ä¹Ÿå³æ¯æ¬¡æ–°ç”Ÿä»£ä¸­å¯ç”¨å†…å­˜ç©ºé—´ä¸ºæ•´ä¸ªæ–°ç”Ÿä»£å®¹é‡çš„ 90%(Eden çš„ 80% åŠ ä¸Šä¸€ä¸ª Survivor çš„ 10%), åªæœ‰ä¸€ä¸ª Survivor ç©ºé—´, å³ 10% çš„æ–°ç”Ÿä»£æ˜¯ä¼šè¢« "æµªè´¹" çš„')]),s._v(".")]),s._v(" "),t("p",[s._v("å¦‚æœæ¯æ¬¡å›æ”¶æœ‰å¤šäº 10% çš„å¯¹è±¡å­˜æ´», é‚£ä¹ˆä¸€å— Survivor å°±"),t("strong",[s._v("ä¸å¤Ÿç”¨")]),s._v("äº†, æ­¤æ—¶éœ€è¦ä¾èµ–äº"),t("strong",[s._v("è€å¹´ä»£è¿›è¡Œç©ºé—´åˆ†é…æ‹…ä¿")]),s._v(", ä¹Ÿå°±æ˜¯å€Ÿç”¨è€å¹´ä»£çš„ç©ºé—´å­˜å‚¨æ”¾ä¸ä¸‹çš„å¯¹è±¡. å¦‚æœç©ºé—´æ‹…ä¿å¤±è´¥, åˆ™è§¦å‘ Full GC.")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("å†…å­˜çš„åˆ†é…æ‹…ä¿")])]),s._v("å¥½æ¯”å»é“¶è¡Œå€Ÿæ¬¾, å¦‚æœä¿¡èª‰å¾ˆå¥½, åœ¨ 98% çš„æƒ…å†µä¸‹éƒ½èƒ½æŒ‰æ—¶å¿è¿˜, äºæ˜¯é“¶è¡Œå¯èƒ½ä¼šé»˜è®¤ä¸‹ä¸€æ¬¡ä¹Ÿèƒ½æŒ‰æ—¶æŒ‰é‡åœ°å¿è¿˜è´·æ¬¾, åªéœ€è¦æœ‰ä¸€ä¸ªæ‹…ä¿äººèƒ½ä¿è¯å¦‚æœæˆ‘ä¸èƒ½è¿˜æ¬¾æ—¶, å¯ä»¥ä»ä»–çš„è´¦æˆ·æ‰£é’±, é‚£é“¶è¡Œå°±è®¤ä¸ºæ²¡æœ‰ä»€ä¹ˆé£é™©äº†. "),t("mark",[t("strong",[s._v("å†…å­˜çš„åˆ†é…æ‹…ä¿ä¹Ÿä¸€æ ·, å¦‚æœå¦å¤–ä¸€å— Survivor ç©ºé—´æ²¡æœ‰è¶³å¤Ÿç©ºé—´å­˜æ”¾ä¸Šä¸€æ¬¡æ–°ç”Ÿä»£æ”¶é›†ä¸‹æ¥çš„å­˜æ´»å¯¹è±¡, è¿™äº›å¯¹è±¡ä¾¿å°†é€šè¿‡åˆ†é…æ‹…ä¿æœºåˆ¶ç›´æ¥è¿›å…¥è€å¹´ä»£, è¿™å¯¹è™šæ‹Ÿæœºæ¥è¯´å°±æ˜¯å®‰å…¨çš„")])]),s._v(". å…³äºå¯¹æ–°ç”Ÿä»£è¿›è¡Œåˆ†é…æ‹…ä¿çš„å†…å®¹, åé¢ä»‹ç»åƒåœ¾æ”¶é›†å™¨æ‰§è¡Œè§„åˆ™æ—¶è¿˜ä¼šå†è¿›è¡Œè®²è§£(å‚è€ƒ: ç©ºé—´åˆ†é…æ‹…ä¿).")]),s._v(" "),t("h5",{attrs:{id:"_4-æ ‡è®°-æ•´ç†ç®—æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-æ ‡è®°-æ•´ç†ç®—æ³•"}},[s._v("#")]),s._v(" 4.æ ‡è®°-æ•´ç†ç®—æ³•")]),s._v(" "),t("p",[t("strong",[s._v("æ ‡è®°-å¤åˆ¶ç®—æ³•åœ¨å¯¹è±¡å­˜æ´»ç‡è¾ƒé«˜æ—¶å°±è¦è¿›è¡Œè¾ƒå¤šçš„å¤åˆ¶æ“ä½œ, æ•ˆç‡å°†ä¼šé™ä½")]),s._v(". æ›´å…³é”®çš„æ˜¯, å¦‚æœä¸æƒ³æµªè´¹ 50% çš„ç©ºé—´, å°±éœ€è¦æœ‰é¢å¤–çš„ç©ºé—´è¿›è¡Œåˆ†é…æ‹…ä¿, ä»¥åº”å¯¹è¢«ä½¿ç”¨çš„å†…å­˜ä¸­æ‰€æœ‰å¯¹è±¡éƒ½ 100% å­˜æ´»çš„æç«¯æƒ…å†µ, æ‰€ä»¥"),t("strong",[s._v("åœ¨è€å¹´ä»£ä¸€èˆ¬ä¸èƒ½ç›´æ¥é€‰ç”¨è¿™ç§ç®—æ³•")]),s._v(".")]),s._v(" "),t("p",[s._v('é’ˆå¯¹è€å¹´ä»£å¯¹è±¡çš„å­˜äº¡ç‰¹å¾(å¤§å¯¹è±¡, ä¸”å­˜æ´»æ—¶é—´é•¿çš„å¯¹è±¡), Edward Lueders æå‡ºäº†å¦å¤–ä¸€ç§æœ‰é’ˆå¯¹æ€§çš„ "'),t("strong",[s._v("æ ‡è®°-æ•´ç†")]),s._v('"(Mark-Compact)ç®—æ³•, å…¶ä¸­çš„æ ‡è®°è¿‡ç¨‹ä»ç„¶ä¸ "æ ‡è®°-æ¸…é™¤" ç®—æ³•ä¸€æ ·, ä½†åç»­æ­¥éª¤ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶å¯¹è±¡è¿›è¡Œæ¸…ç†, è€Œæ˜¯'),t("strong",[s._v("è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘å†…å­˜ç©ºé—´ä¸€ç«¯ç§»åŠ¨, ç„¶åç›´æ¥æ¸…ç†æ‰è¾¹ç•Œä»¥å¤–çš„å†…å­˜")]),s._v(".")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521132900524.png",alt:""}})]),s._v(" "),t("p",[s._v("æ ‡è®°-æ¸…é™¤ç®—æ³•ä¸æ ‡è®°-æ•´ç†ç®—æ³•çš„æœ¬è´¨å·®å¼‚åœ¨äºå‰è€…æ˜¯ä¸€ç§éç§»åŠ¨å¼çš„å›æ”¶ç®—æ³•, è€Œåè€…æ˜¯ç§»åŠ¨å¼çš„. "),t("strong",[s._v("æ˜¯å¦ç§»åŠ¨å›æ”¶åçš„å­˜æ´»å¯¹è±¡æ˜¯ä¸€é¡¹ä¼˜ç¼ºç‚¹å¹¶å­˜çš„é£é™©å†³ç­–")]),s._v(":")]),s._v(" "),t("ul",[t("li",[s._v("å¦‚æœç§»åŠ¨å­˜æ´»å¯¹è±¡, å°¤å…¶æ˜¯åœ¨è€å¹´ä»£è¿™ç§æ¯æ¬¡å›æ”¶éƒ½æœ‰å¤§é‡å¯¹è±¡å­˜æ´»åŒºåŸŸ, ç§»åŠ¨å­˜æ´»å¯¹è±¡å¹¶æ›´æ–°æ‰€æœ‰å¼•ç”¨è¿™äº›å¯¹è±¡çš„åœ°æ–¹å°†ä¼šæ˜¯ä¸€ç§æä¸ºè´Ÿé‡çš„æ“ä½œ, è€Œä¸”"),t("strong",[s._v("è¿™ç§å¯¹è±¡ç§»åŠ¨æ“ä½œå¿…é¡»å…¨ç¨‹æš‚åœç”¨æˆ·åº”ç”¨ç¨‹åºæ‰èƒ½è¿›è¡Œ")]),s._v(".")]),s._v(" "),t("li",[s._v('ä½†å¦‚æœè·Ÿæ ‡è®°-æ¸…é™¤ç®—æ³•é‚£æ ·å®Œå…¨ä¸è€ƒè™‘ç§»åŠ¨å’Œæ•´ç†å­˜æ´»å¯¹è±¡çš„è¯, å¼¥æ•£äºå †ä¸­çš„å­˜æ´»å¯¹è±¡å¯¼è‡´çš„ç©ºé—´ç¢ç‰‡åŒ–é—®é¢˜å°±åªèƒ½ä¾èµ–æ›´ä¸ºå¤æ‚çš„å†…å­˜åˆ†é…å™¨å’Œå†…å­˜è®¿é—®å™¨æ¥è§£å†³. è­¬å¦‚é€šè¿‡ "åˆ†åŒºç©ºé—²åˆ†é…é“¾è¡¨" æ¥è§£å†³å†…å­˜åˆ†é…é—®é¢˜(è®¡ç®—æœºç¡¬ç›˜å­˜å‚¨å¤§æ–‡ä»¶å°±ä¸è¦æ±‚ç‰©ç†è¿ç»­çš„ç£ç›˜ç©ºé—´, èƒ½å¤Ÿåœ¨ç¢ç‰‡åŒ–çš„ç¡¬ç›˜ä¸Šå­˜å‚¨å’Œè®¿é—®å°±æ˜¯é€šè¿‡ç¡¬ç›˜åˆ†åŒºè¡¨å®ç°çš„). å†…å­˜çš„è®¿é—®æ˜¯ç”¨æˆ·ç¨‹åºæœ€é¢‘ç¹çš„æ“ä½œ, ç”šè‡³éƒ½æ²¡æœ‰ä¹‹ä¸€, å‡å¦‚åœ¨è¿™ä¸ªç¯èŠ‚ä¸Šå¢åŠ äº†é¢å¤–çš„è´Ÿæ‹…, åŠ¿å¿…ä¼šç›´æ¥å½±å“åº”ç”¨ç¨‹åºçš„ååé‡.')])]),s._v(" "),t("p",[s._v("åŸºäºä»¥ä¸Šä¸¤ç‚¹, æ˜¯å¦ç§»åŠ¨å¯¹è±¡éƒ½å­˜åœ¨å¼Šç«¯, ç§»åŠ¨åˆ™å†…å­˜å›æ”¶æ—¶ä¼šæ›´å¤æ‚, ä¸ç§»åŠ¨åˆ™å†…å­˜åˆ†é…æ—¶ä¼šæ›´å¤æ‚. ä»åƒåœ¾æ”¶é›†çš„åœé¡¿æ—¶é—´æ¥çœ‹, ä¸ç§»åŠ¨å¯¹è±¡åœé¡¿æ—¶é—´ä¼šæ›´çŸ­, ç”šè‡³å¯ä»¥ä¸éœ€è¦åœé¡¿, ä½†æ˜¯ä»æ•´ä¸ªç¨‹åºçš„ååé‡æ¥çœ‹, ç§»åŠ¨å¯¹è±¡ä¼šæ›´åˆ’ç®—. æ­¤è¯­å¢ƒä¸­, "),t("strong",[s._v('ååé‡çš„å®è´¨æ˜¯èµ‹å€¼å™¨(Mutator, å¯ä»¥ç†è§£ä¸ºä½¿ç”¨åƒåœ¾æ”¶é›†çš„ç”¨æˆ·ç¨‹åº, æœ¬ä¹¦ä¸ºä¾¿äºç†è§£, å¤šæ•°åœ°æ–¹ç”¨ "ç”¨æˆ·ç¨‹åº" æˆ– "ç”¨æˆ·çº¿ç¨‹" ä»£æ›¿)ä¸æ”¶é›†å™¨çš„æ•ˆç‡æ€»å’Œ')]),s._v(". å³ä½¿ä¸ç§»åŠ¨å¯¹è±¡ä¼šä½¿å¾—æ”¶é›†å™¨çš„æ•ˆç‡æå‡ä¸€äº›, ä½†å› å†…å­˜åˆ†é…å’Œè®¿é—®ç›¸æ¯”åƒåœ¾æ”¶é›†é¢‘ç‡è¦é«˜å¾—å¤š, è¿™éƒ¨åˆ†çš„è€—æ—¶å¢åŠ , æ€»ååé‡ä»ç„¶æ˜¯ä¸‹é™çš„. "),t("strong",[s._v("HotSpot è™šæ‹Ÿæœºé‡Œé¢å…³æ³¨ååé‡çš„ Parallel Scavenge æ”¶é›†å™¨æ˜¯åŸºäºæ ‡è®°-æ•´ç†ç®—æ³•çš„, è€Œå…³æ³¨å»¶è¿Ÿçš„ CMS æ”¶é›†å™¨åˆ™æ˜¯åŸºäºæ ‡è®°-æ¸…é™¤ç®—æ³•çš„")]),s._v(", è¿™ä¹Ÿä»ä¾§é¢å°è¯è¿™ç‚¹.")]),s._v(" "),t("p",[s._v('å¦å¤–, è¿˜æœ‰ä¸€ç§ "å’Œç¨€æ³¥å¼" è§£å†³æ–¹æ¡ˆå¯ä»¥ä¸åœ¨å†…å­˜åˆ†é…å’Œè®¿é—®ä¸Šå¢åŠ å¤ªå¤§é¢å¤–è´Ÿæ‹…, åšæ³•æ˜¯è®©è™šæ‹Ÿæœºå¹³æ—¶å¤šæ•°æ—¶é—´éƒ½é‡‡ç”¨æ ‡è®°-æ¸…é™¤ç®—æ³•, æš‚æ—¶å®¹å¿å†…å­˜ç¢ç‰‡çš„å­˜åœ¨, ç›´åˆ°å†…å­˜ç©ºé—´çš„ç¢ç‰‡åŒ–ç¨‹åº¦å·²ç»å¤§åˆ°å½±å“å¯¹è±¡åˆ†é…æ—¶, å†é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•æ”¶é›†ä¸€æ¬¡, ä»¥è·å¾—è§„æ•´çš„å†…å­˜ç©ºé—´. å‰é¢æåˆ°çš„åŸºäºæ ‡è®°-æ¸…é™¤ç®—æ³•çš„ CMS æ”¶é›†å™¨é¢ä¸´ç©ºé—´ç¢ç‰‡è¿‡å¤šæ—¶é‡‡ç”¨çš„å°±æ˜¯è¿™ç§å¤„ç†åŠæ³•.')]),s._v(" "),t("h4",{attrs:{id:"hotspotè™šæ‹Ÿæœºåƒåœ¾æ”¶é›†ç®—æ³•å®ç°ç»†èŠ‚"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hotspotè™šæ‹Ÿæœºåƒåœ¾æ”¶é›†ç®—æ³•å®ç°ç»†èŠ‚"}},[s._v("#")]),s._v(" HotSpotè™šæ‹Ÿæœºåƒåœ¾æ”¶é›†ç®—æ³•å®ç°ç»†èŠ‚")]),s._v(" "),t("p",[s._v("å‰é¢ä»ç†è®ºåŸç†ä¸Šä»‹ç»äº†å¸¸è§çš„å¯¹è±¡å­˜æ´»åˆ¤å®šç®—æ³•å’Œåƒåœ¾æ”¶é›†ç®—æ³•, Java è™šæ‹Ÿæœºå®ç°è¿™äº›ç®—æ³•æ—¶, å¿…é¡»å¯¹ç®—æ³•çš„æ‰§è¡Œæ•ˆç‡æœ‰ä¸¥æ ¼çš„è€ƒé‡, æ‰èƒ½ä¿è¯è™šæ‹Ÿæœºé«˜æ•ˆè¿è¡Œ. æœ¬ç« è®¾ç½®è¿™éƒ¨åˆ†å†…å®¹ä¸»è¦æ˜¯ä¸ºäº†ç¨åä»‹ç»å„æ¬¾åƒåœ¾æ”¶é›†å™¨æ—¶åšå‰ç½®çŸ¥è¯†é“ºå«.")]),s._v(" "),t("h5",{attrs:{id:"_1-æ ¹èŠ‚ç‚¹æšä¸¾"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ ¹èŠ‚ç‚¹æšä¸¾"}},[s._v("#")]),s._v(" 1.æ ¹èŠ‚ç‚¹æšä¸¾")]),s._v(" "),t("p",[s._v("è¿™é‡Œä»¥å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­ä» GC Roots é›†åˆæ‰¾å¼•ç”¨é“¾è¿™ä¸ªæ“ä½œä½œä¸ºä»‹ç»è™šæ‹Ÿæœºé«˜æ•ˆå®ç°çš„ç¬¬ä¸€ä¸ªä¾‹å­. å›ºå®šå¯ä½œä¸º GC Roots çš„èŠ‚ç‚¹ä¸»è¦åœ¨å…¨å±€æ€§çš„å¼•ç”¨(ä¾‹å¦‚å¸¸é‡æˆ–ç±»é™æ€å±æ€§)ä¸æ‰§è¡Œä¸Šä¸‹æ–‡(ä¾‹å¦‚æ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨)ä¸­, å°½ç®¡ç›®æ ‡æ˜ç¡®, ä½†"),t("strong",[s._v("æŸ¥æ‰¾è¿‡ç¨‹è¦åšåˆ°é«˜æ•ˆå¹¶éä¸€ä»¶å®¹æ˜“çš„äº‹æƒ…")]),s._v(", ç°åœ¨ Java åº”ç”¨è¶Šåšè¶Šåºå¤§, å…‰æ˜¯æ–¹æ³•åŒºçš„å¤§å°å°±å¸¸æœ‰æ•°ç™¾ä¸Šåƒå…†, è‹¥è¦é€ä¸ªæ£€æŸ¥ä»¥è¿™é‡Œä¸ºèµ·æºçš„å¼•ç”¨è‚¯å®šå¾—æ¶ˆè€—ä¸å°‘æ—¶é—´.")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v('è¿„ä»Šä¸ºæ­¢, æ‰€æœ‰æ”¶é›†å™¨åœ¨æ ¹èŠ‚ç‚¹æšä¸¾è¿™ä¸€æ­¥éª¤æ—¶éƒ½æ˜¯å¿…é¡»æš‚åœç”¨æˆ·çº¿ç¨‹çš„, å› æ­¤æ¯«æ— ç–‘é—®æ ¹èŠ‚ç‚¹æšä¸¾ä¸ä¹‹å‰æåŠçš„æ•´ç†å†…å­˜ç¢ç‰‡ä¸€æ ·ä¼šé¢ä¸´ç›¸ä¼¼çš„ "Stop The World(STW)" çš„å›°æ‰°. ç°åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•è€—æ—¶æœ€é•¿çš„æŸ¥æ‰¾å¼•ç”¨é“¾çš„è¿‡ç¨‹å·²ç»å¯ä»¥åšåˆ°ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘, ä½†æ ¹èŠ‚ç‚¹æšä¸¾å§‹ç»ˆè¿˜æ˜¯å¿…é¡»åœ¨ä¸€ä¸ªèƒ½ä¿éšœä¸€è‡´æ€§çš„å¿«ç…§ä¸­æ‰å¾—ä»¥è¿›è¡Œ, è¿™é‡Œ "ä¸€è‡´æ€§" çš„æ„æ€æ˜¯æ•´ä¸ªæšä¸¾æœŸé—´æ‰§è¡Œå­ç³»ç»Ÿçœ‹èµ·æ¥å°±åƒè¢«å†»ç»“åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Š, ä¸ä¼šå‡ºç°åˆ†æè¿‡ç¨‹ä¸­, æ ¹èŠ‚ç‚¹é›†åˆçš„å¯¹è±¡å¼•ç”¨å…³ç³»è¿˜åœ¨ä¸æ–­å˜åŒ–çš„æƒ…å†µ, è‹¥è¿™ç‚¹ä¸èƒ½æ»¡è¶³çš„è¯, åˆ†æç»“æœå‡†ç¡®æ€§ä¹Ÿå°±æ— æ³•ä¿è¯. è¿™æ˜¯å¯¼è‡´åƒåœ¾æ”¶é›†è¿‡ç¨‹å¿…é¡»åœé¡¿æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹çš„å…¶ä¸­ä¸€ä¸ªé‡è¦åŸå› , å³ä½¿æ˜¯å·ç§°åœé¡¿æ—¶é—´å¯æ§, æˆ–è€…(å‡ ä¹)ä¸ä¼šå‘ç”Ÿåœé¡¿çš„ CMS, G1, ZGC ç­‰æ”¶é›†å™¨, æšä¸¾æ ¹èŠ‚ç‚¹æ—¶ä¹Ÿæ˜¯å¿…é¡»è¦åœé¡¿çš„')])]),s._v(".")]),s._v(" "),t("p",[s._v("ç”±äºç›®å‰ä¸»æµ Java è™šæ‹Ÿæœºä½¿ç”¨çš„éƒ½æ˜¯"),t("strong",[s._v("å‡†ç¡®å¼")]),s._v("åƒåœ¾æ”¶é›†, æ‰€ä»¥å½“ç”¨æˆ·çº¿ç¨‹åœé¡¿ä¸‹æ¥ä¹‹å, å…¶å®å¹¶ä¸éœ€è¦ä¸€ä¸ªä¸æ¼åœ°æ£€æŸ¥å®Œæ‰€æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå…¨å±€çš„å¼•ç”¨ä½ç½®, è™šæ‹Ÿæœºåº”å½“æ˜¯æœ‰åŠæ³•ç›´æ¥å¾—åˆ°å“ªäº›åœ°æ–¹å­˜æ”¾ç€å¯¹è±¡å¼•ç”¨çš„. åœ¨ HotSpot çš„è§£å†³æ–¹æ¡ˆé‡Œ, æ˜¯"),t("strong",[s._v("ä½¿ç”¨ä¸€ç»„ç§°ä¸º OopMap çš„æ•°æ®ç»“æ„")]),s._v("æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„. "),t("strong",[s._v("ä¸€æ—¦ç±»åŠ è½½åŠ¨ä½œå®Œæˆçš„æ—¶å€™, HotSpot å°±ä¼šæŠŠå¯¹è±¡å†…ä»€ä¹ˆåç§»é‡ä¸Šæ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®è®¡ç®—å‡ºæ¥, åœ¨å³æ—¶ç¼–è¯‘è¿‡ç¨‹ä¸­, ä¹Ÿä¼šåœ¨ç‰¹å®šçš„ä½ç½®è®°å½•ä¸‹æ ˆé‡Œå’Œå¯„å­˜å™¨é‡Œå“ªäº›ä½ç½®æ˜¯å¼•ç”¨. è¿™æ ·æ”¶é›†å™¨åœ¨æ‰«ææ—¶å°±å¯ä»¥ç›´æ¥å¾—çŸ¥è¿™äº›ä¿¡æ¯äº†, å¹¶ä¸éœ€è¦çœŸæ­£ä¸€ä¸ªä¸æ¼åœ°ä»æ–¹æ³•åŒºç­‰ GC Roots å¼€å§‹æŸ¥æ‰¾")]),s._v(".")]),s._v(" "),t("p",[s._v("ä¸‹é¢ä»£ç æ¸…å• 3-3 æ˜¯ HotSpot è™šæ‹Ÿæœºå®¢æˆ·ç«¯æ¨¡å¼ä¸‹ç”Ÿæˆçš„ä¸€æ®µ "),t("code",[s._v("String::hashCode()")]),s._v("â€‹ æ–¹æ³•çš„æœ¬åœ°ä»£ç , å¯ä»¥çœ‹åˆ°åœ¨ 0x026eb7a9 å¤„çš„ call æŒ‡ä»¤æœ‰ OopMap è®°å½•, å®ƒæŒ‡æ˜äº† EBX å¯„å­˜å™¨å’Œæ ˆä¸­åç§»é‡ä¸º 16 çš„å†…å­˜åŒºåŸŸä¸­å„æœ‰ä¸€ä¸ªæ™®é€šå¯¹è±¡æŒ‡é’ˆ(Ordinary Object Pointer, OOP)çš„å¼•ç”¨, æœ‰æ•ˆèŒƒå›´ä¸ºä» call æŒ‡ä»¤å¼€å§‹ç›´åˆ° 0x026eb730(æŒ‡ä»¤æµçš„èµ·å§‹ä½ç½®) + 142(OopMap è®°å½•çš„åç§»é‡) = 0x026eb7be, å³ hlt æŒ‡ä»¤ä¸ºæ­¢.")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»£ç æ¸…å•3-3 String.hashCode()æ–¹æ³•ç¼–è¯‘åçš„æœ¬åœ°ä»£ç ")])]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[Verified Entry Point]\n0x026eb730: mov    %eax,-0x8000(%esp)\n......\n;; ImplicitNullCheckStub slow case\n0x026eb7a9: call   0x026e83e0       ; OopMap{ebx=Oop [16]=Oop off=142}\n                                    ; *caload\n                                    ; - java.lang.String::hashCode@48 (line 1489)\n                                    ;   {runtime_call}\n    0x026eb7ae: push   $0x83c5c18   ;   {external_word}\n    0x026eb7b3: call   0x026eb7b8\n    0x026eb7b8: pusha\n    0x026eb7b9: call   0x0822bec0   ;   {runtime_call}\n    0x026eb7be: hlt\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("h5",{attrs:{id:"_2-å®‰å…¨ç‚¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å®‰å…¨ç‚¹"}},[s._v("#")]),s._v(" 2.å®‰å…¨ç‚¹")]),s._v(" "),t("p",[s._v("åœ¨ OopMap çš„ååŠ©ä¸‹, HotSpot å¯ä»¥å¿«é€Ÿå‡†ç¡®åœ°å®Œæˆ GC Roots æšä¸¾, ä½†ä¸€ä¸ªå¾ˆç°å®çš„é—®é¢˜éšä¹‹è€Œæ¥: "),t("strong",[s._v("å¯èƒ½å¯¼è‡´å¼•ç”¨å…³ç³»å˜åŒ–, æˆ–è€…è¯´å¯¼è‡´ OopMap å†…å®¹å˜åŒ–çš„æŒ‡ä»¤éå¸¸å¤š, å¦‚æœä¸ºæ¯ä¸€æ¡æŒ‡ä»¤éƒ½ç”Ÿæˆå¯¹åº”çš„ OopMap, é‚£å°†ä¼šéœ€è¦å¤§é‡çš„é¢å¤–å­˜å‚¨ç©ºé—´, è¿™æ ·åƒåœ¾æ”¶é›†ä¼´éšè€Œæ¥çš„ç©ºé—´æˆæœ¬å°±ä¼šå˜å¾—æ— æ³•å¿å—çš„é«˜æ˜‚")]),s._v(".")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v('å®é™…ä¸Š HotSpot ä¹Ÿçš„ç¡®æ²¡æœ‰ä¸ºæ¯æ¡æŒ‡ä»¤éƒ½ç”Ÿæˆ OopMap, å‰é¢å·²ç»æåˆ°, åªæ˜¯åœ¨ "ç‰¹å®šçš„ä½ç½®" è®°å½•äº†è¿™äº›ä¿¡æ¯, è¿™äº›ä½ç½®è¢«ç§°ä¸ºå®‰å…¨ç‚¹(Safepoint)')])]),s._v(" . æœ‰äº†å®‰å…¨ç‚¹çš„è®¾å®š, ä¹Ÿå°±å†³å®šäº†ç”¨æˆ·ç¨‹åºæ‰§è¡Œæ—¶å¹¶éåœ¨ä»£ç æŒ‡ä»¤æµçš„ä»»æ„ä½ç½®éƒ½èƒ½å¤Ÿåœé¡¿ä¸‹æ¥å¼€å§‹åƒåœ¾æ”¶é›†, è€Œæ˜¯"),t("mark",[t("strong",[s._v("å¼ºåˆ¶è¦æ±‚å¿…é¡»æ‰§è¡Œåˆ°è¾¾å®‰å…¨ç‚¹åæ‰èƒ½å¤Ÿæš‚åœ")])]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("å®‰å…¨ç‚¹å°±æ˜¯æŒ‡ä»£ç ä¸­ä¸€äº›ç‰¹å®šçš„ä½ç½®, å½“çº¿ç¨‹è¿è¡Œåˆ°è¿™äº›ä½ç½®æ—¶å®ƒçš„çŠ¶æ€æ˜¯ç¡®å®šçš„, è¿™æ · JVM å°±å¯ä»¥å®‰å…¨çš„è¿›è¡Œä¸€äº›æ“ä½œ")]),s._v(", æ¯”å¦‚ GC ç­‰, æ‰€ä»¥ GC ä¸æ˜¯æƒ³ä»€ä¹ˆæ—¶å€™åšå°±ç«‹å³è§¦å‘çš„, æ˜¯éœ€è¦ç­‰å¾…æ‰€æœ‰çº¿ç¨‹è¿è¡Œåˆ°å®‰å…¨ç‚¹åæ‰èƒ½è§¦å‘.")]),s._v(" "),t("blockquote",[t("p",[s._v("å®‰å…¨ç‚¹çš„é€‰å®šç­–ç•¥")])]),s._v(" "),t("p",[s._v('å®‰å…¨ç‚¹çš„é€‰å®šæ—¢ä¸èƒ½å¤ªå°‘ä»¥è‡³äºè®©æ”¶é›†å™¨ç­‰å¾…æ—¶é—´è¿‡é•¿, ä¹Ÿä¸èƒ½å¤ªè¿‡é¢‘ç¹ä»¥è‡³äºè¿‡åˆ†å¢å¤§è¿è¡Œæ—¶çš„å†…å­˜è´Ÿè·. å®‰å…¨ç‚¹ä½ç½®çš„é€‰å–åŸºæœ¬ä¸Šæ˜¯ä»¥ "'),t("strong",[s._v("æ˜¯å¦å…·æœ‰è®©ç¨‹åºé•¿æ—¶é—´æ‰§è¡Œçš„ç‰¹å¾")]),s._v('" ä¸ºæ ‡å‡†è¿›è¡Œé€‰å®šçš„, å› ä¸ºæ¯æ¡æŒ‡ä»¤æ‰§è¡Œçš„æ—¶é—´éƒ½éå¸¸çŸ­æš‚, ç¨‹åºä¸å¤ªå¯èƒ½å› ä¸ºæŒ‡ä»¤æµé•¿åº¦å¤ªé•¿è¿™æ ·çš„åŸå› è€Œé•¿æ—¶é—´æ‰§è¡Œ, "é•¿æ—¶é—´æ‰§è¡Œ" çš„æœ€æ˜æ˜¾ç‰¹å¾å°±æ˜¯'),t("strong",[s._v("æŒ‡ä»¤åºåˆ—çš„å¤ç”¨")]),s._v(", ä¾‹å¦‚"),t("strong",[s._v("æ–¹æ³•è°ƒç”¨, å¾ªç¯è·³è½¬, å¼‚å¸¸è·³è½¬ç­‰éƒ½å±äºæŒ‡ä»¤åºåˆ—å¤ç”¨, æ‰€ä»¥åªæœ‰å…·æœ‰è¿™äº›åŠŸèƒ½çš„æŒ‡ä»¤æ‰ä¼šäº§ç”Ÿå®‰å…¨ç‚¹")]),s._v(".")]),s._v(" "),t("p",[s._v("å¯¹äºå®‰å…¨ç‚¹, å¦å¤–ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜æ˜¯, "),t("strong",[s._v("å¦‚ä½•åœ¨åƒåœ¾æ”¶é›†å‘ç”Ÿæ—¶è®©æ‰€æœ‰çº¿ç¨‹(è¿™é‡Œå…¶å®ä¸åŒ…æ‹¬æ‰§è¡Œ JNI è°ƒç”¨çš„çº¿ç¨‹)éƒ½è·‘åˆ°æœ€è¿‘çš„å®‰å…¨ç‚¹, ç„¶ååœé¡¿ä¸‹æ¥")]),s._v(". è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ¡ˆå¯ä¾›é€‰æ‹©: æŠ¢å…ˆå¼ä¸­æ–­(Preemptive Suspension)å’Œä¸»åŠ¨å¼ä¸­æ–­(Voluntary Suspension), æŠ¢å…ˆå¼ä¸­æ–­ä¸éœ€è¦çº¿ç¨‹çš„æ‰§è¡Œä»£ç ä¸»åŠ¨å»é…åˆ, åœ¨åƒåœ¾æ”¶é›†å‘ç”Ÿæ—¶, ç³»ç»Ÿé¦–å…ˆæŠŠæ‰€æœ‰ç”¨æˆ·çº¿ç¨‹å…¨éƒ¨ä¸­æ–­, å¦‚æœå‘ç°æœ‰ç”¨æˆ·çº¿ç¨‹ä¸­æ–­çš„åœ°æ–¹ä¸åœ¨å®‰å…¨ç‚¹ä¸Š, å°±æ¢å¤è¿™æ¡çº¿ç¨‹æ‰§è¡Œ, è®©å®ƒä¸€ä¼šå†é‡æ–°ä¸­æ–­, ç›´åˆ°è·‘åˆ°å®‰å…¨ç‚¹ä¸Š. ç°åœ¨"),t("strong",[s._v("å‡ ä¹æ²¡æœ‰")]),s._v("è™šæ‹Ÿæœºå®ç°é‡‡ç”¨æŠ¢å…ˆå¼ä¸­æ–­æ¥æš‚åœçº¿ç¨‹å“åº” GC äº‹ä»¶.")]),s._v(" "),t("p",[s._v("è€Œä¸»åŠ¨å¼ä¸­æ–­çš„æ€æƒ³æ˜¯å½“åƒåœ¾æ”¶é›†éœ€è¦ä¸­æ–­çº¿ç¨‹çš„æ—¶å€™, ä¸ç›´æ¥å¯¹çº¿ç¨‹æ“ä½œ, ä»…ä»…ç®€å•åœ°è®¾ç½®ä¸€ä¸ªæ ‡å¿—ä½, å„ä¸ªçº¿ç¨‹æ‰§è¡Œè¿‡ç¨‹æ—¶ä¼šä¸åœåœ°ä¸»åŠ¨å»è½®è¯¢è¿™ä¸ªæ ‡å¿—, ä¸€æ—¦å‘ç°ä¸­æ–­æ ‡å¿—ä¸ºçœŸæ—¶å°±è‡ªå·±åœ¨æœ€è¿‘çš„å®‰å…¨ç‚¹ä¸Šä¸»åŠ¨ä¸­æ–­æŒ‚èµ·. è½®è¯¢æ ‡å¿—çš„åœ°æ–¹å’Œå®‰å…¨ç‚¹æ˜¯é‡åˆçš„, å¦å¤–è¿˜è¦åŠ ä¸Šæ‰€æœ‰åˆ›å»ºå¯¹è±¡å’Œå…¶ä»–éœ€è¦åœ¨ Java å †ä¸Šåˆ†é…å†…å­˜çš„åœ°æ–¹, è¿™æ˜¯ä¸ºäº†æ£€æŸ¥æ˜¯å¦å³å°†è¦å‘ç”Ÿåƒåœ¾æ”¶é›†, é¿å…æ²¡æœ‰è¶³å¤Ÿå†…å­˜åˆ†é…æ–°å¯¹è±¡.")]),s._v(" "),t("p",[s._v("ç”±äºè½®è¯¢æ“ä½œåœ¨ä»£ç ä¸­ä¼šé¢‘ç¹å‡ºç°, è¿™è¦æ±‚å®ƒå¿…é¡»è¶³å¤Ÿé«˜æ•ˆ. HotSpot ä½¿ç”¨"),t("strong",[s._v("å†…å­˜ä¿æŠ¤é™·é˜±")]),s._v("çš„æ–¹å¼, æŠŠè½®è¯¢æ“ä½œç²¾ç®€è‡³åªæœ‰ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤çš„ç¨‹åº¦. ä¸‹é¢ä»£ç æ¸…å• 3-4 ä¸­çš„ test æŒ‡ä»¤å°±æ˜¯ HotSpot ç”Ÿæˆçš„è½®è¯¢æŒ‡ä»¤, å½“éœ€è¦æš‚åœç”¨æˆ·çº¿ç¨‹æ—¶, è™šæ‹ŸæœºæŠŠ 0x160100 çš„å†…å­˜é¡µè®¾ç½®ä¸ºä¸å¯è¯», é‚£çº¿ç¨‹æ‰§è¡Œåˆ° test æŒ‡ä»¤æ—¶å°±ä¼šäº§ç”Ÿä¸€ä¸ªè‡ªé™·å¼‚å¸¸ä¿¡å·, ç„¶ååœ¨é¢„å…ˆæ³¨å†Œçš„å¼‚å¸¸å¤„ç†å™¨ä¸­æŒ‚èµ·çº¿ç¨‹å®ç°ç­‰å¾…, è¿™æ ·ä»…é€šè¿‡ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤ä¾¿å®Œæˆå®‰å…¨ç‚¹è½®è¯¢å’Œè§¦å‘çº¿ç¨‹ä¸­æ–­äº†.")]),s._v(" "),t("p",[t("strong",[s._v("ä»£ç æ¸…å•3-4ã€€è½®è¯¢æŒ‡ä»¤")])]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("0x01b6d627: call   0x01b2b210          ; OopMap{[60]=Oop off=460}\n                                       ; *invokeinterface size\n                                       ; - Client1::main@113 (line 23)\n                                       ;   {virtual_call}\n    0x01b6d62c: nop                    ; OopMap{[60]=Oop off=461}\n                                       ; *if_icmplt\n                                       ; - Client1::main@118 (line 23)\n    0x01b6d62d: test   %eax,0x160100   ;   {poll}\n    0x01b6d633: mov    0x50(%esp),%esi\n    0x01b6d637: cmp    %eax,%esi\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h5",{attrs:{id:"_3-å®‰å…¨åŒºåŸŸ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-å®‰å…¨åŒºåŸŸ"}},[s._v("#")]),s._v(" 3.å®‰å…¨åŒºåŸŸ")]),s._v(" "),t("p",[s._v("ä½¿ç”¨å®‰å…¨ç‚¹çš„è®¾è®¡ä¼¼ä¹å·²ç»å®Œç¾"),t("strong",[s._v("è§£å†³å¦‚ä½•åœé¡¿ç”¨æˆ·çº¿ç¨‹, è®©è™šæ‹Ÿæœºè¿›å…¥åƒåœ¾å›æ”¶çŠ¶æ€çš„é—®é¢˜")]),s._v("äº†, ä½†å®é™…æƒ…å†µå´å¹¶ä¸ä¸€å®š. å®‰å…¨ç‚¹æœºåˆ¶ä¿è¯äº†ç¨‹åºæ‰§è¡Œæ—¶, åœ¨ä¸å¤ªé•¿çš„æ—¶é—´å†…å°±ä¼šé‡åˆ°å¯è¿›å…¥åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„å®‰å…¨ç‚¹. "),t("strong",[s._v('ä½†ç¨‹åº "ä¸æ‰§è¡Œ" çš„æ—¶å€™å‘¢')]),s._v("? æ‰€è°“çš„ç¨‹åºä¸æ‰§è¡Œå°±æ˜¯"),t("strong",[s._v("æ²¡æœ‰åˆ†é…å¤„ç†å™¨æ—¶é—´")]),s._v(", å…¸å‹çš„åœºæ™¯ä¾¿æ˜¯ç”¨æˆ·çº¿ç¨‹å¤„äº Sleep çŠ¶æ€æˆ–è€… Blocked çŠ¶æ€, "),t("strong",[s._v("è¿™æ—¶å€™çº¿ç¨‹æ— æ³•å“åº”è™šæ‹Ÿæœºçš„ä¸­æ–­è¯·æ±‚, ä¸èƒ½å†èµ°åˆ°å®‰å…¨çš„åœ°æ–¹å»ä¸­æ–­æŒ‚èµ·è‡ªå·±, è™šæ‹Ÿæœºä¹Ÿæ˜¾ç„¶ä¸å¯èƒ½æŒç»­ç­‰å¾…çº¿ç¨‹é‡æ–°è¢«æ¿€æ´»åˆ†é…å¤„ç†å™¨æ—¶é—´")]),s._v(". å¯¹äºè¿™ç§æƒ…å†µ, å°±å¿…é¡»å¼•å…¥"),t("mark",[t("strong",[s._v("å®‰å…¨åŒºåŸŸ")])]),s._v("(Safe Region)æ¥è§£å†³.")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("å®‰å…¨åŒºåŸŸæ˜¯æŒ‡èƒ½å¤Ÿç¡®ä¿åœ¨æŸä¸€æ®µä»£ç ç‰‡æ®µä¹‹ä¸­, å¼•ç”¨å…³ç³»ä¸ä¼šå‘ç”Ÿå˜åŒ–, å› æ­¤åœ¨è¿™ä¸ªåŒºåŸŸä¸­ä»»æ„åœ°æ–¹å¼€å§‹åƒåœ¾æ”¶é›†éƒ½æ˜¯å®‰å…¨çš„")])]),s._v(". ä¹Ÿå¯ä»¥æŠŠå®‰å…¨åŒºåŸŸçœ‹ä½œè¢«æ‰©å±•"),t("strong",[s._v("æ‹‰ä¼¸äº†çš„å®‰å…¨ç‚¹")]),s._v(".")]),s._v(" "),t("p",[s._v("å½“ç”¨æˆ·çº¿ç¨‹æ‰§è¡Œåˆ°å®‰å…¨åŒºåŸŸé‡Œé¢çš„ä»£ç æ—¶, é¦–å…ˆä¼šæ ‡è¯†è‡ªå·±å·²ç»è¿›å…¥äº†å®‰å…¨åŒºåŸŸ, é‚£æ ·å½“è¿™æ®µæ—¶é—´é‡Œè™šæ‹Ÿæœºè¦å‘èµ·åƒåœ¾æ”¶é›†æ—¶å°±ä¸å¿…å»ç®¡è¿™äº›å·²å£°æ˜è‡ªå·±åœ¨å®‰å…¨åŒºåŸŸå†…çš„çº¿ç¨‹äº†. å½“çº¿ç¨‹è¦ç¦»å¼€å®‰å…¨åŒºåŸŸæ—¶, å®ƒè¦æ£€æŸ¥è™šæ‹Ÿæœºæ˜¯å¦å·²ç»å®Œæˆäº†æ ¹èŠ‚ç‚¹æšä¸¾(æˆ–è€…åƒåœ¾æ”¶é›†è¿‡ç¨‹ä¸­å…¶ä»–éœ€è¦æš‚åœç”¨æˆ·çº¿ç¨‹çš„é˜¶æ®µ), å¦‚æœå®Œæˆäº†, é‚£çº¿ç¨‹å°±å½“ä½œæ²¡äº‹å‘ç”Ÿè¿‡, ç»§ç»­æ‰§è¡Œ; å¦åˆ™å®ƒå°±å¿…é¡»ä¸€ç›´ç­‰å¾…, ç›´åˆ°æ”¶åˆ°å¯ä»¥ç¦»å¼€å®‰å…¨åŒºåŸŸçš„ä¿¡å·ä¸ºæ­¢.")]),s._v(" "),t("p",[s._v("å®‰å…¨ç‚¹æ˜¯å¯¹"),t("strong",[s._v("æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹è®¾å®š")]),s._v("çš„. å¦‚æœä¸€ä¸ªçº¿ç¨‹å¤„äº Sleep æˆ–ä¸­æ–­çŠ¶æ€, å®ƒå°±ä¸èƒ½å“åº” JVM çš„ä¸­æ–­è¯·æ±‚è€Œè¿è¡Œåˆ°å®‰å…¨ç‚¹ä¸Š. å› æ­¤ JVM å¼•å…¥äº†å®‰å…¨åŒºåŸŸ. å®‰å…¨åŒºåŸŸæ˜¯æŒ‡åœ¨ä¸€æ®µä»£ç ç‰‡æ®µä¸­, "),t("strong",[s._v("å¼•ç”¨å…³ç³»ä¸ä¼šå‘ç”Ÿå˜åŒ–")]),s._v(". åœ¨è¿™ä¸ªåŒºåŸŸå†…çš„"),t("strong",[s._v("ä»»æ„åœ°æ–¹å¼€å§‹ GC éƒ½æ˜¯å®‰å…¨çš„")]),s._v(".")]),s._v(" "),t("h5",{attrs:{id:"_4-è®°å¿†é›†ä¸å¡è¡¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-è®°å¿†é›†ä¸å¡è¡¨"}},[s._v("#")]),s._v(" 4.è®°å¿†é›†ä¸å¡è¡¨")]),s._v(" "),t("p",[s._v("è®²è§£åˆ†ä»£æ”¶é›†ç†è®ºçš„æ—¶å€™, æåˆ°äº†ä¸ºè§£å†³"),t("strong",[s._v("å¯¹è±¡è·¨ä»£å¼•ç”¨")]),s._v("æ‰€å¸¦æ¥çš„é—®é¢˜, åƒåœ¾æ”¶é›†å™¨åœ¨"),t("mark",[t("strong",[s._v("æ–°ç”Ÿä»£ä¸­å»ºç«‹äº†åä¸ºè®°å¿†é›†(Remembered Set)çš„æ•°æ®ç»“æ„, ç”¨ä»¥é¿å…æŠŠæ•´ä¸ªè€å¹´ä»£åŠ è¿› GC Roots æ‰«æèŒƒå›´")])]),s._v(". äº‹å®ä¸Šå¹¶ä¸åªæ˜¯æ–°ç”Ÿä»£, è€å¹´ä»£ä¹‹é—´æ‰æœ‰è·¨ä»£å¼•ç”¨çš„é—®é¢˜, æ‰€æœ‰æ¶‰åŠéƒ¨åˆ†åŒºåŸŸæ”¶é›†(Partial GC)è¡Œä¸ºçš„åƒåœ¾æ”¶é›†å™¨, å…¸å‹çš„å¦‚ G1, ZGC å’Œ Shenandoah æ”¶é›†å™¨, éƒ½ä¼šé¢ä¸´ç›¸åŒçš„é—®é¢˜, å› æ­¤æœ‰å¿…è¦è¿›ä¸€æ­¥ç†æ¸…è®°å¿†é›†çš„åŸç†å’Œå®ç°æ–¹å¼, ä»¥ä¾¿åœ¨åç»­ç« èŠ‚é‡Œä»‹ç»å‡ æ¬¾æœ€æ–°çš„æ”¶é›†å™¨ç›¸å…³çŸ¥è¯†æ—¶èƒ½æ›´å¥½åœ°ç†è§£.")]),s._v(" "),t("p",[t("strong",[s._v("è®°å¿†é›†æ˜¯ä¸€ç§ç”¨äºè®°å½•ä»éæ”¶é›†åŒºåŸŸæŒ‡å‘æ”¶é›†åŒºåŸŸçš„æŒ‡é’ˆé›†åˆçš„æŠ½è±¡æ•°æ®ç»“æ„")]),s._v(". å¦‚æœä¸è€ƒè™‘æ•ˆç‡å’Œæˆæœ¬çš„è¯, æœ€ç®€å•çš„å®ç°å¯ä»¥ç”¨éæ”¶é›†åŒºåŸŸä¸­æ‰€æœ‰å«è·¨ä»£å¼•ç”¨çš„å¯¹è±¡æ•°ç»„æ¥å®ç°è¿™ä¸ªæ•°æ®ç»“æ„, å¦‚ä»£ç æ¸…å• 3-5 æ‰€ç¤º:")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»£ç æ¸…å•3-5 ä»¥å¯¹è±¡æŒ‡é’ˆæ¥å®ç°è®°å¿†é›†çš„ä¼ªä»£ç ")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RememberedSet")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" set"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("OBJECT_INTERGENERATIONAL_REFERENCE_SIZE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("è¿™ç§è®°å½•å…¨éƒ¨å«è·¨ä»£å¼•ç”¨å¯¹è±¡çš„å®ç°æ–¹æ¡ˆ, æ— è®ºæ˜¯ç©ºé—´å ç”¨è¿˜æ˜¯ç»´æŠ¤æˆæœ¬éƒ½ç›¸å½“é«˜æ˜‚. è€Œåœ¨åƒåœ¾æ”¶é›†çš„åœºæ™¯ä¸­, æ”¶é›†å™¨åªéœ€è¦é€šè¿‡è®°å¿†é›†"),t("strong",[s._v("åˆ¤æ–­å‡ºæŸä¸€å—éæ”¶é›†åŒºåŸŸæ˜¯å¦å­˜åœ¨æœ‰æŒ‡å‘äº†æ”¶é›†åŒºåŸŸçš„æŒ‡é’ˆ")]),s._v("å°±å¯ä»¥äº†, å¹¶ä¸éœ€è¦äº†è§£è¿™äº›è·¨ä»£æŒ‡é’ˆçš„å…¨éƒ¨ç»†èŠ‚. é‚£è®¾è®¡è€…åœ¨å®ç°è®°å¿†é›†çš„æ—¶å€™, ä¾¿å¯ä»¥é€‰æ‹©æ›´ä¸ºç²—çŠ·çš„è®°å½•ç²’åº¦æ¥èŠ‚çœè®°å¿†é›†çš„å­˜å‚¨å’Œç»´æŠ¤æˆæœ¬, ä¸‹é¢åˆ—ä¸¾äº†ä¸€äº›å¯ä¾›é€‰æ‹©(å½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©è¿™ä¸ªèŒƒå›´ä»¥å¤–çš„)çš„è®°å½•ç²¾åº¦:")]),s._v(" "),t("ul",[t("li",[s._v("å­—é•¿ç²¾åº¦: æ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€ä¸ªæœºå™¨å­—é•¿(å°±æ˜¯å¤„ç†å™¨çš„å¯»å€ä½æ•°, å¦‚å¸¸è§çš„ 32 ä½æˆ– 64 ä½, è¿™ä¸ªç²¾åº¦å†³å®šäº†æœºå™¨è®¿é—®ç‰©ç†å†…å­˜åœ°å€çš„æŒ‡é’ˆé•¿åº¦), è¯¥å­—åŒ…å«è·¨ä»£æŒ‡é’ˆ.")]),s._v(" "),t("li",[s._v("å¯¹è±¡ç²¾åº¦: æ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€ä¸ªå¯¹è±¡, è¯¥å¯¹è±¡é‡Œæœ‰å­—æ®µå«æœ‰è·¨ä»£æŒ‡é’ˆ.")]),s._v(" "),t("li",[s._v("å¡ç²¾åº¦: æ¯ä¸ªè®°å½•ç²¾ç¡®åˆ°ä¸€å—å†…å­˜åŒºåŸŸ, è¯¥åŒºåŸŸå†…æœ‰å¯¹è±¡å«æœ‰è·¨ä»£æŒ‡é’ˆ.")])]),s._v(" "),t("blockquote",[t("p",[s._v("ä½¿ç”¨å¡è¡¨å®ç°è®°å¿†é›†")])]),s._v(" "),t("p",[s._v('å…¶ä¸­, ç¬¬ä¸‰ç§ "å¡ç²¾åº¦" æ‰€æŒ‡çš„æ˜¯ç”¨ä¸€ç§ç§°ä¸º "'),t("strong",[s._v("å¡è¡¨")]),s._v('"(Card Table)çš„æ–¹å¼å»'),t("strong",[s._v("å®ç°è®°å¿†é›†")]),s._v(', è¿™ä¹Ÿæ˜¯ç›®å‰æœ€å¸¸ç”¨çš„ä¸€ç§è®°å¿†é›†å®ç°å½¢å¼, ä¸€äº›èµ„æ–™ä¸­ç”šè‡³ç›´æ¥æŠŠå®ƒå’Œè®°å¿†é›†æ··ä¸ºä¸€è°ˆ. å‰é¢å®šä¹‰ä¸­æåˆ°è®°å¿†é›†å…¶å®æ˜¯ä¸€ç§ "æŠ½è±¡" çš„æ•°æ®ç»“æ„, æŠ½è±¡çš„æ„æ€æ˜¯åªå®šä¹‰äº†è®°å¿†é›†çš„è¡Œä¸ºæ„å›¾, å¹¶æ²¡æœ‰å®šä¹‰å…¶è¡Œä¸ºçš„å…·ä½“å®ç°. '),t("mark",[t("strong",[s._v("å¡è¡¨å°±æ˜¯è®°å¿†é›†çš„ä¸€ç§å…·ä½“å®ç°, å®ƒå®šä¹‰äº†è®°å¿†é›†çš„è®°å½•ç²¾åº¦, ä¸å †å†…å­˜çš„æ˜ å°„å…³ç³»ç­‰")])]),s._v(". å…³äºå¡è¡¨ä¸è®°å¿†é›†çš„å…³ç³», å¯ä»¥æŒ‰ç…§ HashMap ä¸ Map çš„å…³ç³»æ¥ç±»æ¯”ç†è§£.")]),s._v(" "),t("p",[t("strong",[s._v("å¡è¡¨æœ€ç®€å•çš„å½¢å¼å¯ä»¥åªæ˜¯ä¸€ä¸ªå­—èŠ‚æ•°ç»„")]),s._v(", è€Œ HotSpot è™šæ‹Ÿæœºç¡®å®ä¹Ÿæ˜¯è¿™æ ·åšçš„. ä»¥ä¸‹è¿™è¡Œä»£ç æ˜¯ HotSpot é»˜è®¤çš„å¡è¡¨æ ‡è®°é€»è¾‘:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("CARD_TABLE [this address >> 9] = 0;\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v('å­—èŠ‚æ•°ç»„ CARD_TABLE çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¯¹åº”ç€å…¶æ ‡è¯†çš„å†…å­˜åŒºåŸŸä¸­ä¸€å—ç‰¹å®šå¤§å°çš„å†…å­˜å—, è¿™ä¸ªå†…å­˜å—è¢«ç§°ä½œ "'),t("strong",[s._v("å¡é¡µ")]),s._v('"(Card Page). ä¸€èˆ¬æ¥è¯´, å¡é¡µå¤§å°éƒ½æ˜¯ä»¥ 2 çš„ N æ¬¡å¹‚çš„å­—èŠ‚æ•°, é€šè¿‡ä¸Šé¢ä»£ç å¯ä»¥çœ‹å‡º HotSpot ä¸­ä½¿ç”¨çš„å¡é¡µæ˜¯ 2 çš„ 9 æ¬¡å¹‚, å³ 512 å­—èŠ‚(åœ°å€å³ç§» 9 ä½, ç›¸å½“äºç”¨åœ°å€é™¤ä»¥ 512). é‚£å¦‚æœå¡è¡¨æ ‡è¯†å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€æ˜¯ 0x0000 çš„è¯, æ•°ç»„ CARD_TABLE çš„ç¬¬ 0, 1, 2 å·å…ƒç´ , åˆ†åˆ«å¯¹åº”äº†åœ°å€èŒƒå›´ä¸º 0x0000ï½0x01FF, 0x0200ï½0x03FF, 0x0400ï½0x05FF çš„å¡é¡µå†…å­˜å—, å¦‚ä¸‹å›¾æ‰€ç¤º.')]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/image-20240709234115-oqchz9l.png",alt:"image",title:"å¡è¡¨ä¸å¡é¡µå¯¹åº”ç¤ºæ„å›¾"}})]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("ä¸€ä¸ªå¡é¡µçš„å†…å­˜ä¸­é€šå¸¸åŒ…å«ä¸æ­¢ä¸€ä¸ªå¯¹è±¡(å› ä¸ºä¸€ä¸ªå¡é¡µæœ‰ 512 å­—èŠ‚), åªè¦å¡é¡µå†…æœ‰ä¸€ä¸ª(æˆ–æ›´å¤š)å¯¹è±¡çš„å­—æ®µå­˜åœ¨ç€è·¨ä»£æŒ‡é’ˆ, é‚£å°±å°†å¯¹åº”å¡è¡¨çš„æ•°ç»„å…ƒç´ çš„å€¼æ ‡è¯†ä¸º 1, ç§°ä¸ºè¿™ä¸ªå…ƒç´ å˜è„(Dirty), æ²¡æœ‰åˆ™æ ‡è¯†ä¸º 0. åœ¨åƒåœ¾æ”¶é›†å‘ç”Ÿæ—¶, åªè¦ç­›é€‰å‡ºå¡è¡¨ä¸­å˜è„çš„å…ƒç´ , å°±èƒ½è½»æ˜“å¾—å‡ºå“ªäº›å¡é¡µå†…å­˜å—ä¸­åŒ…å«è·¨ä»£æŒ‡é’ˆ, æŠŠå®ƒä»¬åŠ å…¥ GC Roots ä¸­ä¸€å¹¶æ‰«æ")])]),s._v(".")]),s._v(" "),t("p",[s._v("è¿™æ ·çš„è¯, åªè¦ä¸€ä¸ªå¡è¡¨ä¸­çš„å…ƒç´ å€¼ä¸º 0, é‚£å¯¹åº”çš„å¡é¡µå°±ä¸€å®šæ²¡æœ‰è·¨ä»£æŒ‡é’ˆ; å¦‚æœå…ƒç´ å€¼ä¸º 1, å°±æ˜¯å­˜åœ¨è·¨ä»£æŒ‡é’ˆçš„.")]),s._v(" "),t("h5",{attrs:{id:"_5-å†™å±éšœ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-å†™å±éšœ"}},[s._v("#")]),s._v(" 5.å†™å±éšœ")]),s._v(" "),t("p",[s._v("å‰é¢å·²ç»è§£å†³äº†å¦‚ä½•"),t("strong",[s._v("ä½¿ç”¨è®°å¿†é›†æ¥ç¼©å‡ GC Roots æ‰«æèŒƒå›´çš„é—®é¢˜, ä½†è¿˜æ²¡æœ‰è§£å†³")]),s._v("â€‹"),t("mark",[t("strong",[s._v("å¡è¡¨å…ƒç´ å¦‚ä½•ç»´æŠ¤çš„é—®é¢˜")])]),s._v(", ä¾‹å¦‚å®ƒä»¬ä½•æ—¶å˜è„, è°æ¥æŠŠå®ƒä»¬å˜è„ç­‰.")]),s._v(" "),t("blockquote",[t("p",[s._v("ä½¿ç”¨å†™å±éšœç»´æŠ¤å¡è¡¨çŠ¶æ€")])]),s._v(" "),t("p",[s._v("å¡è¡¨å…ƒç´ ä½•æ—¶å˜è„çš„ç­”æ¡ˆæ˜¯å¾ˆæ˜ç¡®çš„---"),t("mark",[t("strong",[s._v("æœ‰å…¶ä»–åˆ†ä»£åŒºåŸŸä¸­å¯¹è±¡å¼•ç”¨äº†æœ¬åŒºåŸŸå¯¹è±¡æ—¶, å…¶å¯¹åº”çš„å¡è¡¨å…ƒç´ å°±åº”è¯¥å˜è„, å˜è„æ—¶é—´ç‚¹åŸåˆ™ä¸Šåº”è¯¥å‘ç”Ÿåœ¨å¼•ç”¨ç±»å‹å­—æ®µèµ‹å€¼çš„é‚£ä¸€åˆ»")])]),s._v(". ä½†é—®é¢˜æ˜¯å¦‚ä½•å˜è„, å³å¦‚ä½•åœ¨å¯¹è±¡èµ‹å€¼çš„é‚£ä¸€åˆ»å»æ›´æ–°ç»´æŠ¤å¡è¡¨å‘¢? å‡å¦‚æ˜¯è§£é‡Šæ‰§è¡Œçš„å­—èŠ‚ç , é‚£ç›¸å¯¹å¥½å¤„ç†, è™šæ‹Ÿæœºè´Ÿè´£æ¯æ¡å­—èŠ‚ç æŒ‡ä»¤çš„æ‰§è¡Œ, æœ‰å……åˆ†çš„ä»‹å…¥ç©ºé—´; ä½†åœ¨"),t("strong",[s._v("ç¼–è¯‘æ‰§è¡Œ")]),s._v("çš„åœºæ™¯ä¸­å‘¢? ç»è¿‡å³æ—¶ç¼–è¯‘åçš„ä»£ç å·²ç»æ˜¯çº¯ç²¹çš„æœºå™¨æŒ‡ä»¤æµäº†, è¿™å°±å¿…é¡»æ‰¾åˆ°ä¸€ä¸ªåœ¨æœºå™¨ç å±‚é¢çš„æ‰‹æ®µ, æŠŠç»´æŠ¤å¡è¡¨çš„åŠ¨ä½œ"),t("strong",[s._v("æ”¾åˆ°æ¯ä¸€ä¸ªèµ‹å€¼æ“ä½œ")]),s._v("ä¹‹ä¸­.")]),s._v(" "),t("p",[s._v("åœ¨ HotSpot è™šæ‹Ÿæœºé‡Œæ˜¯"),t("mark",[t("strong",[s._v("é€šè¿‡å†™å±éšœ(Write Barrier)æŠ€æœ¯ç»´æŠ¤å¡è¡¨çŠ¶æ€")])]),s._v('çš„. æ³¨æ„å°†è¿™é‡Œæåˆ°çš„ "å†™å±éšœ", ä»¥åŠåé¢åœ¨ä½å»¶è¿Ÿæ”¶é›†å™¨ä¸­ä¼šæåˆ°çš„ "è¯»å±éšœ" ä¸è§£å†³å¹¶å‘ä¹±åºæ‰§è¡Œé—®é¢˜ä¸­çš„ "å†…å­˜å±éšœ" åŒºåˆ†å¼€æ¥, é¿å…æ··æ·†. å†™å±éšœå¯ä»¥çœ‹ä½œåœ¨è™šæ‹Ÿæœºå±‚é¢å¯¹ "å¼•ç”¨ç±»å‹å­—æ®µèµ‹å€¼" è¿™ä¸ªåŠ¨ä½œçš„ '),t("strong",[s._v("AOP åˆ‡é¢")]),s._v(", åœ¨å¼•ç”¨å¯¹è±¡èµ‹å€¼æ—¶ä¼šäº§ç”Ÿä¸€ä¸ªç¯å½¢(Around)é€šçŸ¥, ä¾›ç¨‹åºæ‰§è¡Œé¢å¤–çš„åŠ¨ä½œ, ä¹Ÿå°±æ˜¯è¯´"),t("strong",[s._v("èµ‹å€¼çš„å‰åéƒ½åœ¨å†™å±éšœçš„è¦†ç›–èŒƒç•´å†…")]),s._v(". åœ¨èµ‹å€¼å‰çš„éƒ¨åˆ†çš„å†™å±éšœå«ä½œå†™å‰å±éšœ(Pre-Write Barrier), åœ¨èµ‹å€¼åçš„åˆ™å«ä½œå†™åå±éšœ(Post-Write Barrier). HotSpot è™šæ‹Ÿæœºçš„è®¸å¤šæ”¶é›†å™¨ä¸­éƒ½æœ‰ä½¿ç”¨åˆ°å†™å±éšœ, ä½†ç›´è‡³ G1 æ”¶é›†å™¨å‡ºç°ä¹‹å‰, å…¶ä»–æ”¶é›†å™¨éƒ½åªç”¨åˆ°äº†å†™åå±éšœ. ä¸‹é¢è¿™æ®µä»£ç æ¸…å• 3-6 æ˜¯ä¸€æ®µæ›´æ–°å¡è¡¨çŠ¶æ€çš„ç®€åŒ–é€»è¾‘:")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»£ç æ¸…å•3-6 å†™åå±éšœæ›´æ–°å¡è¡¨")])]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("oop_field_store")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oop"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oop new_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å¼•ç”¨å­—æ®µèµ‹å€¼æ“ä½œ")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("field "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" new_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å†™åå±éšœ, åœ¨è¿™é‡Œå®Œæˆå¡è¡¨çŠ¶æ€æ›´æ–°")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("post_write_barrier")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" new_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[t("strong",[s._v("åº”ç”¨å†™å±éšœå, è™šæ‹Ÿæœºå°±ä¼šä¸ºæ‰€æœ‰èµ‹å€¼æ“ä½œç”Ÿæˆç›¸åº”çš„æŒ‡ä»¤, ä¸€æ—¦æ”¶é›†å™¨åœ¨å†™å±éšœä¸­å¢åŠ äº†æ›´æ–°å¡è¡¨æ“ä½œ, æ— è®ºæ›´æ–°çš„æ˜¯ä¸æ˜¯è€å¹´ä»£å¯¹æ–°ç”Ÿä»£å¯¹è±¡çš„å¼•ç”¨, æ¯æ¬¡åªè¦å¯¹å¼•ç”¨è¿›è¡Œæ›´æ–°, å°±ä¼šäº§ç”Ÿé¢å¤–çš„å¼€é”€")]),s._v(", ä¸è¿‡è¿™ä¸ªå¼€é”€ä¸ Minor GC æ—¶æ‰«ææ•´ä¸ªè€å¹´ä»£çš„ä»£ä»·ç›¸æ¯”è¿˜æ˜¯ä½å¾—å¤šçš„.")]),s._v(" "),t("blockquote",[t("p",[s._v("ä¼ªå…±äº«é—®é¢˜")])]),s._v(" "),t("p",[s._v('é™¤äº†å†™å±éšœçš„å¼€é”€å¤–, å¡è¡¨åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹è¿˜é¢ä¸´ç€ "'),t("strong",[s._v("ä¼ªå…±äº«")]),s._v('"(False Sharing)é—®é¢˜. ä¼ªå…±äº«æ˜¯å¤„ç†å¹¶å‘åº•å±‚ç»†èŠ‚æ—¶ä¸€ç§ç»å¸¸éœ€è¦è€ƒè™‘çš„é—®é¢˜, ç°ä»£ä¸­å¤®å¤„ç†å™¨çš„ç¼“å­˜ç³»ç»Ÿä¸­æ˜¯ä»¥'),t("strong",[s._v("ç¼“å­˜è¡Œ")]),s._v("(Cache Line)ä¸ºå•ä½å­˜å‚¨çš„, å½“å¤šçº¿ç¨‹ä¿®æ”¹äº’ç›¸ç‹¬ç«‹çš„å˜é‡æ—¶, å¦‚æœè¿™äº›å˜é‡æ°å¥½å…±äº«åŒä¸€ä¸ªç¼“å­˜è¡Œ, å°±ä¼šå½¼æ­¤å½±å“(å†™å›, æ— æ•ˆåŒ–æˆ–è€…åŒæ­¥)è€Œå¯¼è‡´æ€§èƒ½é™ä½, è¿™å°±æ˜¯ä¼ªå…±äº«é—®é¢˜.")]),s._v(" "),t("p",[s._v("å‡è®¾å¤„ç†å™¨çš„ç¼“å­˜è¡Œå¤§å°ä¸º 64 å­—èŠ‚, ç”±äºä¸€ä¸ªå¡è¡¨å…ƒç´ å  1 ä¸ªå­—èŠ‚, 64 ä¸ªå¡è¡¨å…ƒç´ å°†å…±äº«åŒä¸€ä¸ªç¼“å­˜è¡Œ. è¿™ 64 ä¸ªå¡è¡¨å…ƒç´ å¯¹åº”çš„å¡é¡µæ€»çš„å†…å­˜ä¸º 32KB(64Ã—512 å­—èŠ‚), ä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸åŒçº¿ç¨‹æ›´æ–°çš„å¯¹è±¡æ­£å¥½å¤„äºè¿™ 32KB çš„å†…å­˜åŒºåŸŸå†…, å°±ä¼šå¯¼è‡´æ›´æ–°å¡è¡¨æ—¶æ­£å¥½å†™å…¥åŒä¸€ä¸ªç¼“å­˜è¡Œè€Œå½±å“æ€§èƒ½. ä¸ºäº†é¿å…ä¼ªå…±äº«é—®é¢˜, ä¸€ç§ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯ä¸é‡‡ç”¨æ— æ¡ä»¶çš„å†™å±éšœ, è€Œæ˜¯å…ˆæ£€æŸ¥å¡è¡¨æ ‡è®°, åªæœ‰å½“è¯¥å¡è¡¨å…ƒç´ æœªè¢«æ ‡è®°è¿‡æ—¶æ‰å°†å…¶æ ‡è®°ä¸ºå˜è„, å³å°†å¡è¡¨æ›´æ–°çš„é€»è¾‘å˜ä¸ºä»¥ä¸‹ä»£ç æ‰€ç¤º:")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CARD_TABLE "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("this address "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    CARD_TABLE "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("this address "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("åœ¨ JDK 7 ä¹‹å, HotSpot è™šæ‹Ÿæœºå¢åŠ äº†ä¸€ä¸ªæ–°çš„å‚æ•° "),t("code",[s._v("-XX: +UseCondCardMark")]),s._v("â€‹, ç”¨æ¥å†³å®šæ˜¯å¦å¼€å¯å¡è¡¨æ›´æ–°çš„æ¡ä»¶åˆ¤æ–­. å¼€å¯ä¼šå¢åŠ ä¸€æ¬¡é¢å¤–åˆ¤æ–­çš„å¼€é”€, ä½†èƒ½å¤Ÿé¿å…ä¼ªå…±äº«é—®é¢˜, ä¸¤è€…å„æœ‰æ€§èƒ½æŸè€—, æ˜¯å¦æ‰“å¼€è¦æ ¹æ®åº”ç”¨å®é™…è¿è¡Œæƒ…å†µæ¥è¿›è¡Œæµ‹è¯•æƒè¡¡.")]),s._v(" "),t("h5",{attrs:{id:"_6-å¹¶å‘çš„å¯è¾¾æ€§åˆ†æ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-å¹¶å‘çš„å¯è¾¾æ€§åˆ†æ"}},[s._v("#")]),s._v(" 6.å¹¶å‘çš„å¯è¾¾æ€§åˆ†æ")]),s._v(" "),t("h6",{attrs:{id:"_1-ä¸‰è‰²æ ‡è®°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ä¸‰è‰²æ ‡è®°"}},[s._v("#")]),s._v(" (1)ä¸‰è‰²æ ‡è®°")]),s._v(" "),t("p",[s._v("å‰é¢æ›¾ç»æåˆ°äº†å½“å‰ä¸»æµç¼–ç¨‹è¯­è¨€çš„åƒåœ¾æ”¶é›†å™¨åŸºæœ¬ä¸Šéƒ½æ˜¯ä¾é å¯è¾¾æ€§åˆ†æç®—æ³•æ¥åˆ¤å®šå¯¹è±¡æ˜¯å¦å­˜æ´»çš„, å¯è¾¾æ€§åˆ†æç®—æ³•ç†è®ºä¸Šè¦æ±‚"),t("mark",[t("strong",[s._v("å…¨è¿‡ç¨‹éƒ½åŸºäºä¸€ä¸ªèƒ½ä¿éšœä¸€è‡´æ€§çš„å¿«ç…§ä¸­æ‰èƒ½å¤Ÿè¿›è¡Œåˆ†æ, è¿™æ„å‘³ç€å¿…é¡»å…¨ç¨‹å†»ç»“ç”¨æˆ·çº¿ç¨‹çš„è¿è¡Œ")])]),s._v(". åœ¨æ ¹èŠ‚ç‚¹æšä¸¾(å‚è€ƒ: æ ¹èŠ‚ç‚¹æšä¸¾)è¿™ä¸ªæ­¥éª¤ä¸­, ç”±äº GC Roots ç›¸æ¯”èµ·æ•´ä¸ª Java å †ä¸­å…¨éƒ¨çš„å¯¹è±¡æ¯•ç«Ÿè¿˜ç®—æ˜¯æå°‘æ•°, ä¸”åœ¨å„ç§ä¼˜åŒ–æŠ€å·§(å¦‚ OopMap)çš„åŠ æŒä¸‹, å®ƒå¸¦æ¥çš„åœé¡¿å·²ç»æ˜¯éå¸¸çŸ­æš‚ä¸”ç›¸å¯¹å›ºå®š(ä¸éšå †å®¹é‡è€Œå¢é•¿)çš„äº†. å¯ä» GC Roots å†ç»§ç»­å¾€ä¸‹éå†å¯¹è±¡å›¾, è¿™ä¸€æ­¥éª¤çš„åœé¡¿æ—¶é—´å°±å¿…å®šä¼šä¸ Java å †å®¹é‡ç›´æ¥æˆæ­£æ¯”ä¾‹å…³ç³»äº†: "),t("strong",[s._v("å †è¶Šå¤§, å­˜å‚¨çš„å¯¹è±¡è¶Šå¤š, å¯¹è±¡å›¾ç»“æ„è¶Šå¤æ‚, è¦æ ‡è®°æ›´å¤šå¯¹è±¡è€Œäº§ç”Ÿçš„åœé¡¿æ—¶é—´è‡ªç„¶å°±æ›´é•¿")]),s._v(", è¿™å¬èµ·æ¥æ˜¯ç†æ‰€å½“ç„¶çš„äº‹æƒ….")]),s._v(" "),t("p",[s._v('è¦çŸ¥é“åŒ…å« "æ ‡è®°" é˜¶æ®µæ˜¯æ‰€æœ‰è¿½è¸ªå¼åƒåœ¾æ”¶é›†ç®—æ³•çš„å…±åŒç‰¹å¾, å¦‚æœè¿™ä¸ªé˜¶æ®µä¼šéšç€å †å˜å¤§è€Œç­‰æ¯”ä¾‹å¢åŠ åœé¡¿æ—¶é—´, å…¶å½±å“å°±ä¼šæ³¢åŠå‡ ä¹æ‰€æœ‰çš„åƒåœ¾æ”¶é›†å™¨, åŒç†å¯çŸ¥, å¦‚æœèƒ½å¤Ÿå‰Šå‡è¿™éƒ¨åˆ†åœé¡¿æ—¶é—´çš„è¯, é‚£æ”¶ç›Šä¹Ÿå°†ä¼šæ˜¯ç³»ç»Ÿæ€§çš„.')]),s._v(" "),t("p",[s._v("æƒ³è§£å†³æˆ–è€…é™ä½ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿, å°±è¦å…ˆææ¸…æ¥š"),t("strong",[s._v("ä¸ºä»€ä¹ˆå¿…é¡»åœ¨ä¸€ä¸ªèƒ½ä¿éšœä¸€è‡´æ€§çš„å¿«ç…§ä¸Šæ‰èƒ½è¿›è¡Œå¯¹è±¡å›¾çš„éå†")]),s._v("? ä¸ºäº†èƒ½è§£é‡Šæ¸…æ¥šè¿™ä¸ªé—®é¢˜, å¯ä»¥å¼•å…¥"),t("mark",[t("strong",[s._v("ä¸‰è‰²æ ‡è®°")])]),s._v("(Tri-color Marking) ä½œä¸ºå·¥å…·æ¥è¾…åŠ©æ¨å¯¼, "),t("strong",[s._v('æŠŠéå†å¯¹è±¡å›¾è¿‡ç¨‹ä¸­é‡åˆ°çš„å¯¹è±¡, æŒ‰ç…§ "æ˜¯å¦è®¿é—®è¿‡" è¿™ä¸ªæ¡ä»¶æ ‡è®°æˆä»¥ä¸‹ä¸‰ç§é¢œè‰²')]),s._v(":")]),s._v(" "),t("ul",[t("li",[t("mark",[t("strong",[s._v("ç™½è‰²: è¡¨ç¤ºå¯¹è±¡å°šæœªè¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡")])]),s._v(". æ˜¾ç„¶åœ¨å¯è¾¾æ€§åˆ†æåˆšåˆšå¼€å§‹çš„é˜¶æ®µ, "),t("strong",[s._v("æ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ç™½è‰²çš„")]),s._v(", è‹¥åœ¨åˆ†æç»“æŸçš„é˜¶æ®µ, ä»ç„¶æ˜¯ç™½è‰²çš„å¯¹è±¡, å³ä»£è¡¨"),t("strong",[s._v("ä¸å¯è¾¾")]),s._v(".")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("é»‘è‰²: è¡¨ç¤ºå¯¹è±¡å·²ç»è¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡, ä¸”è¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½å·²ç»æ‰«æè¿‡")])]),s._v(". é»‘è‰²çš„å¯¹è±¡ä»£è¡¨"),t("strong",[s._v("å·²ç»æ‰«æè¿‡, å®ƒæ˜¯å®‰å…¨å­˜æ´»çš„")]),s._v(", å¦‚æœæœ‰å…¶ä»–å¯¹è±¡å¼•ç”¨æŒ‡å‘äº†é»‘è‰²å¯¹è±¡, æ— é¡»é‡æ–°æ‰«æä¸€é. é»‘è‰²å¯¹è±¡ä¸å¯èƒ½ç›´æ¥(ä¸ç»è¿‡ç°è‰²å¯¹è±¡)æŒ‡å‘æŸä¸ªç™½è‰²å¯¹è±¡.")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("ç°è‰²: è¡¨ç¤ºå¯¹è±¡å·²ç»è¢«åƒåœ¾æ”¶é›†å™¨è®¿é—®è¿‡, ä½†è¿™ä¸ªå¯¹è±¡ä¸Šè‡³å°‘å­˜åœ¨ä¸€ä¸ªå¼•ç”¨è¿˜æ²¡æœ‰è¢«æ‰«æè¿‡")])]),s._v(".")])]),s._v(" "),t("p",[s._v("å…³äºå¯è¾¾æ€§åˆ†æçš„æ‰«æè¿‡ç¨‹, è¯»è€…ä¸å¦¨å‘æŒ¥ä¸€ä¸‹æƒ³è±¡åŠ›, æŠŠå®ƒçœ‹ä½œå¯¹è±¡å›¾ä¸Šä¸€è‚¡ä»¥ç°è‰²ä¸ºæ³¢å³°çš„æ³¢çº¹ä»é»‘å‘ç™½æ¨è¿›çš„è¿‡ç¨‹, å¦‚æœç”¨æˆ·çº¿ç¨‹æ­¤æ—¶æ˜¯å†»ç»“çš„, åªæœ‰æ”¶é›†å™¨çº¿ç¨‹åœ¨å·¥ä½œ, é‚£ä¸ä¼šæœ‰ä»»ä½•é—®é¢˜. ä½†å¦‚æœ"),t("mark",[t("strong",[s._v("ç”¨æˆ·çº¿ç¨‹ä¸æ”¶é›†å™¨æ˜¯å¹¶å‘å·¥ä½œ")])]),s._v("å‘¢? "),t("strong",[s._v("æ”¶é›†å™¨åœ¨å¯¹è±¡å›¾ä¸Šæ ‡è®°é¢œè‰², åŒæ—¶ç”¨æˆ·çº¿ç¨‹åœ¨ä¿®æ”¹å¼•ç”¨å…³ç³», å³ä¿®æ”¹å¯¹è±¡å›¾çš„ç»“æ„")]),s._v(", è¿™æ ·å¯èƒ½å‡ºç°ä¸¤ç§åæœ. ä¸€ç§æ˜¯æŠŠåŸæœ¬æ¶ˆäº¡çš„å¯¹è±¡é”™è¯¯æ ‡è®°ä¸ºå­˜æ´», è¿™ä¸æ˜¯å¥½äº‹, ä½†å…¶å®æ˜¯å¯ä»¥å®¹å¿çš„, åªä¸è¿‡äº§ç”Ÿäº†ä¸€ç‚¹é€ƒè¿‡æœ¬æ¬¡æ”¶é›†çš„æµ®åŠ¨åƒåœ¾è€Œå·², ä¸‹æ¬¡æ”¶é›†æ¸…ç†æ‰å°±å¥½. å¦ä¸€ç§æ˜¯"),t("strong",[s._v("æŠŠåŸæœ¬å­˜æ´»çš„å¯¹è±¡é”™è¯¯æ ‡è®°ä¸ºå·²æ¶ˆäº¡")]),s._v(", è¿™å°±æ˜¯éå¸¸è‡´å‘½çš„åæœäº†, ç¨‹åºè‚¯å®šä¼šå› æ­¤å‘ç”Ÿé”™è¯¯, ä¸‹é¢è¡¨ 3-1 æ¼”ç¤ºäº†è¿™æ ·çš„è‡´å‘½é”™è¯¯å…·ä½“æ˜¯å¦‚ä½•äº§ç”Ÿçš„.")]),s._v(" "),t("blockquote",[t("p",[s._v('è¡¨3-1 å¹¶å‘å‡ºç°"å¯¹è±¡æ¶ˆå¤±"é—®é¢˜çš„ç¤ºæ„')])]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00026-20240302133505-rjh1sj7.jpg",alt:""}})]),s._v(" "),t("p",[s._v('Wilson äº 1994 å¹´åœ¨ç†è®ºä¸Šè¯æ˜äº†, å½“ä¸”ä»…å½“ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³æ—¶, ä¼šäº§ç”Ÿ "'),t("strong",[s._v("å¯¹è±¡æ¶ˆå¤±")]),s._v('" çš„é—®é¢˜, å³åŸæœ¬åº”è¯¥æ˜¯é»‘è‰²çš„å¯¹è±¡è¢«'),t("strong",[s._v("è¯¯æ ‡ä¸ºç™½è‰²")]),s._v(":")]),s._v(" "),t("ul",[t("li",[s._v("èµ‹å€¼å™¨æ’å…¥äº†ä¸€æ¡æˆ–å¤šæ¡ä»é»‘è‰²å¯¹è±¡åˆ°ç™½è‰²å¯¹è±¡çš„æ–°å¼•ç”¨;")]),s._v(" "),t("li",[s._v("èµ‹å€¼å™¨åˆ é™¤äº†å…¨éƒ¨ä»ç°è‰²å¯¹è±¡åˆ°è¯¥ç™½è‰²å¯¹è±¡çš„ç›´æ¥æˆ–é—´æ¥å¼•ç”¨.")])]),s._v(" "),t("h6",{attrs:{id:"_2-å¢é‡æ›´æ–°ä¸åŸå§‹å¿«ç…§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å¢é‡æ›´æ–°ä¸åŸå§‹å¿«ç…§"}},[s._v("#")]),s._v(" (2)å¢é‡æ›´æ–°ä¸åŸå§‹å¿«ç…§")]),s._v(" "),t("p",[s._v("å› æ­¤, "),t("strong",[s._v("è¦è§£å†³å¹¶å‘æ‰«ææ—¶çš„å¯¹è±¡æ¶ˆå¤±é—®é¢˜, åªéœ€ç ´åè¿™ä¸¤ä¸ªæ¡ä»¶çš„ä»»æ„ä¸€ä¸ªå³å¯")]),s._v(". ç”±æ­¤åˆ†åˆ«äº§ç”Ÿäº†ä¸¤ç§è§£å†³æ–¹æ¡ˆ: "),t("mark",[t("strong",[s._v("å¢é‡æ›´æ–°(Incremental Update)å’ŒåŸå§‹å¿«ç…§(Snapshot At The Beginning, SATB)")])]),s._v(" .")]),s._v(" "),t("p",[t("strong",[s._v("å¢é‡æ›´æ–°è¦ç ´åçš„æ˜¯ç¬¬ä¸€ä¸ªæ¡ä»¶, å½“é»‘è‰²å¯¹è±¡æ’å…¥æ–°çš„æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨å…³ç³»æ—¶, å°±å°†è¿™ä¸ªæ–°æ’å…¥çš„å¼•ç”¨è®°å½•ä¸‹æ¥, ç­‰å¹¶å‘æ‰«æç»“æŸä¹‹å, å†å°†è¿™äº›è®°å½•è¿‡çš„å¼•ç”¨å…³ç³»ä¸­çš„é»‘è‰²å¯¹è±¡ä¸ºæ ¹, é‡æ–°æ‰«æä¸€æ¬¡. è¿™å¯ä»¥ç®€åŒ–ç†è§£ä¸º, é»‘è‰²å¯¹è±¡ä¸€æ—¦æ–°æ’å…¥äº†æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨ä¹‹å, å®ƒå°±å˜å›ç°è‰²å¯¹è±¡äº†")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("åŸå§‹å¿«ç…§è¦ç ´åçš„æ˜¯ç¬¬äºŒä¸ªæ¡ä»¶, å½“ç°è‰²å¯¹è±¡è¦åˆ é™¤æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¼•ç”¨å…³ç³»æ—¶, å°±å°†è¿™ä¸ªè¦åˆ é™¤çš„å¼•ç”¨è®°å½•ä¸‹æ¥, åœ¨å¹¶å‘æ‰«æç»“æŸä¹‹å, å†å°†è¿™äº›è®°å½•è¿‡çš„å¼•ç”¨å…³ç³»ä¸­çš„ç°è‰²å¯¹è±¡ä¸ºæ ¹, é‡æ–°æ‰«æä¸€æ¬¡. è¿™ä¹Ÿå¯ä»¥ç®€åŒ–ç†è§£ä¸º, æ— è®ºå¼•ç”¨å…³ç³»åˆ é™¤ä¸å¦, éƒ½ä¼šæŒ‰ç…§åˆšåˆšå¼€å§‹æ‰«æé‚£ä¸€åˆ»çš„å¯¹è±¡å›¾å¿«ç…§æ¥è¿›è¡Œæœç´¢.")])]),s._v(" "),t("p",[s._v("ä»¥ä¸Šæ— è®ºæ˜¯å¯¹å¼•ç”¨å…³ç³»è®°å½•çš„æ’å…¥è¿˜æ˜¯åˆ é™¤, è™šæ‹Ÿæœºçš„è®°å½•æ“ä½œéƒ½æ˜¯"),t("strong",[s._v("é€šè¿‡å†™å±éšœå®ç°")]),s._v("çš„, å†™å±éšœæ˜¯"),t("strong",[s._v("ä»£ç çº§åˆ«å®ç°")]),s._v("çš„, ä¸ JMM ä¸­çš„å†™å±éšœä¸ä¸€æ ·, è¿™é‡Œæ›´ç±»ä¼¼äº AOP æ“ä½œ. åœ¨ HotSpot è™šæ‹Ÿæœºä¸­, "),t("strong",[s._v("å¢é‡æ›´æ–°å’ŒåŸå§‹å¿«ç…§è¿™ä¸¤ç§è§£å†³æ–¹æ¡ˆéƒ½æœ‰å®é™…åº”ç”¨")]),s._v(", è­¬å¦‚ CMS æ˜¯åŸºäºå¢é‡æ›´æ–°æ¥åšå¹¶å‘æ ‡è®°çš„, "),t("strong",[s._v("G1, Shenandoah åˆ™æ˜¯ç”¨åŸå§‹å¿«ç…§æ¥å®ç°")]),s._v(".")]),s._v(" "),t("p",[s._v("åˆ°è¿™é‡Œç®€è¦ä»‹ç»äº† HotSpot è™šæ‹Ÿæœºå¦‚ä½•å‘èµ·å†…å­˜å›æ”¶, å¦‚ä½•åŠ é€Ÿå†…å­˜å›æ”¶, ä»¥åŠå¦‚ä½•ä¿è¯å›æ”¶æ­£ç¡®æ€§ç­‰é—®é¢˜, ä½†æ˜¯è™šæ‹Ÿæœºå¦‚ä½•å…·ä½“åœ°è¿›è¡Œå†…å­˜å›æ”¶åŠ¨ä½œä»ç„¶æœªæ¶‰åŠ. å› ä¸ºå†…å­˜å›æ”¶å¦‚ä½•è¿›è¡Œæ˜¯ç”±è™šæ‹Ÿæœºæ‰€é‡‡ç”¨å“ªä¸€æ¬¾åƒåœ¾æ”¶é›†å™¨æ‰€å†³å®šçš„, è€Œé€šå¸¸è™šæ‹Ÿæœºä¸­å¾€å¾€æœ‰å¤šç§åƒåœ¾æ”¶é›†å™¨, ä¸‹é¢å°†é€ä¸€ä»‹ç» HotSpot è™šæ‹Ÿæœºä¸­å‡ºç°è¿‡çš„åƒåœ¾æ”¶é›†å™¨.")]),s._v(" "),t("h6",{attrs:{id:"_3-å†™å±éšœ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-å†™å±éšœ"}},[s._v("#")]),s._v(" (3)å†™å±éšœ")]),s._v(" "),t("p",[s._v("ç»™æŸä¸ªå¯¹è±¡çš„æˆå‘˜å˜é‡èµ‹å€¼æ—¶, å…¶åº•å±‚ä»£ç å¤§æ¦‚å¦‚ä¸‹, ä¸‹é¢éƒ½æ˜¯"),t("strong",[s._v("ä¼ªä»£ç ")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * @param field æŸå¯¹è±¡çš„æˆå‘˜å˜é‡, å¦‚ a.b.d \n * @param new_value æ–°å€¼, å¦‚ null\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("oop_field_store")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oop"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oop new_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("field "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" new_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// èµ‹å€¼æ“ä½œ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("æ‰€è°“å†™å±éšœå…¶å®å°±æ˜¯æŒ‡åœ¨èµ‹å€¼æ“ä½œå‰å, åŠ å…¥ä¸€äº›å¤„ç†(å¯ä»¥å‚è€ƒ AOP çš„æ¦‚å¿µ):")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("oop_field_store")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oop"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oop new_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  \n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pre_write_barrier")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å†™å±éšœ-å†™å‰æ“ä½œ")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("field "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" new_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// èµ‹å€¼æ“")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("post_write_barrier")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å†™å±éšœ-å†™åæ“ä½œ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("blockquote",[t("p",[s._v("å†™å±éšœå®ç°SATB")])]),s._v(" "),t("p",[s._v("å½“å¯¹è±¡ B çš„æˆå‘˜å˜é‡çš„å¼•ç”¨å‘ç”Ÿå˜åŒ–æ—¶, æ¯”å¦‚å¼•ç”¨æ¶ˆå¤±(a.b.d = null), å¯ä»¥åˆ©ç”¨å†™å±éšœ, å°† B åŸæ¥æˆå‘˜å˜é‡çš„å¼•ç”¨å¯¹è±¡ D è®°å½•ä¸‹æ¥. SATB æ˜¯è®°å½•åˆ æ‰çš„å¼•ç”¨, å› æ­¤éœ€è¦åœ¨åˆ ä¹‹å‰è¿›è¡Œè®°å½•.")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pre_write_barrier")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oop"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    oop old_value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è·å–æ—§å€¼")]),s._v("\n    remark_set"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("old_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®°å½•åŸæ¥çš„å¼•ç”¨å¯¹è±¡(åŠ å…¥åˆ°ä¸€ä¸ªsetä¸­)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("blockquote",[t("p",[s._v("å†™å±éšœå®ç°å¢é‡æ›´æ–°")])]),s._v(" "),t("p",[s._v("å½“å¯¹è±¡ A çš„æˆå‘˜å˜é‡çš„å¼•ç”¨å‘ç”Ÿå˜åŒ–æ—¶, æ¯”å¦‚æ–°å¢å¼•ç”¨(a.d = d), å¯ä»¥åˆ©ç”¨å†™å±éšœ, å°† A æ–°çš„æˆå‘˜å˜é‡å¼•ç”¨å¯¹è±¡ D è®°å½•ä¸‹æ¥. å¢é‡æ›´æ–°æ˜¯è®°å½•æ–°å¢çš„å¼•ç”¨, å› æ­¤è¦åœ¨æ–°å¢ä¹‹åè¿›è¡Œè®°å½•.")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("post_write_barrier")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oop"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oop new_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  \n    remark_set"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("new_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®°å½•æ–°å¼•ç”¨çš„å¯¹è±¡(åŠ å…¥åˆ°ä¸€ä¸ªsetä¸­)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h6",{attrs:{id:"_4-è¯»å±éšœ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-è¯»å±éšœ"}},[s._v("#")]),s._v(" (4)è¯»å±éšœ")]),s._v(" "),t("p",[s._v("è¯»å±éšœå®ç°ä¼ªä»£ç å¦‚ä¸‹.")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[s._v("oop "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("oop_field_load")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oop"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pre_load_barrier")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è¯»å±éšœ-è¯»å–å‰æ“ä½œ")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("è¯»å±éšœæ˜¯å½“"),t("strong",[s._v("è¯»å–æˆå‘˜å˜é‡")]),s._v("æ—¶, ä¸€å¾‹è®°å½•ä¸‹æ¥:")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pre_load_barrier")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("oop"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  \n    oop old_value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("field"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    remark_set"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("old_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è®°å½•è¯»å–åˆ°çš„å¯¹è±¡")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h6",{attrs:{id:"_5-æ€»ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-æ€»ç»“"}},[s._v("#")]),s._v(" (5)æ€»ç»“")]),s._v(" "),t("p",[s._v("ç°ä»£"),t("strong",[s._v("è¿½è¸ªå¼(å¯è¾¾æ€§åˆ†æ)çš„åƒåœ¾å›æ”¶å™¨å‡ ä¹éƒ½å€Ÿé‰´äº†ä¸‰è‰²æ ‡è®°çš„ç®—æ³•æ€æƒ³")]),s._v(", å°½ç®¡å®ç°çš„æ–¹å¼ä¸å°½ç›¸åŒ: æ¯”å¦‚ç™½è‰²/é»‘è‰²é›†åˆä¸€èˆ¬éƒ½ä¸ä¼šå‡ºç°(ä½†æ˜¯æœ‰å…¶ä»–ä½“ç°é¢œè‰²çš„åœ°æ–¹), ç°è‰²é›†åˆå¯ä»¥é€šè¿‡æ ˆ/é˜Ÿåˆ—/ç¼“å­˜æ—¥å¿—ç­‰æ–¹å¼è¿›è¡Œå®ç°, éå†æ–¹å¼å¯ä»¥æ˜¯å¹¿åº¦/æ·±åº¦éå†ç­‰ç­‰.")]),s._v(" "),t("p",[s._v("å¯¹äºè¯»å†™å±éšœ, ä»¥ HotSpot ä¸ºä¾‹, å…¶å¹¶å‘æ ‡è®°æ—¶å¯¹"),t("strong",[s._v("æ¼æ ‡")]),s._v("çš„å¤„ç†æ–¹æ¡ˆå¦‚ä¸‹:")]),s._v(" "),t("ul",[t("li",[s._v("CMS: å†™å±éšœ + å¢é‡æ›´æ–°")]),s._v(" "),t("li",[s._v("G1, Shenandoah: å†™å±éšœ + SATB")]),s._v(" "),t("li",[s._v("ZGC: è¯»å±éšœ")])]),s._v(" "),t("p",[s._v("å·¥ç¨‹å®ç°ä¸­, è¯»å†™å±éšœè¿˜æœ‰å…¶ä»–åŠŸèƒ½, æ¯”å¦‚å†™å±éšœå¯ä»¥ç”¨äºè®°å½•è·¨ä»£/åŒºå¼•ç”¨çš„å˜åŒ–, è¯»å±éšœå¯ä»¥ç”¨äºæ”¯æŒç§»åŠ¨å¯¹è±¡çš„å¹¶å‘æ‰§è¡Œç­‰. åŠŸèƒ½ä¹‹å¤–, è¿˜æœ‰æ€§èƒ½çš„è€ƒè™‘, æ‰€ä»¥å¯¹äºé€‰æ‹©å“ªç§, æ¯æ¬¾åƒåœ¾å›æ”¶å™¨éƒ½æœ‰è‡ªå·±çš„æƒ³æ³•.")]),s._v(" "),t("h4",{attrs:{id:"ç»å…¸åƒåœ¾æ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç»å…¸åƒåœ¾æ”¶é›†å™¨"}},[s._v("#")]),s._v(" ç»å…¸åƒåœ¾æ”¶é›†å™¨")]),s._v(" "),t("h5",{attrs:{id:"_1-åŸºç¡€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-åŸºç¡€"}},[s._v("#")]),s._v(" 1.åŸºç¡€")]),s._v(" "),t("p",[s._v("å¦‚æœè¯´"),t("strong",[s._v("æ”¶é›†ç®—æ³•æ˜¯å†…å­˜å›æ”¶çš„æ–¹æ³•è®º, é‚£åƒåœ¾æ”¶é›†å™¨å°±æ˜¯å†…å­˜å›æ”¶ç®—æ³•çš„å…·ä½“å®ç°")]),s._v(".")]),s._v(" "),t("blockquote",[t("p",[s._v("åƒåœ¾æ”¶é›†å™¨æ¦‚è§ˆ")])]),s._v(" "),t("p",[s._v("ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹ä¸­å¯¹åƒåœ¾æ”¶é›†å™¨åº”è¯¥å¦‚ä½•å®ç°å¹¶æ²¡æœ‰åšå‡ºä»»ä½•è§„å®š, å› æ­¤ä¸åŒçš„å‚å•†, ä¸åŒç‰ˆæœ¬çš„è™šæ‹Ÿæœºæ‰€åŒ…å«çš„åƒåœ¾æ”¶é›†å™¨éƒ½å¯èƒ½ä¼šæœ‰å¾ˆå¤§å·®åˆ«, ä¸åŒçš„è™šæ‹Ÿæœºä¸€èˆ¬ä¹Ÿéƒ½ä¼šæä¾›å„ç§å‚æ•°ä¾›ç”¨æˆ·æ ¹æ®è‡ªå·±çš„åº”ç”¨ç‰¹ç‚¹å’Œè¦æ±‚ç»„åˆå‡ºå„ä¸ªå†…å­˜åˆ†ä»£æ‰€ä½¿ç”¨çš„æ”¶é›†å™¨.")]),s._v(" "),t("p",[s._v('æœ¬èŠ‚æ ‡é¢˜ä¸­ "ç»å…¸" äºŒå­—å¹¶éæƒ…æ€€, å®ƒå…¶å®æ˜¯'),t("strong",[s._v("è®¨è®ºèŒƒå›´")]),s._v('çš„é™å®šè¯­, è¿™é‡Œè®¨è®ºçš„æ˜¯åœ¨ JDK 7 Update 4 ä¹‹å(åœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­æ­£å¼æä¾›äº†å•†ç”¨çš„ G1 æ”¶é›†å™¨, æ­¤å‰ G1 ä»å¤„äºå®éªŒçŠ¶æ€), JDK 11 æ­£å¼å‘å¸ƒä¹‹å‰, OracleJDK ä¸­çš„ HotSpot è™šæ‹Ÿæœºæ‰€åŒ…å«çš„å…¨éƒ¨å¯ç”¨çš„åƒåœ¾æ”¶é›†å™¨. ä½¿ç”¨ "ç»å…¸" äºŒå­—æ˜¯ä¸ºäº†ä¸å‡ æ¬¾ç›®å‰ä»å¤„äºå®éªŒçŠ¶æ€, ä½†æ‰§è¡Œæ•ˆæœä¸Šæœ‰é©å‘½æ€§æ”¹è¿›çš„é«˜æ€§èƒ½ä½å»¶è¿Ÿæ”¶é›†å™¨åŒºåˆ†å¼€æ¥, è¿™äº›ç»å…¸çš„æ”¶é›†å™¨å°½ç®¡å·²ç»ç®—ä¸ä¸Šæ˜¯æœ€å…ˆè¿›çš„æŠ€æœ¯, ä½†å®ƒä»¬æ›¾åœ¨å®è·µä¸­åƒé”¤ç™¾ç‚¼, è¶³å¤Ÿæˆç†Ÿ. å„æ¬¾ç»å…¸æ”¶é›†å™¨ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤º.')]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("æ–°ç”Ÿä»£æ”¶é›†å™¨")]),s._v(": Serial, ParNew, Parallel Scavenge æ”¶é›†å™¨.")]),s._v(" "),t("li",[t("strong",[s._v("è€å¹´ä»£æ”¶é›†å™¨")]),s._v(": Serial Old, ParNew Old, "),t("strong",[s._v("CMS æ”¶é›†å™¨")]),s._v(".")]),s._v(" "),t("li",[t("strong",[s._v("æ–°ç”Ÿä»£ä¸è€å¹´ä»£å‡å¯")]),s._v(": "),t("strong",[s._v("G1 æ”¶é›†å™¨, ZGC ç­‰")]),s._v(".")])]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/image-20230326141727-e2hy6yx.png",alt:"image",title:"HotSpot è™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†å™¨"}})]),s._v(" "),t("p",[s._v("è¿™é‡Œå±•ç¤ºäº†ä½œç”¨äºä¸åŒåˆ†ä»£çš„æ”¶é›†å™¨, å¦‚æœ"),t("strong",[s._v("ä¸¤ä¸ªæ”¶é›†å™¨ä¹‹é—´å­˜åœ¨è¿çº¿, å°±è¯´æ˜å®ƒä»¬å¯ä»¥æ­é…ä½¿ç”¨")]),s._v(", å›¾ä¸­æ”¶é›†å™¨æ‰€å¤„çš„åŒºåŸŸ, åˆ™è¡¨ç¤ºå®ƒæ˜¯"),t("strong",[s._v("å±äºæ–°ç”Ÿä»£æ”¶é›†å™¨æˆ–æ˜¯è€å¹´ä»£æ”¶é›†å™¨")]),s._v(". æ¥ä¸‹æ¥å°†é€ä¸€ä»‹ç»è¿™äº›æ”¶é›†å™¨çš„ç›®æ ‡, ç‰¹æ€§, åŸç†å’Œä½¿ç”¨åœºæ™¯, å¹¶é‡ç‚¹åˆ†æ CMS å’Œ G1è¿™ä¸¤æ¬¾ç›¸å¯¹å¤æ‚è€Œåˆå¹¿æ³›ä½¿ç”¨çš„æ”¶é›†å™¨, æ·±å…¥äº†è§£å®ƒä»¬çš„éƒ¨åˆ†è¿ä½œç»†èŠ‚.")]),s._v(" "),t("p",[s._v("åœ¨ä»‹ç»è¿™äº›æ”¶é›†å™¨å„è‡ªçš„ç‰¹æ€§ä¹‹å‰, å…ˆæ¥æ˜ç¡®ä¸€ä¸ªè§‚ç‚¹: è™½ç„¶è¿™é‡Œä¼šå¯¹å„ä¸ªæ”¶é›†å™¨è¿›è¡Œæ¯”è¾ƒ, ä½†å¹¶éä¸ºäº†æŒ‘é€‰ä¸€ä¸ªæœ€å¥½çš„æ”¶é›†å™¨å‡ºæ¥, è™½ç„¶åƒåœ¾æ”¶é›†å™¨çš„æŠ€æœ¯åœ¨ä¸æ–­è¿›æ­¥, ä½†"),t("mark",[t("strong",[s._v('ç›´åˆ°ç°åœ¨è¿˜æ²¡æœ‰æœ€å¥½çš„æ”¶é›†å™¨å‡ºç°, æ›´åŠ ä¸å­˜åœ¨ "ä¸‡èƒ½" çš„æ”¶é›†å™¨, æ‰€ä»¥åªèƒ½æ ¹æ®å…·ä½“åº”ç”¨åœºæ™¯é€‰æ‹©æœ€åˆé€‚çš„æ”¶é›†å™¨')])]),s._v(". è¿™ç‚¹ä¸éœ€è¦å¤šåŠ è®ºè¿°å°±èƒ½è¯æ˜: å¦‚æœæœ‰ä¸€ç§æ”¾ä¹‹å››æµ·çš†å‡†, ä»»ä½•åœºæ™¯ä¸‹éƒ½é€‚ç”¨çš„å®Œç¾æ”¶é›†å™¨å­˜åœ¨, HotSpot è™šæ‹Ÿæœºå®Œå…¨æ²¡å¿…è¦å®ç°é‚£ä¹ˆå¤šç§ä¸åŒçš„æ”¶é›†å™¨äº†.")]),s._v(" "),t("blockquote",[t("p",[s._v("å¹¶å‘ä¸å¹¶è¡Œ")])]),s._v(" "),t("p",[s._v("åé¢å°†ä¼šæ¥è§¦åˆ°è‹¥å¹²æ¬¾æ¶‰åŠ  "),t("strong",[s._v('"å¹¶å‘" å’Œ "å¹¶è¡Œ" æ¦‚å¿µçš„æ”¶é›†å™¨')]),s._v(". å…ˆè§£é‡Šæ¸…æ¥šè¿™ä¸¤ä¸ªåè¯. å¹¶è¡Œå’Œå¹¶å‘éƒ½æ˜¯å¹¶å‘ç¼–ç¨‹ä¸­çš„ä¸“ä¸šåè¯, åœ¨è°ˆè®ºåƒåœ¾æ”¶é›†å™¨çš„ä¸Šä¸‹æ–‡è¯­å¢ƒä¸­, å®ƒä»¬å¯ä»¥ç†è§£ä¸º:")]),s._v(" "),t("ul",[t("li",[t("mark",[t("strong",[s._v("å¹¶è¡Œ(Parallel)")])]),s._v("â€‹ "),t("strong",[s._v(": å¹¶è¡Œæè¿°çš„æ˜¯")]),s._v("â€‹"),t("mark",[t("strong",[s._v("å¤šæ¡åƒåœ¾æ”¶é›†å™¨çº¿ç¨‹ä¹‹é—´")])]),s._v("â€‹"),t("strong",[s._v("çš„å…³ç³», è¯´æ˜åŒä¸€æ—¶é—´æœ‰å¤šæ¡è¿™æ ·çš„çº¿ç¨‹åœ¨ååŒå·¥ä½œ, é€šå¸¸é»˜è®¤æ­¤æ—¶ç”¨æˆ·çº¿ç¨‹æ˜¯å¤„äºç­‰å¾…çŠ¶æ€.")])]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("å¹¶å‘(Concurrent)")])]),s._v("â€‹ "),t("strong",[s._v(": å¹¶å‘æè¿°çš„æ˜¯")]),s._v("â€‹"),t("mark",[t("strong",[s._v("åƒåœ¾æ”¶é›†å™¨çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹ä¹‹é—´")])]),s._v("â€‹"),t("strong",[s._v("çš„å…³ç³», è¯´æ˜åŒä¸€æ—¶é—´åƒåœ¾æ”¶é›†å™¨çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹éƒ½åœ¨è¿è¡Œ. ç”±äºç”¨æˆ·çº¿ç¨‹å¹¶æœªè¢«å†»ç»“, æ‰€ä»¥ç¨‹åºä»ç„¶èƒ½å“åº”æœåŠ¡è¯·æ±‚, ä½†ç”±äºåƒåœ¾æ”¶é›†å™¨çº¿ç¨‹å ç”¨äº†ä¸€éƒ¨åˆ†ç³»ç»Ÿèµ„æº, æ­¤æ—¶åº”ç”¨ç¨‹åºçš„å¤„ç†çš„ååé‡å°†å—åˆ°ä¸€å®šå½±å“.")])])]),s._v(" "),t("blockquote",[t("p",[s._v("å¹¶è¡Œä¸ä¸²è¡Œ")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("ä¸²è¡Œ")]),s._v("æŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨ä¸ç”¨æˆ·ç¨‹åº"),t("strong",[s._v("äº¤æ›¿æ‰§è¡Œ")]),s._v(", è¿™æ„å‘³ç€åœ¨æ‰§è¡Œåƒåœ¾æ”¶é›†çš„æ—¶å€™éœ€è¦"),t("strong",[s._v("åœé¡¿ç”¨æˆ·ç¨‹åº")]),s._v(".")]),s._v(" "),t("li",[t("strong",[s._v("å¹¶è¡Œ")]),s._v("æŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨å’Œç”¨æˆ·ç¨‹åº"),t("strong",[s._v("åŒæ—¶æ‰§è¡Œ")]),s._v(", åªæœ‰ "),t("strong",[s._v("CMS å’Œ G1 æ˜¯å¹¶è¡Œ")]),s._v("æ‰§è¡Œ.")])]),s._v(" "),t("blockquote",[t("p",[s._v("åœé¡¿æ—¶é—´ä¸ååé‡çš„æƒè¡¡")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("åœé¡¿æ—¶é—´è¶ŠçŸ­å°±è¶Šé€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„ç¨‹åº, è‰¯å¥½çš„å“åº”é€Ÿåº¦èƒ½æå‡ç”¨æˆ·ä½“éªŒ.")]),s._v("  ä½¿ç”¨ "),t("strong",[s._v("Parallel Scavenge å’Œ Parallel Old")]),s._v(" æ”¶é›†å™¨. ç¼©çŸ­åœé¡¿æ—¶é—´æ˜¯ä»¥ç‰ºç‰²ååé‡å’Œæ–°ç”Ÿä»£ç©ºé—´æ¥æ¢å–çš„: æ–°ç”Ÿä»£ç©ºé—´å˜å°, åƒåœ¾å›æ”¶å˜å¾—é¢‘ç¹, å¯¼è‡´ååé‡ä¸‹é™.")]),s._v(" "),t("li",[t("strong",[s._v("é«˜ååé‡åˆ™å¯ä»¥é«˜æ•ˆç‡åœ°åˆ©ç”¨ CPU æ—¶é—´, å°½å¿«å®Œæˆç¨‹åºçš„è¿ç®—ä»»åŠ¡, é€‚åˆåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡.")]),s._v("  å¯ä»¥ä½¿ç”¨ "),t("strong",[s._v("CMS")]),s._v(" æ”¶é›†å™¨.")])]),s._v(" "),t("blockquote",[t("p",[s._v("STW = Stop The World")])]),s._v(" "),t("p",[s._v("STW å°±æ˜¯è¿›è¡Œåƒåœ¾æ”¶é›†å·¥ä½œçš„æ—¶å€™å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„"),t("strong",[s._v("å·¥ä½œçº¿ç¨‹")]),s._v(".")]),s._v(" "),t("p",[s._v('"Stop The World" è¿™ä¸ªè¯è¯­ä¹Ÿè®¸å¬èµ·æ¥å¾ˆé…·, ä½†è¿™é¡¹å·¥ä½œæ˜¯ç”±è™šæ‹Ÿæœºåœ¨åå°è‡ªåŠ¨å‘èµ·å’Œè‡ªåŠ¨å®Œæˆçš„, åœ¨ç”¨æˆ·ä¸å¯çŸ¥, ä¸å¯æ§çš„æƒ…å†µä¸‹æŠŠç”¨æˆ·çš„æ­£å¸¸å·¥ä½œçš„çº¿ç¨‹å…¨éƒ¨åœæ‰, è¿™å¯¹å¾ˆå¤šåº”ç”¨æ¥è¯´éƒ½æ˜¯ä¸èƒ½æ¥å—çš„. å¯¹äº STW å¸¦ç»™ç”¨æˆ·çš„æ¶åŠ£ä½“éªŒ, æ—©æœŸ HotSpot è™šæ‹Ÿæœºçš„è®¾è®¡è€…ä»¬è¡¨ç¤ºå®Œå…¨ç†è§£, ä½†ä¹ŸåŒæ—¶è¡¨ç¤ºéå¸¸å§”å±ˆ: "ä½ å¦ˆå¦ˆåœ¨ç»™ä½ æ‰“æ‰«æˆ¿é—´çš„æ—¶å€™, è‚¯å®šä¹Ÿä¼šè®©ä½ è€è€å®å®åœ°åœ¨æ¤…å­ä¸Šæˆ–è€…æˆ¿é—´å¤–å¾…ç€, å¦‚æœå¥¹ä¸€è¾¹æ‰“æ‰«, ä½ ä¸€è¾¹ä¹±æ‰”çº¸å±‘, è¿™æˆ¿é—´è¿˜èƒ½æ‰“æ‰«å®Œ?" è¿™ç¡®å®æ˜¯ä¸€ä¸ªåˆæƒ…åˆç†çš„çŸ›ç›¾, è™½ç„¶åƒåœ¾æ”¶é›†è¿™é¡¹å·¥ä½œå¬èµ·æ¥å’Œæ‰“æ‰«æˆ¿é—´å±äºä¸€ä¸ªå·¥ç§, ä½†å®é™…ä¸Šè‚¯å®šè¿˜è¦æ¯”æ‰“æ‰«æˆ¿é—´å¤æ‚å¾—å¤š!')]),s._v(" "),t("p",[s._v("å› æ­¤, HotSpot è™šæ‹Ÿæœºå¼€å‘å›¢é˜Ÿ"),t("strong",[s._v("ä¸ºæ¶ˆé™¤æˆ–è€…é™ä½ç”¨æˆ·çº¿ç¨‹å› åƒåœ¾æ”¶é›†è€Œå¯¼è‡´åœé¡¿çš„åŠªåŠ›ä¸€ç›´æŒç»­è¿›è¡Œç€")]),s._v(", ä» Serial æ”¶é›†å™¨åˆ° Parallel æ”¶é›†å™¨, å†åˆ° Concurrent Mark Sweep(CMS)å’Œ Garbage First(G1)æ”¶é›†å™¨, æœ€ç»ˆè‡³ç°åœ¨åƒåœ¾æ”¶é›†å™¨çš„æœ€å‰æ²¿æˆæœ Shenandoah å’Œ ZGC ç­‰, å¯ä»¥çœ‹åˆ°ä¸€ä¸ªä¸ªè¶Šæ¥è¶Šæ„æ€ç²¾å·§, è¶Šæ¥è¶Šä¼˜ç§€, ä¹Ÿè¶Šæ¥è¶Šå¤æ‚çš„åƒåœ¾æ”¶é›†å™¨ä¸æ–­æ¶Œç°, ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´åœ¨æŒç»­ç¼©çŸ­, ä½†æ˜¯"),t("mark",[t("strong",[s._v("ä»ç„¶æ²¡æœ‰åŠæ³•å½»åº•æ¶ˆé™¤")])]),s._v("(è¿™é‡Œä¸å»è®¨è®º RTSJ ä¸­çš„æ”¶é›†å™¨), æ¢ç´¢æ›´ä¼˜ç§€åƒåœ¾æ”¶é›†å™¨çš„å·¥ä½œä»åœ¨ç»§ç»­.")]),s._v(" "),t("h5",{attrs:{id:"_2-serialæ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-serialæ”¶é›†å™¨"}},[s._v("#")]),s._v(" 2.Serialæ”¶é›†å™¨")]),s._v(" "),t("p",[s._v("è¿™ä¸ªæ”¶é›†å™¨æ˜¯ä¸€ä¸ª"),t("strong",[s._v("å•çº¿ç¨‹")]),s._v('å·¥ä½œçš„æ”¶é›†å™¨, ä½†å®ƒçš„ "å•çº¿ç¨‹" çš„æ„ä¹‰å¹¶ä¸ä»…ä»…æ˜¯è¯´æ˜å®ƒåªä¼šä½¿ç”¨ä¸€ä¸ªå¤„ç†å™¨æˆ–ä¸€æ¡æ”¶é›†çº¿ç¨‹å»å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œ, æ›´é‡è¦çš„æ˜¯å¼ºè°ƒåœ¨å®ƒ'),t("strong",[s._v("è¿›è¡Œåƒåœ¾æ”¶é›†æ—¶, å¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰å·¥ä½œçº¿ç¨‹(STW), ç›´åˆ°å®ƒæ”¶é›†ç»“æŸ")]),s._v(".")]),s._v(" "),t("p",[s._v("ä¸‹å›¾æ˜¯ Serial é…åˆ Serial Old ä¸€èµ·ä½¿ç”¨çš„è¿è¡Œè¿‡ç¨‹, è¿™é‡Œ"),t("strong",[s._v("æ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•, è€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•.")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521141659319.png",alt:"",title:"Serial/Serial Old æ”¶é›†å™¨è¿è¡Œç¤ºæ„å›¾"}})]),s._v(" "),t("p",[s._v("äº‹å®ä¸Š, è¿„ä»Šä¸ºæ­¢, å®ƒä¾ç„¶æ˜¯ HotSpot è™šæ‹Ÿæœºè¿è¡Œåœ¨å®¢æˆ·ç«¯æ¨¡å¼ä¸‹çš„é»˜è®¤æ–°ç”Ÿä»£æ”¶é›†å™¨, æœ‰ç€ä¼˜äºå…¶ä»–æ”¶é›†å™¨çš„åœ°æ–¹, é‚£å°±æ˜¯ç®€å•è€Œé«˜æ•ˆ(ä¸å…¶ä»–æ”¶é›†å™¨çš„å•çº¿ç¨‹ç›¸æ¯”), å¯¹äº"),t("strong",[s._v("å†…å­˜èµ„æºå—é™çš„ç¯å¢ƒ")]),s._v(", å®ƒæ˜¯æ‰€æœ‰æ”¶é›†å™¨é‡Œé¢å¤–å†…å­˜æ¶ˆè€—(Memory Footprint)æœ€å°çš„; å¯¹äº"),t("strong",[s._v("å•æ ¸å¤„ç†å™¨")]),s._v("æˆ–å¤„ç†å™¨æ ¸å¿ƒæ•°è¾ƒå°‘çš„ç¯å¢ƒæ¥è¯´, "),t("strong",[s._v("Serial æ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€, ä¸“å¿ƒåšåƒåœ¾æ”¶é›†è‡ªç„¶å¯ä»¥è·å¾—æœ€é«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡")]),s._v(". åœ¨ç”¨æˆ·æ¡Œé¢çš„åº”ç”¨åœºæ™¯ä»¥åŠè¿‘å¹´æ¥æµè¡Œçš„éƒ¨åˆ†å¾®æœåŠ¡åº”ç”¨ä¸­, åˆ†é…ç»™è™šæ‹Ÿæœºç®¡ç†çš„å†…å­˜ä¸€èˆ¬æ¥è¯´å¹¶ä¸ä¼šç‰¹åˆ«å¤§, æ”¶é›†å‡ åå…†ç”šè‡³ä¸€ä¸¤ç™¾å…†çš„æ–°ç”Ÿä»£(ä»…ä»…æ˜¯æŒ‡æ–°ç”Ÿä»£ä½¿ç”¨çš„å†…å­˜, æ¡Œé¢åº”ç”¨ç”šå°‘è¶…è¿‡è¿™ä¸ªå®¹é‡), åƒåœ¾æ”¶é›†çš„åœé¡¿æ—¶é—´å®Œå…¨å¯ä»¥æ§åˆ¶åœ¨å‡ åæ¯«ç§’, æœ€å¤šä¸€ç™¾å¤šæ¯«ç§’ä»¥å†…, åªè¦ä¸æ˜¯é¢‘ç¹å‘ç”Ÿæ”¶é›†, è¿™ç‚¹åœé¡¿æ—¶é—´å¯¹è®¸å¤šç”¨æˆ·æ¥è¯´æ˜¯å®Œå…¨å¯ä»¥æ¥å—çš„. æ‰€ä»¥ "),t("strong",[s._v("Serial æ”¶é›†å™¨å¯¹äºè¿è¡Œåœ¨å®¢æˆ·ç«¯æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºæ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©")]),s._v(".")]),s._v(" "),t("h5",{attrs:{id:"_3-parnewæ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-parnewæ”¶é›†å™¨"}},[s._v("#")]),s._v(" 3.ParNewæ”¶é›†å™¨")]),s._v(" "),t("blockquote",[t("p",[s._v("å·²ç»é€€å‡ºå†å²èˆå°")])]),s._v(" "),t("p",[s._v("Serial æ”¶é›†å™¨é€‚åˆ"),t("strong",[s._v("å• CPU")]),s._v(" ä¸‹å·¥ä½œ, å¦‚æœæœ‰"),t("strong",[s._v("å¤š CPU")]),s._v(", é‚£ä¹ˆå¯ä»¥è€ƒè™‘ç”¨ ParNew æ”¶é›†å™¨. "),t("strong",[s._v("ParNew æ”¶é›†å™¨å®è´¨ä¸Šæ˜¯ Serial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹å¹¶è¡Œç‰ˆæœ¬")]),s._v(", é™¤äº†åŒæ—¶ä½¿ç”¨å¤šæ¡çº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†ä¹‹å¤–, å…¶ä½™çš„è¡Œä¸ºåŒ…æ‹¬ Serial æ”¶é›†å™¨å¯ç”¨çš„æ‰€æœ‰æ§åˆ¶å‚æ•°, å…¶æ”¶é›†ç®—æ³•, Stop The World, å¯¹è±¡åˆ†é…è§„åˆ™, å›æ”¶ç­–ç•¥ç­‰éƒ½ä¸ Serial æ”¶é›†å™¨"),t("mark",[t("strong",[s._v("å®Œå…¨ä¸€è‡´")])]),s._v(", åœ¨å®ç°ä¸Šè¿™ä¸¤ç§æ”¶é›†å™¨ä¹Ÿå…±ç”¨äº†ç›¸å½“å¤šçš„ä»£ç . ParNew æ”¶é›†å™¨çš„å·¥ä½œè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521142052614.png",alt:"",title:"ParNew/Serial Old æ”¶é›†å™¨è¿è¡Œç¤ºæ„å›¾"}})]),s._v(" "),t("p",[s._v("ParNew æ”¶é›†å™¨é™¤äº†æ”¯æŒå¤šçº¿ç¨‹å¹¶è¡Œæ”¶é›†ä¹‹å¤–, å…¶ä»–ä¸ Serial æ”¶é›†å™¨ç›¸æ¯”å¹¶æ²¡æœ‰å¤ªå¤šåˆ›æ–°ä¹‹å¤„, ä½†å®ƒå´æ˜¯ä¸å°‘è¿è¡Œåœ¨"),t("strong",[s._v("æœåŠ¡ç«¯æ¨¡å¼")]),s._v("ä¸‹çš„ HotSpot è™šæ‹Ÿæœº, å°¤å…¶æ˜¯ JDK 7 ä¹‹å‰çš„é—ç•™ç³»ç»Ÿä¸­é¦–é€‰çš„æ–°ç”Ÿä»£æ”¶é›†å™¨, å…¶ä¸­æœ‰ä¸€ä¸ªä¸åŠŸèƒ½, æ€§èƒ½æ— å…³ä½†å…¶å®å¾ˆé‡è¦çš„åŸå› æ˜¯: "),t("strong",[s._v("é™¤äº† Serial æ”¶é›†å™¨å¤–, ç›®å‰åªæœ‰å®ƒèƒ½ä¸ CMS æ”¶é›†å™¨é…åˆå·¥ä½œ")]),s._v(".")]),s._v(" "),t("p",[s._v("å¯ä»¥è¯´ç›´åˆ° CMS çš„å‡ºç°æ‰å·©å›ºäº† ParNew çš„åœ°ä½, ä½†æˆä¹Ÿè§ä½•è´¥ä¹Ÿè§ä½•, éšç€åƒåœ¾æ”¶é›†å™¨æŠ€æœ¯çš„ä¸æ–­æ”¹è¿›, æ›´å…ˆè¿›çš„ G1 æ”¶é›†å™¨å¸¦ç€ CMS ç»§æ‰¿è€…å’Œæ›¿ä»£è€…çš„å…‰ç¯ç™»åœº. G1 æ˜¯ä¸€ä¸ªé¢å‘å…¨å †çš„æ”¶é›†å™¨, ä¸å†éœ€è¦å…¶ä»–æ–°ç”Ÿä»£æ”¶é›†å™¨çš„é…åˆå·¥ä½œ. æ‰€ä»¥è‡ª JDK 9 å¼€å§‹, ParNew åŠ  CMS æ”¶é›†å™¨çš„ç»„åˆå°±"),t("strong",[s._v("ä¸å†æ˜¯å®˜æ–¹æ¨è")]),s._v("çš„æœåŠ¡ç«¯æ¨¡å¼ä¸‹çš„æ”¶é›†å™¨è§£å†³æ–¹æ¡ˆäº†. å®˜æ–¹å¸Œæœ›å®ƒèƒ½å®Œå…¨è¢« G1 æ‰€å–ä»£, ç”šè‡³è¿˜å–æ¶ˆäº† ParNew åŠ  Serial Old ä»¥åŠ Serial åŠ  CMS è¿™ä¸¤ç»„æ”¶é›†å™¨ç»„åˆçš„æ”¯æŒ(å…¶å®åŸæœ¬ä¹Ÿå¾ˆå°‘äººè¿™æ ·ä½¿ç”¨), è¿™æ„å‘³ç€ ParNew å’Œ CMS ä»æ­¤åªèƒ½äº’ç›¸æ­é…ä½¿ç”¨, å†ä¹Ÿæ²¡æœ‰å…¶ä»–æ”¶é›†å™¨èƒ½å¤Ÿå’Œå®ƒä»¬é…åˆäº†. è¯»è€…ä¹Ÿå¯ä»¥ç†è§£ä¸ºä»æ­¤ä»¥å, ParNew åˆå¹¶å…¥ CMS, æˆä¸ºå®ƒä¸“é—¨å¤„ç†æ–°ç”Ÿä»£çš„ç»„æˆéƒ¨åˆ†. "),t("strong",[s._v("ParNew å¯ä»¥è¯´æ˜¯ HotSpot è™šæ‹Ÿæœºä¸­ç¬¬ä¸€æ¬¾é€€å‡ºå†å²èˆå°")]),s._v("çš„åƒåœ¾æ”¶é›†å™¨.")]),s._v(" "),t("h5",{attrs:{id:"_4-parallel-scavengeæ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-parallel-scavengeæ”¶é›†å™¨"}},[s._v("#")]),s._v(" 4.Parallel Scavengeæ”¶é›†å™¨")]),s._v(" "),t("p",[s._v("ä¸ ParNew ä¸€æ ·æ˜¯"),t("strong",[s._v("å¤šçº¿ç¨‹")]),s._v("æ”¶é›†å™¨. ä½†æ˜¯ä¸»è¦å…³æ³¨"),t("strong",[s._v("ååé‡")]),s._v(". å› æ­¤å®ƒè¢«ç§°ä¸º  "),t("strong",[s._v('"ååé‡ä¼˜å…ˆ"')]),s._v("  æ”¶é›†å™¨. è¿™é‡Œçš„"),t("strong",[s._v("ååé‡")]),s._v("æŒ‡ CPU ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´å æ€»æ—¶é—´çš„æ¯”å€¼.")]),s._v(" "),t("blockquote",[t("p",[s._v("ååé‡ = è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ / (è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ + åƒåœ¾æ”¶é›†æ—¶é—´)")])]),s._v(" "),t("p",[s._v("å¦‚æœè™šæ‹Ÿæœºå®ŒæˆæŸä¸ªä»»åŠ¡, ç”¨æˆ·ä»£ç åŠ ä¸Šåƒåœ¾æ”¶é›†æ€»å…±è€—è´¹äº† 100 åˆ†é’Ÿ, å…¶ä¸­åƒåœ¾æ”¶é›†èŠ±æ‰ 1 åˆ†é’Ÿ, é‚£ååé‡å°±æ˜¯ 99%. "),t("mark",[t("strong",[s._v("åœé¡¿æ—¶é—´è¶ŠçŸ­")])]),s._v("â€‹"),t("strong",[s._v("å°±è¶Šé€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’æˆ–éœ€è¦ä¿è¯æœåŠ¡å“åº”è´¨é‡çš„ç¨‹åº, è‰¯å¥½çš„å“åº”é€Ÿåº¦èƒ½æå‡ç”¨æˆ·ä½“éªŒ; è€Œ")]),s._v("â€‹"),t("mark",[t("strong",[s._v("é«˜ååé‡")])]),s._v("â€‹"),t("strong",[s._v("åˆ™å¯ä»¥æœ€é«˜æ•ˆç‡åœ°åˆ©ç”¨å¤„ç†å™¨èµ„æº, å°½å¿«å®Œæˆç¨‹åºçš„è¿ç®—ä»»åŠ¡, ä¸»è¦é€‚åˆåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„åˆ†æä»»åŠ¡")]),s._v(".")]),s._v(" "),t("p",[s._v("ä¸‹å›¾æ˜¯ Parallel Scavenge æ­é… Parallel Old, è¿™é‡Œ"),t("strong",[s._v("æ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•, è€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•.")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521142336388.png",alt:""}})]),s._v(" "),t("blockquote",[t("p",[s._v("ååé‡æ§åˆ¶å‚æ•°")])]),s._v(" "),t("p",[s._v("Parallel Scavenge æ”¶é›†å™¨æä¾›äº†ä¸¤ä¸ªå‚æ•°ç”¨äºç²¾ç¡®æ§åˆ¶ååé‡, åˆ†åˆ«æ˜¯æ§åˆ¶æœ€å¤§åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´çš„ "),t("code",[s._v("-XX: MaxGCPauseMillis")]),s._v("â€‹ å‚æ•°ä»¥åŠç›´æ¥è®¾ç½®ååé‡å¤§å°çš„ "),t("code",[s._v("-XX: GCTimeRatio")]),s._v("â€‹ å‚æ•°.")]),s._v(" "),t("ul",[t("li",[s._v("â€‹"),t("code",[s._v("-XX: MaxGCPauseMillis")]),s._v("â€‹ å‚æ•°æ˜¯"),t("strong",[s._v("æœ€å¤§åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´")]),s._v(". æ”¶é›†å™¨å°†å°½åŠ›ä¿è¯å†…å­˜å›æ”¶èŠ±è´¹çš„æ—¶é—´ä¸è¶…è¿‡ç”¨æˆ·è®¾å®šå€¼. ä¸è¿‡å¤§å®¶"),t("strong",[s._v("ä¸è¦å¼‚æƒ³å¤©å¼€åœ°è®¤ä¸ºå¦‚æœæŠŠè¿™ä¸ªå‚æ•°çš„å€¼è®¾ç½®å¾—æ›´å°ä¸€ç‚¹å°±èƒ½ä½¿å¾—ç³»ç»Ÿçš„åƒåœ¾æ”¶é›†é€Ÿåº¦å˜å¾—æ›´å¿«")]),s._v(", åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´ç¼©çŸ­æ˜¯ä»¥ç‰ºç‰²ååé‡å’Œæ–°ç”Ÿä»£ç©ºé—´ä¸ºä»£ä»·æ¢å–çš„: ç³»ç»ŸæŠŠæ–°ç”Ÿä»£è°ƒå¾—å°ä¸€äº›, æ”¶é›† 300MB æ–°ç”Ÿä»£è‚¯å®šæ¯”æ”¶é›† 500MB å¿«, ä½†è¿™ä¹Ÿç›´æ¥å¯¼è‡´åƒåœ¾æ”¶é›†å‘ç”Ÿå¾—æ›´é¢‘ç¹, åŸæ¥ 10 ç§’æ”¶é›†ä¸€æ¬¡, æ¯æ¬¡åœé¡¿ 100 æ¯«ç§’, ç°åœ¨å˜æˆ 5 ç§’æ”¶é›†ä¸€æ¬¡, æ¯æ¬¡åœé¡¿ 70 æ¯«ç§’. "),t("strong",[s._v("åœé¡¿æ—¶é—´çš„ç¡®åœ¨ä¸‹é™, ä½†ååé‡ä¹Ÿé™ä¸‹æ¥äº†")]),s._v(".")]),s._v(" "),t("li",[s._v("â€‹"),t("code",[s._v("-XX: GCTimeRatio")]),s._v("â€‹ å‚æ•°çš„å€¼åˆ™åº”å½“æ˜¯ä¸€ä¸ªå¤§äº 0 å°äº 100 çš„æ•´æ•°, ä¹Ÿå°±æ˜¯"),t("strong",[s._v("åƒåœ¾æ”¶é›†æ—¶é—´å æ€»æ—¶é—´çš„æ¯”ç‡")]),s._v(", ç›¸å½“äº"),t("strong",[s._v("ååé‡çš„å€’æ•°")]),s._v(". è­¬å¦‚æŠŠæ­¤å‚æ•°è®¾ç½®ä¸º 19, é‚£å…è®¸çš„æœ€å¤§åƒåœ¾æ”¶é›†æ—¶é—´å°±å æ€»æ—¶é—´çš„ 5% (å³ 1 / (1 + 19)), é»˜è®¤å€¼ä¸º 99, å³å…è®¸æœ€å¤§ 1% (å³ 1 / (1 + 99)) çš„åƒåœ¾æ”¶é›†æ—¶é—´.")])]),s._v(" "),t("p",[s._v("å¯ä»¥é€šè¿‡  "),t("strong",[s._v("-XX:+UserAdaptiveSizePolicy")]),s._v(" å‚æ•°æ‰“å¼€ GC "),t("strong",[s._v("è‡ªé€‚åº”çš„è°ƒèŠ‚ç­–ç•¥")]),s._v(", å°±ä¸éœ€è¦æ‰‹å·¥æŒ‡å®šæ–°ç”Ÿä»£çš„å¤§å°, Eden å’Œ Survivor åŒºçš„æ¯”ä¾‹, æ™‹å‡è€å¹´ä»£å¯¹è±¡å¹´é¾„ç­‰ç»†èŠ‚å‚æ•°äº†. è™šæ‹Ÿæœºä¼šæ ¹æ®å½“å‰ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯, "),t("strong",[s._v("åŠ¨æ€è°ƒæ•´")]),s._v("è¿™äº›å‚æ•°ä»¥æä¾›æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–è€…æœ€å¤§çš„ååé‡.")]),s._v(" "),t("h5",{attrs:{id:"_5-serial-oldæ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-serial-oldæ”¶é›†å™¨"}},[s._v("#")]),s._v(" 5.Serial Oldæ”¶é›†å™¨")]),s._v(" "),t("p",[t("strong",[s._v("Serial Old æ˜¯ Serial æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬, å®ƒåŒæ ·æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨, ä½¿ç”¨æ ‡è®°-æ•´ç†ç®—æ³•")]),s._v(". è¿™ä¸ªæ”¶é›†å™¨çš„ä¸»è¦æ„ä¹‰ä¹Ÿæ˜¯ä¾›"),t("strong",[s._v("å®¢æˆ·ç«¯æ¨¡å¼")]),s._v("ä¸‹çš„ HotSpot è™šæ‹Ÿæœºä½¿ç”¨. å¦‚æœåœ¨æœåŠ¡ç«¯æ¨¡å¼ä¸‹, å®ƒä¹Ÿå¯èƒ½æœ‰ä¸¤ç§ç”¨é€”: ä¸€ç§æ˜¯åœ¨ JDK 5 ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸­ä¸ Parallel Scavenge æ”¶é›†å™¨æ­é…ä½¿ç”¨, å¦å¤–ä¸€ç§å°±æ˜¯ä½œä¸º CMS æ”¶é›†å™¨å‘ç”Ÿå¤±è´¥æ—¶çš„åå¤‡é¢„æ¡ˆ, åœ¨å¹¶å‘æ”¶é›†å‘ç”Ÿ Concurrent Mode Failure æ—¶ä½¿ç”¨. è¿™ä¸¤ç‚¹éƒ½å°†åœ¨åé¢çš„å†…å®¹ä¸­ç»§ç»­è®²è§£. Serial Old æ”¶é›†å™¨çš„å·¥ä½œè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521141659319.png",alt:"",title:"Serial/Serial Old æ”¶é›†å™¨è¿è¡Œç¤ºæ„å›¾"}})]),s._v(" "),t("h5",{attrs:{id:"_6-parallel-oldæ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-parallel-oldæ”¶é›†å™¨"}},[s._v("#")]),s._v(" 6.Parallel Oldæ”¶é›†å™¨")]),s._v(" "),t("p",[t("strong",[s._v("Parallel Old æ˜¯ Parallel Scavenge æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬, æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘æ”¶é›†, åŸºäºæ ‡è®°-æ•´ç†ç®—æ³•å®ç°,")]),s._v("  ä¹Ÿæ˜¯å…³æ³¨"),t("strong",[s._v("ååé‡")]),s._v(".")]),s._v(" "),t("p",[s._v('ç›´åˆ° Parallel Old æ”¶é›†å™¨å‡ºç°å, "'),t("strong",[s._v("ååé‡ä¼˜å…ˆ")]),s._v('" æ”¶é›†å™¨ç»ˆäºæœ‰äº†æ¯”è¾ƒåå‰¯å…¶å®çš„æ­é…ç»„åˆ, '),t("strong",[s._v("åœ¨æ³¨é‡ååé‡æˆ–è€…å¤„ç†å™¨èµ„æºè¾ƒä¸ºç¨€ç¼ºçš„åœºåˆ, éƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ Parallel Scavenge åŠ  Parallel Old æ”¶é›†å™¨è¿™ä¸ªç»„åˆ")]),s._v(". Parallel Old æ”¶é›†å™¨çš„å·¥ä½œè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521142336388.png",alt:"",title:"Parallel Scavenge/Parallel Old æ”¶é›†å™¨è¿è¡Œç¤ºæ„å›¾"}})]),s._v(" "),t("h5",{attrs:{id:"_7-cmsæ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-cmsæ”¶é›†å™¨"}},[s._v("#")]),s._v(" 7.CMSæ”¶é›†å™¨")]),s._v(" "),t("p",[t("strong",[s._v("CMS(Concurrent Mark Sweep)æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–")]),s._v("â€‹"),t("mark",[t("strong",[s._v("æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´")])]),s._v("â€‹"),t("strong",[s._v("ä¸ºç›®æ ‡çš„æ”¶é›†å™¨")]),s._v(". ç›®å‰å¾ˆå¤§ä¸€éƒ¨åˆ†çš„ Java åº”ç”¨é›†ä¸­åœ¨äº’è”ç½‘ç½‘ç«™æˆ–è€…åŸºäºæµè§ˆå™¨çš„ B/S ç³»ç»Ÿçš„"),t("strong",[s._v("æœåŠ¡ç«¯")]),s._v("ä¸Š, è¿™ç±»åº”ç”¨é€šå¸¸éƒ½ä¼šè¾ƒä¸ºå…³æ³¨æœåŠ¡çš„"),t("strong",[s._v("å“åº”é€Ÿåº¦")]),s._v(", å¸Œæœ›ç³»ç»Ÿåœé¡¿æ—¶é—´å°½å¯èƒ½çŸ­, ä»¥ç»™ç”¨æˆ·å¸¦æ¥è‰¯å¥½çš„äº¤äº’ä½“éªŒ. æ¯”å¦‚"),t("strong",[s._v("æœåŠ¡å™¨å°¤å…¶é‡è§†æœåŠ¡å“åº”é€Ÿåº¦")]),s._v(", å¸Œæœ›ç³»ç»Ÿçš„åœé¡¿æ—¶é—´æœ€çŸ­. "),t("strong",[s._v("å®ƒéå¸¸ç¬¦åˆåœ¨æ³¨é‡ç”¨æˆ·ä½“éªŒçš„åº”ç”¨ä¸Šä½¿ç”¨, å®ƒæ˜¯ HotSpot è™šæ‹Ÿæœºç¬¬ä¸€æ¬¾çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨, å®ƒç¬¬ä¸€æ¬¡å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹(åŸºæœ¬ä¸Š)åŒæ—¶å·¥ä½œ")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("å†…å­˜è¾ƒå°")]),s._v("çš„ç³»ç»Ÿå¯ä»¥ä½¿ç”¨: "),t("strong",[s._v("ParNew + CMS,")]),s._v("  ä¸€èˆ¬çš„åº”ç”¨åœºæ™¯å¯ä»¥ç”¨è¿™ä¸ªç»„åˆ.")]),s._v(" "),t("blockquote",[t("p",[s._v("æ”¶é›†æµç¨‹")])]),s._v(" "),t("p",[s._v('ä»åå­—(åŒ…å« "Mark Sweep")ä¸Šå°±å¯ä»¥çœ‹å‡º CMS æ”¶é›†å™¨æ˜¯åŸºäº'),t("strong",[s._v("æ ‡è®°-æ¸…é™¤")]),s._v("ç®—æ³•å®ç°çš„, å®ƒçš„è¿ä½œè¿‡ç¨‹ç›¸å¯¹äºå‰é¢å‡ ç§æ”¶é›†å™¨æ¥è¯´è¦æ›´å¤æ‚ä¸€äº›, æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤, åŒ…æ‹¬:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("åˆå§‹æ ‡è®°(STW)")]),s._v(" : åˆå§‹æ ‡è®°ä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹ GC Roots èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡, é€Ÿåº¦"),t("strong",[s._v("å¾ˆå¿«")]),s._v(".")]),s._v(" "),t("li",[t("strong",[s._v("å¹¶å‘æ ‡è®°")]),s._v(": å¹¶å‘æ ‡è®°é˜¶æ®µå°±æ˜¯"),t("strong",[s._v("ä» GC Roots çš„ç›´æ¥å…³è”å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾çš„è¿‡ç¨‹, è¿™ä¸ªè¿‡ç¨‹è€—æ—¶è¾ƒé•¿ä½†æ˜¯ä¸éœ€è¦åœé¡¿ç”¨æˆ·çº¿ç¨‹, å¯ä»¥ä¸åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸€èµ·å¹¶å‘è¿è¡Œ")]),s._v(". ç”±äºç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œ, æ‰€ä»¥å¯èƒ½ä¼šæœ‰å¯¼è‡´å·²ç»æ ‡è®°è¿‡çš„å¯¹è±¡çŠ¶æ€å‘ç”Ÿæ”¹å˜. æ¯”å¦‚æœ‰çš„å¯¹è±¡åœ¨å¼€å§‹å¹¶å‘æ ‡è®°çš„æ—¶å€™æ˜¯å­˜æ´»çš„, ä½†æ˜¯å¹¶å‘æ ‡è®°ä¸ä¼š STW, éšç€ç”¨æˆ·çº¿ç¨‹é‡Šæ”¾åå°±å˜æˆåƒåœ¾å¯¹è±¡äº†.")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521143207389.png",alt:""}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("é‡æ–°æ ‡è®°(STW)")]),s._v(" : é‡æ–°æ ‡è®°é˜¶æ®µåˆ™æ˜¯ä¸ºäº†"),t("strong",[s._v("ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´, å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•")]),s._v("(è¯¦è§å…³äºå¢é‡æ›´æ–°çš„è®²è§£), è¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´é€šå¸¸ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µç¨é•¿ä¸€äº›, ä½†ä¹Ÿè¿œæ¯”å¹¶å‘æ ‡è®°é˜¶æ®µçš„æ—¶é—´çŸ­.")]),s._v(" "),t("li",[t("strong",[s._v("å¹¶å‘æ¸…é™¤")]),s._v(": å¼€å¯ç”¨æˆ·çº¿ç¨‹, åŒæ—¶ GC çº¿ç¨‹å¼€å§‹"),t("strong",[s._v("æ¸…ç†åˆ é™¤æ‰æ ‡è®°é˜¶æ®µåˆ¤æ–­çš„å·²ç»æ­»äº¡çš„å¯¹è±¡, ç”±äºä¸éœ€è¦ç§»åŠ¨å­˜æ´»å¯¹è±¡, æ‰€ä»¥è¿™ä¸ªé˜¶æ®µä¹Ÿæ˜¯å¯ä»¥ä¸ç”¨æˆ·çº¿ç¨‹åŒæ—¶å¹¶å‘çš„")]),s._v(".")])]),s._v(" "),t("p",[s._v("ç”±äºåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­, éœ€è¦ STW çš„åœ°æ–¹éƒ½æ˜¯è€—æ—¶æ¯”è¾ƒçŸ­çš„åˆå§‹æ ‡è®°å’Œé‡æ–°æ ‡è®°é˜¶æ®µ, è€Œ"),t("strong",[s._v("è€—æ—¶æœ€é•¿çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤é˜¶æ®µä¸­, åƒåœ¾æ”¶é›†å™¨çº¿ç¨‹éƒ½å¯ä»¥ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å·¥ä½œè€Œä¸éœ€è¦åœé¡¿")]),s._v(", æ‰€ä»¥ä»æ€»ä½“ä¸Šæ¥è¯´, CMS æ”¶é›†å™¨çš„å†…å­˜å›æ”¶è¿‡ç¨‹æ˜¯ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘æ‰§è¡Œçš„. é€šè¿‡ä¸‹å›¾å¯ä»¥æ¯”è¾ƒæ¸…æ¥šåœ°çœ‹åˆ° CMS æ”¶é›†å™¨çš„è¿ä½œæ­¥éª¤ä¸­å¹¶å‘å’Œéœ€è¦åœé¡¿çš„é˜¶æ®µ.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521154058783.png",alt:"",title:"Concurrent Mark Sweep æ”¶é›†å™¨è¿è¡Œç¤ºæ„å›¾"}})]),s._v(" "),t("blockquote",[t("p",[s._v("CMSä¼˜ç¼ºç‚¹")])]),s._v(" "),t("p",[s._v("CMS æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æ”¶é›†å™¨, å®ƒæœ€ä¸»è¦çš„"),t("strong",[s._v("ä¼˜ç‚¹")]),s._v("åœ¨åå­—ä¸Šå·²ç»ä½“ç°å‡ºæ¥: "),t("strong",[s._v("å¹¶å‘æ”¶é›†, ä½åœé¡¿")]),s._v(', ä¸€äº›å®˜æ–¹å…¬å¼€æ–‡æ¡£é‡Œé¢ä¹Ÿç§°ä¹‹ä¸º "å¹¶å‘ä½åœé¡¿æ”¶é›†å™¨"(Concurrent Low Pause Collector).')]),s._v(" "),t("p",[s._v("CMS æ”¶é›†å™¨æ˜¯ HotSpot è™šæ‹Ÿæœºè¿½æ±‚ä½åœé¡¿çš„ç¬¬ä¸€æ¬¡æˆåŠŸå°è¯•, ä½†æ˜¯å®ƒè¿˜è¿œè¾¾ä¸åˆ°å®Œç¾çš„ç¨‹åº¦, è‡³å°‘æœ‰"),t("strong",[s._v("ä»¥ä¸‹ä¸‰ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹")]),s._v(":")]),s._v(" "),t("ul",[t("li",[s._v("é¦–å…ˆ, "),t("strong",[s._v("CMS æ”¶é›†å™¨å¯¹ CPU èµ„æºéå¸¸æ•æ„Ÿ")]),s._v(". äº‹å®ä¸Š, é¢å‘å¹¶å‘è®¾è®¡çš„ç¨‹åºéƒ½å¯¹å¤„ç†å™¨èµ„æºæ¯”è¾ƒæ•æ„Ÿ. åœ¨å¹¶å‘é˜¶æ®µ, å®ƒè™½ç„¶ä¸ä¼šå¯¼è‡´ç”¨æˆ·çº¿ç¨‹åœé¡¿, ä½†å´ä¼šå› ä¸ºå ç”¨äº†ä¸€éƒ¨åˆ†çº¿ç¨‹(æˆ–è€…è¯´å¤„ç†å™¨çš„è®¡ç®—èƒ½åŠ›)è€Œå¯¼è‡´åº”ç”¨ç¨‹åºå˜æ…¢, "),t("strong",[s._v("é™ä½æ€»ååé‡")]),s._v(". CMS é»˜è®¤å¯åŠ¨çš„å›æ”¶çº¿ç¨‹æ•°æ˜¯ (å¤„ç†å™¨æ ¸å¿ƒæ•°é‡ + 3) / 4, ä¹Ÿå°±æ˜¯è¯´, å¦‚æœå¤„ç†å™¨æ ¸å¿ƒæ•°åœ¨å››ä¸ªæˆ–ä»¥ä¸Š, å¹¶å‘å›æ”¶æ—¶åƒåœ¾æ”¶é›†çº¿ç¨‹åªå ç”¨ä¸è¶…è¿‡ 25% çš„å¤„ç†å™¨è¿ç®—èµ„æº, å¹¶ä¸”ä¼šéšç€å¤„ç†å™¨æ ¸å¿ƒæ•°é‡çš„å¢åŠ è€Œä¸‹é™. ä½†æ˜¯å½“å¤„ç†å™¨æ ¸å¿ƒæ•°é‡ä¸è¶³å››ä¸ªæ—¶, CMS å¯¹ç”¨æˆ·ç¨‹åºçš„å½±å“å°±å¯èƒ½å˜å¾—å¾ˆå¤§. "),t("strong",[s._v("å¦‚æœåº”ç”¨æœ¬æ¥çš„å¤„ç†å™¨è´Ÿè½½å°±å¾ˆé«˜, è¿˜è¦åˆ†å‡ºä¸€åŠçš„è¿ç®—èƒ½åŠ›å»æ‰§è¡Œæ”¶é›†å™¨çº¿ç¨‹, å°±å¯èƒ½å¯¼è‡´ç”¨æˆ·ç¨‹åºçš„æ‰§è¡Œé€Ÿåº¦å¿½ç„¶å¤§å¹…é™ä½")]),s._v(".")]),s._v(" "),t("li",[s._v("ç„¶å, "),t("strong",[s._v("æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾, ä»è€Œå¯¼è‡´æ‰§è¡Œè¿‡ç¨‹å­˜åœ¨ä¸ç¡®å®šæ€§")]),s._v('. ç”±äº CMS æ”¶é›†å™¨æ— æ³•å¤„ç† "æµ®åŠ¨åƒåœ¾"(Floating Garbage), æœ‰å¯èƒ½å‡ºç° "Con-current Mode Failure" å¤±è´¥è¿›è€Œå¯¼è‡´å¦ä¸€æ¬¡ Full GC çš„äº§ç”Ÿ. åœ¨ CMS çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…ç†é˜¶æ®µ, ç”¨æˆ·çº¿ç¨‹æ˜¯è¿˜åœ¨ç»§ç»­è¿è¡Œçš„, ç¨‹åºåœ¨è¿è¡Œè‡ªç„¶å°±è¿˜ä¼šä¼´éšæœ‰'),t("strong",[s._v("æ–°çš„åƒåœ¾")]),s._v('å¯¹è±¡ä¸æ–­äº§ç”Ÿ, ä½†è¿™ä¸€éƒ¨åˆ†åƒåœ¾å¯¹è±¡æ˜¯å‡ºç°åœ¨æ ‡è®°è¿‡ç¨‹ç»“æŸä»¥å, CMS æ— æ³•åœ¨å½“æ¬¡æ”¶é›†ä¸­å¤„ç†æ‰å®ƒä»¬, åªå¥½ç•™å¾…ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†æ—¶å†æ¸…ç†æ‰. è¿™ä¸€éƒ¨åˆ†åƒåœ¾å°±ç§°ä¸º "'),t("mark",[t("strong",[s._v("æµ®åŠ¨åƒåœ¾")])]),s._v('". åŒæ ·ä¹Ÿæ˜¯ç”±äºåœ¨åƒåœ¾æ”¶é›†é˜¶æ®µç”¨æˆ·çº¿ç¨‹è¿˜éœ€è¦æŒç»­è¿è¡Œ, é‚£å°±è¿˜éœ€è¦é¢„ç•™è¶³å¤Ÿå†…å­˜ç©ºé—´æä¾›ç»™ç”¨æˆ·çº¿ç¨‹ä½¿ç”¨, å› æ­¤ CMS æ”¶é›†å™¨ä¸èƒ½åƒå…¶ä»–æ”¶é›†å™¨é‚£æ ·ç­‰å¾…åˆ°è€å¹´ä»£å‡ ä¹å®Œå…¨è¢«å¡«æ»¡äº†å†è¿›è¡Œæ”¶é›†, å¿…é¡»é¢„ç•™ä¸€éƒ¨åˆ†ç©ºé—´ä¾›å¹¶å‘æ”¶é›†æ—¶çš„ç¨‹åºè¿ä½œä½¿ç”¨.')]),s._v(" "),t("li",[s._v('è¿˜æœ‰æœ€åä¸€ä¸ªç¼ºç‚¹, CMS æ˜¯ä¸€æ¬¾åŸºäº "æ ‡è®°-æ¸…é™¤" ç®—æ³•(å‚è€ƒ: æ ‡è®°-æ¸…é™¤ç®—æ³•)å®ç°çš„æ”¶é›†å™¨, è¿™æ„å‘³ç€'),t("strong",[s._v("æ”¶é›†ç»“æŸæ—¶å¯èƒ½ä¼šæœ‰å¤§é‡ç©ºé—´ç¢ç‰‡äº§ç”Ÿ")]),s._v(". ç©ºé—´ç¢ç‰‡è¿‡å¤šæ—¶, å°†ä¼šç»™å¤§å¯¹è±¡åˆ†é…å¸¦æ¥å¾ˆå¤§éº»çƒ¦, å¾€å¾€ä¼šå‡ºç°è€å¹´ä»£è¿˜æœ‰å¾ˆå¤šå‰©ä½™ç©ºé—´, ä½†å°±æ˜¯æ— æ³•æ‰¾åˆ°è¶³å¤Ÿå¤§çš„è¿ç»­ç©ºé—´æ¥åˆ†é…å½“å‰å¯¹è±¡, è€Œä¸å¾—ä¸æå‰è§¦å‘ä¸€æ¬¡ Full GC çš„æƒ…å†µ.")])]),s._v(" "),t("h5",{attrs:{id:"_8-garbage-firstæ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-garbage-firstæ”¶é›†å™¨"}},[s._v("#")]),s._v(" 8.Garbage Firstæ”¶é›†å™¨")]),s._v(" "),t("h6",{attrs:{id:"_1-åŸºç¡€-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-åŸºç¡€-2"}},[s._v("#")]),s._v(" (1)åŸºç¡€")]),s._v(" "),t("p",[s._v("Garbage First(ç®€ç§° G1)æ”¶é›†å™¨æ˜¯åƒåœ¾æ”¶é›†å™¨æŠ€æœ¯å‘å±•å†å²ä¸Šçš„é‡Œç¨‹ç¢‘å¼çš„æˆæœ, å®ƒå¼€åˆ›äº†æ”¶é›†å™¨"),t("strong",[s._v("é¢å‘å±€éƒ¨æ”¶é›†çš„è®¾è®¡æ€è·¯å’ŒåŸºäº Region çš„å†…å­˜å¸ƒå±€å½¢å¼")]),s._v(". JDK 8 Update 40 "),t("strong",[s._v('è¿™ä¸ªç‰ˆæœ¬ä»¥åçš„ G1 æ”¶é›†å™¨æ‰è¢« Oracle å®˜æ–¹ç§°ä¸º "å…¨åŠŸèƒ½çš„åƒåœ¾æ”¶é›†å™¨"(Fully-Featured Garbage Collector)')]),s._v(" .")]),s._v(" "),t("p",[s._v("G1 æ˜¯ä¸€æ¬¾ä¸»è¦é¢å‘"),t("strong",[s._v("æœåŠ¡ç«¯åº”ç”¨")]),s._v("çš„åƒåœ¾æ”¶é›†å™¨, ä¸»è¦é’ˆå¯¹é…å¤‡"),t("strong",[s._v("å¤š CPU åŠå¤§å®¹é‡å†…å­˜")]),s._v("çš„æœºå™¨. HotSpot å¼€å‘å›¢é˜Ÿæœ€åˆèµ‹äºˆå®ƒçš„æœŸæœ›æ˜¯(åœ¨æ¯”è¾ƒé•¿æœŸçš„)æœªæ¥å¯ä»¥æ›¿æ¢æ‰ CMS æ”¶é›†å™¨. JDK 9 å‘å¸ƒä¹‹æ—¥, G1 å®£å‘Šå–ä»£ Parallel Scavenge åŠ  Parallel Old ç»„åˆ, "),t("mark",[t("strong",[s._v("æˆä¸ºæœåŠ¡ç«¯æ¨¡å¼ä¸‹çš„é»˜è®¤åƒåœ¾æ”¶é›†å™¨")])]),s._v(", è€Œ CMS åˆ™æ²¦è½è‡³è¢«å£°æ˜ä¸º"),t("strong",[s._v("ä¸æ¨èä½¿ç”¨")]),s._v("(Deprecate)çš„æ”¶é›†å™¨.")]),s._v(" "),t("p",[s._v('ä½œä¸º CMS æ”¶é›†å™¨çš„æ›¿ä»£è€…å’Œç»§æ‰¿äºº, è®¾è®¡è€…ä»¬å¸Œæœ›åšå‡ºä¸€æ¬¾èƒ½å¤Ÿå»ºç«‹èµ· "'),t("mark",[t("strong",[s._v("åœé¡¿æ—¶é—´æ¨¡å‹")])]),s._v('"(Pause Prediction Model)çš„æ”¶é›†å™¨, '),t("strong",[s._v("åœé¡¿æ—¶é—´æ¨¡å‹çš„æ„æ€æ˜¯èƒ½å¤Ÿæ”¯æŒæŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸º M æ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…, æ¶ˆè€—åœ¨åƒåœ¾æ”¶é›†ä¸Šçš„æ—¶é—´å¤§æ¦‚ç‡ä¸è¶…è¿‡ N æ¯«ç§’è¿™æ ·çš„ç›®æ ‡, è¿™å‡ ä¹å·²ç»æ˜¯å®æ—¶ Java(RTSJ)çš„ä¸­è½¯å®æ—¶åƒåœ¾æ”¶é›†å™¨ç‰¹å¾äº†")]),s._v(".")]),s._v(" "),t("p",[s._v("é‚£å…·ä½“è¦æ€ä¹ˆåšæ‰èƒ½å®ç°è¿™ä¸ªç›®æ ‡å‘¢? é¦–å…ˆè¦æœ‰ä¸€ä¸ªæ€æƒ³ä¸Šçš„æ”¹å˜, åœ¨ G1 æ”¶é›†å™¨å‡ºç°ä¹‹å‰çš„æ‰€æœ‰å…¶ä»–æ”¶é›†å™¨, åŒ…æ‹¬ CMS åœ¨å†…, åƒåœ¾æ”¶é›†çš„ç›®æ ‡èŒƒå›´è¦ä¹ˆæ˜¯æ•´ä¸ªæ–°ç”Ÿä»£(Minor GC), è¦ä¹ˆå°±æ˜¯æ•´ä¸ªè€å¹´ä»£(Major GC), å†è¦ä¹ˆå°±æ˜¯æ•´ä¸ª Java å †(Full GC). "),t("mark",[t("strong",[s._v("è€Œ G1 è·³å‡ºäº†è¿™ä¸ªæ¨Šç¬¼, å®ƒå¯ä»¥é¢å‘å †å†…å­˜ä»»ä½•éƒ¨åˆ†æ¥ç»„æˆå›æ”¶é›†(Collection Set, ä¸€èˆ¬ç®€ç§° CSet)è¿›è¡Œå›æ”¶, è¡¡é‡æ ‡å‡†ä¸å†æ˜¯å®ƒå±äºå“ªä¸ªåˆ†ä»£, è€Œæ˜¯å“ªå—å†…å­˜ä¸­å­˜æ”¾çš„åƒåœ¾æ•°é‡æœ€å¤š, å›æ”¶æ”¶ç›Šæœ€å¤§, è¿™å°±æ˜¯ G1 æ”¶é›†å™¨çš„ Mixed GC æ¨¡å¼")])]),s._v(".")]),s._v(" "),t("h6",{attrs:{id:"_2-region"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-region"}},[s._v("#")]),s._v(" (2)Region")]),s._v(" "),t("p",[s._v("G1 å¼€åˆ›çš„"),t("mark",[t("strong",[s._v("åŸºäº Region çš„å †å†…å­˜å¸ƒå±€")])]),s._v("æ˜¯å®ƒèƒ½å¤Ÿå®ç°è¿™ä¸ªç›®æ ‡çš„å…³é”®. è™½ç„¶ G1 ä¹Ÿä»æ˜¯éµå¾ªåˆ†ä»£æ”¶é›†ç†è®ºè®¾è®¡çš„, ä½†å…¶å †å†…å­˜çš„å¸ƒå±€ä¸å…¶ä»–æ”¶é›†å™¨æœ‰éå¸¸æ˜æ˜¾çš„å·®å¼‚: "),t("strong",[s._v("G1 ä¸å†åšæŒå›ºå®šå¤§å°ä»¥åŠå›ºå®šæ•°é‡çš„åˆ†ä»£åŒºåŸŸåˆ’åˆ†, è€Œæ˜¯æŠŠè¿ç»­çš„ Java å †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸ(Region), æ¯ä¸€ä¸ª Region éƒ½å¯ä»¥æ ¹æ®éœ€è¦, æ‰®æ¼”æ–°ç”Ÿä»£çš„ Eden ç©ºé—´, Survivor ç©ºé—´, æˆ–è€…è€å¹´ä»£ç©ºé—´")]),s._v(". æ”¶é›†å™¨èƒ½å¤Ÿå¯¹æ‰®æ¼”ä¸åŒè§’è‰²çš„ Region é‡‡ç”¨ä¸åŒçš„ç­–ç•¥å»å¤„ç†, è¿™æ ·æ— è®ºæ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡è¿˜æ˜¯å·²ç»å­˜æ´»äº†ä¸€æ®µæ—¶é—´, ç†¬è¿‡å¤šæ¬¡æ”¶é›†çš„æ—§å¯¹è±¡éƒ½èƒ½è·å–å¾ˆå¥½çš„æ”¶é›†æ•ˆæœ.")]),s._v(" "),t("p",[s._v("G1 æŠŠ"),t("strong",[s._v("å †")]),s._v("åˆ’åˆ†æˆå¤šä¸ªå¤§å°ç›¸ç­‰çš„"),t("strong",[s._v("ç‹¬ç«‹åŒºåŸŸ")]),s._v("(Region), æ–°ç”Ÿä»£å’Œè€å¹´ä»£"),t("strong",[s._v("ä¸å†")]),s._v("ç‰©ç†éš”ç¦», å„ä¸ªåŒºåŸŸæ˜¯"),t("strong",[s._v("ä¸ä¸€å®šè¿ç»­")]),s._v("çš„. å¦‚ä¸‹å›¾æ‰€ç¤º.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521153429792.png",alt:""}})]),s._v(" "),t("p",[s._v("ä¸€èˆ¬ "),t("strong",[s._v("Region")]),s._v(" å¤§å°ç­‰äº"),t("strong",[s._v("å †å¤§å°é™¤ä»¥ 2048(ä¸ª)")]),s._v(' , æ¯”å¦‚å †å¤§å°ä¸º 4096 M, åˆ™ Region å¤§å°ä¸º 2M, å½“ç„¶ä¹Ÿå¯ä»¥ç”¨å‚æ•° "-XX:G1HeapRegionSize" æ‰‹åŠ¨æŒ‡å®š Region å¤§å°, æ¨èé»˜è®¤çš„è®¡ç®—æ–¹å¼. G1 ä¿ç•™äº†'),t("strong",[s._v("å¹´è½»ä»£å’Œè€å¹´ä»£çš„æ¦‚å¿µ")]),s._v(", ä½†"),t("strong",[s._v("ä¸å†æ˜¯ç‰©ç†éš”ç¦»")]),s._v("äº†, å®ƒä»¬éƒ½æ˜¯å¯ä»¥ä¸è¿ç»­ Region çš„é›†åˆ. é»˜è®¤"),t("strong",[s._v("å¹´è½»ä»£")]),s._v("å¯¹å †å†…å­˜çš„å æ¯”æ˜¯ "),t("strong",[s._v("5%")]),s._v(' , å¦‚æœå †å¤§å°ä¸º 4096 M, é‚£ä¹ˆå¹´è½»ä»£å æ® 200MB å·¦å³çš„å†…å­˜, å¯¹åº”å¤§æ¦‚æ˜¯ 100 ä¸ª Region, å¯ä»¥é€šè¿‡ "-XX:G1NewSizePercent" è®¾ç½®'),t("strong",[s._v("å¹´è½»ä»£åˆå§‹å æ¯”")]),s._v(", åœ¨ç³»ç»Ÿè¿è¡Œä¸­, JVM ä¼š"),t("strong",[s._v("ä¸åœçš„ç»™å¹´è½»ä»£å¢åŠ æ›´å¤š")]),s._v("çš„ Region, ä½†æ˜¯æœ€å¤š"),t("strong",[s._v("æ–°ç”Ÿä»£çš„å æ¯”ä¸ä¼šè¶…è¿‡ 60%")]),s._v(' , å¯ä»¥é€šè¿‡ "-XX:G1MaxNewSizePercent" è°ƒæ•´. å¹´è½»ä»£ä¸­çš„ Eden å’Œ Survivor å¯¹åº”çš„ region ä¹Ÿè·Ÿä¹‹å‰ä¸€æ ·, é»˜è®¤ '),t("strong",[s._v("8:1:1")]),s._v(", å‡è®¾å¹´è½»ä»£ç°åœ¨æœ‰ 1000 ä¸ª region, eden åŒºå¯¹åº” 800 ä¸ª, s0 å¯¹åº” 100 ä¸ª, s1 å¯¹åº” 100 ä¸ª.")]),s._v(" "),t("p",[s._v("Region ä¸­è¿˜æœ‰ä¸€ç±»ç‰¹æ®Šçš„ "),t("strong",[s._v("Humongous åŒºåŸŸ")]),s._v(", ä¸“é—¨ç”¨æ¥"),t("strong",[s._v("å­˜å‚¨å¤§å¯¹è±¡")]),s._v(". G1 è®¤ä¸ºåªè¦å¤§å°è¶…è¿‡äº†ä¸€ä¸ª Region å®¹é‡ä¸€åŠçš„å¯¹è±¡å³å¯åˆ¤å®šä¸ºå¤§å¯¹è±¡. æ¯ä¸ª Region çš„å¤§å°å¯ä»¥é€šè¿‡å‚æ•° "),t("code",[s._v("-XX: G1HeapRegionSize")]),s._v("â€‹ è®¾å®š, å–å€¼èŒƒå›´ä¸º 1MBï½32MB, ä¸”åº”ä¸º 2 çš„ N æ¬¡å¹‚. è€Œå¯¹äºé‚£äº›è¶…è¿‡äº†æ•´ä¸ª Region å®¹é‡çš„è¶…çº§å¤§å¯¹è±¡, å°†ä¼šè¢«"),t("strong",[s._v("å­˜æ”¾åœ¨ N ä¸ªè¿ç»­")]),s._v("çš„ Humongous Region ä¹‹ä¸­, G1 çš„"),t("strong",[s._v("å¤§å¤šæ•°è¡Œä¸ºéƒ½æŠŠ Humongous Region ä½œä¸ºè€å¹´ä»£çš„ä¸€éƒ¨åˆ†")]),s._v("æ¥è¿›è¡Œçœ‹å¾….")]),s._v(" "),t("h6",{attrs:{id:"_3-g1åƒåœ¾æ”¶é›†æ€è·¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-g1åƒåœ¾æ”¶é›†æ€è·¯"}},[s._v("#")]),s._v(" (3)G1åƒåœ¾æ”¶é›†æ€è·¯")]),s._v(" "),t("p",[s._v("è™½ç„¶ G1 ä»ç„¶ä¿ç•™æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¦‚å¿µ, ä½†æ–°ç”Ÿä»£å’Œè€å¹´ä»£"),t("strong",[s._v("ä¸å†æ˜¯å›ºå®š")]),s._v("çš„äº†, å®ƒä»¬éƒ½æ˜¯ä¸€ç³»åˆ—åŒºåŸŸ(ä¸éœ€è¦è¿ç»­)çš„åŠ¨æ€é›†åˆ. G1 æ”¶é›†å™¨ä¹‹æ‰€ä»¥èƒ½å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹, æ˜¯å› ä¸ºå®ƒ"),t("strong",[s._v("å°† Region ä½œä¸ºå•æ¬¡å›æ”¶çš„æœ€å°å•å…ƒ")]),s._v(", å³æ¯æ¬¡æ”¶é›†åˆ°çš„å†…å­˜ç©ºé—´éƒ½æ˜¯ Region å¤§å°çš„æ•´æ•°å€, è¿™æ ·å¯ä»¥æœ‰è®¡åˆ’åœ°é¿å…åœ¨æ•´ä¸ª Java å †ä¸­è¿›è¡Œå…¨åŒºåŸŸçš„åƒåœ¾æ”¶é›†. æ›´å…·ä½“çš„å¤„ç†æ€è·¯æ˜¯"),t("mark",[t("strong",[s._v('è®© G1 æ”¶é›†å™¨å»è·Ÿè¸ªå„ä¸ª Region é‡Œé¢çš„åƒåœ¾å †ç§¯çš„ "ä»·å€¼" å¤§å°, ä»·å€¼å³å›æ”¶æ‰€è·å¾—çš„ç©ºé—´å¤§å°ä»¥åŠå›æ”¶æ‰€éœ€æ—¶é—´çš„ç»éªŒå€¼, ç„¶ååœ¨åå°ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆçº§åˆ—è¡¨, æ¯æ¬¡æ ¹æ®ç”¨æˆ·è®¾å®šå…è®¸çš„æ”¶é›†åœé¡¿æ—¶é—´(ä½¿ç”¨å‚æ•° -XX: MaxGCPauseMillis æŒ‡å®š, é»˜è®¤å€¼æ˜¯ 200 æ¯«ç§’), ä¼˜å…ˆå¤„ç†å›æ”¶ä»·å€¼æ”¶ç›Šæœ€å¤§çš„é‚£äº› Region, è¿™ä¹Ÿå°±æ˜¯ "Garbage First" åå­—çš„ç”±æ¥')])]),s._v(". è¿™ç§ä½¿ç”¨ Region åˆ’åˆ†å†…å­˜ç©ºé—´, ä»¥åŠå…·æœ‰ä¼˜å…ˆçº§çš„åŒºåŸŸå›æ”¶æ–¹å¼, ä¿è¯äº† G1 æ”¶é›†å™¨åœ¨æœ‰é™çš„æ—¶é—´å†…è·å–å°½å¯èƒ½é«˜çš„æ”¶é›†æ•ˆç‡. æ¯”å¦‚ä¸€ä¸ª Region èŠ± 200ms èƒ½å›æ”¶ 10M åƒåœ¾, å¦å¤–ä¸€ä¸ª Region èŠ± 50ms èƒ½å›æ”¶ 20M åƒåœ¾, åœ¨å›æ”¶æ—¶é—´æœ‰é™æƒ…å†µä¸‹, G1 å½“ç„¶ä¼šä¼˜å…ˆé€‰æ‹©åé¢è¿™ä¸ª Region å›æ”¶.")]),s._v(" "),t("p",[s._v("G1 ä¸ç®¡æ˜¯å¹´è½»ä»£æˆ–æ˜¯è€å¹´ä»£, "),t("strong",[s._v("å›æ”¶ç®—æ³•ä¸»è¦ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•")]),s._v(", "),t("strong",[s._v("å°†ä¸€ä¸ª region ä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ª region ä¸­, è¿™ç§ä¸ä¼šåƒ CMS é‚£æ ·å›æ”¶å®Œå› ä¸ºæœ‰å¾ˆå¤šå†…å­˜ç¢ç‰‡è¿˜éœ€è¦æ•´ç†ä¸€æ¬¡, G1 é‡‡ç”¨å¤åˆ¶ç®—æ³•å›æ”¶å‡ ä¹ä¸ä¼šæœ‰å¤ªå¤šå†…å­˜ç¢ç‰‡")]),s._v(". çœ‹ä¸Šå›¾è§‰å¾—å¯èƒ½ä¹Ÿä¼šæœ‰å¾ˆå¤šç©ºæ ¼, è¿™ä¸ç®—å†…å­˜ç¢ç‰‡, å› ä¸ºä¸€ä¸ª region æ ¼å­å¯ä»¥å­˜æ”¾å¾ˆå¤šå¯¹è±¡.")]),s._v(" "),t("p",[s._v("ä» G1 å¼€å§‹, "),t("mark",[t("strong",[s._v("æœ€å…ˆè¿›çš„åƒåœ¾æ”¶é›†å™¨çš„è®¾è®¡å¯¼å‘éƒ½ä¸çº¦è€ŒåŒåœ°å˜ä¸ºè¿½æ±‚èƒ½å¤Ÿåº”ä»˜åº”ç”¨çš„å†…å­˜åˆ†é…é€Ÿç‡(Allocation Rate), è€Œä¸è¿½æ±‚ä¸€æ¬¡æŠŠæ•´ä¸ª Java å †å…¨éƒ¨æ¸…ç†å¹²å‡€. è¿™æ ·, åº”ç”¨åœ¨åˆ†é…, åŒæ—¶æ”¶é›†å™¨åœ¨æ”¶é›†, åªè¦æ”¶é›†çš„é€Ÿåº¦èƒ½è·Ÿå¾—ä¸Šå¯¹è±¡åˆ†é…çš„é€Ÿåº¦, é‚£ä¸€åˆ‡å°±èƒ½è¿ä½œå¾—å¾ˆå®Œç¾")])]),s._v(". è¿™ç§æ–°çš„æ”¶é›†å™¨è®¾è®¡æ€è·¯ä»å·¥ç¨‹å®ç°ä¸Šçœ‹æ˜¯ä» G1 å¼€å§‹å…´èµ·çš„, æ‰€ä»¥è¯´ G1 æ˜¯æ”¶é›†å™¨æŠ€æœ¯å‘å±•çš„ä¸€ä¸ªé‡Œç¨‹ç¢‘.")]),s._v(" "),t("blockquote",[t("p",[s._v("éœ€è¦è§£å†³çš„ç»†èŠ‚é—®é¢˜")])]),s._v(" "),t("p",[s._v('G1 å°†å †å†…å­˜ "åŒ–æ•´ä¸ºé›¶" çš„ "è§£é¢˜æ€è·¯", çœ‹èµ·æ¥ä¼¼ä¹æ²¡æœ‰å¤ªå¤šä»¤äººæƒŠè®¶ä¹‹å¤„, ä¹Ÿå®Œå…¨ä¸éš¾ç†è§£, ä½†å…¶ä¸­çš„å®ç°ç»†èŠ‚å¯æ˜¯è¿œè¿œæ²¡æœ‰æƒ³è±¡ä¸­é‚£ä¹ˆç®€å•, å¦åˆ™å°±ä¸ä¼šç”¨å°†è¿‘ 10 å¹´æ—¶é—´æ‰å€’è…¾å‡ºèƒ½å¤Ÿå•†ç”¨çš„ G1 æ”¶é›†å™¨æ¥. G1 æ”¶é›†å™¨è‡³å°‘æœ‰(ä¸é™äº)ä»¥ä¸‹è¿™äº›å…³é”®çš„'),t("strong",[s._v("ç»†èŠ‚é—®é¢˜éœ€è¦å¦¥å–„è§£å†³")]),s._v(":")]),s._v(" "),t("ul",[t("li",[s._v("è­¬å¦‚, å°† Java å †åˆ†æˆå¤šä¸ªç‹¬ç«‹ Region å, "),t("strong",[s._v("Region é‡Œé¢å­˜åœ¨çš„è·¨ Region å¼•ç”¨å¯¹è±¡å¦‚ä½•è§£å†³")]),s._v("? è§£å†³çš„æ€è·¯å·²ç»çŸ¥é“: "),t("strong",[s._v("ä½¿ç”¨è®°å¿†é›†é¿å…å…¨å †ä½œä¸º GC Roots æ‰«æ")]),s._v(", ä½†åœ¨ G1 æ”¶é›†å™¨ä¸Šè®°å¿†é›†çš„åº”ç”¨å…¶å®è¦å¤æ‚å¾ˆå¤š, å®ƒçš„"),t("strong",[s._v("æ¯ä¸ª Region éƒ½ç»´æŠ¤æœ‰è‡ªå·±çš„è®°å¿†é›†")]),s._v(', è¿™äº›è®°å¿†é›†ä¼šè®°å½•ä¸‹åˆ«çš„ Region æŒ‡å‘è‡ªå·±çš„æŒ‡é’ˆ, å¹¶æ ‡è®°è¿™äº›æŒ‡é’ˆåˆ†åˆ«åœ¨å“ªäº›å¡é¡µçš„èŒƒå›´ä¹‹å†…. G1 çš„è®°å¿†é›†åœ¨å­˜å‚¨ç»“æ„çš„æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å“ˆå¸Œè¡¨, Key æ˜¯åˆ«çš„ Region çš„èµ·å§‹åœ°å€, Value æ˜¯ä¸€ä¸ªé›†åˆ, é‡Œé¢å­˜å‚¨çš„å…ƒç´ æ˜¯å¡è¡¨çš„ç´¢å¼•å·. è¿™ç§ "åŒå‘" çš„å¡è¡¨ç»“æ„(å¡è¡¨æ˜¯ "æˆ‘æŒ‡å‘è°", è¿™ç§ç»“æ„è¿˜è®°å½•äº† "è°æŒ‡å‘æˆ‘")æ¯”åŸæ¥çš„å¡è¡¨å®ç°èµ·æ¥æ›´å¤æ‚, åŒæ—¶ç”±äº Region æ•°é‡æ¯”ä¼ ç»Ÿæ”¶é›†å™¨çš„åˆ†ä»£æ•°é‡æ˜æ˜¾è¦å¤šå¾—å¤š, å› æ­¤ G1 æ”¶é›†å™¨è¦æ¯”å…¶ä»–çš„ä¼ ç»Ÿåƒåœ¾æ”¶é›†å™¨æœ‰ç€'),t("strong",[s._v("æ›´é«˜çš„å†…å­˜å ç”¨è´Ÿæ‹…")]),s._v(". æ ¹æ®ç»éªŒ, "),t("strong",[s._v("G1 è‡³å°‘è¦è€—è´¹å¤§çº¦ç›¸å½“äº Java å †å®¹é‡ 10% è‡³ 20% çš„é¢å¤–å†…å­˜æ¥ç»´æŒæ”¶é›†å™¨å·¥ä½œ")]),s._v(".")]),s._v(" "),t("li",[s._v("è­¬å¦‚, "),t("strong",[s._v("åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µå¦‚ä½•ä¿è¯æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹äº’ä¸å¹²æ‰°åœ°è¿è¡Œ")]),s._v("? è¿™é‡Œé¦–å…ˆè¦è§£å†³çš„æ˜¯"),t("strong",[s._v("ç”¨æˆ·çº¿ç¨‹æ”¹å˜å¯¹è±¡å¼•ç”¨å…³ç³»æ—¶, å¿…é¡»ä¿è¯å…¶ä¸èƒ½æ‰“ç ´åŸæœ¬çš„å¯¹è±¡å›¾ç»“æ„, å¯¼è‡´æ ‡è®°ç»“æœå‡ºç°é”™è¯¯")]),s._v(", è¯¥é—®é¢˜çš„è§£å†³åŠæ³•å‰é¢è®²è§£è¿‡: CMS æ”¶é›†å™¨é‡‡ç”¨å¢é‡æ›´æ–°ç®—æ³•å®ç°, è€Œ G1 æ”¶é›†å™¨åˆ™æ˜¯é€šè¿‡"),t("strong",[s._v("åŸå§‹å¿«ç…§(SATB)ç®—æ³•")]),s._v('æ¥å®ç°çš„. æ­¤å¤–, åƒåœ¾æ”¶é›†å¯¹ç”¨æˆ·çº¿ç¨‹çš„å½±å“è¿˜ä½“ç°åœ¨å›æ”¶è¿‡ç¨‹ä¸­æ–°åˆ›å»ºå¯¹è±¡çš„å†…å­˜åˆ†é…ä¸Š, ç¨‹åºè¦ç»§ç»­è¿è¡Œå°±è‚¯å®šä¼šæŒç»­æœ‰æ–°å¯¹è±¡è¢«åˆ›å»º, G1 ä¸ºæ¯ä¸€ä¸ª Region è®¾è®¡äº†ä¸¤ä¸ªåä¸º TAMS(Top at Mark Start)çš„æŒ‡é’ˆ, æŠŠ Region ä¸­çš„ä¸€éƒ¨åˆ†ç©ºé—´åˆ’åˆ†å‡ºæ¥ç”¨äºå¹¶å‘å›æ”¶è¿‡ç¨‹ä¸­çš„æ–°å¯¹è±¡åˆ†é…, å¹¶å‘å›æ”¶æ—¶æ–°åˆ†é…çš„å¯¹è±¡åœ°å€éƒ½å¿…é¡»è¦åœ¨è¿™ä¸¤ä¸ªæŒ‡é’ˆä½ç½®ä»¥ä¸Š. G1 æ”¶é›†å™¨é»˜è®¤åœ¨è¿™ä¸ªåœ°å€ä»¥ä¸Šçš„å¯¹è±¡æ˜¯è¢«éšå¼æ ‡è®°è¿‡çš„, å³é»˜è®¤å®ƒä»¬æ˜¯å­˜æ´»çš„, ä¸çº³å…¥å›æ”¶èŒƒå›´. ä¸ CMS ä¸­çš„ "Concurrent Mode Failure" å¤±è´¥ä¼šå¯¼è‡´ Full GC ç±»ä¼¼, å¦‚æœå†…å­˜å›æ”¶çš„é€Ÿåº¦èµ¶ä¸ä¸Šå†…å­˜åˆ†é…çš„é€Ÿåº¦, G1 æ”¶é›†å™¨ä¹Ÿè¦è¢«è¿«å†»ç»“ç”¨æˆ·çº¿ç¨‹æ‰§è¡Œ, å¯¼è‡´ Full GC è€Œäº§ç”Ÿé•¿æ—¶é—´ STW.')]),s._v(" "),t("li",[s._v("è­¬å¦‚, "),t("strong",[s._v("æ€æ ·å»ºç«‹èµ·å¯é çš„åœé¡¿é¢„æµ‹æ¨¡å‹")]),s._v("? ç”¨æˆ·é€šè¿‡ "),t("code",[s._v("-XX: MaxGCPauseMillis")]),s._v("â€‹ å‚æ•°æŒ‡å®šçš„åœé¡¿æ—¶é—´åªæ„å‘³ç€åƒåœ¾æ”¶é›†å‘ç”Ÿä¹‹å‰çš„æœŸæœ›å€¼, ä½† G1 æ”¶é›†å™¨è¦æ€ä¹ˆåšæ‰èƒ½æ»¡è¶³ç”¨æˆ·çš„æœŸæœ›å‘¢? G1 æ”¶é›†å™¨çš„åœé¡¿é¢„æµ‹æ¨¡å‹æ˜¯"),t("strong",[s._v("ä»¥è¡°å‡å‡å€¼(Decaying Average)ä¸ºç†è®ºåŸºç¡€")]),s._v("æ¥å®ç°çš„, åœ¨åƒåœ¾æ”¶é›†è¿‡ç¨‹ä¸­, G1 æ”¶é›†å™¨ä¼š"),t("strong",[s._v("è®°å½•æ¯ä¸ª Region çš„å›æ”¶è€—æ—¶, æ¯ä¸ª Region è®°å¿†é›†é‡Œçš„è„å¡æ•°é‡ç­‰å„ä¸ªå¯æµ‹é‡çš„æ­¥éª¤èŠ±è´¹çš„æˆæœ¬, å¹¶åˆ†æå¾—å‡ºå¹³å‡å€¼, æ ‡å‡†åå·®, ç½®ä¿¡åº¦ç­‰ç»Ÿè®¡ä¿¡æ¯")]),s._v('. è¿™é‡Œå¼ºè°ƒçš„ "è¡°å‡å¹³å‡å€¼" æ˜¯æŒ‡å®ƒä¼šæ¯”æ™®é€šçš„å¹³å‡å€¼æ›´å®¹æ˜“å—åˆ°æ–°æ•°æ®çš„å½±å“, å¹³å‡å€¼ä»£è¡¨æ•´ä½“å¹³å‡çŠ¶æ€, ä½†è¡°å‡å¹³å‡å€¼æ›´å‡†ç¡®åœ°ä»£è¡¨ "æœ€è¿‘çš„" å¹³å‡çŠ¶æ€. æ¢å¥è¯è¯´, Region çš„ç»Ÿè®¡çŠ¶æ€è¶Šæ–°è¶Šèƒ½å†³å®šå…¶å›æ”¶çš„ä»·å€¼. ç„¶åé€šè¿‡è¿™äº›ä¿¡æ¯é¢„æµ‹ç°åœ¨å¼€å§‹å›æ”¶çš„è¯, ç”±å“ªäº› Region ç»„æˆå›æ”¶é›†æ‰å¯ä»¥åœ¨ä¸è¶…è¿‡æœŸæœ›åœé¡¿æ—¶é—´çš„çº¦æŸä¸‹è·å¾—æœ€é«˜çš„æ”¶ç›Š.')])]),s._v(" "),t("h6",{attrs:{id:"_4-æ”¶é›†æµç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-æ”¶é›†æµç¨‹"}},[s._v("#")]),s._v(" (4)æ”¶é›†æµç¨‹")]),s._v(" "),t("p",[s._v("å¦‚æœä¸å»è®¡ç®—ç”¨æˆ·çº¿ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­çš„åŠ¨ä½œ(å¦‚ä½¿ç”¨å†™å±éšœç»´æŠ¤è®°å¿†é›†çš„æ“ä½œ), G1 æ”¶é›†å™¨çš„è¿ä½œè¿‡ç¨‹å¤§è‡´å¯åˆ’åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæ­¥éª¤, å‰å‡ ä¸ªæ­¥éª¤ä¸ CMS æ”¶é›†å™¨ç±»ä¼¼, ä¸»è¦åŒºåˆ«åœ¨äº"),t("strong",[s._v("ç¬¬å››æ­¥")]),s._v(":")]),s._v(" "),t("ul",[t("li",[t("mark",[t("strong",[s._v("åˆå§‹æ ‡è®°(çŸ­æš‚STW)")])]),s._v(" : ä»…ä»…åªæ˜¯"),t("strong",[s._v("æ ‡è®°ä¸€ä¸‹ GC Roots èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡")]),s._v(", å¹¶ä¸”ä¿®æ”¹ TAMS æŒ‡é’ˆçš„å€¼, è®©ä¸‹ä¸€é˜¶æ®µç”¨æˆ·çº¿ç¨‹å¹¶å‘è¿è¡Œæ—¶, èƒ½æ­£ç¡®åœ°åœ¨å¯ç”¨çš„ Region ä¸­åˆ†é…æ–°å¯¹è±¡. è¿™ä¸ªé˜¶æ®µ"),t("strong",[s._v("éœ€è¦åœé¡¿çº¿ç¨‹, ä½†è€—æ—¶å¾ˆçŸ­")]),s._v(", è€Œä¸”æ˜¯å€Ÿç”¨è¿›è¡Œ Minor GC çš„æ—¶å€™åŒæ­¥å®Œæˆçš„, æ‰€ä»¥ G1 æ”¶é›†å™¨åœ¨è¿™ä¸ªé˜¶æ®µå®é™…å¹¶æ²¡æœ‰é¢å¤–çš„åœé¡¿.")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("å¹¶å‘æ ‡è®°")])]),s._v(": ä» GC Root å¼€å§‹å¯¹å †ä¸­å¯¹è±¡è¿›è¡Œ"),t("strong",[s._v("å¯è¾¾æ€§åˆ†æ")]),s._v(", é€’å½’æ‰«ææ•´ä¸ªå †é‡Œçš„å¯¹è±¡å›¾, æ‰¾å‡ºè¦å›æ”¶çš„å¯¹è±¡, è¿™é˜¶æ®µ"),t("strong",[s._v("è€—æ—¶è¾ƒé•¿, ä½†å¯ä¸ç”¨æˆ·ç¨‹åºå¹¶å‘æ‰§è¡Œ")]),s._v(". å½“å¯¹è±¡å›¾æ‰«æå®Œæˆä»¥å, è¿˜è¦é‡æ–°å¤„ç† SATB è®°å½•ä¸‹çš„åœ¨å¹¶å‘æ—¶æœ‰å¼•ç”¨å˜åŠ¨çš„å¯¹è±¡.")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("æœ€ç»ˆæ ‡è®°(çŸ­æš‚STW)")])]),s._v(" : å¯¹ç”¨æˆ·çº¿ç¨‹åšå¦ä¸€ä¸ª"),t("strong",[s._v("çŸ­æš‚çš„æš‚åœ")]),s._v(", ç”¨äºå¤„ç†å¹¶å‘é˜¶æ®µç»“æŸåä»"),t("strong",[s._v("é—ç•™ä¸‹æ¥çš„æœ€åé‚£å°‘é‡çš„ SATB è®°å½•")]),s._v(".")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("ç­›é€‰å›æ”¶(STW)")])]),s._v(" : è´Ÿè´£"),t("strong",[s._v("æ›´æ–° Region çš„ç»Ÿè®¡æ•°æ®")]),s._v(", å¯¹å„ä¸ª Region çš„"),t("mark",[t("strong",[s._v("å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åº")])]),s._v(", æ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„åœé¡¿æ—¶é—´æ¥åˆ¶å®šå›æ”¶è®¡åˆ’, å¯ä»¥è‡ªç”±é€‰æ‹©ä»»æ„å¤šä¸ª Region æ„æˆå›æ”¶é›†, ç„¶åæŠŠå†³å®šå›æ”¶çš„é‚£ä¸€éƒ¨åˆ† Region çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°ç©ºçš„ Region ä¸­, å†æ¸…ç†æ‰æ•´ä¸ªæ—§ Region çš„å…¨éƒ¨ç©ºé—´. è¿™é‡Œçš„æ“ä½œ"),t("strong",[s._v("æ¶‰åŠå­˜æ´»å¯¹è±¡çš„ç§»åŠ¨, æ˜¯å¿…é¡»æš‚åœç”¨æˆ·çº¿ç¨‹, ç”±å¤šæ¡æ”¶é›†å™¨çº¿ç¨‹å¹¶è¡Œå®Œæˆçš„")]),s._v(". è¿™é‡Œä¼šæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„ GC "),t("strong",[s._v("åœé¡¿ STW æ—¶é—´(ç”¨å‚æ•° -XX:MaxGCPauseMillis æŒ‡å®š)")]),s._v("  æ¥åˆ¶å®šå›æ”¶è®¡åˆ’. æ¯”å¦‚è€å¹´ä»£æœ‰ 1000 ä¸ª Region éƒ½æ»¡äº†, ä½†æ˜¯æ ¹æ®é¢„æœŸè®¾ç½®çš„åœé¡¿æ—¶é—´, æœ¬æ¬¡åƒåœ¾å›æ”¶å¯èƒ½"),t("strong",[s._v("åªèƒ½åœé¡¿ 200 æ¯«ç§’")]),s._v(", é‚£ä¹ˆé€šè¿‡ä¹‹å‰å›æ”¶æˆæœ¬è®¡ç®—å¾—çŸ¥å›æ”¶å…¶ä¸­ 800 ä¸ª Region åˆšå¥½éœ€è¦ 200ms, é‚£ä¹ˆå°±åªä¼šå›æ”¶ 800 ä¸ª Region, å°½é‡æŠŠ GC å¯¼è‡´çš„åœé¡¿æ—¶é—´æ§åˆ¶åœ¨"),t("strong",[s._v("æŒ‡å®šçš„èŒƒå›´å†…")]),s._v(".")])]),s._v(" "),t("p",[s._v("ä»ä¸Šè¿°é˜¶æ®µçš„æè¿°å¯ä»¥çœ‹å‡º, "),t("strong",[s._v("G1 æ”¶é›†å™¨é™¤äº†å¹¶å‘æ ‡è®°å¤–, å…¶ä½™é˜¶æ®µä¹Ÿæ˜¯è¦å®Œå…¨æš‚åœç”¨æˆ·çº¿ç¨‹çš„")]),s._v(', æ¢è¨€ä¹‹, å®ƒå¹¶éçº¯ç²¹åœ°è¿½æ±‚ä½å»¶è¿Ÿ, å®˜æ–¹ç»™å®ƒè®¾å®šçš„ç›®æ ‡æ˜¯åœ¨å»¶è¿Ÿå¯æ§çš„æƒ…å†µä¸‹è·å¾—å°½å¯èƒ½é«˜çš„ååé‡, æ‰€ä»¥æ‰èƒ½æ‹…å½“èµ· "å…¨åŠŸèƒ½æ”¶é›†å™¨" çš„é‡ä»»ä¸æœŸæœ›.')]),s._v(" "),t("p",[s._v("ä» Oracle å®˜æ–¹é€éœ²å‡ºæ¥çš„ä¿¡æ¯å¯è·çŸ¥, å›æ”¶é˜¶æ®µ(Evacuation)å…¶å®æœ¬ä¹Ÿæœ‰æƒ³è¿‡è®¾è®¡æˆä¸ç”¨æˆ·ç¨‹åºä¸€èµ·å¹¶å‘æ‰§è¡Œ, ä½†è¿™ä»¶äº‹æƒ…åšèµ·æ¥æ¯”è¾ƒå¤æ‚, è€ƒè™‘åˆ° G1 åªæ˜¯å›æ”¶ä¸€éƒ¨åˆ† Region, åœé¡¿æ—¶é—´æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„, æ‰€ä»¥å¹¶ä¸è¿«åˆ‡å»å®ç°, è€Œé€‰æ‹©æŠŠè¿™ä¸ªç‰¹æ€§æ”¾åˆ°äº† G1 ä¹‹åå‡ºç°çš„ä½å»¶è¿Ÿåƒåœ¾æ”¶é›†å™¨(å³ ZGC)ä¸­. å¦å¤–, è¿˜è€ƒè™‘åˆ° G1 ä¸æ˜¯ä»…ä»…é¢å‘ä½å»¶è¿Ÿ, åœé¡¿ç”¨æˆ·çº¿ç¨‹èƒ½å¤Ÿæœ€å¤§å¹…åº¦æé«˜åƒåœ¾æ”¶é›†æ•ˆç‡, ä¸ºäº†ä¿è¯ååé‡æ‰€ä»¥æ‰é€‰æ‹©äº†å®Œå…¨æš‚åœç”¨æˆ·çº¿ç¨‹çš„å®ç°æ–¹æ¡ˆ. é€šè¿‡ä¸‹å›¾å¯ä»¥æ¯”è¾ƒæ¸…æ¥šåœ°çœ‹åˆ° G1 æ”¶é›†å™¨çš„è¿ä½œæ­¥éª¤ä¸­å¹¶å‘å’Œéœ€è¦åœé¡¿çš„é˜¶æ®µ.")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521154201453.png",alt:"",title:"G1æ”¶é›†å™¨è¿è¡Œç¤ºæ„å›¾"}})]),s._v(" "),t("h6",{attrs:{id:"_5-åœé¡¿æ—¶é—´çš„è®¾ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-åœé¡¿æ—¶é—´çš„è®¾ç½®"}},[s._v("#")]),s._v(" (5)åœé¡¿æ—¶é—´çš„è®¾ç½®")]),s._v(" "),t("p",[s._v("æ¯«æ— ç–‘é—®, å¯ä»¥ç”±ç”¨æˆ·æŒ‡å®šæœŸæœ›çš„åœé¡¿æ—¶é—´æ˜¯ G1 æ”¶é›†å™¨å¾ˆå¼ºå¤§çš„ä¸€ä¸ªåŠŸèƒ½, "),t("strong",[s._v("è®¾ç½®ä¸åŒçš„æœŸæœ›åœé¡¿æ—¶é—´, å¯ä½¿å¾— G1 åœ¨ä¸åŒåº”ç”¨åœºæ™¯ä¸­å–å¾—å…³æ³¨ååé‡å’Œå…³æ³¨å»¶è¿Ÿä¹‹é—´çš„æœ€ä½³å¹³è¡¡")]),s._v('. ä¸è¿‡, è¿™é‡Œè®¾ç½®çš„ "æœŸæœ›å€¼" å¿…é¡»æ˜¯'),t("strong",[s._v("ç¬¦åˆå®é™…")]),s._v("çš„, ä¸èƒ½å¼‚æƒ³å¤©å¼€, æ¯•ç«Ÿ G1 æ˜¯è¦å†»ç»“ç”¨æˆ·çº¿ç¨‹æ¥å¤åˆ¶å¯¹è±¡çš„, è¿™ä¸ªåœé¡¿æ—¶é—´å†æ€ä¹ˆä½ä¹Ÿå¾—æœ‰ä¸ªé™åº¦. å®ƒ"),t("strong",[s._v("é»˜è®¤çš„åœé¡¿ç›®æ ‡ä¸ºä¸¤ç™¾æ¯«ç§’")]),s._v(", ä¸€èˆ¬æ¥è¯´, å›æ”¶é˜¶æ®µå åˆ°å‡ ååˆ°ä¸€ç™¾ç”šè‡³æ¥è¿‘ä¸¤ç™¾æ¯«ç§’éƒ½å¾ˆæ­£å¸¸, ä½†å¦‚æœæŠŠåœé¡¿æ—¶é—´è°ƒå¾—éå¸¸ä½, è­¬å¦‚è®¾ç½®ä¸ºäºŒåæ¯«ç§’, å¾ˆå¯èƒ½å‡ºç°çš„ç»“æœå°±æ˜¯ç”±äºåœé¡¿ç›®æ ‡æ—¶é—´å¤ªçŸ­, å¯¼è‡´æ¯æ¬¡é€‰å‡ºæ¥çš„å›æ”¶é›†åªå å †å†…å­˜å¾ˆå°çš„ä¸€éƒ¨åˆ†, æ”¶é›†å™¨æ”¶é›†çš„é€Ÿåº¦é€æ¸è·Ÿä¸ä¸Šåˆ†é…å™¨åˆ†é…çš„é€Ÿåº¦, å¯¼è‡´åƒåœ¾æ…¢æ…¢å †ç§¯. å¾ˆå¯èƒ½ä¸€å¼€å§‹æ”¶é›†å™¨è¿˜èƒ½ä»ç©ºé—²çš„å †å†…å­˜ä¸­è·å¾—ä¸€äº›å–˜æ¯çš„æ—¶é—´, ä½†åº”ç”¨è¿è¡Œæ—¶é—´ä¸€é•¿å°±ä¸è¡Œäº†, æœ€ç»ˆå æ»¡å †å¼•å‘ Full GC åè€Œé™ä½æ€§èƒ½, æ‰€ä»¥"),t("mark",[t("strong",[s._v("é€šå¸¸æŠŠæœŸæœ›åœé¡¿æ—¶é—´è®¾ç½®ä¸ºä¸€ä¸¤ç™¾æ¯«ç§’æˆ–è€…ä¸¤ä¸‰ç™¾æ¯«ç§’ä¼šæ˜¯æ¯”è¾ƒåˆç†çš„")])]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("æ ¸å¿ƒåœ¨äºè°ƒèŠ‚ -XX:MaxGCPauseMills(æœŸæœ›åœé¡¿æ—¶é—´) å‚æ•°çš„å€¼")]),s._v(", éœ€è¦ä¿è¯"),t("strong",[s._v("å¹´è½»ä»£ GC åˆ«å¤ªé¢‘ç¹")]),s._v("çš„åŒæ—¶, è¿˜å¾—è€ƒè™‘æ¯æ¬¡ GC è¿‡åçš„å­˜æ´»å¯¹è±¡æœ‰å¤šå°‘, é¿å…å­˜æ´»å¯¹è±¡å¤ªå¤šå¿«é€Ÿè¿›å…¥è€å¹´ä»£, "),t("strong",[s._v("é¢‘ç¹è§¦å‘ Mixed GC")]),s._v(".")]),s._v(" "),t("p",[s._v("å‡è®¾å‚æ•° -"),t("strong",[s._v("XX:MaxGCPauseMills")]),s._v(" è®¾ç½®çš„"),t("strong",[s._v("å¾ˆå¤§")]),s._v(", å¯¼è‡´ç³»ç»Ÿè¿è¡Œå¾ˆä¹…, å¹´è½»ä»£å¯èƒ½éƒ½å ç”¨äº†å †å†…å­˜çš„ 60%äº†, æ­¤æ—¶æ‰è§¦å‘å¹´è½»ä»£ GC. é‚£ä¹ˆå­˜æ´»ä¸‹æ¥çš„å¯¹è±¡å¯èƒ½å°±ä¼š"),t("strong",[s._v("å¾ˆå¤š")]),s._v(", æ­¤æ—¶å°±ä¼šå¯¼è‡´ Survivor åŒºåŸŸæ”¾ä¸ä¸‹é‚£ä¹ˆå¤šçš„å¯¹è±¡, å°±ä¼šè¿›å…¥"),t("strong",[s._v("è€å¹´ä»£")]),s._v("ä¸­. æˆ–è€…æ˜¯å¹´è½»ä»£ GC è¿‡å, å­˜æ´»ä¸‹æ¥çš„å¯¹è±¡è¿‡å¤š, å¯¼è‡´è¿›å…¥ Survivor åŒºåŸŸåè§¦å‘äº†åŠ¨æ€å¹´é¾„åˆ¤å®šè§„åˆ™, è¾¾åˆ°äº† Survivor åŒºåŸŸçš„ 50%, ä¹Ÿä¼šå¿«é€Ÿå¯¼è‡´ä¸€äº›å¯¹è±¡è¿›å…¥è€å¹´ä»£ä¸­. ä½†æ˜¯ -"),t("strong",[s._v("XX:MaxGCPauseMills")]),s._v(" ä¹Ÿä¸èƒ½è®¾ç½®çš„å¾ˆå°, å› ä¸ºå¾ˆå°çš„æƒ…å†µä¸‹ä¼šå¯¼è‡´æ¯æ¬¡ GC å¯ä»¥æ¸…ç†çš„å¯¹è±¡å¤ªå°‘, ä¹…è€Œä¹…ä¹‹å¯èƒ½å°±è§¦å‘ Full GC äº†.")]),s._v(" "),t("h6",{attrs:{id:"_6-g1çš„ä¼˜ç¼ºç‚¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-g1çš„ä¼˜ç¼ºç‚¹"}},[s._v("#")]),s._v(" (6)G1çš„ä¼˜ç¼ºç‚¹")]),s._v(" "),t("p",[s._v('G1 æ”¶é›†å™¨å¸¸ä¼šè¢«æ‹¿æ¥ä¸ CMS æ”¶é›†å™¨äº’ç›¸æ¯”è¾ƒ, æ¯•ç«Ÿå®ƒä»¬éƒ½éå¸¸å…³æ³¨åœé¡¿æ—¶é—´çš„æ§åˆ¶, å®˜æ–¹èµ„æ–™ä¸­å°†å®ƒä»¬ä¸¤ä¸ªå¹¶ç§°ä¸º "The Mostly Concurrent Collectors". åœ¨æœªæ¥, G1 æ”¶é›†å™¨æœ€ç»ˆè¿˜æ˜¯è¦å–ä»£ CMS çš„, è€Œå½“ä¸‹å®ƒä»¬ä¸¤è€…å¹¶å­˜çš„æ—¶é—´é‡Œ, åˆ†ä¸ªé«˜ä½ä¼˜åŠ£å°±æ— å¯é¿å….')]),s._v(" "),t("p",[s._v('ç›¸æ¯” CMS, G1 çš„ä¼˜ç‚¹æœ‰å¾ˆå¤š, æš‚ä¸”ä¸è®ºå¯ä»¥æŒ‡å®šæœ€å¤§åœé¡¿æ—¶é—´, åˆ† Region çš„å†…å­˜å¸ƒå±€, æŒ‰æ”¶ç›ŠåŠ¨æ€ç¡®å®šå›æ”¶é›†è¿™äº›åˆ›æ–°æ€§è®¾è®¡å¸¦æ¥çš„çº¢åˆ©, å•ä»æœ€ä¼ ç»Ÿçš„ç®—æ³•ç†è®ºä¸Šçœ‹, G1 ä¹Ÿæ›´æœ‰å‘å±•æ½œåŠ›. ä¸ CMS çš„ "æ ‡è®°-æ¸…é™¤" ç®—æ³•ä¸åŒ, '),t("mark",[t("strong",[s._v('G1 ä»æ•´ä½“æ¥çœ‹æ˜¯åŸºäº "æ ‡è®°-æ•´ç†" ç®—æ³•å®ç°çš„æ”¶é›†å™¨, ä½†ä»å±€éƒ¨(ä¸¤ä¸ª Region ä¹‹é—´)ä¸Šçœ‹åˆæ˜¯åŸºäº "æ ‡è®°-å¤åˆ¶" ç®—æ³•å®ç°')])]),s._v(", æ— è®ºå¦‚ä½•, è¿™ä¸¤ç§ç®—æ³•éƒ½æ„å‘³ç€ G1 è¿ä½œæœŸé—´"),t("mark",[t("strong",[s._v("ä¸ä¼šäº§ç”Ÿå†…å­˜ç©ºé—´ç¢ç‰‡")])]),s._v(", åƒåœ¾æ”¶é›†å®Œæˆä¹‹åèƒ½æä¾›è§„æ•´çš„å¯ç”¨å†…å­˜. è¿™ç§ç‰¹æ€§æœ‰åˆ©äºç¨‹åºé•¿æ—¶é—´è¿è¡Œ, åœ¨ç¨‹åºä¸ºå¤§å¯¹è±¡åˆ†é…å†…å­˜æ—¶ä¸å®¹æ˜“å› æ— æ³•æ‰¾åˆ°è¿ç»­å†…å­˜ç©ºé—´è€Œæå‰è§¦å‘ä¸‹ä¸€æ¬¡æ”¶é›†.")]),s._v(" "),t("p",[s._v("ä¸è¿‡, G1 ç›¸å¯¹äº CMS ä»ç„¶ä¸æ˜¯å å…¨æ–¹ä½, å‹å€’æ€§ä¼˜åŠ¿çš„, ä»å®ƒå‡ºç°å‡ å¹´ä»ä¸èƒ½åœ¨æ‰€æœ‰åº”ç”¨åœºæ™¯ä¸­ä»£æ›¿ CMS å°±å¯ä»¥å¾—çŸ¥è¿™ä¸ªç»“è®º. æ¯”èµ· CMS, G1 çš„å¼±é¡¹ä¹Ÿå¯ä»¥åˆ—ä¸¾å‡ºä¸å°‘, å¦‚åœ¨ç”¨æˆ·ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­, G1 æ— è®ºæ˜¯"),t("strong",[s._v("ä¸ºäº†åƒåœ¾æ”¶é›†äº§ç”Ÿçš„å†…å­˜å ç”¨(Footprint)è¿˜æ˜¯ç¨‹åºè¿è¡Œæ—¶çš„é¢å¤–æ‰§è¡Œè´Ÿè½½(Overload)éƒ½è¦æ¯” CMS è¦é«˜")]),s._v(".")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("G1 å†…å­˜å ç”¨æ›´å¤§")]),s._v(": è™½ç„¶ G1 å’Œ CMS éƒ½ä½¿ç”¨å¡è¡¨æ¥å¤„ç†è·¨ä»£æŒ‡é’ˆ, ä½† G1 çš„å¡è¡¨å®ç°æ›´ä¸ºå¤æ‚, è€Œä¸”å †ä¸­æ¯ä¸ª Region, æ— è®ºæ‰®æ¼”çš„æ˜¯æ–°ç”Ÿä»£è¿˜æ˜¯è€å¹´ä»£è§’è‰², éƒ½"),t("strong",[s._v("å¿…é¡»æœ‰ä¸€ä»½å¡è¡¨, è¿™å¯¼è‡´ G1 çš„è®°å¿†é›†(å’Œå…¶ä»–å†…å­˜æ¶ˆè€—)å¯èƒ½ä¼šå æ•´ä¸ªå †å®¹é‡çš„ 20% ä¹ƒè‡³æ›´å¤šçš„å†…å­˜ç©ºé—´")]),s._v("; ç›¸æ¯”èµ·æ¥ CMS çš„å¡è¡¨å°±ç›¸å½“ç®€å•, åªæœ‰å”¯ä¸€ä¸€ä»½, è€Œä¸”åªéœ€è¦å¤„ç†è€å¹´ä»£åˆ°æ–°ç”Ÿä»£çš„å¼•ç”¨, åè¿‡æ¥åˆ™ä¸éœ€è¦, ç”±äºæ–°ç”Ÿä»£çš„å¯¹è±¡å…·æœ‰æœç”Ÿå¤•ç­çš„ä¸ç¨³å®šæ€§, å¼•ç”¨å˜åŒ–é¢‘ç¹, èƒ½çœä¸‹è¿™ä¸ªåŒºåŸŸçš„ç»´æŠ¤å¼€é”€æ˜¯å¾ˆåˆ’ç®—çš„.")]),s._v(" "),t("li",[t("strong",[s._v("G1 æ‰§è¡Œè´Ÿè½½æ›´é«˜")]),s._v(": åœ¨æ‰§è¡Œè´Ÿè½½çš„è§’åº¦ä¸Š, åŒæ ·ç”±äºä¸¤ä¸ªæ”¶é›†å™¨å„è‡ªçš„ç»†èŠ‚å®ç°ç‰¹ç‚¹å¯¼è‡´äº†ç”¨æˆ·ç¨‹åºè¿è¡Œæ—¶çš„è´Ÿè½½ä¼šæœ‰ä¸åŒ, è­¬å¦‚å®ƒä»¬éƒ½ä½¿ç”¨åˆ°"),t("strong",[s._v("å†™å±éšœ")]),s._v(", CMS ç”¨å†™åå±éšœæ¥æ›´æ–°ç»´æŠ¤å¡è¡¨; è€Œ G1 é™¤äº†ä½¿ç”¨å†™åå±éšœæ¥è¿›è¡ŒåŒæ ·çš„(ç”±äº G1çš„å¡è¡¨ç»“æ„å¤æ‚, å…¶å®æ˜¯æ›´çƒ¦ççš„)å¡è¡¨ç»´æŠ¤æ“ä½œå¤–, ä¸ºäº†å®ç°åŸå§‹å¿«ç…§æœç´¢(SATB)ç®—æ³•, è¿˜éœ€è¦ä½¿ç”¨å†™å‰å±éšœæ¥è·Ÿè¸ªå¹¶å‘æ—¶çš„æŒ‡é’ˆå˜åŒ–æƒ…å†µ. ç›¸æ¯”èµ·å¢é‡æ›´æ–°ç®—æ³•, åŸå§‹å¿«ç…§æœç´¢èƒ½å¤Ÿå‡å°‘å¹¶å‘æ ‡è®°å’Œé‡æ–°æ ‡è®°é˜¶æ®µçš„æ¶ˆè€—, é¿å… CMS é‚£æ ·åœ¨æœ€ç»ˆæ ‡è®°é˜¶æ®µåœé¡¿æ—¶é—´è¿‡é•¿çš„ç¼ºç‚¹, ä½†æ˜¯åœ¨ç”¨æˆ·ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ç¡®å®ä¼šäº§ç”Ÿç”±è·Ÿè¸ªå¼•ç”¨å˜åŒ–å¸¦æ¥çš„é¢å¤–è´Ÿæ‹…. ç”±äº G1 å¯¹å†™å±éšœçš„å¤æ‚æ“ä½œè¦æ¯” CMS æ¶ˆè€—æ›´å¤šçš„è¿ç®—èµ„æº, æ‰€ä»¥ CMS çš„å†™å±éšœå®ç°æ˜¯ç›´æ¥çš„åŒæ­¥æ“ä½œ, è€Œ G1 å°±ä¸å¾—ä¸å°†å…¶å®ç°ä¸ºç±»ä¼¼äºæ¶ˆæ¯é˜Ÿåˆ—çš„ç»“æ„, æŠŠå†™å‰å±éšœå’Œå†™åå±éšœä¸­è¦åšçš„äº‹æƒ…éƒ½æ”¾åˆ°é˜Ÿåˆ—é‡Œ, ç„¶åå†å¼‚æ­¥å¤„ç†.")])]),s._v(" "),t("p",[s._v("ä»¥ä¸Šçš„ä¼˜ç¼ºç‚¹å¯¹æ¯”ä»…ä»…æ˜¯é’ˆå¯¹ G1å’Œ CMS ä¸¤æ¬¾åƒåœ¾æ”¶é›†å™¨å•ç‹¬æŸæ–¹é¢çš„å®ç°ç»†èŠ‚çš„å®šæ€§åˆ†æ, é€šå¸¸å¤§å®¶è¯´å“ªæ¬¾æ”¶é›†å™¨è¦æ›´å¥½, è¦å¥½ä¸Šå¤šå°‘, å¾€å¾€æ˜¯é’ˆå¯¹"),t("strong",[s._v("å…·ä½“åœºæ™¯")]),s._v("æ‰èƒ½åšçš„å®šé‡æ¯”è¾ƒ. æŒ‰ç…§ç¬”è€…çš„å®è·µç»éªŒ, ç›®å‰"),t("mark",[t("strong",[s._v("åœ¨å°å†…å­˜åº”ç”¨ä¸Š CMS çš„è¡¨ç°å¤§æ¦‚ç‡ä»ç„¶è¦ä¼šä¼˜äº G1, è€Œåœ¨å¤§å†…å­˜åº”ç”¨ä¸Š G1åˆ™å¤§å¤šèƒ½å‘æŒ¥å…¶ä¼˜åŠ¿, è¿™ä¸ªä¼˜åŠ£åŠ¿çš„ Java å †å®¹é‡å¹³è¡¡ç‚¹é€šå¸¸åœ¨ 6GB è‡³ 8GB ä¹‹é—´")])]),s._v(", å½“ç„¶, ä»¥ä¸Šè¿™äº›ä¹Ÿä»…æ˜¯ç»éªŒä¹‹è°ˆ, ä¸åŒåº”ç”¨éœ€è¦é‡ä½“è£è¡£åœ°å®é™…æµ‹è¯•æ‰èƒ½å¾—å‡ºæœ€åˆé€‚çš„ç»“è®º, éšç€ HotSpot çš„å¼€å‘è€…å¯¹ G1 çš„ä¸æ–­ä¼˜åŒ–, ä¹Ÿä¼šè®©å¯¹æ¯”ç»“æœç»§ç»­å‘ G1 å€¾æ–œ.")]),s._v(" "),t("h6",{attrs:{id:"_7-å‚æ•°è®¾ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-å‚æ•°è®¾ç½®"}},[s._v("#")]),s._v(" (7)å‚æ•°è®¾ç½®")]),s._v(" "),t("p",[s._v("å¯é…ç½®çš„è™šæ‹Ÿæœºå‚æ•°å¦‚ä¸‹:")]),s._v(" "),t("ul",[t("li",[s._v("-XX: "),t("strong",[s._v("+UseG1GC")]),s._v(": ä½¿ç”¨ G1 æ”¶é›†å™¨.")]),s._v(" "),t("li",[s._v("-XX:"),t("strong",[s._v("ParallelGCThreads")]),s._v(": æŒ‡å®š GC å·¥ä½œçš„"),t("strong",[s._v("çº¿ç¨‹æ•°é‡")]),s._v(".")]),s._v(" "),t("li",[s._v("-XX:G1HeapRegionSize: æŒ‡å®š Region å¤§å°(1MB ~ 32MB, ä¸”å¿…é¡»æ˜¯ 2 çš„å¹‚), é»˜è®¤å°†æ•´å †åˆ’åˆ†ä¸º 2048 ä¸ª region.")]),s._v(" "),t("li",[s._v("-"),t("strong",[s._v("XX:MaxGCPauseMillis")]),s._v(": "),t("strong",[s._v("ç›®æ ‡æš‚åœæ—¶é—´")]),s._v("(é»˜è®¤ "),t("strong",[s._v("200ms")]),s._v(").")]),s._v(" "),t("li",[s._v("-XX:G1NewSizePercent: æ–°ç”Ÿä»£å†…å­˜åˆå§‹ç©ºé—´(é»˜è®¤æ•´å † 5%).")]),s._v(" "),t("li",[s._v("-XX:G1MaxNewSizePercent: æ–°ç”Ÿä»£å†…å­˜æœ€å¤§ç©ºé—´.")]),s._v(" "),t("li",[s._v("-XX:TargetSurvivorRatio: Survivor åŒºçš„å¡«å……å®¹é‡(é»˜è®¤ 50%), Survivor åŒºåŸŸé‡Œçš„ä¸€æ‰¹å¯¹è±¡(å¹´é¾„1 + å¹´é¾„2 + å¹´é¾„n çš„å¤šä¸ªå¹´é¾„å¯¹è±¡)æ€»å’Œè¶…è¿‡äº† Survivor åŒºåŸŸçš„ 50%, æ­¤æ—¶å°±ä¼šæŠŠå¹´é¾„ n (å«)ä»¥ä¸Šçš„å¯¹è±¡éƒ½æ”¾å…¥è€å¹´ä»£.")]),s._v(" "),t("li",[s._v("-XX:MaxTenuringThreshold: æœ€å¤§å¹´é¾„é˜ˆå€¼(é»˜è®¤ 15).")]),s._v(" "),t("li",[s._v("-XX:InitiatingHeapOccupancyPercent: è€å¹´ä»£å ç”¨ç©ºé—´è¾¾åˆ°æ•´å †å†…å­˜é˜ˆå€¼(é»˜è®¤ 45%), åˆ™æ‰§è¡Œæ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ··åˆæ”¶é›†("),t("strong",[s._v("MixedGC")]),s._v("), æ¯”å¦‚å †é»˜è®¤æœ‰ 2048 ä¸ª Region, å¦‚æœæœ‰æ¥è¿‘ 1000 ä¸ª Region éƒ½æ˜¯è€å¹´ä»£çš„, åˆ™å¯èƒ½å°±è¦è§¦å‘ MixedGC.")]),s._v(" "),t("li",[s._v("-XX:G1HeapWastePercent(é»˜è®¤ 5%): GC è¿‡ç¨‹ä¸­ç©ºå‡ºæ¥çš„ region æ˜¯å¦å……è¶³é˜ˆå€¼, åœ¨æ··åˆå›æ”¶çš„æ—¶å€™, å¯¹ Region å›æ”¶éƒ½æ˜¯åŸºäºå¤åˆ¶ç®—æ³•è¿›è¡Œçš„, éƒ½æ˜¯æŠŠè¦å›æ”¶çš„ Region é‡Œçš„å­˜æ´»å¯¹è±¡æ”¾å…¥å…¶ä»– Region, ç„¶åè¿™ä¸ª Region ä¸­çš„åƒåœ¾å¯¹è±¡å…¨éƒ¨æ¸…ç†æ‰, è¿™æ ·çš„è¯åœ¨å›æ”¶è¿‡ç¨‹å°±ä¼šä¸æ–­ç©ºå‡ºæ¥æ–°çš„ Region, ä¸€æ—¦ç©ºé—²å‡ºæ¥çš„ Region æ•°é‡è¾¾åˆ°äº†å †å†…å­˜çš„ 5%, æ­¤æ—¶å°±ä¼šç«‹å³åœæ­¢æ··åˆå›æ”¶, æ„å‘³ç€æœ¬æ¬¡æ··åˆå›æ”¶å°±ç»“æŸäº†.")]),s._v(" "),t("li",[s._v("-XX:G1MixedGCLiveThresholdPercent(é»˜è®¤85%): Region ä¸­çš„å­˜æ´»å¯¹è±¡ä½äºè¿™ä¸ªå€¼æ—¶æ‰ä¼šå›æ”¶è¯¥ Region, å¦‚æœè¶…è¿‡è¿™ä¸ªå€¼, å­˜æ´»å¯¹è±¡è¿‡å¤š, å›æ”¶çš„æ„ä¹‰ä¸å¤§.")]),s._v(" "),t("li",[s._v("-XX:G1MixedGCCountTarget: åœ¨ä¸€æ¬¡å›æ”¶è¿‡ç¨‹ä¸­æŒ‡å®šåšå‡ æ¬¡ç­›é€‰å›æ”¶(é»˜è®¤ 8 æ¬¡), åœ¨æœ€åä¸€ä¸ªç­›é€‰å›æ”¶é˜¶æ®µå¯ä»¥å›æ”¶ä¸€ä¼š, ç„¶åæš‚åœå›æ”¶, æ¢å¤ç³»ç»Ÿè¿è¡Œ, ä¸€ä¼šå†å¼€å§‹å›æ”¶, è¿™æ ·å¯ä»¥è®©ç³»ç»Ÿä¸è‡³äºå•æ¬¡åœé¡¿æ—¶é—´è¿‡é•¿.")])]),s._v(" "),t("h6",{attrs:{id:"_8-g1åƒåœ¾æ”¶é›†ç±»å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-g1åƒåœ¾æ”¶é›†ç±»å‹"}},[s._v("#")]),s._v(" (8)G1åƒåœ¾æ”¶é›†ç±»å‹")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("Young GC")]),s._v(": Young GC å¹¶ä¸æ˜¯è¯´ç°æœ‰çš„ Eden åŒºæ”¾æ»¡äº†å°±ä¼šé©¬ä¸Šè§¦å‘, G1 ä¼šè®¡ç®—ä¸‹ç°åœ¨ Eden åŒºå›æ”¶å¤§æ¦‚è¦å¤šä¹…æ—¶é—´, å¦‚æœå›æ”¶æ—¶é—´è¿œè¿œå°äºå‚æ•° -XX:MaxGCPauseMills è®¾å®šçš„å€¼, é‚£ä¹ˆ"),t("strong",[s._v("å¢åŠ å¹´è½»ä»£çš„ region")]),s._v(", ç»§ç»­å­˜æ”¾æ–°å¯¹è±¡, ä¸ä¼šé©¬ä¸Šåš Young GC, "),t("strong",[s._v("ç›´åˆ°ä¸‹ä¸€æ¬¡ Eden åŒºæ”¾æ»¡")]),s._v(". å½“è®¡ç®—å›æ”¶æ—¶é—´æ¥è¿‘å‚æ•° -"),t("strong",[s._v("XX:MaxGCPauseMills")]),s._v(" è®¾å®šçš„å€¼, é‚£ä¹ˆå°±ä¼šè§¦å‘ Young GC.")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("Mixed GC")]),s._v(": ä¸æ˜¯ Full GC, è€å¹´ä»£çš„å †å æœ‰ç‡è¾¾åˆ°å‚æ•°( "),t("strong",[s._v("-XX:InitiatingHeapOccupancyPercent")]),s._v(") è®¾å®šçš„å€¼åˆ™è§¦å‘, å›æ”¶"),t("strong",[s._v("æ‰€æœ‰çš„ Young å’Œéƒ¨åˆ† Old")]),s._v("(æ ¹æ®æœŸæœ›çš„ GC åœé¡¿æ—¶é—´ç¡®å®š old åŒºåƒåœ¾æ”¶é›†çš„ä¼˜å…ˆé¡ºåº)ä»¥åŠå¤§å¯¹è±¡åŒº, æ­£å¸¸æƒ…å†µ G1 çš„åƒåœ¾æ”¶é›†æ˜¯å…ˆåš "),t("strong",[s._v("Mixed GC")]),s._v(", ä¸»è¦ä½¿ç”¨"),t("strong",[s._v("å¤åˆ¶ç®—æ³•")]),s._v(", éœ€è¦æŠŠå„ä¸ª region ä¸­å­˜æ´»çš„å¯¹è±¡æ‹·è´åˆ°åˆ«çš„ region é‡Œå», æ‹·è´è¿‡ç¨‹ä¸­å¦‚æœå‘ç°"),t("strong",[s._v("æ²¡æœ‰è¶³å¤Ÿçš„ç©º region")]),s._v(" èƒ½å¤Ÿæ‰¿è½½æ‹·è´å¯¹è±¡å°±ä¼šè§¦å‘ä¸€æ¬¡ Full GC. å¤§å¯¹è±¡ä¹Ÿä¼šåœ¨ Mixed GC ä¸­å›æ”¶.")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("Full GC")]),s._v(": åœæ­¢"),t("strong",[s._v("ç³»ç»Ÿç¨‹åº")]),s._v(", ç„¶åé‡‡ç”¨å•çº¿ç¨‹è¿›è¡Œæ ‡è®°, æ¸…ç†å’Œå‹ç¼©æ•´ç†, å¥½ç©ºé—²å‡ºæ¥ä¸€æ‰¹ Region æ¥ä¾›ä¸‹ä¸€æ¬¡ Mixed GC ä½¿ç”¨, è¿™ä¸ªè¿‡ç¨‹éå¸¸è€—æ—¶.")])])]),s._v(" "),t("h6",{attrs:{id:"_9-g1åº”ç”¨åœºæ™¯ä¸ç¤ºä¾‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-g1åº”ç”¨åœºæ™¯ä¸ç¤ºä¾‹"}},[s._v("#")]),s._v(" (9)G1åº”ç”¨åœºæ™¯ä¸ç¤ºä¾‹")]),s._v(" "),t("blockquote",[t("p",[s._v("ä»€ä¹ˆåœºæ™¯é€‚åˆä½¿ç”¨G1?")])]),s._v(" "),t("ol",[t("li",[s._v("50% ä»¥ä¸Šçš„å †è¢«"),t("strong",[s._v("å­˜æ´»å¯¹è±¡")]),s._v("å ç”¨.")]),s._v(" "),t("li",[s._v("å¯¹è±¡åˆ†é…å’Œæ™‹å‡çš„"),t("strong",[s._v("é€Ÿåº¦å˜åŒ–")]),s._v("éå¸¸å¤§.")]),s._v(" "),t("li",[s._v("åƒåœ¾å›æ”¶"),t("strong",[s._v("æ—¶é—´ç‰¹åˆ«é•¿")]),s._v(", è¶…è¿‡ 1 ç§’.")]),s._v(" "),t("li",[s._v("8GB ä»¥ä¸Šçš„"),t("strong",[s._v("å †å†…å­˜")]),s._v("(å»ºè®®å€¼), å³"),t("strong",[s._v("å¤§å†…å­˜")]),s._v("ä¸‹.")]),s._v(" "),t("li",[s._v("åœé¡¿æ—¶é—´æ˜¯ "),t("strong",[s._v("500ms ä»¥å†…")]),s._v(".")])]),s._v(" "),t("p",[s._v("å¯¹äº Kafka è¿™ç§é«˜å¹¶å‘æ¶ˆæ¯çš„ç³»ç»Ÿæ¥è¯´, "),t("strong",[s._v("æ¯ç§’å¤„ç†å‡ ä¸‡ç”šè‡³å‡ åä¸‡æ¶ˆæ¯")]),s._v("æ˜¯å¾ˆæ­£å¸¸çš„, ä¸€èˆ¬éƒ¨ç½² Kafka éœ€è¦ç”¨"),t("strong",[s._v("å¤§å†…å­˜æœºå™¨")]),s._v("(æ¯”å¦‚ 64G), ä¹Ÿå°±æ˜¯è¯´å¯ä»¥ç»™å¹´è½»ä»£åˆ†é…ä¸‰å››å G çš„å†…å­˜ç”¨æ¥æ”¯æ’‘é«˜å¹¶å‘å¤„ç†. è¿™é‡Œå°±æ¶‰åŠåˆ°ä¸€ä¸ªé—®é¢˜, ä¹‹å‰è¯´å¯¹äº eden åŒºçš„ Young GC æ˜¯"),t("strong",[s._v("å¾ˆå¿«")]),s._v("çš„, è¿™ç§æƒ…å†µä¸‹å®ƒçš„æ‰§è¡Œè¿˜ä¼šå¾ˆå¿«å—? å¾ˆæ˜¾ç„¶ä¸å¯èƒ½, å› ä¸ºå†…å­˜å¤ªå¤§, å¤„ç†è¿˜æ˜¯è¦èŠ±ä¸å°‘æ—¶é—´çš„, å‡è®¾ä¸‰å››å G å†…å­˜å›æ”¶å¯èƒ½æœ€å¿«ä¹Ÿè¦"),t("strong",[s._v("å‡ ç§’é’Ÿ")]),s._v(", æŒ‰ Kafka è¿™ä¸ª"),t("strong",[s._v("å¹¶å‘é‡æ”¾æ»¡ä¸‰å››å G çš„ eden åŒºå¯èƒ½ä¹Ÿå°±ä¸€ä¸¤åˆ†é’Ÿ")]),s._v(", é‚£ä¹ˆæ„å‘³ç€æ•´ä¸ªç³»ç»Ÿ"),t("strong",[s._v("æ¯è¿è¡Œä¸€ä¸¤åˆ†é’Ÿå°±ä¼šå› ä¸º Young GC å¡é¡¿å‡ ç§’é’Ÿ")]),s._v("æ²¡æ³•å¤„ç†æ–°æ¶ˆæ¯, è¿™æ˜¾ç„¶ä¸è¡Œ. è¿™ç§æƒ…å†µå¯ä»¥ä½¿ç”¨ G1 æ”¶é›†å™¨, è®¾ç½® -"),t("strong",[s._v("XX:MaxGCPauseMills")]),s._v(" ä¸º "),t("strong",[s._v("50ms")]),s._v(", å‡è®¾ 50ms èƒ½å¤Ÿå›æ”¶ä¸‰åˆ°å››ä¸ª G å†…å­˜, ç„¶å 50ms çš„å¡é¡¿å®Œå…¨èƒ½å¤Ÿæ¥å—, ç”¨æˆ·å‡ ä¹æ— æ„ŸçŸ¥, é‚£ä¹ˆæ•´ä¸ªç³»ç»Ÿå°±å¯ä»¥åœ¨å¡é¡¿å‡ ä¹æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹"),t("strong",[s._v("ä¸€è¾¹å¤„ç†ä¸šåŠ¡ä¸€è¾¹æ”¶é›†åƒåœ¾")]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("G1 å¤©ç”Ÿå°±é€‚åˆè¿™ç§å¤§å†…å­˜æœºå™¨çš„ JVM è¿è¡Œ, å¯ä»¥æ¯”è¾ƒå®Œç¾çš„è§£å†³å¤§å†…å­˜åƒåœ¾å›æ”¶æ—¶é—´è¿‡é•¿çš„é—®é¢˜. å¦‚æœç”¨ CMS è¿™ç§æ”¶é›†å™¨çš„è¯, åœ¨å¤§å†…å­˜ä¸‹ç”±äºéœ€è¦å¤„ç†çš„å†…å­˜å¤ªå¤§è€Œå¯¼è‡´ STW çš„æ—¶é—´å¯èƒ½ä¼šå¾ˆé•¿.")])]),s._v(" "),t("h4",{attrs:{id:"ä½å»¶è¿Ÿåƒåœ¾æ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ä½å»¶è¿Ÿåƒåœ¾æ”¶é›†å™¨"}},[s._v("#")]),s._v(" ä½å»¶è¿Ÿåƒåœ¾æ”¶é›†å™¨")]),s._v(" "),t("p",[s._v('HotSpot çš„åƒåœ¾æ”¶é›†å™¨ä» Serial å‘å±•åˆ° CMS å†åˆ° G1, ç»å†äº†é€¾äºŒåå¹´æ—¶é—´, ç»è¿‡äº†æ•°ç™¾ä¸Šåƒä¸‡å°æœåŠ¡å™¨ä¸Šçš„åº”ç”¨å®è·µ, å·²ç»è¢«æ·¬ç‚¼å¾—ç›¸å½“æˆç†Ÿäº†, ä¸è¿‡å®ƒä»¬è·ç¦» "å®Œç¾" è¿˜æ˜¯å¾ˆé¥è¿œ. æ€æ ·çš„æ”¶é›†å™¨æ‰ç®—æ˜¯ "å®Œç¾" å‘¢? è¿™å¬èµ·æ¥åƒæ˜¯ä¸€é“ä¸»è§‚é¢˜, å…¶å®ä¸ç„¶, å®Œç¾éš¾ä»¥å®ç°, ä½†æ˜¯ç¡®å®å¯ä»¥æŠŠå®ƒå®¢è§‚æè¿°å‡ºæ¥.')]),s._v(" "),t("blockquote",[t("p",[s._v("è¡¡é‡åƒåœ¾æ”¶é›†å™¨çš„æŒ‡æ ‡")])]),s._v(" "),t("p",[s._v("è¡¡é‡åƒåœ¾æ”¶é›†å™¨çš„ä¸‰é¡¹æœ€é‡è¦çš„æŒ‡æ ‡æ˜¯: "),t("mark",[t("strong",[s._v("å†…å­˜å ç”¨(Footprint), ååé‡(Throughput)å’Œå»¶è¿Ÿ(Latency)")])]),s._v(' , ä¸‰è€…å…±åŒæ„æˆäº†ä¸€ä¸ª "'),t("strong",[s._v("ä¸å¯èƒ½ä¸‰è§’")]),s._v('". ä¸‰è€…æ€»ä½“çš„è¡¨ç°ä¼šéšæŠ€æœ¯è¿›æ­¥è€Œè¶Šæ¥è¶Šå¥½, ä½†æ˜¯è¦åœ¨è¿™ä¸‰ä¸ªæ–¹é¢åŒæ—¶å…·æœ‰å“è¶Šè¡¨ç°çš„ "å®Œç¾" æ”¶é›†å™¨æ˜¯æå…¶å›°éš¾ç”šè‡³æ˜¯ä¸å¯èƒ½çš„, ä¸€æ¬¾ä¼˜ç§€çš„æ”¶é›†å™¨'),t("strong",[s._v("é€šå¸¸æœ€å¤šå¯ä»¥åŒæ—¶è¾¾æˆå…¶ä¸­çš„ä¸¤é¡¹")]),s._v(". (è¿™ä¸å°±ç±»ä¼¼ CAP?)")]),s._v(" "),t("p",[s._v("åœ¨å†…å­˜å ç”¨, ååé‡å’Œå»¶è¿Ÿè¿™ä¸‰é¡¹æŒ‡æ ‡é‡Œ, "),t("mark",[t("strong",[s._v("å»¶è¿Ÿçš„é‡è¦æ€§æ—¥ç›Šå‡¸æ˜¾, è¶Šå‘å¤‡å—å…³æ³¨")])]),s._v(". å…¶åŸå› æ˜¯éšç€è®¡ç®—æœºç¡¬ä»¶çš„å‘å±•, æ€§èƒ½çš„æå‡, å¤§å®¶è¶Šæ¥è¶Šèƒ½å®¹å¿æ”¶é›†å™¨å¤šå ç”¨ä¸€ç‚¹å†…å­˜; ç¡¬ä»¶æ€§èƒ½å¢é•¿, å¯¹è½¯ä»¶ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›æ˜¯æœ‰ç›´æ¥åŠ©ç›Šçš„, ç¡¬ä»¶çš„è§„æ ¼å’Œæ€§èƒ½è¶Šé«˜, ä¹Ÿæœ‰åŠ©äºé™ä½æ”¶é›†å™¨è¿è¡Œæ—¶å¯¹åº”ç”¨ç¨‹åºçš„å½±å“, æ¢å¥è¯è¯´, ååé‡ä¼šæ›´é«˜. ä½†å¯¹å»¶è¿Ÿåˆ™ä¸æ˜¯è¿™æ ·, ç¡¬ä»¶è§„æ ¼æå‡, å‡†ç¡®åœ°è¯´æ˜¯å†…å­˜çš„æ‰©å¤§, å¯¹å»¶è¿Ÿåè€Œä¼šå¸¦æ¥è´Ÿé¢çš„æ•ˆæœ, è¿™ç‚¹ä¹Ÿæ˜¯å¾ˆç¬¦åˆç›´è§‚æ€ç»´çš„: è™šæ‹Ÿæœºè¦å›æ”¶å®Œæ•´çš„ 1TB çš„å †å†…å­˜, æ¯«æ— ç–‘é—®è¦æ¯”å›æ”¶ 1GB çš„å †å†…å­˜è€—è´¹æ›´å¤šæ—¶é—´. ç”±æ­¤å°±ä¸éš¾ç†è§£ä¸ºä½•å»¶è¿Ÿä¼šæˆä¸ºåƒåœ¾æ”¶é›†å™¨æœ€è¢«é‡è§†çš„æ€§èƒ½æŒ‡æ ‡äº†. ç°åœ¨æ¥è§‚å¯Ÿä¸€ä¸‹"),t("strong",[s._v("ç°åœ¨å·²æ¥è§¦è¿‡çš„åƒåœ¾æ”¶é›†å™¨çš„åœé¡¿çŠ¶å†µ")]),s._v(", å¦‚ä¸‹å›¾æ‰€ç¤º.")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00036-20240302133505-tx3ykyv.jpg",alt:"",title:"å„æ¬¾æ”¶é›†å™¨çš„å¹¶å‘æƒ…å†µ"}})]),s._v(" "),t("p",[s._v("å›¾ä¸­"),t("strong",[s._v("æµ…è‰²é˜¶æ®µè¡¨ç¤ºå¿…é¡»æŒ‚èµ·ç”¨æˆ·çº¿ç¨‹, æ·±è‰²è¡¨ç¤ºæ”¶é›†å™¨çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹æ˜¯å¹¶å‘å·¥ä½œçš„")]),s._v(". ç”±å›¾å¯è§, åœ¨ CMS å’Œ G1 ä¹‹å‰çš„å…¨éƒ¨æ”¶é›†å™¨, å…¶å·¥ä½œçš„æ‰€æœ‰æ­¥éª¤éƒ½ä¼šäº§ç”Ÿ STW å¼çš„åœé¡¿; CMS å’Œ G1 åˆ†åˆ«ä½¿ç”¨"),t("strong",[s._v("å¢é‡æ›´æ–°å’ŒåŸå§‹å¿«ç…§")]),s._v("æŠ€æœ¯, å®ç°äº†æ ‡è®°é˜¶æ®µçš„å¹¶å‘, ä¸ä¼šå› ç®¡ç†çš„å †å†…å­˜å˜å¤§, è¦æ ‡è®°çš„å¯¹è±¡å˜å¤šè€Œå¯¼è‡´åœé¡¿æ—¶é—´éšä¹‹å¢é•¿. ä½†æ˜¯å¯¹äºæ ‡è®°é˜¶æ®µä¹‹åçš„å¤„ç†, ä»æœªå¾—åˆ°å¦¥å–„è§£å†³. CMS ä½¿ç”¨æ ‡è®°-æ¸…é™¤ç®—æ³•, è™½ç„¶é¿å…äº†æ•´ç†é˜¶æ®µæ”¶é›†å™¨å¸¦æ¥çš„åœé¡¿, ä½†æ˜¯æ¸…é™¤ç®—æ³•ä¸è®ºå¦‚ä½•ä¼˜åŒ–æ”¹è¿›, åœ¨è®¾è®¡åŸç†ä¸Šé¿å…ä¸äº†ç©ºé—´ç¢ç‰‡çš„äº§ç”Ÿ, éšç€ç©ºé—´ç¢ç‰‡ä¸æ–­æ·¤ç§¯æœ€ç»ˆä¾ç„¶é€ƒä¸è¿‡ STW çš„å‘½è¿. G1 è™½ç„¶å¯ä»¥æŒ‰æ›´å°çš„ç²’åº¦è¿›è¡Œå›æ”¶, ä»è€ŒæŠ‘åˆ¶æ•´ç†é˜¶æ®µå‡ºç°æ—¶é—´è¿‡é•¿çš„åœé¡¿, ä½†æ¯•ç«Ÿä¹Ÿè¿˜æ˜¯è¦æš‚åœçš„.")]),s._v(" "),t("p",[t("strong",[s._v("æœ€åçš„ä¸¤æ¬¾æ”¶é›†å™¨, Shenandoah å’Œ ZGC, å‡ ä¹æ•´ä¸ªå·¥ä½œè¿‡ç¨‹å…¨éƒ¨éƒ½æ˜¯å¹¶å‘çš„")]),s._v(", åªæœ‰åˆå§‹æ ‡è®°, æœ€ç»ˆæ ‡è®°è¿™äº›é˜¶æ®µæœ‰çŸ­æš‚çš„åœé¡¿, è¿™éƒ¨åˆ†åœé¡¿çš„æ—¶é—´åŸºæœ¬ä¸Šæ˜¯å›ºå®šçš„, ä¸å †çš„å®¹é‡, å †ä¸­å¯¹è±¡çš„æ•°é‡æ²¡æœ‰æ­£æ¯”ä¾‹å…³ç³». å®é™…ä¸Š, å®ƒä»¬éƒ½å¯ä»¥åœ¨ä»»æ„å¯ç®¡ç†çš„(è­¬å¦‚ç°åœ¨ ZGC åªèƒ½ç®¡ç† 4TB ä»¥å†…çš„å †)å †å®¹é‡ä¸‹, å®ç°åƒåœ¾æ”¶é›†çš„åœé¡¿éƒ½ä¸è¶…è¿‡åæ¯«ç§’è¿™ç§ä»¥å‰å¬èµ·æ¥æ˜¯å¤©æ–¹å¤œè°­, åŒªå¤·æ‰€æ€çš„ç›®æ ‡. è¿™ä¸¤æ¬¾ç›®å‰ä»å¤„äº"),t("strong",[s._v("å®éªŒçŠ¶æ€")]),s._v('çš„æ”¶é›†å™¨, è¢«å®˜æ–¹å‘½åä¸º "'),t("strong",[s._v("ä½å»¶è¿Ÿåƒåœ¾æ”¶é›†å™¨")]),s._v('"(Low-Latency Garbage Collector æˆ–è€… Low-Pause-Time Garbage Collector).')]),s._v(" "),t("h5",{attrs:{id:"_1-shenandoahæ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-shenandoahæ”¶é›†å™¨"}},[s._v("#")]),s._v(" 1.Shenandoahæ”¶é›†å™¨")]),s._v(" "),t("p",[s._v('åœ¨æœ¬ä¹¦æ‰€å‡ºç°çš„ä¼—å¤šåƒåœ¾æ”¶é›†å™¨é‡Œ, Shenandoah å¤§æ¦‚æ˜¯æœ€ "'),t("strong",[s._v("å­¤ç‹¬")]),s._v('" çš„ä¸€ä¸ª. ç°ä»£ç¤¾ä¼šç«äº‰æ¿€çƒˆ, è¿ä¸€ä¸ªå…¬å¸é‡Œä¸åŒå›¢é˜Ÿä¹‹é—´éƒ½å­˜åœ¨ "éƒ¨é—¨å¢™", é‚£ Shenandoah ä½œä¸ºç¬¬ä¸€æ¬¾ä¸ç”± Oracle(åŒ…æ‹¬ä»¥å‰çš„ Sun)å…¬å¸çš„è™šæ‹Ÿæœºå›¢é˜Ÿæ‰€é¢†å¯¼å¼€å‘çš„ HotSpot åƒåœ¾æ”¶é›†å™¨, ä¸å¯é¿å…åœ°ä¼šå—åˆ°ä¸€äº›æ¥è‡ª "å®˜æ–¹" çš„æ’æŒ¤. å¦‚æœè¯»è€…çš„é¡¹ç›®è¦æ±‚ç”¨åˆ° Oracle å•†ä¸šæ”¯æŒçš„è¯, å°±ä¸å¾—ä¸æŠŠ Shenandoah æ’é™¤åœ¨é€‰æ‹©èŒƒå›´ä¹‹å¤–äº†.')]),s._v(" "),t("p",[s._v("ä»ä»£ç å†å²æ¸Šæºä¸Šè®², æ¯”èµ·ç¨åè¦ä»‹ç»çš„æœ‰ç€ Oracle æ­£æœ”è¡€ç»Ÿçš„ ZGC, "),t("strong",[s._v("Shenandoah åè€Œæ›´åƒæ˜¯ G1 çš„ä¸‹ä¸€ä»£ç»§æ‰¿è€…, å®ƒä»¬ä¸¤è€…æœ‰ç€ç›¸ä¼¼çš„å †å†…å­˜å¸ƒå±€, åœ¨åˆå§‹æ ‡è®°, å¹¶å‘æ ‡è®°ç­‰è®¸å¤šé˜¶æ®µçš„å¤„ç†æ€è·¯ä¸Šéƒ½é«˜åº¦ä¸€è‡´, ç”šè‡³è¿˜ç›´æ¥å…±äº«äº†ä¸€éƒ¨åˆ†å®ç°ä»£ç ")]),s._v(', è¿™ä½¿å¾—éƒ¨åˆ†å¯¹ G1 çš„æ‰“ç£¨æ”¹è¿›å’Œ Bug ä¿®æ”¹ä¼šåŒæ—¶åæ˜ åœ¨ Shenandoah ä¹‹ä¸Š, è€Œç”±äº Shenandoah åŠ å…¥æ‰€å¸¦æ¥çš„ä¸€äº›æ–°ç‰¹æ€§, ä¹Ÿæœ‰éƒ¨åˆ†ä¼šå‡ºç°åœ¨ G1 æ”¶é›†å™¨ä¸­, è­¬å¦‚åœ¨å¹¶å‘å¤±è´¥åä½œä¸º "é€ƒç”Ÿé—¨" çš„ Full GC, G1 å°±æ˜¯ç”±äºåˆå¹¶äº† Shenandoah çš„ä»£ç æ‰è·å¾—å¤šçº¿ç¨‹ Full GC çš„æ”¯æŒ.')]),s._v(" "),t("p",[s._v("é‚£ Shenandoah ç›¸æ¯”èµ· G1 åˆæœ‰ä»€ä¹ˆæ”¹è¿›å‘¢? è™½ç„¶ Shenandoah ä¹Ÿæ˜¯ä½¿ç”¨åŸºäº Region çš„å †å†…å­˜å¸ƒå±€, åŒæ ·æœ‰ç€ç”¨äºå­˜æ”¾å¤§å¯¹è±¡çš„ Humongous Region, é»˜è®¤çš„å›æ”¶ç­–ç•¥ä¹ŸåŒæ ·æ˜¯ä¼˜å…ˆå¤„ç†å›æ”¶ä»·å€¼æœ€å¤§çš„ Region... ä½†åœ¨ç®¡ç†å †å†…å­˜æ–¹é¢, å®ƒ"),t("strong",[s._v("ä¸ G1 è‡³å°‘æœ‰ä¸‰ä¸ªæ˜æ˜¾çš„ä¸åŒä¹‹å¤„")]),s._v(", æœ€é‡è¦çš„å½“ç„¶æ˜¯"),t("strong",[s._v("æ”¯æŒå¹¶å‘çš„æ•´ç†ç®—æ³•")]),s._v(", G1 çš„å›æ”¶é˜¶æ®µæ˜¯å¯ä»¥å¤šçº¿ç¨‹å¹¶è¡Œçš„, ä½†å´ä¸èƒ½ä¸ç”¨æˆ·çº¿ç¨‹å¹¶å‘, è¿™ç‚¹ä½œä¸º Shenandoah æœ€æ ¸å¿ƒçš„åŠŸèƒ½ç¨åç¬”è€…ä¼šç€é‡è®²è§£. å…¶æ¬¡, "),t("strong",[s._v("Shenandoah(ç›®å‰)æ˜¯é»˜è®¤ä¸ä½¿ç”¨åˆ†ä»£æ”¶é›†çš„")]),s._v(", æ¢è¨€ä¹‹, ä¸ä¼šæœ‰ä¸“é—¨çš„æ–°ç”Ÿä»£ Region æˆ–è€…è€å¹´ä»£ Region çš„å­˜åœ¨, æ²¡æœ‰å®ç°åˆ†ä»£, å¹¶ä¸æ˜¯è¯´åˆ†ä»£å¯¹ Shenandoah æ²¡æœ‰ä»·å€¼, è¿™æ›´å¤šæ˜¯å‡ºäºæ€§ä»·æ¯”çš„æƒè¡¡, åŸºäºå·¥ä½œé‡ä¸Šçš„è€ƒè™‘è€Œå°†å…¶æ”¾åˆ°ä¼˜å…ˆçº§è¾ƒä½çš„ä½ç½®ä¸Š. æœ€å, "),t("strong",[s._v('Shenandoah æ‘’å¼ƒäº†åœ¨ G1 ä¸­è€—è´¹å¤§é‡å†…å­˜å’Œè®¡ç®—èµ„æºå»ç»´æŠ¤çš„è®°å¿†é›†, æ”¹ç”¨åä¸º "è¿æ¥çŸ©é˜µ"(Connection Matrix)çš„å…¨å±€æ•°æ®ç»“æ„æ¥è®°å½•è·¨ Region çš„å¼•ç”¨å…³ç³»')]),s._v(", é™ä½äº†å¤„ç†è·¨ä»£æŒ‡é’ˆæ—¶çš„è®°å¿†é›†ç»´æŠ¤æ¶ˆè€—, ä¹Ÿé™ä½äº†ä¼ªå…±äº«é—®é¢˜çš„å‘ç”Ÿæ¦‚ç‡. è¿æ¥çŸ©é˜µå¯ä»¥ç®€å•ç†è§£ä¸ºä¸€å¼ äºŒç»´è¡¨æ ¼, å¦‚æœ Region N æœ‰å¯¹è±¡æŒ‡å‘ Region M, å°±åœ¨è¡¨æ ¼çš„ N è¡Œ M åˆ—ä¸­æ‰“ä¸Šä¸€ä¸ªæ ‡è®°, å¦‚ä¸‹å›¾æ‰€ç¤º, å¦‚æœ Region 5 ä¸­çš„å¯¹è±¡ Baz å¼•ç”¨äº† Region 3 çš„ Foo, Foo åˆå¼•ç”¨äº† Region 1 çš„ Bar, é‚£è¿æ¥çŸ©é˜µä¸­çš„ 5 è¡Œ 3 åˆ—, 3 è¡Œ 1 åˆ—å°±åº”è¯¥è¢«æ‰“ä¸Šæ ‡è®°. åœ¨å›æ”¶æ—¶é€šè¿‡è¿™å¼ è¡¨æ ¼å°±å¯ä»¥å¾—å‡ºå“ªäº› Region ä¹‹é—´äº§ç”Ÿäº†è·¨ä»£å¼•ç”¨.")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00037-20240302133505-vc23akl.jpg",alt:"",title:"Shenandoah æ”¶é›†å™¨çš„è¿æ¥çŸ©é˜µç¤ºæ„å›¾"}})]),s._v(" "),t("p",[s._v("Shenandoah æ”¶é›†å™¨çš„å·¥ä½œè¿‡ç¨‹å¤§è‡´å¯ä»¥åˆ’åˆ†ä¸ºä»¥ä¸‹"),t("strong",[s._v("ä¹ä¸ªé˜¶æ®µ")]),s._v(":")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("åˆå§‹æ ‡è®°")]),s._v(': ä¸ G1 ä¸€æ ·, é¦–å…ˆæ ‡è®°ä¸ GC Roots ç›´æ¥å…³è”çš„å¯¹è±¡, è¿™ä¸ªé˜¶æ®µä»æ˜¯ "'),t("strong",[s._v("Stop The World")]),s._v('" çš„, ä½†åœé¡¿æ—¶é—´ä¸å †å¤§å°æ— å…³, åªä¸ GC Roots çš„æ•°é‡ç›¸å…³.')]),s._v(" "),t("li",[t("strong",[s._v("å¹¶å‘æ ‡è®°")]),s._v(": ä¸ G1 ä¸€æ ·, éå†å¯¹è±¡å›¾, æ ‡è®°å‡ºå…¨éƒ¨å¯è¾¾çš„å¯¹è±¡, è¿™ä¸ªé˜¶æ®µæ˜¯"),t("strong",[s._v("ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘çš„")]),s._v(", æ—¶é—´é•¿çŸ­å–å†³äºå †ä¸­å­˜æ´»å¯¹è±¡çš„æ•°é‡ä»¥åŠå¯¹è±¡å›¾çš„ç»“æ„å¤æ‚ç¨‹åº¦.")]),s._v(" "),t("li",[t("strong",[s._v("æœ€ç»ˆæ ‡è®°")]),s._v(": ä¸ G1 ä¸€æ ·, "),t("strong",[s._v("å¤„ç†å‰©ä½™çš„ SATB æ‰«æ")]),s._v(", å¹¶åœ¨è¿™ä¸ªé˜¶æ®µç»Ÿè®¡å‡ºå›æ”¶ä»·å€¼æœ€é«˜çš„ Region, å°†è¿™äº› Region æ„æˆä¸€ç»„å›æ”¶é›†(Collection Set). æœ€ç»ˆæ ‡è®°é˜¶æ®µä¹Ÿä¼šæœ‰ä¸€"),t("strong",[s._v("å°æ®µçŸ­æš‚çš„åœé¡¿")]),s._v(".")]),s._v(" "),t("li",[t("strong",[s._v("å¹¶å‘æ¸…ç†")]),s._v(": è¿™ä¸ªé˜¶æ®µç”¨äºæ¸…ç†é‚£äº›æ•´ä¸ªåŒºåŸŸå†…è¿ä¸€ä¸ªå­˜æ´»å¯¹è±¡éƒ½æ²¡æœ‰æ‰¾åˆ°çš„ Region(è¿™ç±» Region è¢«ç§°ä¸º Immediate Garbage Region).")]),s._v(" "),t("li",[t("strong",[s._v("å¹¶å‘å›æ”¶")]),s._v(": å¹¶å‘å›æ”¶é˜¶æ®µæ˜¯ Shenandoah ä¸ä¹‹å‰ HotSpot ä¸­å…¶ä»–æ”¶é›†å™¨çš„"),t("strong",[s._v("æ ¸å¿ƒå·®å¼‚")]),s._v(". åœ¨è¿™ä¸ªé˜¶æ®µ, Shenandoah è¦æŠŠå›æ”¶é›†é‡Œé¢çš„å­˜æ´»å¯¹è±¡å…ˆå¤åˆ¶ä¸€ä»½åˆ°å…¶ä»–æœªè¢«ä½¿ç”¨çš„ Region ä¹‹ä¸­. å¤åˆ¶å¯¹è±¡è¿™ä»¶äº‹æƒ…å¦‚æœå°†ç”¨æˆ·çº¿ç¨‹å†»ç»“èµ·æ¥å†åšé‚£æ˜¯ç›¸å½“ç®€å•çš„, ä½†å¦‚æœä¸¤è€…å¿…é¡»è¦åŒæ—¶"),t("strong",[s._v("å¹¶å‘è¿›è¡Œ")]),s._v('çš„è¯, å°±å˜å¾—å¤æ‚èµ·æ¥äº†. å…¶å›°éš¾ç‚¹æ˜¯åœ¨ç§»åŠ¨å¯¹è±¡çš„åŒæ—¶, ç”¨æˆ·çº¿ç¨‹ä»ç„¶å¯èƒ½ä¸åœå¯¹è¢«ç§»åŠ¨çš„å¯¹è±¡è¿›è¡Œè¯»å†™è®¿é—®, ç§»åŠ¨å¯¹è±¡æ˜¯ä¸€æ¬¡æ€§çš„è¡Œä¸º, ä½†ç§»åŠ¨ä¹‹åæ•´ä¸ªå†…å­˜ä¸­æ‰€æœ‰æŒ‡å‘è¯¥å¯¹è±¡çš„å¼•ç”¨éƒ½è¿˜æ˜¯æ—§å¯¹è±¡çš„åœ°å€, è¿™æ˜¯å¾ˆéš¾ä¸€ç¬é—´å…¨éƒ¨æ”¹å˜è¿‡æ¥çš„. å¯¹äºå¹¶å‘å›æ”¶é˜¶æ®µé‡åˆ°çš„è¿™äº›å›°éš¾, Shenandoah å°†ä¼šé€šè¿‡è¯»å±éšœå’Œè¢«ç§°ä¸º "Brooks Pointers" çš„è½¬å‘æŒ‡é’ˆæ¥è§£å†³(è®²è§£å®Œ Shenandoah æ•´ä¸ªå·¥ä½œè¿‡ç¨‹ä¹‹åè¿˜è¦å†å›å¤´ä»‹ç»å®ƒ). å¹¶å‘å›æ”¶é˜¶æ®µè¿è¡Œçš„æ—¶é—´é•¿çŸ­å–å†³äºå›æ”¶é›†çš„å¤§å°.')]),s._v(" "),t("li",[t("strong",[s._v("åˆå§‹å¼•ç”¨æ›´æ–°")]),s._v(": å¹¶å‘å›æ”¶é˜¶æ®µå¤åˆ¶å¯¹è±¡ç»“æŸå, è¿˜éœ€è¦æŠŠå †ä¸­æ‰€æœ‰æŒ‡å‘æ—§å¯¹è±¡çš„å¼•ç”¨ä¿®æ­£åˆ°å¤åˆ¶åçš„æ–°åœ°å€, è¿™ä¸ªæ“ä½œç§°ä¸ºå¼•ç”¨æ›´æ–°. å¼•ç”¨æ›´æ–°çš„åˆå§‹åŒ–é˜¶æ®µå®é™…ä¸Šå¹¶æœªåšä»€ä¹ˆå…·ä½“çš„å¤„ç†, è®¾ç«‹è¿™ä¸ªé˜¶æ®µåªæ˜¯ä¸ºäº†å»ºç«‹ä¸€ä¸ªçº¿ç¨‹é›†åˆç‚¹, ç¡®ä¿æ‰€æœ‰å¹¶å‘å›æ”¶é˜¶æ®µä¸­è¿›è¡Œçš„æ”¶é›†å™¨çº¿ç¨‹éƒ½å·²å®Œæˆåˆ†é…ç»™å®ƒä»¬çš„å¯¹è±¡ç§»åŠ¨ä»»åŠ¡è€Œå·². åˆå§‹å¼•ç”¨æ›´æ–°æ—¶é—´å¾ˆçŸ­, ä¼šäº§ç”Ÿä¸€ä¸ªéå¸¸çŸ­æš‚çš„åœé¡¿.")]),s._v(" "),t("li",[t("strong",[s._v("å¹¶å‘å¼•ç”¨æ›´æ–°")]),s._v(": çœŸæ­£å¼€å§‹è¿›è¡Œå¼•ç”¨æ›´æ–°æ“ä½œ, è¿™ä¸ªé˜¶æ®µæ˜¯ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘çš„, æ—¶é—´é•¿çŸ­å–å†³äºå†…å­˜ä¸­æ¶‰åŠçš„å¼•ç”¨æ•°é‡çš„å¤šå°‘. å¹¶å‘å¼•ç”¨æ›´æ–°ä¸å¹¶å‘æ ‡è®°ä¸åŒ, å®ƒä¸å†éœ€è¦æ²¿ç€å¯¹è±¡å›¾æ¥æœç´¢, åªéœ€è¦æŒ‰ç…§å†…å­˜ç‰©ç†åœ°å€çš„é¡ºåº, çº¿æ€§åœ°æœç´¢å‡ºå¼•ç”¨ç±»å‹, æŠŠæ—§å€¼æ”¹ä¸ºæ–°å€¼å³å¯.")]),s._v(" "),t("li",[t("strong",[s._v("æœ€ç»ˆå¼•ç”¨æ›´æ–°")]),s._v(": è§£å†³äº†å †ä¸­çš„å¼•ç”¨æ›´æ–°å, è¿˜è¦ä¿®æ­£å­˜åœ¨äº GC Roots ä¸­çš„å¼•ç”¨. è¿™ä¸ªé˜¶æ®µæ˜¯ Shenandoah çš„æœ€åä¸€æ¬¡åœé¡¿, åœé¡¿æ—¶é—´åªä¸ GC Roots çš„æ•°é‡ç›¸å…³.")]),s._v(" "),t("li",[t("strong",[s._v("å¹¶å‘æ¸…ç†")]),s._v(": ç»è¿‡å¹¶å‘å›æ”¶å’Œå¼•ç”¨æ›´æ–°ä¹‹å, æ•´ä¸ªå›æ”¶é›†ä¸­æ‰€æœ‰çš„ Region å·²å†æ— å­˜æ´»å¯¹è±¡, è¿™äº› Region éƒ½å˜æˆ Immediate Garbage Regions äº†, æœ€åå†è°ƒç”¨ä¸€æ¬¡å¹¶å‘æ¸…ç†è¿‡ç¨‹æ¥å›æ”¶è¿™äº› Region çš„å†…å­˜ç©ºé—´, ä¾›ä»¥åæ–°å¯¹è±¡åˆ†é…ä½¿ç”¨.")])]),s._v(" "),t("p",[s._v("ä»¥ä¸Šå¯¹ Shenandoah æ”¶é›†å™¨è¿™ä¹ä¸ªé˜¶æ®µçš„å·¥ä½œè¿‡ç¨‹çš„æè¿°å¯èƒ½æ‹†åˆ†å¾—ç•¥ä¸ºçç¢, åªè¦æŠ“ä½å…¶ä¸­"),t("strong",[s._v("ä¸‰ä¸ªæœ€é‡è¦")]),s._v("çš„å¹¶å‘é˜¶æ®µ("),t("strong",[s._v("å¹¶å‘æ ‡è®°, å¹¶å‘å›æ”¶, å¹¶å‘å¼•ç”¨æ›´æ–°")]),s._v("), å°±èƒ½æ¯”è¾ƒå®¹æ˜“ç†æ¸… Shenandoah æ˜¯å¦‚ä½•è¿ä½œçš„äº†. ä¸‹å›¾ä¸­é»„è‰²çš„åŒºåŸŸä»£è¡¨çš„æ˜¯è¢«é€‰å…¥å›æ”¶é›†çš„ Region, ç»¿è‰²éƒ¨åˆ†å°±ä»£è¡¨è¿˜å­˜æ´»çš„å¯¹è±¡, è“è‰²å°±æ˜¯ç”¨æˆ·çº¿ç¨‹å¯ä»¥ç”¨æ¥åˆ†é…å¯¹è±¡çš„å†…å­˜ Region äº†. å›¾ä¸­ä¸ä»…å±•ç¤ºäº† Shenandoah ä¸‰ä¸ªå¹¶å‘é˜¶æ®µçš„å·¥ä½œè¿‡ç¨‹, è¿˜èƒ½å½¢è±¡åœ°è¡¨ç¤ºå‡ºå¹¶å‘æ ‡è®°é˜¶æ®µå¦‚ä½•æ‰¾å‡ºå›æ”¶å¯¹è±¡ç¡®å®šå›æ”¶é›†, å¹¶å‘å›æ”¶é˜¶æ®µå¦‚ä½•ç§»åŠ¨å›æ”¶é›†ä¸­çš„å­˜æ´»å¯¹è±¡, å¹¶å‘å¼•ç”¨æ›´æ–°é˜¶æ®µå¦‚ä½•å°†æŒ‡å‘å›æ”¶é›†ä¸­å­˜æ´»å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨å…¨éƒ¨ä¿®æ­£, æ­¤åå›æ”¶é›†ä¾¿ä¸å­˜åœ¨ä»»ä½•å¼•ç”¨å¯è¾¾çš„å­˜æ´»å¯¹è±¡äº†.")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00038-20240302133505-8xbb7b4.jpg",alt:"",title:"Shenandoah æ”¶é›†å™¨çš„å·¥ä½œè¿‡ç¨‹"}})]),s._v(" "),t("h5",{attrs:{id:"_2-zgcæ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-zgcæ”¶é›†å™¨"}},[s._v("#")]),s._v(" 2.ZGCæ”¶é›†å™¨")]),s._v(" "),t("h6",{attrs:{id:"_1-åŸºç¡€-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-åŸºç¡€-3"}},[s._v("#")]),s._v(" (1)åŸºç¡€")]),s._v(" "),t("p",[s._v('ZGC("Z" å¹¶éä»€ä¹ˆä¸“ä¸šåè¯çš„ç¼©å†™, è¿™æ¬¾æ”¶é›†å™¨çš„åå­—å°±å«ä½œ Z Garbage Collector)æ˜¯ä¸€æ¬¾åœ¨ JDK 11 ä¸­æ–°åŠ å…¥çš„å…·æœ‰å®éªŒæ€§è´¨çš„ä½å»¶è¿Ÿåƒåœ¾æ”¶é›†å™¨, æ˜¯ç”± Oracle å…¬å¸ç ”å‘çš„. 2018 å¹´ Oracle åˆ›å»ºäº† JEP 333 å°† ZGC æäº¤ç»™ OpenJDK, æ¨åŠ¨å…¶è¿›å…¥ OpenJDK 11 çš„å‘å¸ƒæ¸…å•ä¹‹ä¸­.')]),s._v(" "),t("p",[s._v("ZGC å’Œ Shenandoah çš„ç›®æ ‡æ˜¯é«˜åº¦ç›¸ä¼¼çš„, éƒ½å¸Œæœ›åœ¨å°½å¯èƒ½"),t("strong",[s._v("å¯¹ååé‡å½±å“ä¸å¤ªå¤§")]),s._v("çš„å‰æä¸‹, å®ç°åœ¨"),t("strong",[s._v("ä»»æ„å †å†…å­˜å¤§å°")]),s._v("ä¸‹éƒ½å¯ä»¥æŠŠåƒåœ¾æ”¶é›†çš„åœé¡¿æ—¶é—´é™åˆ¶åœ¨"),t("strong",[s._v("åæ¯«ç§’ä»¥å†…")]),s._v("çš„ä½å»¶è¿Ÿ. è¿™é‡Œç»™ ZGC ä¸‹ä¸€ä¸ªè¿™æ ·çš„å®šä¹‰æ¥æ¦‚æ‹¬å®ƒçš„ä¸»è¦ç‰¹å¾: "),t("mark",[t("strong",[s._v("ZGC æ”¶é›†å™¨æ˜¯ä¸€æ¬¾åŸºäº Region å†…å­˜å¸ƒå±€çš„, (æš‚æ—¶)ä¸è®¾åˆ†ä»£çš„, ä½¿ç”¨äº†è¯»å±éšœ, æŸ“è‰²æŒ‡é’ˆå’Œå†…å­˜å¤šé‡æ˜ å°„ç­‰æŠ€æœ¯æ¥å®ç°å¯å¹¶å‘çš„æ ‡è®°-æ•´ç†ç®—æ³•çš„, ä»¥ä½å»¶è¿Ÿä¸ºé¦–è¦ç›®æ ‡çš„ä¸€æ¬¾åƒåœ¾æ”¶é›†å™¨")])]),s._v(". æ¥ä¸‹æ¥å°†é€é¡¹æ¥ä»‹ç» ZGC çš„è¿™äº›æŠ€æœ¯ç‰¹ç‚¹.")]),s._v(" "),t("p",[s._v("ZGC çš„ç›®æ ‡ä¸»è¦æœ‰:")]),s._v(" "),t("ul",[t("li",[s._v("æ”¯æŒ TB é‡çº§çš„å †.")]),s._v(" "),t("li",[s._v("GC åœé¡¿æ—¶é—´æä½, å¯ä»¥ä½è‡³ 10ms é‡çº§.")]),s._v(" "),t("li",[t("strong",[s._v("GC åœé¡¿æ—¶é—´ä¸ä¼šéšå†…å­˜ç©ºé—´å¢å¤§è€Œå¢å¤§")]),s._v(". è¿™ä¸ªæ˜¯å¾ˆçŒ›çš„ç‰¹æ€§.")])]),s._v(" "),t("h6",{attrs:{id:"_2-zgcçš„regionä¸å†…å­˜å¸ƒå±€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-zgcçš„regionä¸å†…å­˜å¸ƒå±€"}},[s._v("#")]),s._v(" (2)ZGCçš„Regionä¸å†…å­˜å¸ƒå±€")]),s._v(" "),t("p",[s._v("é¦–å…ˆä» ZGC çš„"),t("strong",[s._v("å†…å­˜å¸ƒå±€")]),s._v("è¯´èµ·. ä¸ Shenandoah å’Œ G1 ä¸€æ ·, ZGC ä¹Ÿé‡‡ç”¨"),t("strong",[s._v("åŸºäº Region çš„å †å†…å­˜å¸ƒå±€")]),s._v(", ä½†ä¸å®ƒä»¬ä¸åŒçš„æ˜¯, ZGC çš„ Region(åœ¨ä¸€äº›å®˜æ–¹èµ„æ–™ä¸­å°†å®ƒç§°ä¸º Page æˆ–è€… "),t("strong",[s._v("ZPage")]),s._v(", æœ¬ç« ä¸ºè¡Œæ–‡ä¸€è‡´ç»§ç»­ç§°ä¸º Region)å…·æœ‰**åŠ¨æ€æ€§--**â€‹"),t("mark",[t("strong",[s._v("åŠ¨æ€åˆ›å»ºå’Œé”€æ¯, ä»¥åŠåŠ¨æ€çš„åŒºåŸŸå®¹é‡å¤§å°")])]),s._v(". åœ¨ x64 ç¡¬ä»¶å¹³å°ä¸‹, ZGC çš„ Region å¯ä»¥å…·æœ‰å¦‚å›¾ 3-19 æ‰€ç¤ºçš„å¤§, ä¸­, å°ä¸‰ç±»å®¹é‡:")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("å°å‹ Region(Small Region)")]),s._v(" : å®¹é‡å›ºå®šä¸º 2MB, ç”¨äºæ”¾ç½®å°äº 256KB çš„å°å¯¹è±¡.")]),s._v(" "),t("li",[t("strong",[s._v("ä¸­å‹ Region(Medium Region)")]),s._v(" : å®¹é‡å›ºå®šä¸º 32MB, ç”¨äºæ”¾ç½®å¤§äºç­‰äº 256KB ä½†å°äº 4MB çš„å¯¹è±¡.")]),s._v(" "),t("li",[t("strong",[s._v("å¤§å‹ Region(Large Region)")]),s._v(" : å®¹é‡ä¸å›ºå®š, å¯ä»¥"),t("strong",[s._v("åŠ¨æ€å˜åŒ–")]),s._v(", ä½†å¿…é¡»ä¸º 2MB çš„æ•´æ•°å€, ç”¨äºæ”¾ç½® 4MB æˆ–ä»¥ä¸Šçš„å¤§å¯¹è±¡. æ¯ä¸ªå¤§å‹ Region ä¸­åªä¼š"),t("strong",[s._v("å­˜æ”¾ä¸€ä¸ªå¤§å¯¹è±¡")]),s._v(', è¿™ä¹Ÿé¢„ç¤ºç€è™½ç„¶åå­—å«ä½œ "å¤§å‹ Region", ä½†å®ƒçš„å®é™…å®¹é‡å®Œå…¨æœ‰å¯èƒ½å°äºä¸­å‹ Region, æœ€å°å®¹é‡å¯ä½è‡³ 4MB. å¤§å‹ Region åœ¨ ZGC çš„å®ç°ä¸­æ˜¯'),t("strong",[s._v("ä¸ä¼šè¢«é‡åˆ†é…")]),s._v("(é‡åˆ†é…æ˜¯ ZGC çš„ä¸€ç§å¤„ç†åŠ¨ä½œ, ç”¨äºå¤åˆ¶å¯¹è±¡çš„æ”¶é›†å™¨é˜¶æ®µ, ç¨åä¼šä»‹ç»åˆ°)çš„, å› ä¸ºå¤åˆ¶ä¸€ä¸ªå¤§å¯¹è±¡çš„ä»£ä»·éå¸¸é«˜æ˜‚.")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20230401144145-pz9ey01.png",alt:"image",title:"ZGC çš„å †å†…å­˜å¸ƒå±€"}})]),s._v(" "),t("p",[t("strong",[s._v("ZGC æ²¡æœ‰åˆ†ä»£")]),s._v('. ä¹‹å‰çš„åƒåœ¾å›æ”¶å™¨ä¹‹æ‰€ä»¥åˆ†ä»£, æ˜¯æºäº "å¤§éƒ¨åˆ†å¯¹è±¡æœç”Ÿå¤•æ­»" çš„å‡è®¾, äº‹å®ä¸Šå¤§éƒ¨åˆ†ç³»ç»Ÿçš„å¯¹è±¡åˆ†é…è¡Œä¸ºä¹Ÿç¡®å®ç¬¦åˆè¿™ä¸ªå‡è®¾. '),t("strong",[s._v("ä¸åŒå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸ä¸€è‡´çš„")]),s._v(", æ‰€ä»¥æ‰æœ‰äº†åˆ†ä»£çš„å¤„ç†æ–¹å¼.")]),s._v(" "),t("p",[s._v("ä¸ºä»€ä¹ˆ ZGC ä¸åˆ†ä»£? å› ä¸ºåˆ†ä»£å®ç°èµ·æ¥éº»çƒ¦, ä½œè€…å°±å…ˆå®ç°å‡ºä¸€ä¸ªæ¯”è¾ƒç®€å•å¯ç”¨çš„å•ä»£ç‰ˆæœ¬, åç»­ä¼šä¼˜åŒ–.")]),s._v(" "),t("h6",{attrs:{id:"_3-zgcå¹¶å‘æ•´ç†ç®—æ³•å®ç°ä¸æŸ“è‰²æŒ‡é’ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-zgcå¹¶å‘æ•´ç†ç®—æ³•å®ç°ä¸æŸ“è‰²æŒ‡é’ˆ"}},[s._v("#")]),s._v(" (3)ZGCå¹¶å‘æ•´ç†ç®—æ³•å®ç°ä¸æŸ“è‰²æŒ‡é’ˆ")]),s._v(" "),t("p",[s._v("æ¥ä¸‹æ¥æ˜¯ ZGC çš„æ ¸å¿ƒé—®é¢˜, å³"),t("strong",[s._v("å¹¶å‘æ•´ç†ç®—æ³•")]),s._v("çš„å®ç°. Shenandoah ä½¿ç”¨è½¬å‘æŒ‡é’ˆå’Œè¯»å±éšœæ¥å®ç°å¹¶å‘æ•´ç†, ZGC è™½ç„¶åŒæ ·ç”¨åˆ°äº†è¯»å±éšœ, ä½†ç”¨çš„å´æ˜¯ä¸€æ¡ä¸ Shenandoah å®Œå…¨ä¸åŒ, æ›´åŠ å¤æ‚ç²¾å·§çš„è§£é¢˜æ€è·¯.")]),s._v(" "),t("p",[s._v("ZGC æ”¶é›†å™¨æœ‰ä¸€ä¸ªæ ‡å¿—æ€§çš„è®¾è®¡æ˜¯å®ƒé‡‡ç”¨çš„"),t("mark",[t("strong",[s._v("æŸ“è‰²æŒ‡é’ˆæŠ€æœ¯")])]),s._v('(Colored Pointer, å…¶ä»–ç±»ä¼¼çš„æŠ€æœ¯ä¸­å¯èƒ½å°†å®ƒç§°ä¸º Tag Pointer æˆ–è€… Version Pointer). ä»å‰, å¦‚æœè¦åœ¨å¯¹è±¡ä¸Šå­˜å‚¨ä¸€äº›é¢å¤–çš„, åªä¾›æ”¶é›†å™¨æˆ–è€…è™šæ‹Ÿæœºæœ¬èº«ä½¿ç”¨çš„æ•°æ®, é€šå¸¸ä¼šåœ¨å¯¹è±¡å¤´ä¸­å¢åŠ é¢å¤–çš„å­˜å‚¨å­—æ®µ(å‚è€ƒ:å¯¹è±¡å¤´), å¦‚å¯¹è±¡çš„å“ˆå¸Œç , åˆ†ä»£å¹´é¾„, é”è®°å½•ç­‰å°±æ˜¯è¿™æ ·å­˜å‚¨çš„. è¿™ç§è®°å½•æ–¹å¼åœ¨æœ‰å¯¹è±¡è®¿é—®çš„åœºæ™¯ä¸‹æ˜¯å¾ˆè‡ªç„¶æµç•…çš„, ä¸ä¼šæœ‰ä»€ä¹ˆé¢å¤–è´Ÿæ‹…. ä½†å¦‚æœå¯¹è±¡å­˜åœ¨è¢«ç§»åŠ¨è¿‡çš„å¯èƒ½æ€§, å³ä¸èƒ½ä¿è¯å¯¹è±¡è®¿é—®èƒ½å¤ŸæˆåŠŸå‘¢? åˆæˆ–è€…æœ‰ä¸€äº›æ ¹æœ¬å°±ä¸ä¼šå»è®¿é—®å¯¹è±¡, ä½†åˆå¸Œæœ›å¾—çŸ¥è¯¥å¯¹è±¡çš„æŸäº›ä¿¡æ¯çš„åº”ç”¨åœºæ™¯å‘¢? èƒ½ä¸èƒ½ä»æŒ‡é’ˆæˆ–è€…ä¸å¯¹è±¡å†…å­˜æ— å…³çš„åœ°æ–¹å¾—åˆ°è¿™äº›ä¿¡æ¯, è­¬å¦‚æ˜¯å¦èƒ½å¤Ÿçœ‹å‡ºæ¥å¯¹è±¡è¢«ç§»åŠ¨è¿‡? è¿™æ ·çš„è¦æ±‚å¹¶éä¸åˆç†çš„åˆéš¾, å…ˆä¸å»è¯´å¹¶å‘ç§»åŠ¨å¯¹è±¡å¯èƒ½å¸¦æ¥çš„å¯è®¿é—®æ€§é—®é¢˜, æ­¤å‰å°±é‡åˆ°è¿‡è¿™æ ·çš„è¦æ±‚, å³è¿½è¸ªå¼æ”¶é›†ç®—æ³•çš„æ ‡è®°é˜¶æ®µå°±å¯èƒ½å­˜åœ¨åªè·ŸæŒ‡é’ˆæ‰“äº¤é“è€Œä¸å¿…æ¶‰åŠæŒ‡é’ˆæ‰€å¼•ç”¨çš„å¯¹è±¡æœ¬èº«çš„åœºæ™¯. ä¾‹å¦‚å¯¹è±¡æ ‡è®°çš„è¿‡ç¨‹ä¸­éœ€è¦ç»™å¯¹è±¡æ‰“ä¸Šä¸‰è‰²æ ‡è®°, è¿™äº›æ ‡è®°æœ¬è´¨ä¸Šå°±åªå’Œå¯¹è±¡çš„å¼•ç”¨æœ‰å…³, è€Œä¸å¯¹è±¡æœ¬èº«æ— å…³, æŸä¸ªå¯¹è±¡åªæœ‰å®ƒçš„å¼•ç”¨å…³ç³»èƒ½å†³å®šå®ƒå­˜æ´»ä¸å¦, å¯¹è±¡ä¸Šå…¶ä»–æ‰€æœ‰çš„å±æ€§éƒ½ä¸èƒ½å¤Ÿå½±å“å®ƒçš„å­˜æ´»åˆ¤å®šç»“æœ. HotSpot è™šæ‹Ÿæœºçš„å‡ ç§æ”¶é›†å™¨æœ‰ä¸åŒçš„æ ‡è®°å®ç°æ–¹æ¡ˆ, æœ‰çš„æŠŠæ ‡è®°ç›´æ¥è®°å½•åœ¨å¯¹è±¡å¤´ä¸Š(å¦‚ Serial æ”¶é›†å™¨), æœ‰çš„æŠŠæ ‡è®°è®°å½•åœ¨ä¸å¯¹è±¡ç›¸äº’ç‹¬ç«‹çš„æ•°æ®ç»“æ„ä¸Š(å¦‚ G1, Shenandoah ä½¿ç”¨äº†ä¸€ç§ç›¸å½“äºå †å†…å­˜çš„ 1/64 å¤§å°çš„, ç§°ä¸º BitMap çš„ç»“æ„æ¥è®°å½•æ ‡è®°ä¿¡æ¯), è€Œ ZGC çš„æŸ“è‰²æŒ‡é’ˆæ˜¯æœ€ç›´æ¥çš„, æœ€çº¯ç²¹çš„, å®ƒç›´æ¥æŠŠæ ‡è®°ä¿¡æ¯è®°åœ¨å¼•ç”¨å¯¹è±¡çš„æŒ‡é’ˆä¸Š, è¿™æ—¶, ä¸å…¶è¯´å¯è¾¾æ€§åˆ†ææ˜¯éå†å¯¹è±¡å›¾æ¥æ ‡è®°å¯¹è±¡, è¿˜ä¸å¦‚è¯´æ˜¯éå† "å¼•ç”¨å›¾" æ¥æ ‡è®° "å¼•ç”¨" äº†.')]),s._v(" "),t("p",[t("strong",[s._v("æŸ“è‰²æŒ‡é’ˆæ˜¯ä¸€ç§ç›´æ¥å°†å°‘é‡é¢å¤–çš„ä¿¡æ¯å­˜å‚¨åœ¨æŒ‡é’ˆä¸Šçš„æŠ€æœ¯, ä»¥å‰çš„åƒåœ¾å›æ”¶å™¨çš„ GC ä¿¡æ¯éƒ½ä¿å­˜åœ¨å¯¹è±¡å¤´ä¸­, è€Œ ZGC çš„ GC ä¿¡æ¯ä¿å­˜åœ¨æŒ‡é’ˆä¸­")]),s._v(". å¯æ˜¯ä¸ºä»€ä¹ˆæŒ‡é’ˆæœ¬èº«ä¹Ÿå¯ä»¥å­˜å‚¨é¢å¤–ä¿¡æ¯å‘¢? åœ¨ 64 ä½ç³»ç»Ÿä¸­, ç†è®ºå¯ä»¥è®¿é—®çš„å†…å­˜é«˜è¾¾ 16EB(2 çš„ 64 æ¬¡å¹‚)å­—èŠ‚. å®é™…ä¸Š, åŸºäºéœ€æ±‚(ç”¨ä¸åˆ°é‚£ä¹ˆå¤šå†…å­˜), æ€§èƒ½(åœ°å€è¶Šå®½åœ¨åšåœ°å€è½¬æ¢æ—¶éœ€è¦çš„é¡µè¡¨çº§æ•°è¶Šå¤š)å’Œæˆæœ¬(æ¶ˆè€—æ›´å¤šæ™¶ä½“ç®¡)çš„è€ƒè™‘, åœ¨ AMD64 æ¶æ„ä¸­åªæ”¯æŒåˆ° 52 ä½(4PB)çš„åœ°å€æ€»çº¿å’Œ 48 ä½(256TB)çš„è™šæ‹Ÿåœ°å€ç©ºé—´, æ‰€ä»¥ç›®å‰ 64 ä½çš„ç¡¬ä»¶å®é™…èƒ½å¤Ÿæ”¯æŒçš„æœ€å¤§å†…å­˜åªæœ‰ 256TB. æ­¤å¤–, æ“ä½œç³»ç»Ÿä¸€ä¾§ä¹Ÿè¿˜ä¼šæ–½åŠ è‡ªå·±çš„çº¦æŸ, 64 ä½çš„ Linux åˆ™åˆ†åˆ«æ”¯æŒ 47 ä½(128TB)çš„è¿›ç¨‹è™šæ‹Ÿåœ°å€ç©ºé—´å’Œ 46 ä½(64TB)çš„ç‰©ç†åœ°å€ç©ºé—´, 64 ä½çš„ Windows ç³»ç»Ÿç”šè‡³åªæ”¯æŒ 44 ä½(16TB)çš„ç‰©ç†åœ°å€ç©ºé—´. å°½ç®¡ Linux ä¸‹ 64 ä½æŒ‡é’ˆçš„é«˜ 18 ä½ä¸èƒ½ç”¨æ¥å¯»å€, ä½†å‰©ä½™çš„ 46 ä½æŒ‡é’ˆæ‰€èƒ½æ”¯æŒçš„ 64TB å†…å­˜åœ¨ä»Šå¤©ä»ç„¶èƒ½å¤Ÿå……åˆ†æ»¡è¶³å¤§å‹æœåŠ¡å™¨çš„éœ€è¦. é‰´äºæ­¤, ZGC çš„æŸ“è‰²æŒ‡é’ˆæŠ€æœ¯ç»§ç»­ç›¯ä¸Šäº†è¿™å‰©ä¸‹çš„ 46 ä½æŒ‡é’ˆå®½åº¦, å°†å…¶é«˜ 4 ä½æå–å‡ºæ¥å­˜å‚¨å››ä¸ªæ ‡å¿—ä¿¡æ¯. "),t("strong",[s._v("é€šè¿‡è¿™äº›æ ‡å¿—ä½, è™šæ‹Ÿæœºå¯ä»¥ç›´æ¥ä»æŒ‡é’ˆä¸­çœ‹åˆ°å…¶å¼•ç”¨å¯¹è±¡çš„ä¸‰è‰²æ ‡è®°çŠ¶æ€, æ˜¯å¦è¿›å…¥äº†é‡åˆ†é…é›†(å³è¢«ç§»åŠ¨è¿‡), æ˜¯å¦åªèƒ½é€šè¿‡ finalize() æ–¹æ³•æ‰èƒ½è¢«è®¿é—®åˆ°")]),s._v(", å¦‚ä¸‹å›¾æ‰€ç¤º. å½“ç„¶, ç”±äºè¿™äº›æ ‡å¿—ä½è¿›ä¸€æ­¥å‹ç¼©äº†åŸæœ¬å°±åªæœ‰ 46 ä½çš„åœ°å€ç©ºé—´, ä¹Ÿç›´æ¥å¯¼è‡´ ZGC èƒ½å¤Ÿç®¡ç†çš„å†…å­˜ä¸å¯ä»¥è¶…è¿‡ 4TB(2 çš„ 42 æ¬¡å¹‚).")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20230401144421-3vmomk0.png",alt:"image",title:"æŸ“è‰²æŒ‡é’ˆç¤ºæ„"}})]),s._v(" "),t("p",[s._v("ä¸ºä»€ä¹ˆæœ‰ 2 ä¸ª mark æ ‡è®°?")]),s._v(" "),t("p",[s._v("æ¯ä¸€ä¸ª GC å‘¨æœŸå¼€å§‹æ—¶, ä¼šäº¤æ¢ä½¿ç”¨çš„æ ‡è®°ä½, ä½¿ä¸Šæ¬¡ GC å‘¨æœŸä¸­ä¿®æ­£çš„å·²æ ‡è®°çŠ¶æ€å¤±æ•ˆ, æ‰€æœ‰å¼•ç”¨éƒ½å˜æˆæœªæ ‡è®°.")]),s._v(" "),t("ul",[t("li",[s._v("GC å‘¨æœŸ 1: ä½¿ç”¨ mark0, åˆ™å‘¨æœŸç»“æŸæ‰€æœ‰å¼•ç”¨ mark æ ‡è®°éƒ½ä¼šæˆä¸º 01.")]),s._v(" "),t("li",[s._v("GC å‘¨æœŸ 2: ä½¿ç”¨ mark1, åˆ™æœŸå¾…çš„ mark æ ‡è®° 10, æ‰€æœ‰å¼•ç”¨éƒ½èƒ½è¢«é‡æ–°æ ‡è®°.")])]),s._v(" "),t("p",[s._v("è™½ç„¶æŸ“è‰²æŒ‡é’ˆæœ‰ 4TB çš„å†…å­˜é™åˆ¶, ä¸èƒ½æ”¯æŒ 32 ä½å¹³å°, ä¸èƒ½æ”¯æŒå‹ç¼©æŒ‡é’ˆ("),t("code",[s._v("-XX: +UseCompressedOops")]),s._v('â€‹)ç­‰è¯¸å¤šçº¦æŸ, ä½†å®ƒå¸¦æ¥çš„æ”¶ç›Šä¹Ÿæ˜¯éå¸¸å¯è§‚çš„, åœ¨ JEP 333 çš„æè¿°é¡µä¸­, ZGC çš„è®¾è®¡è€… Per Liden åœ¨ "æè¿°" å°èŠ‚é‡Œé™ˆè¿°äº†'),t("mark",[t("strong",[s._v("æŸ“è‰²æŒ‡é’ˆçš„ä¸‰å¤§ä¼˜åŠ¿")])]),s._v(":")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("æŸ“è‰²æŒ‡é’ˆå¯ä»¥ä½¿å¾—ä¸€æ—¦æŸä¸ª Region çš„å­˜æ´»å¯¹è±¡è¢«ç§»èµ°ä¹‹å, è¿™ä¸ª Region ç«‹å³å°±èƒ½å¤Ÿè¢«é‡Šæ”¾å’Œé‡ç”¨æ‰, è€Œä¸å¿…ç­‰å¾…æ•´ä¸ªå †ä¸­æ‰€æœ‰æŒ‡å‘è¯¥ Region çš„å¼•ç”¨éƒ½è¢«ä¿®æ­£åæ‰èƒ½æ¸…ç†")]),s._v('. è¿™ç‚¹ç›¸æ¯”èµ· Shenandoah æ˜¯ä¸€ä¸ªé¢‡å¤§çš„ä¼˜åŠ¿, ä½¿å¾—ç†è®ºä¸Šåªè¦è¿˜æœ‰ä¸€ä¸ªç©ºé—² Region, ZGC å°±èƒ½å®Œæˆæ”¶é›†, è€Œ Shenandoah éœ€è¦ç­‰åˆ°å¼•ç”¨æ›´æ–°é˜¶æ®µç»“æŸä»¥åæ‰èƒ½é‡Šæ”¾å›æ”¶é›†ä¸­çš„ Region, è¿™æ„å‘³ç€å †ä¸­å‡ ä¹æ‰€æœ‰å¯¹è±¡éƒ½å­˜æ´»çš„æç«¯æƒ…å†µ, éœ€è¦ 1âˆ¶1 å¤åˆ¶å¯¹è±¡åˆ°æ–° Region çš„è¯, å°±å¿…é¡»è¦æœ‰ä¸€åŠçš„ç©ºé—² Region æ¥å®Œæˆæ”¶é›†. è‡³äºä¸ºä»€ä¹ˆæŸ“è‰²æŒ‡é’ˆèƒ½å¤Ÿå¯¼è‡´è¿™æ ·çš„ç»“æœ, ç¬”è€…å°†åœ¨åç»­è§£é‡Šå…¶ "è‡ªæ„ˆ" ç‰¹æ€§çš„æ—¶å€™è¿›è¡Œè§£é‡Š.')]),s._v(" "),t("li",[t("strong",[s._v("æŸ“è‰²æŒ‡é’ˆå¯ä»¥å¤§å¹…å‡å°‘åœ¨åƒåœ¾æ”¶é›†è¿‡ç¨‹ä¸­å†…å­˜å±éšœçš„ä½¿ç”¨æ•°é‡, è®¾ç½®å†…å­˜å±éšœ, å°¤å…¶æ˜¯å†™å±éšœçš„ç›®çš„é€šå¸¸æ˜¯ä¸ºäº†è®°å½•å¯¹è±¡å¼•ç”¨çš„å˜åŠ¨æƒ…å†µ, å¦‚æœå°†è¿™äº›ä¿¡æ¯ç›´æ¥ç»´æŠ¤åœ¨æŒ‡é’ˆä¸­, æ˜¾ç„¶å°±å¯ä»¥çœå»ä¸€äº›ä¸“é—¨çš„è®°å½•æ“ä½œ")]),s._v(". å®é™…ä¸Š, åˆ°ç›®å‰ä¸ºæ­¢ ZGC éƒ½å¹¶æœªä½¿ç”¨ä»»ä½•å†™å±éšœ, åªä½¿ç”¨äº†è¯»å±éšœ(ä¸€éƒ¨åˆ†æ˜¯æŸ“è‰²æŒ‡é’ˆçš„åŠŸåŠ³, ä¸€éƒ¨åˆ†æ˜¯ ZGC ç°åœ¨è¿˜ä¸æ”¯æŒåˆ†ä»£æ”¶é›†, å¤©ç„¶å°±æ²¡æœ‰è·¨ä»£å¼•ç”¨çš„é—®é¢˜). å†…å­˜å±éšœå¯¹ç¨‹åºè¿è¡Œæ—¶æ€§èƒ½çš„æŸè€—åœ¨å‰é¢ç« èŠ‚ä¸­å·²ç»è®²è§£è¿‡, èƒ½å¤Ÿçœå»ä¸€éƒ¨åˆ†çš„å†…å­˜å±éšœ, æ˜¾ç„¶å¯¹ç¨‹åºè¿è¡Œæ•ˆç‡æ˜¯å¤§æœ‰è£¨ç›Šçš„, æ‰€ä»¥ ZGC å¯¹ååé‡çš„å½±å“ä¹Ÿç›¸å¯¹è¾ƒä½.")]),s._v(" "),t("li",[t("strong",[s._v("æŸ“è‰²æŒ‡é’ˆå¯ä»¥ä½œä¸ºä¸€ç§å¯æ‰©å±•çš„å­˜å‚¨ç»“æ„ç”¨æ¥è®°å½•æ›´å¤šä¸å¯¹è±¡æ ‡è®°, é‡å®šä½è¿‡ç¨‹ç›¸å…³çš„æ•°æ®, ä»¥ä¾¿æ—¥åè¿›ä¸€æ­¥æé«˜æ€§èƒ½")]),s._v(". ç°åœ¨ Linux ä¸‹çš„ 64 ä½æŒ‡é’ˆè¿˜æœ‰å‰ 18 ä½å¹¶æœªä½¿ç”¨, å®ƒä»¬è™½ç„¶ä¸èƒ½ç”¨æ¥å¯»å€, å´å¯ä»¥é€šè¿‡å…¶ä»–æ‰‹æ®µç”¨äºä¿¡æ¯è®°å½•. å¦‚æœå¼€å‘äº†è¿™ 18 ä½, æ—¢å¯ä»¥è…¾å‡ºå·²ç”¨çš„ 4 ä¸ªæ ‡å¿—ä½, å°† ZGC å¯æ”¯æŒçš„æœ€å¤§å †å†…å­˜ä» 4TB æ‹“å±•åˆ° 64TB, ä¹Ÿå¯ä»¥åˆ©ç”¨å…¶ä½™ä½ç½®å†å­˜å‚¨æ›´å¤šçš„æ ‡å¿—, è­¬å¦‚å­˜å‚¨ä¸€äº›è¿½è¸ªä¿¡æ¯æ¥è®©åƒåœ¾æ”¶é›†å™¨åœ¨ç§»åŠ¨å¯¹è±¡æ—¶èƒ½å°†ä½é¢‘æ¬¡ä½¿ç”¨çš„å¯¹è±¡ç§»åŠ¨åˆ°ä¸å¸¸è®¿é—®çš„å†…å­˜åŒºåŸŸ.")])]),s._v(" "),t("p",[s._v("ä¸è¿‡, è¦é¡ºåˆ©"),t("strong",[s._v("åº”ç”¨æŸ“è‰²æŒ‡é’ˆæœ‰ä¸€ä¸ªå¿…é¡»è§£å†³çš„å‰ç½®é—®é¢˜")]),s._v(": Java è™šæ‹Ÿæœºä½œä¸ºä¸€ä¸ªæ™®æ™®é€šé€šçš„è¿›ç¨‹, è¿™æ ·éšæ„é‡æ–°å®šä¹‰å†…å­˜ä¸­æŸäº›æŒ‡é’ˆçš„å…¶ä¸­å‡ ä½, æ“ä½œç³»ç»Ÿæ˜¯å¦æ”¯æŒ? å¤„ç†å™¨æ˜¯å¦æ”¯æŒ? è¿™æ˜¯å¾ˆç°å®çš„é—®é¢˜, æ— è®ºä¸­é—´è¿‡ç¨‹å¦‚ä½•, ç¨‹åºä»£ç æœ€ç»ˆéƒ½è¦è½¬æ¢ä¸ºæœºå™¨æŒ‡ä»¤æµäº¤ä»˜ç»™å¤„ç†å™¨å»æ‰§è¡Œ, å¤„ç†å™¨å¯ä¸ä¼šç®¡æŒ‡ä»¤æµä¸­çš„æŒ‡é’ˆå“ªéƒ¨åˆ†å­˜çš„æ˜¯æ ‡å¿—ä½, å“ªéƒ¨åˆ†æ‰æ˜¯çœŸæ­£çš„å¯»å€åœ°å€, åªä¼šæŠŠæ•´ä¸ªæŒ‡é’ˆéƒ½è§†ä½œä¸€ä¸ªå†…å­˜åœ°å€æ¥å¯¹å¾…. è¿™é‡Œé¢çš„è§£å†³æ–¹æ¡ˆè¦æ¶‰åŠ"),t("strong",[s._v("è™šæ‹Ÿå†…å­˜æ˜ å°„æŠ€æœ¯")]),s._v(", å…ˆæ¥å¤ä¹ ä¸€ä¸‹è¿™ä¸ª x86 è®¡ç®—æœºä½“ç³»ä¸­çš„ç»å…¸è®¾è®¡.")]),s._v(" "),t("p",[s._v('åœ¨è¿œå¤æ—¶ä»£çš„ x86 è®¡ç®—æœºç³»ç»Ÿé‡Œé¢, æ‰€æœ‰è¿›ç¨‹éƒ½æ˜¯å…±ç”¨åŒä¸€å—ç‰©ç†å†…å­˜ç©ºé—´çš„, è¿™æ ·ä¼šå¯¼è‡´ä¸åŒè¿›ç¨‹ä¹‹é—´çš„å†…å­˜æ— æ³•ç›¸äº’éš”ç¦», å½“ä¸€ä¸ªè¿›ç¨‹æ±¡æŸ“äº†åˆ«çš„è¿›ç¨‹å†…å­˜å, å°±åªèƒ½å¯¹æ•´ä¸ªç³»ç»Ÿè¿›è¡Œå¤ä½åæ‰èƒ½å¾—ä»¥æ¢å¤. ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, ä» Intel 80386 å¤„ç†å™¨å¼€å§‹, æä¾›äº† "ä¿æŠ¤æ¨¡å¼" ç”¨äºéš”ç¦»è¿›ç¨‹. åœ¨ä¿æŠ¤æ¨¡å¼ä¸‹, 386 å¤„ç†å™¨çš„å…¨éƒ¨ 32 æ¡åœ°å€å¯»å€çº¿éƒ½æœ‰æ•ˆ, è¿›ç¨‹å¯è®¿é—®æœ€é«˜ä¹Ÿå¯è¾¾ 4GB çš„å†…å­˜ç©ºé—´, ä½†æ­¤æ—¶å·²ä¸åŒäºä¹‹å‰å®æ¨¡å¼ä¸‹çš„ç‰©ç†å†…å­˜å¯»å€äº†, å¤„ç†å™¨ä¼šä½¿ç”¨'),t("strong",[s._v('åˆ†é¡µç®¡ç†æœºåˆ¶æŠŠçº¿æ€§åœ°å€ç©ºé—´å’Œç‰©ç†åœ°å€ç©ºé—´åˆ†åˆ«åˆ’åˆ†ä¸ºå¤§å°ç›¸åŒçš„å—, è¿™æ ·çš„å†…å­˜å—è¢«ç§°ä¸º "é¡µ"(Page)')]),s._v(" . é€šè¿‡"),t("strong",[s._v("åœ¨çº¿æ€§è™šæ‹Ÿç©ºé—´çš„é¡µä¸ç‰©ç†åœ°å€ç©ºé—´çš„é¡µä¹‹é—´å»ºç«‹çš„æ˜ å°„è¡¨, åˆ†é¡µç®¡ç†æœºåˆ¶ä¼šè¿›è¡Œçº¿æ€§åœ°å€åˆ°ç‰©ç†åœ°å€ç©ºé—´çš„æ˜ å°„, å®Œæˆçº¿æ€§åœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢")]),s._v('. ä¸ºæ–¹ä¾¿ç†è§£, ä¸å¦¨è®¾æƒ³è¿™æ ·ä¸€ä¸ªåœºæ™¯æ¥ç±»æ¯”: å‡å¦‚ä½ è¦å» "ä¸­å±±ä¸€è·¯3å·" è¿™ä¸ªåœ°å€æ‹œè®¿ä¸€ä½æœ‹å‹, æ ¹æ®ä½ æ‰€å¤„åŸå¸‚çš„ä¸åŒ, è­¬å¦‚åœ¨å¹¿å·æˆ–è€…åœ¨ä¸Šæµ·, æ˜¯èƒ½å¤Ÿé€šè¿‡è¿™ä¸ª "ç›¸åŒçš„åœ°å€" å®šä½åˆ°ä¸¤ä¸ªå®Œå…¨ç‹¬ç«‹çš„ç‰©ç†ä½ç½®çš„, è¿™æ—¶'),t("strong",[s._v("åœ°å€ä¸ç‰©ç†ä½ç½®æ˜¯ä¸€å¯¹å¤šå…³ç³»æ˜ å°„")]),s._v(".")]),s._v(" "),t("p",[s._v("ä¸åŒå±‚æ¬¡çš„è™šæ‹Ÿå†…å­˜åˆ°ç‰©ç†å†…å­˜çš„è½¬æ¢å…³ç³»å¯ä»¥åœ¨"),t("strong",[s._v("ç¡¬ä»¶å±‚é¢, æ“ä½œç³»ç»Ÿå±‚é¢æˆ–è€…è½¯ä»¶è¿›ç¨‹å±‚é¢")]),s._v("å®ç°, å¦‚ä½•å®Œæˆåœ°å€è½¬æ¢, æ˜¯ä¸€å¯¹ä¸€, å¤šå¯¹ä¸€è¿˜æ˜¯ä¸€å¯¹å¤šçš„æ˜ å°„, ä¹Ÿå¯ä»¥æ ¹æ®å®é™…éœ€è¦æ¥è®¾è®¡. Linux/x86-64 å¹³å°ä¸Šçš„ "),t("strong",[s._v("ZGC ä½¿ç”¨äº†å¤šé‡æ˜ å°„(Multi-Mapping)å°†å¤šä¸ªä¸åŒçš„è™šæ‹Ÿå†…å­˜åœ°å€æ˜ å°„åˆ°åŒä¸€ä¸ªç‰©ç†å†…å­˜åœ°å€ä¸Š, è¿™æ˜¯ä¸€ç§å¤šå¯¹ä¸€æ˜ å°„, æ„å‘³ç€ ZGC åœ¨è™šæ‹Ÿå†…å­˜ä¸­çœ‹åˆ°çš„åœ°å€ç©ºé—´è¦æ¯”å®é™…çš„å †å†…å­˜å®¹é‡æ¥å¾—æ›´å¤§. æŠŠæŸ“è‰²æŒ‡é’ˆä¸­çš„æ ‡å¿—ä½çœ‹ä½œæ˜¯åœ°å€çš„åˆ†æ®µç¬¦, é‚£åªè¦å°†è¿™äº›ä¸åŒçš„åœ°å€æ®µéƒ½æ˜ å°„åˆ°åŒä¸€ä¸ªç‰©ç†å†…å­˜ç©ºé—´, ç»è¿‡å¤šé‡æ˜ å°„è½¬æ¢å, å°±å¯ä»¥ä½¿ç”¨æŸ“è‰²æŒ‡é’ˆæ­£å¸¸è¿›è¡Œå¯»å€äº†")]),s._v(", æ•ˆæœå¦‚å›¾ 3-21 æ‰€ç¤º.")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00044-20240302133505-bswl4ow.jpg",alt:"",title:"å›¾3-21ã€€å¤šé‡æ˜ å°„ä¸‹çš„å¯»å€"}})]),s._v(" "),t("p",[s._v("åœ¨æŸäº›åœºæ™¯ä¸‹, å¤šé‡æ˜ å°„æŠ€æœ¯ç¡®å®å¯èƒ½ä¼šå¸¦æ¥ä¸€äº›è¯¸å¦‚å¤åˆ¶å¤§å¯¹è±¡æ—¶ä¼šæ›´å®¹æ˜“è¿™æ ·çš„é¢å¤–å¥½å¤„, å¯ä»æ ¹æºä¸Šè®², ZGC çš„å¤šé‡æ˜ å°„åªæ˜¯å®ƒé‡‡ç”¨æŸ“è‰²æŒ‡é’ˆæŠ€æœ¯çš„ä¼´ç”Ÿäº§ç‰©, å¹¶ä¸æ˜¯ä¸“é—¨ä¸ºäº†å®ç°å…¶ä»–æŸç§ç‰¹æ€§éœ€æ±‚è€Œå»åšçš„.")]),s._v(" "),t("h6",{attrs:{id:"_4-zgcåƒåœ¾æ”¶é›†æµç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-zgcåƒåœ¾æ”¶é›†æµç¨‹"}},[s._v("#")]),s._v(" (4)ZGCåƒåœ¾æ”¶é›†æµç¨‹")]),s._v(" "),t("p",[s._v("æ¥ä¸‹æ¥æ¥å­¦ä¹  ZGC æ”¶é›†å™¨æ˜¯å¦‚ä½•å·¥ä½œçš„. ZGC çš„è¿ä½œè¿‡ç¨‹å¤§è‡´å¯åˆ’åˆ†ä¸ºä»¥ä¸‹å››ä¸ªå¤§çš„é˜¶æ®µ. "),t("mark",[t("strong",[s._v("å…¨éƒ¨å››ä¸ªé˜¶æ®µéƒ½æ˜¯å¯ä»¥å¹¶å‘æ‰§è¡Œçš„, ä»…æ˜¯ä¸¤ä¸ªé˜¶æ®µä¸­é—´ä¼šå­˜åœ¨çŸ­æš‚çš„åœé¡¿å°é˜¶æ®µ")])]),s._v(", è¿™äº›å°é˜¶æ®µ, è­¬å¦‚åˆå§‹åŒ– GC Root ç›´æ¥å…³è”å¯¹è±¡çš„ Mark Start, ä¸ä¹‹å‰ G1 å’Œ Shenandoah çš„ Initial Mark é˜¶æ®µå¹¶æ²¡æœ‰ä»€ä¹ˆå·®å¼‚, å°±ä¸å†å•ç‹¬è§£é‡Šäº†. ZGC çš„è¿ä½œè¿‡ç¨‹å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤º.")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00045-20240302133505-fh3rzwl.jpg",alt:"",title:"ZGC è¿ä½œè¿‡ç¨‹"}})]),s._v(" "),t("ul",[t("li",[t("mark",[t("strong",[s._v("å¹¶å‘æ ‡è®°")])]),s._v(": ä¸ G1, Shenandoah ä¸€æ ·, "),t("strong",[s._v("å¹¶å‘æ ‡è®°æ˜¯éå†å¯¹è±¡å›¾åšå¯è¾¾æ€§åˆ†æçš„é˜¶æ®µ")]),s._v(", å‰åä¹Ÿè¦ç»è¿‡ç±»ä¼¼äº G1, Shenandoah çš„åˆå§‹æ ‡è®°, æœ€ç»ˆæ ‡è®°(å°½ç®¡ ZGC ä¸­çš„åå­—ä¸å«è¿™äº›)çš„"),t("strong",[s._v("çŸ­æš‚åœé¡¿")]),s._v(", è€Œä¸”è¿™äº›åœé¡¿é˜¶æ®µæ‰€åšçš„äº‹æƒ…åœ¨ç›®æ ‡ä¸Šä¹Ÿæ˜¯ç›¸ç±»ä¼¼çš„. ä¸ G1, Shenandoah ä¸åŒçš„æ˜¯, "),t("strong",[s._v("ZGC çš„æ ‡è®°æ˜¯åœ¨æŒ‡é’ˆä¸Šè€Œä¸æ˜¯åœ¨å¯¹è±¡ä¸Šè¿›è¡Œçš„")]),s._v(", æ ‡è®°é˜¶æ®µä¼šæ›´æ–°æŸ“è‰²æŒ‡é’ˆä¸­çš„ Marked 0, Marked 1 æ ‡å¿—ä½.")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("å¹¶å‘é¢„å¤‡é‡åˆ†é…")])]),s._v(": è¿™ä¸ªé˜¶æ®µéœ€è¦"),t("strong",[s._v("æ ¹æ®ç‰¹å®šçš„æŸ¥è¯¢æ¡ä»¶ç»Ÿè®¡å¾—å‡ºæœ¬æ¬¡æ”¶é›†è¿‡ç¨‹è¦æ¸…ç†å“ªäº› Region, å°†è¿™äº› Region ç»„æˆé‡åˆ†é…é›†(Relocation Set)")]),s._v(" . é‡åˆ†é…é›†ä¸ G1 æ”¶é›†å™¨çš„å›æ”¶é›†(Collection Set)è¿˜æ˜¯æœ‰åŒºåˆ«çš„, ZGC åˆ’åˆ† Region çš„ç›®çš„å¹¶éä¸ºäº†åƒ G1 é‚£æ ·åšæ”¶ç›Šä¼˜å…ˆçš„å¢é‡å›æ”¶. ç›¸å, "),t("strong",[s._v("ZGC æ¯æ¬¡å›æ”¶éƒ½ä¼šæ‰«ææ‰€æœ‰çš„ Region, ç”¨èŒƒå›´æ›´å¤§çš„æ‰«ææˆæœ¬æ¢å–çœå» G1 ä¸­è®°å¿†é›†çš„ç»´æŠ¤æˆæœ¬")]),s._v(". å› æ­¤, ZGC çš„é‡åˆ†é…é›†åªæ˜¯å†³å®šäº†é‡Œé¢çš„å­˜æ´»å¯¹è±¡ä¼šè¢«é‡æ–°å¤åˆ¶åˆ°å…¶ä»–çš„ Region ä¸­, é‡Œé¢çš„ Region ä¼šè¢«é‡Šæ”¾, è€Œå¹¶ä¸èƒ½è¯´å›æ”¶è¡Œä¸ºå°±åªæ˜¯é’ˆå¯¹è¿™ä¸ªé›†åˆé‡Œé¢çš„ Region è¿›è¡Œ, å› ä¸ºæ ‡è®°è¿‡ç¨‹æ˜¯é’ˆå¯¹å…¨å †çš„. æ­¤å¤–, åœ¨ JDK 12 çš„ ZGC ä¸­å¼€å§‹æ”¯æŒçš„ç±»å¸è½½ä»¥åŠå¼±å¼•ç”¨çš„å¤„ç†, ä¹Ÿæ˜¯åœ¨è¿™ä¸ªé˜¶æ®µä¸­å®Œæˆçš„.")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("å¹¶å‘é‡åˆ†é…")])]),s._v(": é‡åˆ†é…æ˜¯ ZGC æ‰§è¡Œè¿‡ç¨‹ä¸­çš„"),t("strong",[s._v("æ ¸å¿ƒé˜¶æ®µ")]),s._v(", è¿™ä¸ªè¿‡ç¨‹è¦"),t("strong",[s._v("æŠŠé‡åˆ†é…é›†ä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°æ–°çš„ Region ä¸Š, å¹¶ä¸ºé‡åˆ†é…é›†ä¸­çš„æ¯ä¸ª Region ç»´æŠ¤ä¸€ä¸ªè½¬å‘è¡¨(Forward Table), è®°å½•ä»æ—§å¯¹è±¡åˆ°æ–°å¯¹è±¡çš„è½¬å‘å…³ç³»")]),s._v(". å¾—ç›ŠäºæŸ“è‰²æŒ‡é’ˆçš„æ”¯æŒ, ZGC æ”¶é›†å™¨èƒ½ä»…ä»å¼•ç”¨ä¸Šå°±æ˜ç¡®å¾—çŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¤„äºé‡åˆ†é…é›†ä¹‹ä¸­, "),t("strong",[s._v('å¦‚æœç”¨æˆ·çº¿ç¨‹æ­¤æ—¶å¹¶å‘è®¿é—®äº†ä½äºé‡åˆ†é…é›†ä¸­çš„å¯¹è±¡, è¿™æ¬¡è®¿é—®å°†ä¼šè¢«é¢„ç½®çš„å†…å­˜å±éšœæ‰€æˆªè·, ç„¶åç«‹å³æ ¹æ® Region ä¸Šçš„è½¬å‘è¡¨è®°å½•å°†è®¿é—®è½¬å‘åˆ°æ–°å¤åˆ¶çš„å¯¹è±¡ä¸Š, å¹¶åŒæ—¶ä¿®æ­£æ›´æ–°è¯¥å¼•ç”¨çš„å€¼, ä½¿å…¶ç›´æ¥æŒ‡å‘æ–°å¯¹è±¡, ZGC å°†è¿™ç§è¡Œä¸ºç§°ä¸ºæŒ‡é’ˆçš„ "è‡ªæ„ˆ"(Self-Healing) èƒ½åŠ›')]),s._v(". è¿™æ ·åšçš„å¥½å¤„æ˜¯åªæœ‰ç¬¬ä¸€æ¬¡è®¿é—®æ—§å¯¹è±¡ä¼šé™·å…¥è½¬å‘, ä¹Ÿå°±æ˜¯åªæ…¢ä¸€æ¬¡, å¯¹æ¯” Shenandoah çš„ Brooks è½¬å‘æŒ‡é’ˆ, é‚£æ˜¯æ¯æ¬¡å¯¹è±¡è®¿é—®éƒ½å¿…é¡»ä»˜å‡ºçš„å›ºå®šå¼€é”€, ç®€å•åœ°è¯´å°±æ˜¯æ¯æ¬¡éƒ½æ…¢, å› æ­¤ ZGC å¯¹ç”¨æˆ·ç¨‹åºçš„è¿è¡Œæ—¶è´Ÿè½½è¦æ¯” Shenandoah æ¥å¾—æ›´ä½ä¸€äº›. è¿˜æœ‰å¦å¤–ä¸€ä¸ªç›´æ¥çš„å¥½å¤„æ˜¯ç”±äºæŸ“è‰²æŒ‡é’ˆçš„å­˜åœ¨, ä¸€æ—¦é‡åˆ†é…é›†ä¸­æŸä¸ª Region çš„å­˜æ´»å¯¹è±¡éƒ½å¤åˆ¶å®Œæ¯•å, è¿™ä¸ª Region å°±å¯ä»¥"),t("strong",[s._v("ç«‹å³é‡Šæ”¾")]),s._v("ç”¨äºæ–°å¯¹è±¡çš„åˆ†é…(ä½†æ˜¯è½¬å‘è¡¨è¿˜å¾—ç•™ç€ä¸èƒ½é‡Šæ”¾æ‰), å“ªæ€•å †ä¸­è¿˜æœ‰å¾ˆå¤šæŒ‡å‘è¿™ä¸ªå¯¹è±¡çš„æœªæ›´æ–°æŒ‡é’ˆä¹Ÿæ²¡æœ‰å…³ç³», è¿™äº›æ—§æŒ‡é’ˆä¸€æ—¦è¢«ä½¿ç”¨, å®ƒä»¬éƒ½æ˜¯å¯ä»¥è‡ªæ„ˆçš„.")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("å¹¶å‘é‡æ˜ å°„")])]),s._v(": é‡æ˜ å°„æ‰€åšçš„å°±æ˜¯"),t("strong",[s._v("ä¿®æ­£æ•´ä¸ªå †ä¸­æŒ‡å‘é‡åˆ†é…é›†ä¸­æ—§å¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨")]),s._v(', è¿™ä¸€ç‚¹ä»ç›®æ ‡è§’åº¦çœ‹æ˜¯ä¸ Shenandoah å¹¶å‘å¼•ç”¨æ›´æ–°é˜¶æ®µä¸€æ ·çš„, ä½†æ˜¯ ZGC çš„å¹¶å‘é‡æ˜ å°„å¹¶ä¸æ˜¯ä¸€ä¸ªå¿…é¡»è¦ "è¿«åˆ‡" å»å®Œæˆçš„ä»»åŠ¡, å› ä¸ºå‰é¢è¯´è¿‡, å³ä½¿æ˜¯æ—§å¼•ç”¨, å®ƒä¹Ÿæ˜¯å¯ä»¥è‡ªæ„ˆçš„, æœ€å¤šåªæ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶å¤šä¸€æ¬¡è½¬å‘å’Œä¿®æ­£æ“ä½œ. é‡æ˜ å°„æ¸…ç†è¿™äº›æ—§å¼•ç”¨çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ä¸å˜æ…¢(è¿˜æœ‰æ¸…ç†ç»“æŸåå¯ä»¥é‡Šæ”¾è½¬å‘è¡¨è¿™æ ·çš„é™„å¸¦æ”¶ç›Š), æ‰€ä»¥è¯´è¿™å¹¶ä¸æ˜¯å¾ˆ "è¿«åˆ‡". å› æ­¤, ZGC å¾ˆå·§å¦™åœ°'),t("strong",[s._v("æŠŠå¹¶å‘é‡æ˜ å°„é˜¶æ®µè¦åšçš„å·¥ä½œ, åˆå¹¶åˆ°äº†ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å¾ªç¯ä¸­çš„å¹¶å‘æ ‡è®°é˜¶æ®µé‡Œå»å®Œæˆ")]),s._v(", åæ­£å®ƒä»¬éƒ½æ˜¯è¦éå†æ‰€æœ‰å¯¹è±¡çš„, è¿™æ ·åˆå¹¶å°±èŠ‚çœäº†ä¸€æ¬¡éå†å¯¹è±¡å›¾çš„å¼€é”€. ä¸€æ—¦æ‰€æœ‰æŒ‡é’ˆéƒ½è¢«ä¿®æ­£ä¹‹å, åŸæ¥è®°å½•æ–°æ—§å¯¹è±¡å…³ç³»çš„è½¬å‘è¡¨å°±å¯ä»¥é‡Šæ”¾æ‰äº†.")])]),s._v(" "),t("p",[s._v("ZGC çš„è®¾è®¡ç†å¿µæ˜¯è¿„ä»Šåƒåœ¾æ”¶é›†å™¨ç ”ç©¶çš„æœ€å‰æ²¿æˆæœ, å®ƒåšåˆ°äº†"),t("strong",[s._v("å‡ ä¹æ•´ä¸ªæ”¶é›†è¿‡ç¨‹éƒ½å…¨ç¨‹å¯å¹¶å‘, çŸ­æš‚åœé¡¿ä¹Ÿåªä¸ GC Roots å¤§å°ç›¸å…³è€Œä¸å †å†…å­˜å¤§å°æ— å…³, å› è€ŒåŒæ ·å®ç°äº†ä»»ä½•å †ä¸Šåœé¡¿éƒ½å°äºåæ¯«ç§’çš„ç›®æ ‡")]),s._v(".")]),s._v(" "),t("h6",{attrs:{id:"_5-zgcä¼˜ç¼ºç‚¹ä¸é—®é¢˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-zgcä¼˜ç¼ºç‚¹ä¸é—®é¢˜"}},[s._v("#")]),s._v(" (5)ZGCä¼˜ç¼ºç‚¹ä¸é—®é¢˜")]),s._v(" "),t("p",[s._v("ç›¸æ¯” G1, Shenandoah ç­‰å…ˆè¿›çš„åƒåœ¾æ”¶é›†å™¨, ZGC åœ¨å®ç°ç»†èŠ‚ä¸Šåšäº†ä¸€äº›ä¸åŒçš„"),t("strong",[s._v("æƒè¡¡é€‰æ‹©")]),s._v(", è­¬å¦‚ G1 éœ€è¦é€šè¿‡å†™å±éšœæ¥ç»´æŠ¤è®°å¿†é›†, æ‰èƒ½å¤„ç†è·¨ä»£æŒ‡é’ˆ, å¾—ä»¥å®ç° Region çš„å¢é‡å›æ”¶. è®°å¿†é›†è¦å ç”¨å¤§é‡çš„å†…å­˜ç©ºé—´, å†™å±éšœä¹Ÿå¯¹æ­£å¸¸ç¨‹åºè¿è¡Œé€ æˆé¢å¤–è´Ÿæ‹…, è¿™äº›éƒ½æ˜¯æƒè¡¡é€‰æ‹©çš„ä»£ä»·. ZGC å°±å®Œå…¨æ²¡æœ‰ä½¿ç”¨è®°å¿†é›†, å®ƒç”šè‡³è¿åˆ†ä»£éƒ½æ²¡æœ‰, è¿åƒ CMS ä¸­é‚£æ ·åªè®°å½•æ–°ç”Ÿä»£å’Œè€å¹´ä»£é—´å¼•ç”¨çš„å¡è¡¨ä¹Ÿä¸éœ€è¦, å› è€Œ"),t("strong",[s._v("å®Œå…¨æ²¡æœ‰ç”¨åˆ°å†™å±éšœ")]),s._v(", æ‰€ä»¥ç»™ç”¨æˆ·çº¿ç¨‹å¸¦æ¥çš„è¿è¡Œè´Ÿæ‹…ä¹Ÿè¦å°å¾—å¤š. å¯æ˜¯, å¿…å®šè¦æœ‰ä¼˜æœ‰åŠ£æ‰ä¼šç§°ä½œæƒè¡¡, ZGC çš„è¿™ç§é€‰æ‹©ä¹Ÿé™åˆ¶äº†å®ƒ"),t("strong",[s._v("èƒ½æ‰¿å—çš„å¯¹è±¡åˆ†é…é€Ÿç‡ä¸ä¼šå¤ªé«˜")]),s._v(".")]),s._v(" "),t("blockquote",[t("p",[s._v("æµ®åŠ¨åƒåœ¾")])]),s._v(" "),t("p",[s._v("å¯ä»¥æƒ³è±¡ä»¥ä¸‹åœºæ™¯æ¥ç†è§£ ZGC çš„è¿™ä¸ªåŠ£åŠ¿: ZGC å‡†å¤‡è¦å¯¹ä¸€ä¸ªå¾ˆå¤§çš„å †åšä¸€æ¬¡å®Œæ•´çš„å¹¶å‘æ”¶é›†, å‡è®¾å…¶å…¨è¿‡ç¨‹è¦æŒç»­ååˆ†é’Ÿä»¥ä¸Š(è¯·è¯»è€…åˆ‡å‹¿æ··æ·†å¹¶å‘æ—¶é—´ä¸åœé¡¿æ—¶é—´, ZGC ç«‹çš„ Flag æ˜¯"),t("strong",[s._v("åœé¡¿æ—¶é—´ä¸è¶…è¿‡åæ¯«ç§’")]),s._v("), åœ¨è¿™æ®µæ—¶é—´é‡Œé¢, ç”±äºåº”ç”¨çš„å¯¹è±¡åˆ†é…é€Ÿç‡å¾ˆé«˜, å°†åˆ›é€ å¤§é‡çš„æ–°å¯¹è±¡, è¿™äº›æ–°å¯¹è±¡å¾ˆéš¾è¿›å…¥å½“æ¬¡æ”¶é›†çš„æ ‡è®°èŒƒå›´, é€šå¸¸å°±åªèƒ½å…¨éƒ¨å½“ä½œå­˜æ´»å¯¹è±¡æ¥çœ‹å¾…---å°½ç®¡å…¶ä¸­ç»å¤§éƒ¨åˆ†å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•ç­çš„, è¿™å°±"),t("strong",[s._v("äº§ç”Ÿäº†å¤§é‡çš„")]),s._v("â€‹"),t("mark",[t("strong",[s._v("æµ®åŠ¨åƒåœ¾")])]),s._v(". å¦‚æœè¿™ç§é«˜é€Ÿåˆ†é…æŒç»­ç»´æŒçš„è¯, æ¯ä¸€æ¬¡å®Œæ•´çš„å¹¶å‘æ”¶é›†å‘¨æœŸéƒ½ä¼šå¾ˆé•¿, å›æ”¶åˆ°çš„å†…å­˜ç©ºé—´æŒç»­å°äºæœŸé—´å¹¶å‘äº§ç”Ÿçš„æµ®åŠ¨åƒåœ¾æ‰€å çš„ç©ºé—´, å †ä¸­å‰©ä½™å¯è…¾æŒªçš„ç©ºé—´å°±è¶Šæ¥è¶Šå°äº†. å› æ­¤, "),t("strong",[s._v("ZGC æœ€å¤§çš„é—®é¢˜æ˜¯æµ®åŠ¨åƒåœ¾")]),s._v(". ZGC çš„åœé¡¿æ—¶é—´æ˜¯åœ¨ 10ms ä»¥ä¸‹, ä½†æ˜¯ ZGC çš„æ‰§è¡Œæ—¶é—´è¿˜æ˜¯è¿œè¿œå¤§äºè¿™ä¸ªæ—¶é—´çš„. å‡å¦‚ ZGC å…¨è¿‡ç¨‹éœ€è¦æ‰§è¡Œ 10 åˆ†é’Ÿ, åœ¨è¿™ä¸ªæœŸé—´ç”±äºå¯¹è±¡åˆ†é…é€Ÿç‡å¾ˆé«˜, å°†åˆ›å»ºå¤§é‡çš„æ–°å¯¹è±¡, è¿™äº›å¯¹è±¡å¾ˆéš¾è¿›å…¥å½“æ¬¡ GC, æ‰€ä»¥åªèƒ½åœ¨ä¸‹æ¬¡ GC çš„æ—¶å€™è¿›è¡Œå›æ”¶, è¿™äº›åªèƒ½ç­‰åˆ°ä¸‹æ¬¡ GC æ‰èƒ½å›æ”¶çš„å¯¹è±¡å°±æ˜¯æµ®åŠ¨åƒåœ¾.")]),s._v(" "),t("blockquote",[t("p",[s._v("æµ®åŠ¨åƒåœ¾è§£å†³æ–¹æ³•")])]),s._v(" "),t("p",[s._v("ç›®å‰å”¯ä¸€çš„åŠæ³•å°±æ˜¯"),t("strong",[s._v("å°½å¯èƒ½åœ°å¢åŠ å †å®¹é‡å¤§å°, è·å¾—æ›´å¤šå–˜æ¯çš„æ—¶é—´")]),s._v(". ä½†æ˜¯è‹¥è¦ä»æ ¹æœ¬ä¸Šæå‡ ZGC èƒ½å¤Ÿåº”å¯¹çš„å¯¹è±¡åˆ†é…é€Ÿç‡, "),t("strong",[s._v("è¿˜æ˜¯éœ€è¦å¼•å…¥åˆ†ä»£æ”¶é›†, è®©æ–°ç”Ÿå¯¹è±¡éƒ½åœ¨ä¸€ä¸ªä¸“é—¨çš„åŒºåŸŸä¸­åˆ›å»º")]),s._v(", ç„¶åä¸“é—¨é’ˆå¯¹è¿™ä¸ªåŒºåŸŸè¿›è¡Œæ›´é¢‘ç¹, æ›´å¿«çš„æ”¶é›†.")]),s._v(" "),t("h6",{attrs:{id:"_6-zgcæ€§èƒ½"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-zgcæ€§èƒ½"}},[s._v("#")]),s._v(" (6)ZGCæ€§èƒ½")]),s._v(" "),t("p",[s._v('ZGC è¿˜æœ‰ä¸€ä¸ªå¸¸åœ¨æŠ€æœ¯èµ„æ–™ä¸Šè¢«æåŠçš„ä¼˜ç‚¹æ˜¯æ”¯æŒ "'),t("strong",[s._v("NUMA-Aware")]),s._v('" çš„å†…å­˜åˆ†é…. NUMA(Non-Uniform Memory Access, éç»Ÿä¸€å†…å­˜è®¿é—®æ¶æ„)æ˜¯ä¸€ç§ä¸º'),t("strong",[s._v("å¤šå¤„ç†å™¨æˆ–è€…å¤šæ ¸å¤„ç†å™¨çš„è®¡ç®—æœºæ‰€è®¾è®¡çš„å†…å­˜æ¶æ„")]),s._v(". ç”±äºæ‘©å°”å®šå¾‹é€æ¸å¤±æ•ˆ, ç°ä»£å¤„ç†å™¨å› é¢‘ç‡å‘å±•å—é™è½¬è€Œå‘å¤šæ ¸æ–¹å‘å‘å±•, ä»¥å‰åŸæœ¬åœ¨åŒ—æ¡¥èŠ¯ç‰‡ä¸­çš„å†…å­˜æ§åˆ¶å™¨ä¹Ÿè¢«é›†æˆåˆ°äº†å¤„ç†å™¨å†…æ ¸ä¸­, è¿™æ ·æ¯ä¸ªå¤„ç†å™¨æ ¸å¿ƒæ‰€åœ¨çš„è£¸æ™¶(DIE) éƒ½æœ‰å±äºè‡ªå·±å†…å­˜ç®¡ç†å™¨æ‰€ç®¡ç†çš„å†…å­˜, å¦‚æœè¦è®¿é—®è¢«å…¶ä»–å¤„ç†å™¨æ ¸å¿ƒç®¡ç†çš„å†…å­˜, å°±å¿…é¡»é€šè¿‡ Inter-Connect é€šé“æ¥å®Œæˆ, è¿™è¦æ¯”è®¿é—®å¤„ç†å™¨çš„æœ¬åœ°å†…å­˜æ…¢å¾—å¤š. åœ¨ NUMA æ¶æ„ä¸‹, "),t("strong",[s._v("ZGC æ”¶é›†å™¨ä¼šä¼˜å…ˆå°è¯•åœ¨è¯·æ±‚çº¿ç¨‹å½“å‰æ‰€å¤„çš„å¤„ç†å™¨çš„æœ¬åœ°å†…å­˜ä¸Šåˆ†é…å¯¹è±¡, ä»¥ä¿è¯é«˜æ•ˆå†…å­˜è®¿é—®")]),s._v(". åœ¨ ZGC ä¹‹å‰çš„æ”¶é›†å™¨å°±åªæœ‰é’ˆå¯¹ååé‡è®¾è®¡çš„ Parallel Scavenge æ”¯æŒ NUMA å†…å­˜åˆ†é…, å¦‚ä»Š ZGC ä¹Ÿæˆä¸ºå¦å¤–ä¸€ä¸ªé€‰æ‹©.")]),s._v(" "),t("p",[s._v('åœ¨æ€§èƒ½æ–¹é¢, å°½ç®¡ç›®å‰è¿˜å¤„äºå®éªŒçŠ¶æ€, è¿˜æ²¡æœ‰å®Œæˆæ‰€æœ‰ç‰¹æ€§, ç¨³å®šæ€§æ‰“ç£¨å’Œæ€§èƒ½è°ƒä¼˜ä¹Ÿä»åœ¨è¿›è¡Œ, ä½†å³ä½¿æ˜¯è¿™ç§çŠ¶æ€ä¸‹çš„ ZGC, å…¶æ€§èƒ½è¡¨ç°å·²ç»ç›¸å½“äº®çœ¼, ä»å®˜æ–¹ç»™å‡ºçš„æµ‹è¯•ç»“æœæ¥çœ‹, ç”¨ "'),t("strong",[s._v("ä»¤äººéœ‡æƒŠçš„, é©å‘½æ€§çš„ ZGC")]),s._v('" æ¥å½¢å®¹éƒ½ä¸ä¸ºè¿‡.')]),s._v(" "),t("p",[s._v('å›¾ 3-23 å’Œå›¾ 3-24 æ˜¯ ZGC ä¸ Parallel Scavenge, G1 ä¸‰æ¬¾æ”¶é›†å™¨é€šè¿‡ SPECjbb 2015 çš„æµ‹è¯•ç»“æœ. åœ¨ ZGC çš„ "å¼±é¡¹" ååé‡æ–¹é¢, ä»¥ä½å»¶è¿Ÿä¸ºé¦–è¦ç›®æ ‡çš„ ZGC å·²ç»è¾¾åˆ°äº†ä»¥é«˜ååé‡ä¸ºç›®æ ‡ Parallel Scavenge çš„99%, ç›´æ¥è¶…è¶Šäº† G1. å¦‚æœå°†ååé‡æµ‹è¯•è®¾å®šä¸ºé¢å‘ SLA(Service Level Agreements)åº”ç”¨çš„ "Critical Throughput" çš„è¯, ZGC çš„è¡¨ç°ç”šè‡³è¿˜åè¶…äº† Parallel Scavenge æ”¶é›†å™¨.')]),s._v(" "),t("p",[s._v("è€Œåœ¨ ZGC çš„å¼ºé¡¹"),t("strong",[s._v("åœé¡¿æ—¶é—´")]),s._v("æµ‹è¯•ä¸Š, å®ƒå°±æ¯«ä¸ç•™æƒ…åœ°ä¸ Parallel Scavenge, G1 æ‹‰å¼€äº†ä¸¤ä¸ªæ•°é‡çº§çš„å·®è·. ä¸è®ºæ˜¯å¹³å‡åœé¡¿, è¿˜æ˜¯ 95% åœé¡¿, 99% åœé¡¿, 99.9% åœé¡¿, æŠ‘æˆ–æ˜¯æœ€å¤§åœé¡¿æ—¶é—´, "),t("strong",[s._v("ZGC å‡èƒ½æ¯«ä¸è´¹åŠ²åœ°æ§åˆ¶åœ¨åæ¯«ç§’ä¹‹å†…")]),s._v(", ä»¥è‡³äºæŠŠå®ƒå’Œå¦å¤–ä¸¤æ¬¾åœé¡¿æ•°ç™¾è¿‘åƒæ¯«ç§’çš„æ”¶é›†å™¨æ”¾åˆ°ä¸€èµ·å¯¹æ¯”, å°±å‡ ä¹æ˜¾ç¤ºä¸äº† ZGC çš„æŸ±çŠ¶æ¡(å›¾ 3-24a), å¿…é¡»æŠŠç»“æœçš„çºµåæ ‡ä»çº¿æ€§å°ºåº¦è°ƒæ•´æˆå¯¹æ•°å°ºåº¦(å›¾ 3-24b, çºµåæ ‡è½´çš„å°ºåº¦æ˜¯å¯¹æ•°å¢é•¿çš„)æ‰èƒ½è§‚å¯Ÿåˆ° ZGC çš„æµ‹è¯•ç»“æœ.")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00046-20240302133505-rr2lpp2.jpg",alt:"",title:"å›¾3-23ã€€ZGC çš„ååé‡æµ‹è¯•"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/Image00047-20240302133505-b0jjjwk.jpg",alt:"",title:"å›¾3-24ã€€ZGC çš„åœé¡¿æ—¶é—´æµ‹è¯•"}})]),s._v(" "),t("p",[s._v("ZGC åŸæœ¬æ˜¯ Oracle ä½œä¸ºä¸€é¡¹å•†ä¸šç‰¹æ€§(å¦‚åŒ JFR, JMC è¿™äº›åŠŸèƒ½)æ¥è®¾è®¡å’Œå®ç°çš„, åªä¸è¿‡åœ¨å®ƒæ¨ªç©ºå‡ºä¸–çš„ JDK 11 æ—¶æœŸ, æ­£å¥½é€‚é€¢ Oracle è°ƒæ•´è®¸å¯è¯æˆæƒ, æŠŠæ‰€æœ‰å•†ä¸šç‰¹æ€§éƒ½å¼€æºç»™äº† OpenJDK, æ‰€ä»¥ç”¨æˆ·å¯¹å…¶å•†ä¸šæ€§å¹¶æ²¡æœ‰æ˜æ˜¾çš„æ„ŸçŸ¥. ZGC æœ‰ç€ä»¤æ‰€æœ‰å¼€å‘äººå‘˜è¶‹ä¹‹è‹¥é¹œçš„ä¼˜ç§€æ€§èƒ½, ç¬”è€…ç›¸ä¿¡å®ƒ"),t("strong",[s._v("å®Œå…¨æˆç†Ÿä¹‹å, å°†ä¼šæˆä¸ºæœåŠ¡ç«¯, å¤§å†…å­˜, ä½å»¶è¿Ÿåº”ç”¨çš„é¦–é€‰æ”¶é›†å™¨çš„æœ‰åŠ›ç«äº‰è€…")]),s._v(".")]),s._v(" "),t("h6",{attrs:{id:"_7-zgcå‚æ•°è®¾ç½®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-zgcå‚æ•°è®¾ç½®"}},[s._v("#")]),s._v(" (7)ZGCå‚æ•°è®¾ç½®")]),s._v(" "),t("p",[s._v("å¯ç”¨ ZGC æ¯”è¾ƒç®€å•, è®¾ç½® JVM å‚æ•°å³å¯: "),t("code",[s._v("-XX:+UnlockExperimentalVMOptions, -XX:+UseZGC")]),s._v("â€‹. è°ƒä¼˜ä¹Ÿå¹¶ä¸éš¾, å› ä¸º ZGC è°ƒä¼˜å‚æ•°å¹¶ä¸å¤š. å®ƒå’Œ G1 ä¸€æ ·, å¯ä»¥è°ƒä¼˜çš„å‚æ•°éƒ½æ¯”è¾ƒå°‘, å¤§éƒ¨åˆ†å·¥ä½œ JVM èƒ½å¾ˆå¥½çš„è‡ªåŠ¨å®Œæˆ.")]),s._v(" "),t("h4",{attrs:{id:"é€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†å™¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†å™¨"}},[s._v("#")]),s._v(" é€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†å™¨")]),s._v(" "),t("p",[s._v('HotSpot è™šæ‹Ÿæœºæä¾›äº†ç§ç±»ç¹å¤šçš„åƒåœ¾æ”¶é›†å™¨, é€‰æ‹©å¤ªå¤šåè€Œä»¤äººè¸Œèº‡éš¾å†³, è‹¥åªæŒ‘æœ€å…ˆè¿›çš„æ˜¾ç„¶ä¸å¯èƒ½æ»¡è¶³å…¨éƒ¨åº”ç”¨åœºæ™¯, ä½†åªç”¨ä¸€å¥ "å¿…é¡»å› åœ°åˆ¶å®œ, æŒ‰éœ€é€‰ç”¨" åˆæœªå…æœ‰æ•·è¡çš„å«Œç–‘, æœ¬èŠ‚å°±æ¥æ¢è®¨ä¸€ä¸‹'),t("strong",[s._v("å¦‚ä½•é€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†å™¨")]),s._v(".")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[s._v("                åƒåœ¾æ”¶é›†å™¨è¿™ä¹ˆå¤š, **å¦‚ä½•é€‰æ‹©ä¸€æ¬¾é€‚åˆè‡ªå·±åº”ç”¨çš„æ”¶é›†å™¨å‘¢? è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆä¸»è¦å—ä»¥ä¸‹ä¸‰ä¸ªå› ç´ å½±å“**:\n")])])]),t("ul",[t("li",[t("mark",[t("strong",[s._v("åº”ç”¨ç¨‹åºçš„ä¸»è¦å…³æ³¨ç‚¹æ˜¯ä»€ä¹ˆ")])]),s._v("? å¦‚æœæ˜¯æ•°æ®åˆ†æ, ç§‘å­¦è®¡ç®—ç±»çš„ä»»åŠ¡, ç›®æ ‡æ˜¯èƒ½å°½å¿«ç®—å‡ºç»“æœ, é‚£"),t("strong",[s._v("ååé‡")]),s._v("å°±æ˜¯ä¸»è¦å…³æ³¨ç‚¹; å¦‚æœæ˜¯ SLA åº”ç”¨, é‚£åœé¡¿æ—¶é—´ç›´æ¥å½±å“æœåŠ¡è´¨é‡, ä¸¥é‡çš„ç”šè‡³ä¼šå¯¼è‡´äº‹åŠ¡è¶…æ—¶, è¿™æ ·"),t("strong",[s._v("å»¶è¿Ÿå°±æ˜¯ä¸»è¦å…³æ³¨ç‚¹")]),s._v("; è€Œå¦‚æœæ˜¯å®¢æˆ·ç«¯åº”ç”¨æˆ–è€…åµŒå…¥å¼åº”ç”¨, é‚£åƒåœ¾æ”¶é›†çš„"),t("strong",[s._v("å†…å­˜å ç”¨")]),s._v("åˆ™æ˜¯ä¸å¯å¿½è§†çš„.")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("è¿è¡Œåº”ç”¨çš„åŸºç¡€è®¾æ–½å¦‚ä½•")])]),s._v("? è­¬å¦‚ç¡¬ä»¶è§„æ ¼, è¦æ¶‰åŠçš„ç³»ç»Ÿæ¶æ„æ˜¯ x86-32/64, SPARC è¿˜æ˜¯ ARM/Aarch64; å¤„ç†å™¨çš„æ•°é‡å¤šå°‘, åˆ†é…å†…å­˜çš„å¤§å°; é€‰æ‹©çš„æ“ä½œç³»ç»Ÿæ˜¯ Linux, Solaris è¿˜æ˜¯ Windows ç­‰.")]),s._v(" "),t("li",[t("mark",[t("strong",[s._v("ä½¿ç”¨ JDK çš„å‘è¡Œå•†æ˜¯ä»€ä¹ˆ")])]),s._v("? ç‰ˆæœ¬å·æ˜¯å¤šå°‘? æ˜¯ OracleJDK, Open-JDK, OpenJ9 æŠ‘æˆ–æ˜¯å…¶ä»–å…¬å¸çš„å‘è¡Œç‰ˆ? è¯¥ JDK å¯¹åº”äº†ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹çš„å“ªä¸ªç‰ˆæœ¬?")])]),s._v(" "),t("p",[s._v("ä¸€èˆ¬æ¥è¯´, æ”¶é›†å™¨çš„é€‰æ‹©å°±ä»ä»¥ä¸Šè¿™å‡ ç‚¹å‡ºå‘æ¥è€ƒè™‘. ä¸¾ä¸ªä¾‹å­, å‡è®¾æŸä¸ªç›´æ¥é¢å‘ç”¨æˆ·æä¾›æœåŠ¡çš„ B/S ç³»ç»Ÿå‡†å¤‡é€‰æ‹©åƒåœ¾æ”¶é›†å™¨, ä¸€èˆ¬æ¥è¯´"),t("strong",[s._v("å»¶è¿Ÿæ—¶é—´")]),s._v("æ˜¯è¿™ç±»åº”ç”¨çš„ä¸»è¦å…³æ³¨ç‚¹, é‚£ä¹ˆ:")]),s._v(" "),t("ul",[t("li",[s._v("å¦‚æœä½ è™½ç„¶æ²¡æœ‰è¶³å¤Ÿé¢„ç®—å»ä½¿ç”¨å•†ä¸šè§£å†³æ–¹æ¡ˆ, ä½†èƒ½å¤ŸæŒæ§è½¯ç¡¬ä»¶å‹å·, ä½¿ç”¨è¾ƒæ–°çš„ç‰ˆæœ¬, åŒæ—¶åˆç‰¹åˆ«æ³¨é‡å»¶è¿Ÿ, é‚£ ZGC å¾ˆå€¼å¾—å°è¯•.")]),s._v(" "),t("li",[s._v("å¦‚æœä½ å¯¹è¿˜å¤„äºå®éªŒçŠ¶æ€çš„æ”¶é›†å™¨çš„ç¨³å®šæ€§æœ‰æ‰€é¡¾è™‘, æˆ–è€…åº”ç”¨å¿…é¡»è¿è¡Œåœ¨ Win-dows æ“ä½œç³»ç»Ÿä¸‹, é‚£ ZGC å°±æ— ç¼˜äº†, è¯•è¯• Shenandoah å§.")]),s._v(" "),t("li",[s._v("å¦‚æœä½ æ¥æ‰‹çš„æ˜¯é—ç•™ç³»ç»Ÿ, è½¯ç¡¬ä»¶åŸºç¡€è®¾æ–½å’Œ JDK ç‰ˆæœ¬éƒ½æ¯”è¾ƒè½å, é‚£å°±æ ¹æ®å†…å­˜è§„æ¨¡è¡¡é‡ä¸€ä¸‹, å¯¹äºå¤§æ¦‚ 4GB åˆ° 6GB ä»¥ä¸‹çš„å †å†…å­˜, CMS ä¸€èˆ¬èƒ½å¤„ç†å¾—æ¯”è¾ƒå¥½, è€Œå¯¹äºæ›´å¤§çš„å †å†…å­˜, å¯é‡ç‚¹è€ƒå¯Ÿä¸€ä¸‹ "),t("strong",[s._v("G1")]),s._v(".")])]),s._v(" "),t("p",[s._v("å½“ç„¶, ä»¥ä¸Šéƒ½æ˜¯ä»…ä»ç†è®ºå‡ºå‘çš„åˆ†æ, "),t("strong",[s._v("å®æˆ˜ä¸­åˆ‡ä¸å¯çº¸ä¸Šè°ˆå…µ, æ ¹æ®ç³»ç»Ÿå®é™…æƒ…å†µå»æµ‹è¯•æ‰æ˜¯é€‰æ‹©æ”¶é›†å™¨çš„æœ€ç»ˆä¾æ®")]),s._v(".")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("å†…å­˜è¾ƒå°å¯ä»¥ä½¿ç”¨ ParNew + CMS. å†…å­˜è¾ƒå¤§ä½¿ç”¨ G1. æ–°çš„ JDK ç‰ˆæœ¬å¯ä»¥ç”¨ ZGC")])]),s._v(".")]),s._v(" "),t("h4",{attrs:{id:"å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥"}},[s._v("#")]),s._v(" å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥")]),s._v(" "),t("p",[s._v("Java æŠ€æœ¯ä½“ç³»çš„"),t("strong",[s._v("è‡ªåŠ¨å†…å­˜ç®¡ç†, æœ€æ ¹æœ¬çš„ç›®æ ‡")]),s._v("æ˜¯è‡ªåŠ¨åŒ–åœ°è§£å†³ä¸¤ä¸ªé—®é¢˜: "),t("mark",[t("strong",[s._v("è‡ªåŠ¨ç»™å¯¹è±¡åˆ†é…å†…å­˜ä»¥åŠè‡ªåŠ¨å›æ”¶åˆ†é…ç»™å¯¹è±¡çš„å†…å­˜")])]),s._v(". å…³äºå›æ”¶å†…å­˜è¿™æ–¹é¢, ç¬”è€…å·²ç»ä½¿ç”¨äº†å¤§é‡ç¯‡å¹…å»ä»‹ç»è™šæ‹Ÿæœºä¸­çš„åƒåœ¾æ”¶é›†å™¨ä½“ç³»ä»¥åŠè¿ä½œåŸç†, ç°åœ¨æ¥æ¢è®¨ä¸€ä¸‹å…³äº"),t("mark",[t("strong",[s._v("ç»™å¯¹è±¡åˆ†é…å†…å­˜")])]),s._v("çš„é‚£äº›äº‹å„¿.")]),s._v(" "),t("p",[t("strong",[s._v("å¯¹è±¡çš„å†…å­˜åˆ†é…, ä»æ¦‚å¿µä¸Šè®², å¤§éƒ¨åˆ†éƒ½æ˜¯åœ¨å †ä¸Šåˆ†é…(è€Œå®é™…ä¸Šä¹Ÿæœ‰å¯èƒ½ç»è¿‡å³æ—¶ç¼–è¯‘åè¢«æ‹†æ•£ä¸ºæ ‡é‡ç±»å‹å¹¶é—´æ¥åœ°åœ¨æ ˆä¸Šåˆ†é…)")]),s._v(" . åœ¨ç»å…¸åˆ†ä»£çš„è®¾è®¡ä¸‹, æ–°ç”Ÿå¯¹è±¡é€šå¸¸ä¼šåˆ†é…åœ¨æ–°ç”Ÿä»£ä¸­, å°‘æ•°æƒ…å†µä¸‹(ä¾‹å¦‚å¯¹è±¡å¤§å°è¶…è¿‡ä¸€å®šé˜ˆå€¼)ä¹Ÿå¯èƒ½ä¼šç›´æ¥åˆ†é…åœ¨è€å¹´ä»£. å¯¹è±¡åˆ†é…çš„è§„åˆ™å¹¶ä¸æ˜¯å›ºå®šçš„, ã€ŠJava è™šæ‹Ÿæœºè§„èŒƒã€‹å¹¶æœªè§„å®šæ–°å¯¹è±¡çš„åˆ›å»ºå’Œå­˜å‚¨ç»†èŠ‚, è¿™å–å†³äºè™šæ‹Ÿæœºå½“å‰ä½¿ç”¨çš„æ˜¯å“ªä¸€ç§åƒåœ¾æ”¶é›†å™¨, ä»¥åŠè™šæ‹Ÿæœºä¸­ä¸å†…å­˜ç›¸å…³çš„å‚æ•°çš„è®¾å®š.")]),s._v(" "),t("p",[s._v("æ¥ä¸‹æ¥çš„å‡ å°èŠ‚å†…å®¹, å°†ä¼šè®²è§£è‹¥å¹²"),t("mark",[t("strong",[s._v("æœ€åŸºæœ¬çš„å†…å­˜åˆ†é…åŸåˆ™")])]),s._v(", å¹¶é€šè¿‡ä»£ç å»éªŒè¯è¿™äº›åŸåˆ™. æœ¬èŠ‚å‡ºç°çš„ä»£ç å¦‚æ— ç‰¹åˆ«è¯´æ˜, å‡ä½¿ç”¨ HotSpot è™šæ‹Ÿæœº, ä»¥å®¢æˆ·ç«¯æ¨¡å¼è¿è¡Œ. ç”±äºå¹¶æœªæŒ‡å®šæ”¶é›†å™¨ç»„åˆ, å› æ­¤æœ¬èŠ‚éªŒè¯çš„å®é™…æ˜¯"),t("strong",[s._v("ä½¿ç”¨ Serial åŠ  Serial Old å®¢æˆ·ç«¯é»˜è®¤æ”¶é›†å™¨ç»„åˆ")]),s._v("ä¸‹çš„å†…å­˜åˆ†é…å’Œå›æ”¶çš„ç­–ç•¥, è¿™ç§é…ç½®å’Œæ”¶é›†å™¨ç»„åˆä¹Ÿè®¸æ˜¯å¼€å‘äººå‘˜åšç ”å‘æ—¶çš„é»˜è®¤ç»„åˆ(å…¶å®ç°åœ¨ç ”å‘æ—¶å¾ˆå¤šä¹Ÿé»˜è®¤ç”¨æœåŠ¡ç«¯è™šæ‹Ÿæœºäº†), ä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸€èˆ¬ä¸ä¼šè¿™æ ·ç”¨, æ‰€ä»¥ä¸»è¦å­¦ä¹ çš„æ˜¯åˆ†ææ–¹æ³•, è€Œåˆ—ä¸¾çš„åˆ†é…è§„åˆ™åè€Œåªæ˜¯æ¬¡è¦çš„. è¯»è€…ä¹Ÿä¸å¦¨æ ¹æ®è‡ªå·±é¡¹ç›®ä¸­ä½¿ç”¨çš„æ”¶é›†å™¨ç¼–å†™ä¸€äº›ç¨‹åºå»å®è·µéªŒè¯ä¸€ä¸‹ä½¿ç”¨å…¶ä»–å‡ ç§æ”¶é›†å™¨çš„å†…å­˜åˆ†é…è§„åˆ™.")]),s._v(" "),t("p",[s._v("å¯¹è±¡å†…å­˜åˆ†é…æµç¨‹å›¾å¤§ä½“å¦‚ä¸‹æ‰€ç¤º.")]),s._v(" "),t("p",[t("img",{attrs:{src:"/img/image-20230325163536-k63gzvs.png",alt:"https://www.processon.com/diagraming/641ea4c11fae9069cfbe5358"}})]),s._v(" "),t("h5",{attrs:{id:"_1-å¯¹è±¡æ ˆä¸Šåˆ†é…"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å¯¹è±¡æ ˆä¸Šåˆ†é…"}},[s._v("#")]),s._v(" 1.å¯¹è±¡æ ˆä¸Šåˆ†é…")]),s._v(" "),t("p",[s._v("æ™®éçš„è®¤è¯†æ˜¯å¯¹è±¡éƒ½åœ¨å †åŒºåˆ†é…, ä½†æ˜¯ä¹Ÿå¯èƒ½åˆ†é…åˆ°è™šæ‹Ÿæœºæ ˆä¸Š.")]),s._v(" "),t("p",[s._v("å¤§éƒ¨åˆ†å¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸Šè¿›è¡Œåˆ†é…, å½“å¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨çš„æ—¶å€™, éœ€è¦ä¾é  GC è¿›è¡Œå›æ”¶å†…å­˜, å¦‚æœå¯¹è±¡æ•°é‡è¾ƒå¤šçš„æ—¶å€™, ä¼šç»™ GC å¸¦æ¥è¾ƒå¤§å‹åŠ›, ä¹Ÿé—´æ¥å½±å“äº†åº”ç”¨çš„æ€§èƒ½. ä¸ºäº†å‡å°‘ä¸´æ—¶å¯¹è±¡åœ¨å †å†…åˆ†é…çš„æ•°é‡, JVM é€šè¿‡"),t("strong",[s._v("é€ƒé€¸åˆ†æ")]),s._v("(å‚è€ƒ:é€ƒé€¸åˆ†æ)ç¡®å®šè¯¥å¯¹è±¡ä¸ä¼šè¢«å¤–éƒ¨è®¿é—®. å¦‚æœä¸ä¼šé€ƒé€¸å¯ä»¥"),t("strong",[s._v("å°†è¯¥å¯¹è±¡åœ¨æ ˆä¸Šåˆ†é…å†…å­˜")]),s._v(", è¿™æ ·"),t("strong",[s._v("è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å°±å¯ä»¥éšæ ˆå¸§å‡ºæ ˆè€Œé”€æ¯, å°±å‡è½»äº†åƒåœ¾å›æ”¶çš„å‹åŠ›")]),s._v(".")]),s._v(" "),t("p",[s._v("æ ˆä¸Šåˆ†é…å¯¹è±¡ç¤ºä¾‹:")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * æ ˆä¸Šåˆ†é…, æ ‡é‡æ›¿æ¢\n * ä»£ç è°ƒç”¨äº†1äº¿æ¬¡alloc(), å¦‚æœæ˜¯åˆ†é…åˆ°å †ä¸Š, å¤§æ¦‚éœ€è¦1GBä»¥ä¸Šå †ç©ºé—´, å¦‚æœå †ç©ºé—´å°äºè¯¥å€¼, å¿…ç„¶ä¼šè§¦å‘GC. \n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("AllotOnStack")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" start "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentTimeMillis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("alloc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("long")]),s._v(" end "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("currentTimeMillis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("end "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" start"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("alloc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v(" user "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        user"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("setName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Jack"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("p",[s._v("å¯¹äºä¸Šé¢çš„æµ‹è¯•, å¦‚æœé‡‡ç”¨å¦‚ä¸‹çš„å‚æ•°æ‰§è¡Œ, åˆ™ä¸€èˆ¬ä¸ä¼šå‘ç”Ÿ GC. å…¶å®å°±æ˜¯"),t("strong",[s._v("å¼€å¯äº†é€ƒé€¸åˆ†æå’Œæ ‡é‡æ›¿æ¢")]),s._v(", ä½¿å¾— user å¯¹è±¡éƒ½åˆ†é…åˆ°æ ˆä¸Šäº†, æ–¹æ³•ç»“æŸåå°±è¢«é”€æ¯äº†, æ‰€ä»¥ä¸ä¼š GC.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä½¿ç”¨å¦‚ä¸‹å‚æ•°ä¸ä¼šå‘ç”ŸGC")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xmx15m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xms15m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DoEscapeAnalysis")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGC")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EliminateAllocations")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("å¦‚æœä½¿ç”¨ä¸‹é¢çš„å‚æ•°æ‰§è¡Œä»£ç , ä¹Ÿå°±æ˜¯å…³é—­é€ƒé€¸åˆ†æå’Œæ ‡é‡æ›¿æ¢, ä½¿å¾— user å¯¹è±¡éƒ½åˆ†é…åˆ°å †ä¸Šäº†, æ–¹æ³•ç»“æŸåå¯¹è±¡ä¸€ç›´åœ¨å †ä¸­, ä»è€Œè§¦å‘äº†è¾ƒå¤šçš„ GC.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä½¿ç”¨å¦‚ä¸‹å‚æ•°éƒ½ä¼šå‘ç”Ÿå¤§é‡GC")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xmx15m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xms15m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DoEscapeAnalysis")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGC")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EliminateAllocations")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xmx15m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xms15m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DoEscapeAnalysis")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGC")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("XX")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EliminateAllocations")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("strong",[s._v("ç»“è®º: æ ˆä¸Šåˆ†é…ä¾èµ–äºé€ƒé€¸åˆ†æå’Œæ ‡é‡æ›¿æ¢")]),s._v(".")]),s._v(" "),t("h5",{attrs:{id:"_2-å¯¹è±¡ä¼˜å…ˆåœ¨edenåˆ†é…"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å¯¹è±¡ä¼˜å…ˆåœ¨edenåˆ†é…"}},[s._v("#")]),s._v(" 2.å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é…")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("å¤§å¤šæ•°æƒ…å†µä¸‹, å¯¹è±¡åœ¨æ–°ç”Ÿä»£ Eden åŒºä¸­åˆ†é…. å½“ Eden åŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶, è™šæ‹Ÿæœºå°†å‘èµ·ä¸€æ¬¡ Minor GC")])]),s._v(".")]),s._v(" "),t("p",[s._v("HotSpot è™šæ‹Ÿæœºæä¾›äº† "),t("code",[s._v("-XX: +PrintGCDetails")]),s._v("â€‹ è¿™ä¸ªæ”¶é›†å™¨æ—¥å¿—å‚æ•°, å‘Šè¯‰è™šæ‹Ÿæœºåœ¨å‘ç”Ÿåƒåœ¾æ”¶é›†è¡Œä¸ºæ—¶æ‰“å°å†…å­˜å›æ”¶æ—¥å¿—, å¹¶ä¸”åœ¨è¿›ç¨‹é€€å‡ºçš„æ—¶å€™è¾“å‡ºå½“å‰çš„å†…å­˜å„åŒºåŸŸåˆ†é…æƒ…å†µ. åœ¨å®é™…çš„é—®é¢˜æ’æŸ¥ä¸­, æ”¶é›†å™¨æ—¥å¿—å¸¸ä¼šæ‰“å°åˆ°æ–‡ä»¶åé€šè¿‡å·¥å…·è¿›è¡Œåˆ†æ, ä¸è¿‡æœ¬èŠ‚å®éªŒçš„æ—¥å¿—å¹¶ä¸å¤š, ç›´æ¥é˜…è¯»å°±èƒ½çœ‹å¾—å¾ˆæ¸…æ¥š.")]),s._v(" "),t("blockquote",[t("p",[s._v("æ–°ç”Ÿä»£ Minor GCç¤ºä¾‹")])]),s._v(" "),t("p",[s._v("åœ¨ä¸‹é¢ä»£ç çš„ testAllocation() æ–¹æ³•ä¸­, å°è¯•åˆ†é…ä¸‰ä¸ª 2MB å¤§å°å’Œä¸€ä¸ª 4MB å¤§å°çš„å¯¹è±¡, åœ¨è¿è¡Œæ—¶é€šè¿‡ "),t("code",[s._v("-Xms20M, -Xmx20M, -Xmn10M")]),s._v("â€‹ è¿™ä¸‰ä¸ªå‚æ•°é™åˆ¶äº† Java å †å¤§å°ä¸º 20MB, ä¸å¯æ‰©å±•, å…¶ä¸­ 10MB åˆ†é…ç»™æ–°ç”Ÿä»£, å‰©ä¸‹çš„ 10MB åˆ†é…ç»™è€å¹´ä»£. "),t("code",[s._v("-XX: Survivor-Ratio=8")]),s._v('â€‹ å†³å®šäº†æ–°ç”Ÿä»£ä¸­ Eden åŒºä¸ä¸€ä¸ª Survivor åŒºçš„ç©ºé—´æ¯”ä¾‹æ˜¯ 8âˆ¶1, ä»è¾“å‡ºçš„ç»“æœä¹Ÿæ¸…æ™°åœ°çœ‹åˆ° "'),t("code",[s._v("eden space 8192K, from space 1024K, to space 1024K")]),s._v('â€‹" çš„ä¿¡æ¯, æ–°ç”Ÿä»£æ€»å¯ç”¨ç©ºé—´ä¸º 9216KB(Eden åŒº + 1 ä¸ª Survivor åŒºçš„æ€»å®¹é‡).')]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" _1MB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * VM å‚æ•°: -verbose:gc -Xms20M -Xmx20M -Xmn10M -XX:+PrintGCDetails -XX:SurvivorRatio=8\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testAllocation")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" allocation1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// å‡ºç°ä¸€æ¬¡ Minor GC")]),s._v("\n    allocation4 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("è¿è¡Œç»“æœ:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[GC [DefNew: 6651K->148K(9216K), 0.0070106 secs] 6651K->6292K(19456K), 0.0070426 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]\nHeap\n    def new generation   total 9216K, used 4326K [0x029d0000, 0x033d0000, 0x033d0000)\n        eden space 8192K,  51% used [0x029d0000, 0x02de4828, 0x031d0000)\n        from space 1024K,  14% used [0x032d0000, 0x032f5370, 0x033d0000)\n        to   space 1024K,   0% used [0x031d0000, 0x031d0000, 0x032d0000)\n    tenured generation   total 10240K, used 6144K [0x033d0000, 0x03dd0000, 0x03dd0000)\n            the space 10240K,  60% used [0x033d0000, 0x039d0030, 0x039d0200, 0x03dd0000)\n    compacting perm gen  total 12288K, used 2114K [0x03dd0000, 0x049d0000, 0x07dd0000)\n            the space 12288K,  17% used [0x03dd0000, 0x03fe0998, 0x03fe0a00, 0x049d0000)\nNo shared spaces configured.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("æ‰§è¡Œ testAllocation() ä¸­"),t("strong",[s._v("åˆ†é… allocation4 å¯¹è±¡")]),s._v("çš„è¯­å¥æ—¶ä¼šå‘ç”Ÿä¸€æ¬¡ Minor GC, è¿™æ¬¡å›æ”¶çš„ç»“æœæ˜¯æ–°ç”Ÿä»£ 6651KB å˜ä¸º 148KB, è€Œæ€»å†…å­˜å ç”¨é‡åˆ™å‡ ä¹æ²¡æœ‰å‡å°‘(å› ä¸º allocation1, 2, 3 ä¸‰ä¸ªå¯¹è±¡éƒ½æ˜¯å­˜æ´»çš„, è™šæ‹Ÿæœºå‡ ä¹æ²¡æœ‰æ‰¾åˆ°å¯å›æ”¶çš„å¯¹è±¡). "),t("strong",[s._v("äº§ç”Ÿè¿™æ¬¡åƒåœ¾æ”¶é›†çš„åŸå› æ˜¯ä¸º allocation4 åˆ†é…å†…å­˜æ—¶, å‘ç° Eden å·²ç»è¢«å ç”¨äº† 6MB, å‰©ä½™ç©ºé—´å·²ä¸è¶³ä»¥åˆ†é… allocation4 æ‰€éœ€çš„ 4MB å†…å­˜, å› æ­¤å‘ç”Ÿ Minor GC. åƒåœ¾æ”¶é›†æœŸé—´è™šæ‹Ÿæœºåˆå‘ç°å·²æœ‰çš„ä¸‰ä¸ª 2MB å¤§å°çš„å¯¹è±¡å…¨éƒ¨æ— æ³•æ”¾å…¥ Survivor ç©ºé—´(Survivor ç©ºé—´åªæœ‰ 1MB å¤§å°), æ‰€ä»¥åªå¥½é€šè¿‡åˆ†é…æ‹…ä¿æœºåˆ¶æå‰è½¬ç§»åˆ°è€å¹´ä»£å»")]),s._v(".")]),s._v(" "),t("p",[s._v("è¿™æ¬¡æ”¶é›†ç»“æŸå, 4MB çš„ allocation4 å¯¹è±¡é¡ºåˆ©åˆ†é…åœ¨ Eden ä¸­. å› æ­¤ç¨‹åºæ‰§è¡Œå®Œçš„ç»“æœæ˜¯ Eden å ç”¨ 4MB(è¢« allocation4 å ç”¨), Survivor ç©ºé—², è€å¹´ä»£è¢«å ç”¨ 6MB(è¢«æŒªè¿‡å»çš„ allocation1, 2, 3 å ç”¨). é€šè¿‡ GC æ—¥å¿—å°±å¯ä»¥è¯å®è¿™ä¸€ç‚¹.")]),s._v(" "),t("blockquote",[t("p",[s._v("Edenä¸SurvivoråŒºé»˜è®¤8:1:1")])]),s._v(" "),t("p",[s._v("å¤§é‡çš„å¯¹è±¡è¢«åˆ†é…åœ¨ "),t("strong",[s._v("eden åŒº")]),s._v(", eden åŒºæ»¡äº†åä¼šè§¦å‘ "),t("strong",[s._v("Minor GC")]),s._v(", å¯èƒ½ä¼šæœ‰ 99% ä»¥ä¸Šçš„å¯¹è±¡æˆä¸ºåƒåœ¾è¢«å›æ”¶æ‰, å‰©ä½™å­˜æ´»çš„å¯¹è±¡ä¼šè¢«æŒªåˆ°ä¸ºç©ºçš„é‚£å— survivor åŒº, ä¸‹ä¸€æ¬¡ eden åŒºæ»¡äº†ååˆä¼šè§¦å‘ Minor GC, æŠŠ eden åŒºå’Œ survivor åŒºçš„åƒåœ¾å¯¹è±¡å›æ”¶, æŠŠå‰©ä½™å­˜æ´»çš„å¯¹è±¡ä¸€æ¬¡æ€§æŒªåŠ¨åˆ°å¦å¤–ä¸€å—ä¸ºç©ºçš„ survivor åŒº, å› ä¸ºæ–°ç”Ÿä»£çš„å¯¹è±¡å¤§éƒ¨åˆ†éƒ½æ˜¯æœç”Ÿå¤•æ­»çš„, "),t("strong",[s._v("å­˜æ´»æ—¶é—´å¾ˆçŸ­, æ‰€ä»¥ JVM é»˜è®¤çš„ 8:1:1 çš„æ¯”ä¾‹æ˜¯å¾ˆåˆé€‚çš„")]),s._v(", è®© eden åŒºå°½é‡çš„å¤§, survivor åŒºå¤Ÿç”¨å³å¯.")]),s._v(" "),t("p",[s._v("JVM é»˜è®¤æœ‰è¿™ä¸ªå‚æ•° -XX:+UseAdaptiveSizePolicy(é»˜è®¤å¼€å¯), ä¼šå¯¼è‡´è¿™ä¸ª 8:1:1 æ¯”ä¾‹è‡ªåŠ¨å˜åŒ–, å› æ­¤çº¿ä¸Šå®é™…å¯èƒ½ä¸æ˜¯è¿™ä¸ªæ¯”ä¾‹å€¼. å¦‚æœä¸æƒ³è¿™ä¸ªæ¯”ä¾‹æœ‰å˜åŒ–å¯ä»¥è®¾ç½®å‚æ•° -XX:-UseAdaptiveSizePolicy.")]),s._v(" "),t("h5",{attrs:{id:"_3-å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"}},[s._v("#")]),s._v(" 3.å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£")]),s._v(" "),t("p",[t("strong",[s._v("å¤§å¯¹è±¡å°±æ˜¯æŒ‡éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„ Java å¯¹è±¡, æœ€å…¸å‹çš„å¤§å¯¹è±¡ä¾¿æ˜¯é‚£ç§å¾ˆé•¿çš„å­—ç¬¦ä¸², æˆ–è€…å…ƒç´ æ•°é‡å¾ˆåºå¤§çš„æ•°ç»„")]),s._v(', æœ¬èŠ‚ä¾‹å­ä¸­çš„ byte[] æ•°ç»„å°±æ˜¯å…¸å‹çš„å¤§å¯¹è±¡. å¤§å¯¹è±¡å¯¹è™šæ‹Ÿæœºçš„å†…å­˜åˆ†é…æ¥è¯´å°±æ˜¯ä¸€ä¸ªä¸æŠ˜ä¸æ‰£çš„åæ¶ˆæ¯, æ¯”é‡åˆ°ä¸€ä¸ªå¤§å¯¹è±¡æ›´åŠ åçš„æ¶ˆæ¯å°±æ˜¯é‡åˆ°ä¸€ç¾¤ "æœç”Ÿå¤•ç­" çš„ "çŸ­å‘½å¤§å¯¹è±¡", å†™ç¨‹åºçš„æ—¶å€™åº”æ³¨æ„é¿å…. åœ¨ Java è™šæ‹Ÿæœºä¸­è¦'),t("strong",[s._v("é¿å…å¤§å¯¹è±¡")]),s._v("çš„åŸå› æ˜¯, åœ¨åˆ†é…ç©ºé—´æ—¶, å®ƒ"),t("strong",[s._v("å®¹æ˜“å¯¼è‡´å†…å­˜æ˜æ˜è¿˜æœ‰ä¸å°‘ç©ºé—´æ—¶å°±æå‰è§¦å‘åƒåœ¾æ”¶é›†")]),s._v(", ä»¥è·å–è¶³å¤Ÿçš„è¿ç»­ç©ºé—´æ‰èƒ½å®‰ç½®å¥½å®ƒä»¬, è€Œå½“å¤åˆ¶å¯¹è±¡æ—¶, å¤§å¯¹è±¡å°±æ„å‘³ç€é«˜é¢çš„å†…å­˜å¤åˆ¶å¼€é”€. HotSpot è™šæ‹Ÿæœºæä¾›äº† "),t("code",[s._v("-XX: PretenureSizeThreshold")]),s._v("â€‹ å‚æ•°, "),t("mark",[t("strong",[s._v("æŒ‡å®šå¤§äºè¯¥è®¾ç½®å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…, è¿™æ ·åšçš„ç›®çš„å°±æ˜¯é¿å…åœ¨ Eden åŒºåŠä¸¤ä¸ª Survivor åŒºä¹‹é—´æ¥å›å¤åˆ¶, äº§ç”Ÿå¤§é‡çš„å†…å­˜å¤åˆ¶æ“ä½œ")])]),s._v(".")]),s._v(" "),t("p",[t("strong",[s._v("ä¸ºä»€ä¹ˆè¦è¿™æ ·å‘¢?")]),s._v(" "),t("strong",[t("strong",[s._v("è¿™æ˜¯ä¸ºäº†é¿å…ä¸º")])]),s._v("â€‹"),t("strong",[s._v("å¤§å¯¹è±¡åˆ†é…å†…å­˜æ—¶çš„å¤åˆ¶æ“ä½œè€Œé™ä½æ•ˆç‡")]),s._v(". ä¸¾ä¸ªä¾‹å­: å¦‚æœ Eden åŒº 60M, From å’Œ To éƒ½æ˜¯ 10M, å½“ä¸€ä¸ªå¯¹è±¡ 4M æ—¶, å‡è®¾ä¼šä¸€ç›´å¼•ç”¨è¿™ä¸ªå¯¹è±¡, é‚£ä¹ˆè¿™ä¸ª 4M çš„å¯¹è±¡å°±ä¼šå› ä¸º Minor GC åœ¨ From å’Œ To ä¹‹é—´ä¸æ–­ç§»åŠ¨, å½±å“ GC æ€§èƒ½.")]),s._v(" "),t("blockquote",[t("p",[s._v("å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ç¤ºä¾‹")])]),s._v(" "),t("p",[s._v("æ‰§è¡Œä¸‹é¢ä»£ç ä¸­çš„ testPretenureSizeThreshold() æ–¹æ³•å, å¯ä»¥çœ‹åˆ° Eden ç©ºé—´å‡ ä¹æ²¡æœ‰è¢«ä½¿ç”¨, è€Œè€å¹´ä»£çš„ 10MB ç©ºé—´è¢«ä½¿ç”¨äº† 40%, ä¹Ÿå°±æ˜¯ 4MB çš„ allocation å¯¹è±¡"),t("strong",[s._v("ç›´æ¥å°±åˆ†é…åœ¨è€å¹´ä»£")]),s._v("ä¸­, è¿™æ˜¯å› ä¸º "),t("code",[s._v("-XX: PretenureSizeThreshold")]),s._v("â€‹ è¢«è®¾ç½®ä¸º 3MB(å°±æ˜¯ 3145728, è¿™ä¸ªå‚æ•°ä¸èƒ½ä¸ "),t("code",[s._v("-Xmx")]),s._v("â€‹ ä¹‹ç±»çš„å‚æ•°ä¸€æ ·ç›´æ¥å†™ 3MB), å› æ­¤è¶…è¿‡ 3MB çš„å¯¹è±¡éƒ½ä¼šç›´æ¥åœ¨è€å¹´ä»£è¿›è¡Œåˆ†é….")]),s._v(" "),t("p",[s._v("æ³¨æ„: "),t("code",[s._v("-XX: PretenureSizeThreshold")]),s._v("â€‹ å‚æ•°"),t("strong",[s._v("åªå¯¹ Serial å’Œ ParNew ä¸¤æ¬¾æ–°ç”Ÿä»£æ”¶é›†å™¨æœ‰æ•ˆ")]),s._v(", HotSpot çš„å…¶ä»–æ–°ç”Ÿä»£æ”¶é›†å™¨, å¦‚ Parallel Scavenge å¹¶ä¸æ”¯æŒè¿™ä¸ªå‚æ•°. å¦‚æœå¿…é¡»ä½¿ç”¨æ­¤å‚æ•°è¿›è¡Œè°ƒä¼˜, å¯è€ƒè™‘ ParNew åŠ  CMS çš„æ”¶é›†å™¨ç»„åˆ.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" _1MB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * VM å‚æ•°: -verbose:gc -Xms20M -Xmx20M -Xmn10M -XX:+PrintGCDetails -XX:SurvivorRatio=8\n * -XX:PretenureSizeThreshold=3145728  æŒ‡å®šå¤§å¯¹è±¡é˜ˆå€¼ä¸º3M\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testPretenureSizeThreshold")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" allocation"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ç›´æ¥åˆ†é…åœ¨è€å¹´ä»£ä¸­")]),s._v("\n    allocation "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("è¿è¡Œç»“æœ:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Heap\n    def new generation   total 9216K, used 671K [0x029d0000, 0x033d0000, 0x033d0000)\n        eden space 8192K,   8% used [0x029d0000, 0x02a77e98, 0x031d0000)\n        from space 1024K,   0% used [0x031d0000, 0x031d0000, 0x032d0000)\n        to   space 1024K,   0% used [0x032d0000, 0x032d0000, 0x033d0000)\n    tenured generation   total 10240K, used 4096K [0x033d0000, 0x03dd0000, 0x03dd0000)\n            the space 10240K,  40% used [0x033d0000, 0x037d0010, 0x037d0200, 0x03dd0000)\n    compacting perm gen  total 12288K, used 2107K [0x03dd0000, 0x049d0000, 0x07dd0000)\n            the space 12288K,  17% used [0x03dd0000, 0x03fdefd0, 0x03fdf000, 0x049d0000)\nNo shared spaces configured.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h5",{attrs:{id:"_4-é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£"}},[s._v("#")]),s._v(" 4.é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£")]),s._v(" "),t("p",[s._v("HotSpot è™šæ‹Ÿæœºä¸­å¤šæ•°æ”¶é›†å™¨éƒ½é‡‡ç”¨äº†åˆ†ä»£æ”¶é›†æ¥ç®¡ç†å †å†…å­˜, é‚£å†…å­˜å›æ”¶æ—¶å°±å¿…é¡»èƒ½å†³ç­–å“ªäº›å­˜æ´»å¯¹è±¡åº”å½“æ”¾åœ¨æ–°ç”Ÿä»£, å“ªäº›å­˜æ´»å¯¹è±¡æ”¾åœ¨è€å¹´ä»£ä¸­. ä¸ºåšåˆ°è¿™ç‚¹, "),t("strong",[s._v("è™šæ‹Ÿæœºç»™æ¯ä¸ªå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡å¹´é¾„(Age)è®¡æ•°å™¨, å­˜å‚¨åœ¨å¯¹è±¡å¤´ä¸­")]),s._v("(å‚è€ƒ: å¯¹è±¡å¤´). "),t("strong",[s._v("å¯¹è±¡é€šå¸¸åœ¨ Eden åŒºé‡Œè¯ç”Ÿ, å¦‚æœç»è¿‡ç¬¬ä¸€æ¬¡ Minor GC åä»ç„¶å­˜æ´», å¹¶ä¸”èƒ½è¢« Survivor å®¹çº³çš„è¯, è¯¥å¯¹è±¡ä¼šè¢«ç§»åŠ¨åˆ° Survivor ç©ºé—´ä¸­, å¹¶ä¸”å°†å…¶å¯¹è±¡å¹´é¾„è®¾ä¸º1å². å¯¹è±¡åœ¨ Survivor åŒºä¸­æ¯ç†¬è¿‡ä¸€æ¬¡ Minor GC, å¹´é¾„å°±å¢åŠ  1 å², å½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦(é»˜è®¤ä¸º 15), å°±ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­. å¯¹è±¡æ™‹å‡è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼")]),s._v(", å¯ä»¥é€šè¿‡å‚æ•° "),t("code",[s._v("-XX: MaxTenuringThreshold")]),s._v("â€‹ è®¾ç½®.")]),s._v(" "),t("blockquote",[t("p",[s._v("é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ç¤ºä¾‹")])]),s._v(" "),t("p",[s._v("å¯ä»¥è¯•è¯•åˆ†åˆ«ä»¥ "),t("code",[s._v("-XX: MaxTenuringThreshold=1")]),s._v("â€‹ å’Œ "),t("code",[s._v("-XX: MaxTenuringThreshold=15")]),s._v("â€‹ ä¸¤ç§è®¾ç½®æ¥æ‰§è¡Œä¸‹é¢ä»£ç ä¸­çš„ testTenuringThreshold() æ–¹æ³•, æ­¤æ–¹æ³•ä¸­ allocation1 å¯¹è±¡éœ€è¦ 256KB å†…å­˜, Survivor ç©ºé—´å¯ä»¥å®¹çº³. å½“ "),t("code",[s._v("-XX: MaxTenuringThreshold=1")]),s._v("â€‹ æ—¶, allocation1 å¯¹è±¡åœ¨ç¬¬äºŒæ¬¡ GC å‘ç”Ÿæ—¶è¿›å…¥è€å¹´ä»£, æ–°ç”Ÿä»£å·²ä½¿ç”¨çš„å†…å­˜åœ¨åƒåœ¾æ”¶é›†ä»¥åéå¸¸å¹²å‡€åœ°å˜æˆ 0KB. è€Œå½“ "),t("code",[s._v("-XX: MaxTenuringThreshold=15")]),s._v("â€‹ æ—¶, ç¬¬äºŒæ¬¡ GC å‘ç”Ÿå, allocation1 å¯¹è±¡åˆ™è¿˜ç•™åœ¨æ–°ç”Ÿä»£ Survivor ç©ºé—´, è¿™æ—¶å€™æ–°ç”Ÿä»£ä»ç„¶æœ‰ 404KB è¢«å ç”¨.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" _1MB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * VM å‚æ•°: -verbose:gc -Xms20M -Xmx20M -Xmn10M -XX:+PrintGCDetails -XX:Survivor-\n   Ratio=8 -XX:MaxTenuringThreshold=1\n * -XX:+PrintTenuringDistribution\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SuppressWarnings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unused"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testTenuringThreshold")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" allocation1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä»€ä¹ˆæ—¶å€™è¿›å…¥è€å¹´ä»£å†³å®šäº XX:MaxTenuring-Threshold è®¾ç½®")]),s._v("\n    allocation1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("_1MB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   \n    allocation2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("ä»¥ "),t("code",[s._v("-XX: MaxTenuringThreshold=1")]),s._v("â€‹ å‚æ•°æ¥è¿è¡Œçš„ç»“æœ:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[GC [DefNew\nDesired Survivor size 524288 bytes, new threshold 1 (max 1)\n- age   1:     414664 bytes,     414664 total\n: 4859K->404K(9216K), 0.0065012 secs] 4859K->4500K(19456K), 0.0065283 secs] [Times: user=0.02 sys=0.00, real=0.02 secs]\n[GC [DefNew\nDesired Survivor size 524288 bytes, new threshold 1 (max 1)\n: 4500K->0K(9216K), 0.0009253 secs] 8596K->4500K(19456K), 0.0009458 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]\nHeap\n    def new generation   total 9216K, used 4178K [0x029d0000, 0x033d0000, 0x033d0000)\n        eden space 8192K,  51% used [0x029d0000, 0x02de4828, 0x031d0000)\n        from space 1024K,   0% used [0x031d0000, 0x031d0000, 0x032d0000)\n        to   space 1024K,   0% used [0x032d0000, 0x032d0000, 0x033d0000)\n    tenured generation   total 10240K, used 4500K [0x033d0000, 0x03dd0000, 0x03dd0000)\n            the space 10240K,  43% used [0x033d0000, 0x03835348, 0x03835400, 0x03dd0000)\n    com\\pacting perm gen  total 12288K, used 2114K [0x03dd0000, 0x049d0000, 0x07dd0000)\n            the space 12288K,  17% used [0x03dd0000, 0x03fe0998, 0x03fe0a00, 0x049d0000)\nNo shared spaces configured.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("ä»¥ "),t("code",[s._v("-XX: MaxTenuringThreshold=15")]),s._v("â€‹ å‚æ•°æ¥è¿è¡Œçš„ç»“æœ:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[GC [DefNew\nDesired Survivor size 524288 bytes, new threshold 15 (max 15)\n- age   1:     414664 bytes,     414664 total\n: 4859K->404K(9216K), 0.0049637 secs] 4859K->4500K(19456K), 0.0049932 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]\n[GC [DefNew\nDesired Survivor size 524288 bytes, new threshold 15 (max 15)\n- age   2:     414520 bytes,     414520 total\n: 4500K->404K(9216K), 0.0008091 secs] 8596K->4500K(19456K), 0.0008305 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]\nHeap\n    def new generation   total 9216K, used 4582K [0x029d0000, 0x033d0000, 0x033d0000)\n        eden space 8192K,  51% used [0x029d0000, 0x02de4828, 0x031d0000)\n        from space 1024K,  39% used [0x031d0000, 0x03235338, 0x032d0000)\n        to   space 1024K,   0% used [0x032d0000, 0x032d0000, 0x033d0000)\n    tenured generation   total 10240K, used 4096K [0x033d0000, 0x03dd0000, 0x03dd0000)\n            the space 10240K,  40% used [0x033d0000, 0x037d0010, 0x037d0200, 0x03dd0000)\n    compacting perm gen  total 12288K, used 2114K [0x03dd0000, 0x049d0000, 0x07dd0000)\n            the space 12288K,  17% used [0x03dd0000, 0x03fe0998, 0x03fe0a00, 0x049d0000)\nNo shared spaces configured.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h5",{attrs:{id:"_5-åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š"}},[s._v("#")]),s._v(" 5.åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š")]),s._v(" "),t("p",[s._v("ä¸ºäº†èƒ½æ›´å¥½åœ°é€‚åº”ä¸åŒç¨‹åºçš„å†…å­˜çŠ¶å†µ, HotSpot è™šæ‹Ÿæœºå¹¶"),t("strong",[s._v("ä¸æ˜¯æ°¸è¿œè¦æ±‚")]),s._v("å¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ° "),t("code",[s._v("-XX: MaxTenuringThreshold")]),s._v("â€‹ æ‰èƒ½æ™‹å‡è€å¹´ä»£, "),t("mark",[t("strong",[s._v("å¦‚æœåœ¨ Survivor ç©ºé—´ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivor ç©ºé—´çš„ä¸€åŠ, å¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£")])]),s._v(", æ— é¡»ç­‰åˆ° "),t("code",[s._v("-XX: MaxTenuringThreshold")]),s._v("â€‹ ä¸­è¦æ±‚çš„å¹´é¾„.")]),s._v(" "),t("p",[s._v("å¯¹è±¡åŠ¨æ€å¹´é¾„åˆ¤æ–­æœºåˆ¶ä¸€èˆ¬æ˜¯åœ¨ Minor GC ä¹‹åè§¦å‘çš„.")]),s._v(" "),t("blockquote",[t("p",[s._v("åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®šç¤ºä¾‹")])]),s._v(" "),t("p",[s._v("æ‰§è¡Œä¸‹é¢ä»£ç ä¸­çš„ testTenuringThreshold2() æ–¹æ³•, å¹¶å°†è®¾ç½® "),t("code",[s._v("-XX: MaxTenuring-Threshold=15")]),s._v("â€‹, å‘ç°è¿è¡Œç»“æœä¸­ Survivor å ç”¨ä»ç„¶ä¸º 0%, è€Œè€å¹´ä»£æ¯”é¢„æœŸå¢åŠ äº† 6%, ä¹Ÿå°±æ˜¯è¯´ allocation1, allocation2 å¯¹è±¡éƒ½ç›´æ¥è¿›å…¥äº†è€å¹´ä»£, å¹¶æ²¡æœ‰ç­‰åˆ° 15 å²çš„ä¸´ç•Œå¹´é¾„. å› ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡åŠ èµ·æ¥å·²ç»åˆ°è¾¾äº† 512KB, å¹¶ä¸”å®ƒä»¬æ˜¯åŒå¹´é¾„çš„, "),t("strong",[s._v("æ»¡è¶³åŒå¹´å¯¹è±¡è¾¾åˆ° Survivor ç©ºé—´ä¸€åŠçš„è§„åˆ™")]),s._v(". åªè¦æ³¨é‡Šæ‰å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„ new æ“ä½œ, å°±ä¼šå‘ç°å¦å¤–ä¸€ä¸ªå°±ä¸ä¼šæ™‹å‡åˆ°è€å¹´ä»£äº†.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" _1MB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * VM å‚æ•°: -verbose:gc -Xms20M -Xmx20M -Xmn10M -XX:+PrintGCDetails -XX:SurvivorRatio=8\n   -XX:MaxTenuringThreshold=15\n * -XX:+PrintTenuringDistribution\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SuppressWarnings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unused"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testTenuringThreshold2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" allocation1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// allocation1+allocation2å¤§äº survivo ç©ºé—´ä¸€åŠ")]),s._v("\n    allocation1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("_1MB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n    allocation2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("_1MB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation4 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation4 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation4 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("p",[s._v("è¿è¡Œç»“æœ:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[GC [DefNew\nDesired Survivor size 524288 bytes, new threshold 1 (max 15)\n- age   1:     676824 bytes,     676824 total\n: 5115K->660K(9216K), 0.0050136 secs] 5115K->4756K(19456K), 0.0050443 secs] [Times: user=0.00 sys=0.01, real=0.01 secs]\n[GC [DefNew\nDesired Survivor size 524288 bytes, new threshold 15 (max 15)\n: 4756K->0K(9216K), 0.0010571 secs] 8852K->4756K(19456K), 0.0011009 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]\nHeap\n    def new generation   total 9216K, used 4178K [0x029d0000, 0x033d0000, 0x033d0000)\n        eden space 8192K,  51% used [0x029d0000, 0x02de4828, 0x031d0000)\n        from space 1024K,   0% used [0x031d0000, 0x031d0000, 0x032d0000)\n        to   space 1024K,   0% used [0x032d0000, 0x032d0000, 0x033d0000)\n    tenured generation   total 10240K, used 4756K [0x033d0000, 0x03dd0000, 0x03dd0000)\n            the space 10240K,  46% used [0x033d0000, 0x038753e8, 0x03875400, 0x03dd0000)\n    compacting perm gen  total 12288K, used 2114K [0x03dd0000, 0x049d0000, 0x07dd0000)\n        the space 12288K,  17% used [0x03dd0000, 0x03fe09a0, 0x03fe0a00, 0x049d0000)\nNo shared spaces configured.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h5",{attrs:{id:"_6-è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶"}},[s._v("#")]),s._v(" 6.è€å¹´ä»£ç©ºé—´åˆ†é…æ‹…ä¿æœºåˆ¶")]),s._v(" "),t("p",[t("mark",[t("strong",[s._v("åœ¨å‘ç”Ÿ Minor GC ä¹‹å‰, è™šæ‹Ÿæœºå¿…é¡»å…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´, å¦‚æœè¿™ä¸ªæ¡ä»¶æˆç«‹, é‚£è¿™ä¸€æ¬¡ Minor GC å¯ä»¥ç¡®ä¿æ˜¯å®‰å…¨çš„")])]),s._v(". å¦‚æœä¸æˆç«‹, åˆ™è™šæ‹Ÿæœºä¼šå…ˆæŸ¥çœ‹ "),t("code",[s._v("-XX: HandlePromotionFailure")]),s._v("â€‹ å‚æ•°çš„è®¾ç½®å€¼"),t("strong",[s._v("æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥")]),s._v("(Handle Promotion Failure); å¦‚æœå…è®¸, é‚£ä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°, å¦‚æœå¤§äº, å°†"),t("mark",[t("strong",[s._v("å°è¯•è¿›è¡Œä¸€æ¬¡ Minor GC, å°½ç®¡è¿™æ¬¡ Minor GC æ˜¯æœ‰é£é™©çš„")])]),s._v("; å¦‚æœå°äº, æˆ–è€… "),t("code",[s._v("-XX: HandlePromotionFailure")]),s._v("â€‹ è®¾ç½®"),t("strong",[s._v("ä¸å…è®¸å†’é™©")]),s._v(", é‚£è¿™æ—¶å°±è¦æ”¹ä¸º"),t("mark",[t("strong",[s._v("è¿›è¡Œä¸€æ¬¡ Full GC")])]),s._v('. è¿™æ—¶ä¼šå¯¹è€å¹´ä»£å’Œå¹´è½»ä»£ä¸€èµ·å›æ”¶ä¸€æ¬¡åƒåœ¾, å¦‚æœå›æ”¶å®Œè¿˜æ˜¯æ²¡æœ‰è¶³å¤Ÿç©ºé—´å­˜æ”¾æ–°çš„å¯¹è±¡å°±ä¼šå‘ç”Ÿ "'),t("strong",[s._v("OOM")]),s._v('".')]),s._v(" "),t("p",[t("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20220521114637643.png",alt:""}})]),s._v(" "),t("p",[s._v('è§£é‡Šä¸€ä¸‹ "å†’é™©" æ˜¯å†’äº†ä»€ä¹ˆé£é™©: å‰é¢æåˆ°è¿‡, æ–°ç”Ÿä»£ä½¿ç”¨å¤åˆ¶æ”¶é›†ç®—æ³•, ä½†ä¸ºäº†å†…å­˜åˆ©ç”¨ç‡, åªä½¿ç”¨å…¶ä¸­ä¸€ä¸ª Survivor ç©ºé—´æ¥ä½œä¸ºè½®æ¢å¤‡ä»½, å› æ­¤å½“å‡ºç°å¤§é‡å¯¹è±¡åœ¨ Minor GC åä»ç„¶å­˜æ´»çš„æƒ…å†µ, æœ€æç«¯çš„æƒ…å†µå°±æ˜¯'),t("strong",[s._v("å†…å­˜å›æ”¶åæ–°ç”Ÿä»£ä¸­æ‰€æœ‰å¯¹è±¡éƒ½å­˜æ´», éœ€è¦è€å¹´ä»£è¿›è¡Œåˆ†é…æ‹…ä¿(è¿™å°±æ˜¯è€å¹´ä»£ç©ºé—´æ‹…ä¿æœºåˆ¶), æŠŠ Survivor æ— æ³•å®¹çº³çš„å¯¹è±¡ç›´æ¥é€å…¥è€å¹´ä»£")]),s._v(", è¿™ä¸ç”Ÿæ´»ä¸­è´·æ¬¾æ‹…ä¿ç±»ä¼¼. è€å¹´ä»£è¦è¿›è¡Œè¿™æ ·çš„æ‹…ä¿, å‰ææ˜¯è€å¹´ä»£æœ¬èº«è¿˜æœ‰å®¹çº³è¿™äº›å¯¹è±¡çš„å‰©ä½™ç©ºé—´, ä½†ä¸€å…±æœ‰å¤šå°‘å¯¹è±¡ä¼šåœ¨è¿™æ¬¡å›æ”¶ä¸­æ´»ä¸‹æ¥åœ¨å®é™…å®Œæˆå†…å­˜å›æ”¶ä¹‹å‰æ˜¯æ— æ³•æ˜ç¡®çŸ¥é“çš„, æ‰€ä»¥"),t("strong",[s._v("åªèƒ½å–ä¹‹å‰æ¯ä¸€æ¬¡å›æ”¶æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡å®¹é‡çš„å¹³å‡å¤§å°ä½œä¸ºç»éªŒå€¼, ä¸è€å¹´ä»£çš„å‰©ä½™ç©ºé—´è¿›è¡Œæ¯”è¾ƒ, å†³å®šæ˜¯å¦è¿›è¡Œ Full GC æ¥è®©è€å¹´ä»£è…¾å‡ºæ›´å¤šç©ºé—´")]),s._v(".")]),s._v(" "),t("p",[s._v("è¿™é‡Œå…¶å®å°±æ˜¯"),t("strong",[s._v("å‡è®¾")]),s._v("å¹´è½»ä»£çš„"),t("strong",[s._v("å…¨éƒ¨å¯¹è±¡")]),s._v("éƒ½çªç„¶ä¸€ä¸‹å­æ”¾åˆ°è€å¹´ä»£ä¸­, å¦‚æœè€å¹´ä»£"),t("strong",[s._v("éƒ½èƒ½æ”¾å¾—ä¸‹")]),s._v(", å°±å¯ä»¥"),t("strong",[s._v("æ”¾å¿ƒåš Minor GC")]),s._v("äº†, å› ä¸º Minor GC "),t("strong",[s._v("æœ€å¤š")]),s._v("ä¹Ÿå°±æ˜¯æŠŠå¹´è½»ä»£çš„å…¨éƒ¨å¯¹è±¡éƒ½æ”¾åˆ°è€å¹´ä»£ä¸­, å¦‚æœä¸èƒ½å…¨éƒ¨æ”¾ä¸‹, é‚£å°±éœ€è¦è€ƒè™‘ä¸€ä¸‹æ˜¯"),t("strong",[s._v("å¦æœ‰å¿…è¦æ‰§è¡Œä¸€æ¬¡ Full GC")]),s._v(" æ¥æ¸…ç†è€å¹´ä»£çš„ç©ºé—´æ¥å­˜æ”¾å¯èƒ½åˆ°æ¥çš„å¹´è½»ä»£å¯¹è±¡äº†. "),t("strong",[s._v("æ‹…ä¿çš„å«ä¹‰")]),s._v("å°±æ˜¯æ‹…ä¿è€å¹´ä»£ä¸­ä¸€å®šæœ‰ç©ºé—´æ¥å­˜æ”¾å¹´è½»ä»£ä¸­å¯èƒ½æ¥çš„å¯¹è±¡.")]),s._v(" "),t("p",[t("strong",[s._v("å–å†å²å¹³å‡å€¼")]),s._v("æ¥æ¯”è¾ƒå…¶å®ä»ç„¶æ˜¯ä¸€ç§èµŒæ¦‚ç‡çš„è§£å†³åŠæ³•, ä¹Ÿå°±æ˜¯è¯´å‡å¦‚æŸæ¬¡ Minor GC å­˜æ´»åçš„å¯¹è±¡çªå¢, è¿œè¿œé«˜äºå†å²å¹³å‡å€¼çš„è¯, ä¾ç„¶ä¼šå¯¼è‡´æ‹…ä¿å¤±è´¥. å¦‚æœå‡ºç°äº†æ‹…ä¿å¤±è´¥, é‚£å°±åªå¥½è€è€å®å®åœ°é‡æ–°å‘èµ·ä¸€æ¬¡ Full GC, è¿™æ ·åœé¡¿æ—¶é—´å°±å¾ˆé•¿äº†. è™½ç„¶æ‹…ä¿å¤±è´¥æ—¶ç»•çš„åœˆå­æ˜¯æœ€å¤§çš„, ä½†é€šå¸¸æƒ…å†µä¸‹éƒ½è¿˜æ˜¯ä¼šå°† "),t("code",[s._v("-XX: HandlePromotionFailure")]),s._v("â€‹ å¼€å…³"),t("strong",[s._v("æ‰“å¼€")]),s._v(", é¿å… Full GC è¿‡äºé¢‘ç¹.")]),s._v(" "),t("blockquote",[t("p",[s._v("ç©ºé—´åˆ†é…æ‹…ä¿ç¤ºä¾‹")])]),s._v(" "),t("p",[s._v("å‚è§ä¸‹é¢ä»£ç , è¯·å…ˆä»¥ JDK 6 Update 24 ä¹‹å‰çš„ HotSpot è¿è¡Œæµ‹è¯•ä»£ç .")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" _1MB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * VM å‚æ•°: -Xms20M -Xmx20M -Xmn10M -XX:+PrintGCDetails -XX:SurvivorRatio=8 -XX:-Handle-\n   PromotionFailure\n */")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@SuppressWarnings")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unused"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testHandlePromotion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" allocation1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation5"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" alloca"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("tion6"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation7"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation4 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation5 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation6 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation4 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation5 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation6 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation7 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" _1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("p",[s._v("ä»¥ "),t("code",[s._v("-XX: HandlePromotionFailure=false")]),s._v("â€‹ å‚æ•°æ¥è¿è¡Œçš„ç»“æœ:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[GC [DefNew: 6651K->148K(9216K), 0.0078936 secs] 6651K->4244K(19456K), 0.0079192 secs] [Times: user=0.00 sys=0.02, real=0.02 secs]\n[GC [DefNew: 6378K->6378K(9216K), 0.0000206 secs][Tenured: 4096K->4244K(10240K), 0.0042901 secs] 10474K->4244K(19456K), [Perm : 2104K->2104K(12288K)], 0.0043613 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("ä»¥ "),t("code",[s._v("-XX: HandlePromotionFailure=true")]),s._v("â€‹ å‚æ•°æ¥è¿è¡Œçš„ç»“æœ:")]),s._v(" "),t("div",{staticClass:"language-ziti1 line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("[GC [DefNew: 6651K->148K(9216K), 0.0054913 secs] 6651K->4244K(19456K), 0.0055327 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]\n[GC [DefNew: 6378K->148K(9216K), 0.0006584 secs] 10474K->4244K(19456K), 0.0006857 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("åœ¨ JDK 6 Update 24 ä¹‹å, è¿™ä¸ªæµ‹è¯•ç»“æœå°±æœ‰äº†å·®å¼‚, "),t("code",[s._v("-XX: HandlePromotionFailure")]),s._v("â€‹ å‚æ•°"),t("strong",[s._v("ä¸ä¼šå†å½±å“åˆ°è™šæ‹Ÿæœºçš„ç©ºé—´åˆ†é…æ‹…ä¿ç­–ç•¥")]),s._v(", è§‚å¯Ÿ OpenJDK ä¸­çš„æºç å˜åŒ–(è§ä¸‹é¢ä»£ç æ¸…å•), è™½ç„¶æºç ä¸­è¿˜å®šä¹‰äº† "),t("code",[s._v("-XX: HandlePromotionFailure")]),s._v("â€‹ å‚æ•°, ä½†æ˜¯åœ¨å®é™…è™šæ‹Ÿæœºä¸­"),t("strong",[s._v("å·²ç»ä¸ä¼šå†ä½¿ç”¨å®ƒ")]),s._v(". JDK 6 Update 24 ä¹‹åçš„"),t("mark",[t("strong",[s._v("è§„åˆ™å˜ä¸ºåªè¦è€å¹´ä»£çš„è¿ç»­ç©ºé—´å¤§äºæ–°ç”Ÿä»£å¯¹è±¡æ€»å¤§å°æˆ–è€…å†æ¬¡æ™‹å‡çš„å¹³å‡å¤§å°, å°±ä¼šè¿›è¡Œ Minor GC, å¦åˆ™å°†è¿›è¡Œ Full GC")])]),s._v(".")]),s._v(" "),t("blockquote",[t("p",[s._v("HotSpot ä¸­ç©ºé—´åˆ†é…æ£€æŸ¥çš„ä»£ç ç‰‡æ®µ")])]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[s._v("bool TenuredGeneration"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("::")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("promotion_attempt_is_safe")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("size_t")]),s._v("\nmax_promotion_in_bytes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("size_t")]),s._v(" available "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("max_contiguous_available")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// æ¯æ¬¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¹³å‡å¤§å°")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("size_t")]),s._v(" av_promo "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("size_t")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gc_stats")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("avg_promoted")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("padded_average")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// è€å¹´ä»£å¯ç”¨ç©ºé—´æ˜¯å¦å¤§äºå¹³å‡æ™‹å‡å¤§å°, æˆ–è€…è€å¹´ä»£å¯ç”¨ç©ºé—´æ˜¯å¦å¤§äºå½“æ­¤ GC æ—¶æ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡å®¹é‡")]),s._v("\n    bool res "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("available "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" av_promo"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("available "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" max_promotion_in_bytes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" res"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h4",{attrs:{id:"å†…å­˜æ³„æ¼ä¸å†…å­˜æº¢å‡º"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜æ³„æ¼ä¸å†…å­˜æº¢å‡º"}},[s._v("#")]),s._v(" å†…å­˜æ³„æ¼ä¸å†…å­˜æº¢å‡º")]),s._v(" "),t("h5",{attrs:{id:"_1-å†…å­˜æ³„æ¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-å†…å­˜æ³„æ¼"}},[s._v("#")]),s._v(" 1.å†…å­˜æ³„æ¼")]),s._v(" "),t("h6",{attrs:{id:"_1-åŸºç¡€-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-åŸºç¡€-4"}},[s._v("#")]),s._v(" (1)åŸºç¡€")]),s._v(" "),t("p",[t("strong",[s._v("æŒ‡æ— ç”¨å¯¹è±¡(ä¸å†ä½¿ç”¨çš„å¯¹è±¡)æŒç»­å æœ‰å†…å­˜æˆ–æ— ç”¨å¯¹è±¡çš„å†…å­˜å¾—ä¸åˆ°åŠæ—¶é‡Šæ”¾")]),s._v(", ä»è€Œé€ æˆçš„å†…å­˜ç©ºé—´çš„æµªè´¹ç§°ä¸ºå†…å­˜æ³„éœ². æŸäº›å¯¹è±¡å¯ä»¥å…³è”åˆ° GC Roots å¯¹è±¡, ä½†æ˜¯åœ¨ä¸šåŠ¡ä¸Šå·²ç»ä¸éœ€è¦å†ä½¿ç”¨äº†, è¿™äº›å¯¹è±¡ä¸ä¼šè¢« GC æ‰€å›æ”¶, ç„¶è€Œå®ƒå´å ç”¨å†…å­˜, è¿™å°±ä¼šå¯¼è‡´å†…å­˜æ³„æ¼.")]),s._v(" "),t("h6",{attrs:{id:"_2-å†…å­˜æ³„æ¼åŸå› "}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å†…å­˜æ³„æ¼åŸå› "}},[s._v("#")]),s._v(" (2)å†…å­˜æ³„æ¼åŸå› ")]),s._v(" "),t("p",[t("strong",[s._v("é•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡æŒæœ‰çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡çš„å¼•ç”¨å°±å¾ˆå¯èƒ½å‘ç”Ÿå†…å­˜æ³„éœ²")]),s._v(", å°½ç®¡çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡å·²ç»ä¸å†éœ€è¦, ä½†æ˜¯"),t("strong",[s._v("å› ä¸ºé•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡æŒæœ‰å®ƒçš„å¼•ç”¨è€Œå¯¼è‡´ä¸èƒ½è¢«å›æ”¶")]),s._v(". å…·ä½“ä¸»è¦æœ‰å¦‚ä¸‹å‡ å¤§ç±»åœºæ™¯:")]),s._v(" "),t("blockquote",[t("p",[s._v("é™æ€é›†åˆç±»")])]),s._v(" "),t("p",[s._v("ä½¿ç”¨é™æ€é›†åˆç±», æ¯”å¦‚ Set, Vector, HashMap ç­‰é›†åˆç±»çš„æ—¶å€™éœ€è¦ç‰¹åˆ«æ³¨æ„. å½“è¿™äº›ç±»è¢«å®šä¹‰æˆ"),t("strong",[s._v("é™æ€")]),s._v("æ—¶, å…¶ç”Ÿå‘½å‘¨æœŸè·Ÿåº”ç”¨ç¨‹åºä¸€æ ·é•¿, è¿™æ—¶å€™å°±æœ‰å¯èƒ½å‘ç”Ÿå†…å­˜æ³„æ¼.")]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ä¾‹å­ ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("StaticTest")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vector")]),s._v(" v "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("init")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" \n            "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),s._v(" object "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Object")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n            v"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("object"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n            object "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("åœ¨ä¸Šé¢çš„ä»£ç ä¸­, å¾ªç¯ç”³è¯· object å¯¹è±¡, å¹¶æ·»åŠ åˆ° Vector ä¸­, ç„¶åè®¾ç½® object = null(å°±æ˜¯æ¸…é™¤æ ˆä¸­å¼•ç”¨å˜é‡ object), ä½†æ˜¯è¿™äº›å¯¹è±¡è¢« vector å¼•ç”¨ç€, å¿…ç„¶ä¸èƒ½è¢« GC å›æ”¶, é€ æˆå†…å­˜æ³„éœ². å› æ­¤è¦é‡Šæ”¾è¿™äº›å¯¹è±¡, è¿˜éœ€è¦å°†å®ƒä»¬ä» vector ä¸­åˆ é™¤.")]),s._v(" "),t("blockquote",[t("p",[s._v("ç›‘å¬å™¨æœªé‡Šæ”¾")])]),s._v(" "),t("p",[s._v("è®¸å¤šåœºæ™¯éƒ½éœ€è¦å’Œç›‘å¬å™¨æ‰“äº¤é“, é€šå¸¸ä¸€ä¸ªåº”ç”¨ä¸­ä¼šç”¨åˆ°å¾ˆå¤šç›‘å¬å™¨, ä½†å¾€å¾€åœ¨é‡Šæ”¾çš„æ—¶å€™å´æ²¡æœ‰å»åˆ é™¤è¿™äº›ç›‘å¬å™¨, ä»è€Œå¢åŠ äº†å†…å­˜æ³„æ¼çš„å¯èƒ½.")]),s._v(" "),t("blockquote",[t("p",[s._v("å„ç§è¿æ¥æœªå…³é—­")])]),s._v(" "),t("p",[s._v("æ¯”å¦‚"),t("strong",[s._v("æ•°æ®åº“è¿æ¥")]),s._v(", ç½‘ç»œè¿æ¥å’Œ IO è¿æ¥ç­‰, é™¤éå…¶æ˜¾å¼çš„è°ƒç”¨äº†å…¶ "),t("strong",[s._v("close()")]),s._v("  æ–¹æ³•å°†å…¶è¿æ¥å…³é—­, å¦åˆ™å¯èƒ½ä¸ä¼šè‡ªåŠ¨è¢« GC å›æ”¶.")]),s._v(" "),t("blockquote",[t("p",[s._v("å†…éƒ¨ç±»å’Œå¤–éƒ¨æ¨¡å—ç­‰çš„å¼•ç”¨")])]),s._v(" "),t("p",[t("strong",[s._v("å†…éƒ¨ç±»")]),s._v("çš„å¼•ç”¨æ˜¯æ¯”è¾ƒå®¹æ˜“é—å¿˜çš„ä¸€ç§, è€Œä¸”ä¸€æ—¦æ²¡é‡Šæ”¾å¯èƒ½å¯¼è‡´ä¸€ç³»åˆ—çš„åç»§ç±»å¯¹è±¡æ²¡æœ‰é‡Šæ”¾. åœ¨è°ƒç”¨å¤–éƒ¨æ¨¡å—çš„æ—¶å€™, ä¹Ÿåº”è¯¥æ³¨æ„é˜²æ­¢å†…å­˜æ³„æ¼, å¦‚æœæ¨¡å— A è°ƒç”¨äº†å¤–éƒ¨æ¨¡å— B çš„ä¸€ä¸ªæ–¹æ³•, å¦‚ register(Object o), è¿™ä¸ªæ–¹æ³•æœ‰å¯èƒ½å°±ä½¿å¾— A æ¨¡å—æŒæœ‰ä¼ å…¥å¯¹è±¡çš„å¼•ç”¨, è¿™æ—¶å€™éœ€è¦æŸ¥çœ‹ B æ¨¡å—æ˜¯å¦æä¾›äº†å‡ºå»å¼•ç”¨çš„æ–¹æ³•, è¿™ç§æƒ…å†µå®¹æ˜“å¿½ç•¥, è€Œä¸”å‘ç”Ÿå†…å­˜æ³„æ¼çš„è¯, è¿˜æ¯”è¾ƒéš¾å¯Ÿè§‰.")]),s._v(" "),t("blockquote",[t("p",[s._v("å•ä¾‹æ¨¡å¼")])]),s._v(" "),t("p",[s._v("å› ä¸ºå•åˆ©å¯¹è±¡åˆå§‹åŒ–åå°†åœ¨ JVM çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…å­˜åœ¨, å¦‚æœå®ƒæŒæœ‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸæ¯”è¾ƒçŸ­çš„å¤–éƒ¨å¯¹è±¡çš„å¼•ç”¨, é‚£ä¹ˆè¿™ä¸ªå¤–éƒ¨å¯¹è±¡å°±ä¸èƒ½è¢«å›æ”¶, ä»è€Œå¯¼è‡´å†…å­˜æ³„æ¼. å¦‚æœè¿™ä¸ªå¤–éƒ¨å¯¹è±¡è¿˜æŒæœ‰å…¶ä»–å¯¹è±¡çš„å¼•ç”¨, é‚£ä¹ˆå†…å­˜æ³„æ¼æ›´ä¸¥é‡.")]),s._v(" "),t("blockquote",[t("p",[s._v("nativeå¯¹è±¡")])]),s._v(" "),t("p",[s._v("ä¸€äº› native çš„å¯¹è±¡å¯èƒ½é€ æˆå†…å­˜æ³„æ¼. æ¯”å¦‚ Java ä½¿ç”¨ OpenCV çš„åŒ…è¿›è¡Œå›¾åƒå¤„ç†, å…¶ä¸­çš„ Mat å¯¹è±¡éœ€è¦æ‰‹åŠ¨è°ƒç”¨å…¶ native çš„ release() æ–¹æ³•è¿›è¡Œå†…å­˜é‡Šæ”¾, ä¸ç„¶å¯èƒ½å°±ä¼šé€ æˆå†…å­˜æ³„æ¼.")]),s._v(" "),t("h5",{attrs:{id:"_2-å†…å­˜æº¢å‡º"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-å†…å­˜æº¢å‡º"}},[s._v("#")]),s._v(" 2.å†…å­˜æº¢å‡º")]),s._v(" "),t("p",[t("strong",[s._v("å†…å­˜æº¢å‡º")]),s._v(": æŒ‡ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­"),t("strong",[s._v("æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜")]),s._v("è€Œå¯¼è‡´çš„ä¸€ç§é”™è¯¯, å½“å†…å­˜è¾ƒå°çš„æ—¶å€™å¯èƒ½æ­£å¸¸çš„ä¸šåŠ¡ä¹Ÿä¼šå¯¼è‡´å†…å­˜æº¢å‡º. "),t("strong",[s._v("å†…å­˜æ³„éœ²æ˜¯å†…å­˜æº¢å‡ºçš„ä¸€ç§è¯±å› ")]),s._v(", ä¸æ˜¯å”¯ä¸€å› ç´ .")]),s._v(" "),t("p",[s._v("è¯´ç™½äº†å°±æ˜¯"),t("strong",[s._v("å†…å­˜ä¸å¤Ÿ")]),s._v("ç”¨äº†, è¯¦ç»†ç¤ºä¾‹å‚è€ƒ: OutOfMemoryErrorå¼‚å¸¸ç¤ºä¾‹.")]),s._v(" "),t("h5",{attrs:{id:"_3-å¤„ç†æ–¹æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-å¤„ç†æ–¹æ³•"}},[s._v("#")]),s._v(" 3.å¤„ç†æ–¹æ³•")]),s._v(" "),t("p",[s._v("å¦‚æœæ˜¯"),t("strong",[s._v("å†…å­˜æ³„æ¼")]),s._v(", å¯è¿›ä¸€æ­¥é€šè¿‡å·¥å…·æŸ¥çœ‹æ³„æ¼å¯¹è±¡åˆ° GC Roots çš„å¼•ç”¨é“¾. äºæ˜¯å°±èƒ½æ‰¾åˆ°æ³„éœ²å¯¹è±¡æ˜¯é€šè¿‡æ€æ ·çš„è·¯å¾„ä¸ GC Roots ç›¸å…³è”å¹¶å¯¼è‡´åƒåœ¾æ”¶é›†å™¨æ— æ³•è‡ªåŠ¨å›æ”¶å®ƒä»¬çš„. æŒæ¡äº†æ³„æ¼å¯¹è±¡çš„ç±»å‹ä¿¡æ¯åŠ GC Roots å¼•ç”¨é“¾çš„ä¿¡æ¯, å°±å¯ä»¥æ¯”è¾ƒå‡†ç¡®çš„å®šä½å‡ºæ³„æ¼ä»£ç çš„ä½ç½®.")]),s._v(" "),t("p",[s._v("å¦‚æœ"),t("strong",[s._v("ä¸å­˜åœ¨æ³„æ¼")]),s._v(", æ¢å¥è¯è¯´å°±æ˜¯å†…å­˜ä¸­çš„å¯¹è±¡ç¡®å®è¿˜å¿…é¡»å­˜æ´»ç€, é‚£å°±åº”å½“æ£€æŸ¥è™šæ‹Ÿæœºçš„"),t("strong",[s._v("å †å‚æ•°")]),s._v("(-Xmx ä¸ -Xms), ä¸æœºå™¨ç‰©ç†å†…å­˜å¯¹æ¯”çœ‹æ˜¯å¦è¿˜å¯ä»¥è°ƒå¤§, ä»ä»£ç ä¸Šæ£€æŸ¥æ˜¯å¦å­˜åœ¨æŸäº›å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¿‡é•¿, æŒæœ‰çŠ¶æ€æ—¶é—´è¿‡é•¿çš„æƒ…å†µ, å°è¯•å‡å°‘çš„ç¨‹åºè¿è¡ŒæœŸçš„å†…å­˜æ¶ˆè€—.")]),s._v(" "),t("blockquote",[t("p",[s._v("æ’æŸ¥å·¥å…·")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("MemoryAnalyzer")]),s._v(": ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„ JAVA "),t("strong",[s._v("å †è½¬å‚¨")]),s._v("æ–‡ä»¶åˆ†æå·¥å…·, å¯ä»¥å‘ç°å†…å­˜æ¼æ´å’Œå‡å°‘å†…å­˜æ¶ˆè€—.")]),s._v(" "),t("li",[t("strong",[s._v("EclipseMAT")]),s._v(": æ˜¯ä¸€æ¬¾å¼€æºçš„ JAVA å†…å­˜åˆ†æè½¯ä»¶, æŸ¥æ‰¾å†…å­˜æ³„æ¼, èƒ½å®¹æ˜“æ‰¾åˆ°å¤§å—å†…å­˜å¹¶éªŒè¯è°åœ¨ä¸€ç›´å ç”¨å®ƒ.")])]),s._v(" "),t("h4",{attrs:{id:"æœ¬ç« å°ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æœ¬ç« å°ç»“"}},[s._v("#")]),s._v(" æœ¬ç« å°ç»“")]),s._v(" "),t("p",[s._v("æœ¬ç« ä»‹ç»äº†åƒåœ¾æ”¶é›†çš„ç®—æ³•, è‹¥å¹²æ¬¾ HotSpot è™šæ‹Ÿæœºä¸­æä¾›çš„åƒåœ¾æ”¶é›†å™¨çš„ç‰¹ç‚¹ä»¥åŠè¿ä½œåŸç†. é€šè¿‡ä»£ç å®ä¾‹éªŒè¯äº† Java è™šæ‹Ÿæœºä¸­è‡ªåŠ¨å†…å­˜åˆ†é…åŠå›æ”¶çš„ä¸»è¦è§„åˆ™.")]),s._v(" "),t("p",[s._v("åƒåœ¾æ”¶é›†å™¨åœ¨è®¸å¤šåœºæ™¯ä¸­éƒ½æ˜¯å½±å“ç³»ç»Ÿåœé¡¿æ—¶é—´å’Œååèƒ½åŠ›çš„é‡è¦å› ç´ ä¹‹ä¸€, è™šæ‹Ÿæœºä¹‹æ‰€ä»¥æä¾›å¤šç§ä¸åŒçš„æ”¶é›†å™¨ä»¥åŠå¤§é‡çš„è°ƒèŠ‚å‚æ•°, å°±æ˜¯å› ä¸ºåªæœ‰æ ¹æ®å®é™…åº”ç”¨éœ€æ±‚, å®ç°æ–¹å¼é€‰æ‹©æœ€ä¼˜çš„æ”¶é›†æ–¹å¼æ‰èƒ½è·å–æœ€å¥½çš„æ€§èƒ½. æ²¡æœ‰å›ºå®šæ”¶é›†å™¨, å‚æ•°ç»„åˆ, æ²¡æœ‰æœ€ä¼˜çš„è°ƒä¼˜æ–¹æ³•, è™šæ‹Ÿæœºä¹Ÿå°±æ²¡æœ‰ä»€ä¹ˆå¿…ç„¶çš„å†…å­˜å›æ”¶è¡Œä¸º. å› æ­¤å­¦ä¹ è™šæ‹Ÿæœºå†…å­˜çŸ¥è¯†, å¦‚æœè¦åˆ°å®è·µè°ƒä¼˜é˜¶æ®µ, å¿…é¡»"),t("strong",[s._v("äº†è§£æ¯ä¸ªå…·ä½“æ”¶é›†å™¨çš„è¡Œä¸º, ä¼˜åŠ¿åŠ£åŠ¿, è°ƒèŠ‚å‚æ•°")]),s._v(". åœ¨æ¥ä¸‹æ¥çš„ä¸¤ç« ä¸­, ä½œè€…å°†ä¼šä»‹ç»å†…å­˜åˆ†æçš„å·¥å…·å’Œä¸€äº›å…·ä½“è°ƒä¼˜çš„æ¡ˆä¾‹.")]),s._v(" "),t("p",[s._v("â€")]),s._v(" "),t("h4",{attrs:{id:"å‚è€ƒèµ„æ–™"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒèµ„æ–™"}},[s._v("#")]),s._v(" å‚è€ƒèµ„æ–™")]),s._v(" "),t("ul",[t("li",[s._v("å¦‚ä½•é˜…è¯»GCæ—¥å¿—: "),t("a",{attrs:{href:"https://www.jianshu.com/p/4e508ed55155",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.jianshu.com/p/4e508ed55155"),t("OutboundLink")],1)]),s._v(" "),t("li",[s._v("ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœº: JVM é«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µ(ç¬¬äºŒç‰ˆã€‹")]),s._v(" "),t("li",[t("a",{attrs:{href:"https://my.oschina.net/hosee/blog/644618",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://my.oschina.net/hosee/blog/644618"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://docs.oracle.com/javase/specs/jvms/se8/html/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://docs.oracle.com/javase/specs/jvms/se8/html/index.html"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1958285",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://cloud.tencent.com/developer/article/1958285"),t("OutboundLink")],1)])]),s._v(" "),t("p",[s._v("â€")])])}),[],!1,null,null,null);t.default=e.exports}}]);