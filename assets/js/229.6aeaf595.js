(window.webpackJsonp=window.webpackJsonp||[]).push([[229],{532:function(_,v,t){"use strict";t.r(v);var a=t(7),s=Object(a.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h1",{attrs:{id:"_10-拍照检查接口流程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_10-拍照检查接口流程"}},[_._v("#")]),_._v(" 10.拍照检查接口流程")]),_._v(" "),v("h4",{attrs:{id:"拍照检查接口"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#拍照检查接口"}},[_._v("#")]),_._v(" 拍照检查接口")]),_._v(" "),v("p",[_._v("​"),v("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/1717234504340-20240601173807-okrx4ey.jpg",alt:""}}),_._v("​")]),_._v(" "),v("p",[_._v("如上图所示:")]),_._v(" "),v("ol",[v("li",[v("p",[_._v("首先用户在小猿口算客户端提交拍照检查请求, 这里分两种情况:")]),_._v(" "),v("ol",[v("li",[_._v("旧逻辑: 拍照检查请求携带图片资源.")]),_._v(" "),v("li",[_._v("新逻辑: 拍照检查请求不携带图片资源.")])])]),_._v(" "),v("li",[v("p",[_._v("服务端生成一些必要的信息来标示此次检查, ImageId, QueryId, EvaluationId, 三者应该是一一对应的.")])]),_._v(" "),v("li",[v("p",[_._v("如果拍照检查接口未携带图片资源, 而是图片的位置信息, 那么说明客户端已经提前上传过图片了, 服务端需要从OSS上下载下来(这里只是过渡方案).")])]),_._v(" "),v("li",[v("p",[v("strong",[_._v("solar-thor 调用研究组的检查接口进行识别, 题目搜索, 批改, 获取检查结果, 最后返回给 solar-thor 检查识别结果")]),_._v(".")])]),_._v(" "),v("li",[v("p",[_._v("异步保存用户拍照检查历史, 拍照检查识别结果, 对于部分题型, 需要自动加入错题本.")])]),_._v(" "),v("li",[v("p",[_._v("对研究组返回检查结果进行转换, 转换为端上使用的数据结构.")])])]),_._v(" "),v("p",[v("strong",[_._v("核心功能主要在研究组, 口算这边(服务端, 客户端)主要是检查的记录存储, 检查的结果展示")]),_._v(".")]),_._v(" "),v("p",[_._v("这里省略了一些细节, 比如过滤不支持的题型, 对题目内容, 答案中的特殊标示做替换等步骤.")]),_._v(" "),v("blockquote",[v("p",[_._v("检查后续流程")])]),_._v(" "),v("p",[_._v("拍照检查的接口完成之后, 对于大部分题型, 拍照检查接口返回中包含了题目以及答案等信息, 但 Apollo 的题目, 拍照检查只返回了题目的 Token, 客户端需要用 Token 再单独拉取另外的接口拿到题目详情.")]),_._v(" "),v("p",[_._v("此外, 拍照检查详情页面还有其他模块需要展示, 比如题目讲解, 知识点讲解, 动画视频, 数学思维专辑 等模块, 都需要拉取单独的接口.")]),_._v(" "),v("h4",{attrs:{id:"检查历史接口"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#检查历史接口"}},[_._v("#")]),_._v(" 检查历史接口")]),_._v(" "),v("p",[_._v("​"),v("img",{attrs:{src:"https://nano-note.oss-cn-beijing.aliyuncs.com/images/image-20240601174023-1l940du.png",alt:"image"}}),_._v("​")]),_._v(" "),v("p",[_._v("拉取检查历史的逻辑比较简单:")]),_._v(" "),v("ol",[v("li",[_._v("根据用户条件首先从数据库中查询拍照检查历史, 但数据库中没有存储拍照检查的识别结果.")]),_._v(" "),v("li",[_._v("根据数据库中查询得到的信息(其实是 ImageId)从 OSS 上拉取检查的识别结果.")]),_._v(" "),v("li",[_._v("对结果进行转换, 这里的转换逻辑与拍照检查的接口中一样.")])]),_._v(" "),v("p",[_._v("‍")])])}),[],!1,null,null,null);v.default=s.exports}}]);